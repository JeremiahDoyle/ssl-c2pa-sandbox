"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/bytestreamjs";
exports.ids = ["vendor-chunks/bytestreamjs"];
exports.modules = {

/***/ "(ssr)/./node_modules/bytestreamjs/build/mjs/bit.js":
/*!****************************************************!*\
  !*** ./node_modules/bytestreamjs/build/mjs/bit.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bitsToStringArray: () => (/* binding */ bitsToStringArray)\n/* harmony export */ });\nconst bitsToStringArray = [\n    \"00000000\", \"00000001\", \"00000010\",\n    \"00000011\", \"00000100\", \"00000101\",\n    \"00000110\", \"00000111\", \"00001000\",\n    \"00001001\", \"00001010\", \"00001011\",\n    \"00001100\", \"00001101\", \"00001110\",\n    \"00001111\", \"00010000\", \"00010001\",\n    \"00010010\", \"00010011\", \"00010100\",\n    \"00010101\", \"00010110\", \"00010111\",\n    \"00011000\", \"00011001\", \"00011010\",\n    \"00011011\", \"00011100\", \"00011101\",\n    \"00011110\", \"00011111\", \"00100000\",\n    \"00100001\", \"00100010\", \"00100011\",\n    \"00100100\", \"00100101\", \"00100110\",\n    \"00100111\", \"00101000\", \"00101001\",\n    \"00101010\", \"00101011\", \"00101100\",\n    \"00101101\", \"00101110\", \"00101111\",\n    \"00110000\", \"00110001\", \"00110010\",\n    \"00110011\", \"00110100\", \"00110101\",\n    \"00110110\", \"00110111\", \"00111000\",\n    \"00111001\", \"00111010\", \"00111011\",\n    \"00111100\", \"00111101\", \"00111110\",\n    \"00111111\", \"01000000\", \"01000001\",\n    \"01000010\", \"01000011\", \"01000100\",\n    \"01000101\", \"01000110\", \"01000111\",\n    \"01001000\", \"01001001\", \"01001010\",\n    \"01001011\", \"01001100\", \"01001101\",\n    \"01001110\", \"01001111\", \"01010000\",\n    \"01010001\", \"01010010\", \"01010011\",\n    \"01010100\", \"01010101\", \"01010110\",\n    \"01010111\", \"01011000\", \"01011001\",\n    \"01011010\", \"01011011\", \"01011100\",\n    \"01011101\", \"01011110\", \"01011111\",\n    \"01100000\", \"01100001\", \"01100010\",\n    \"01100011\", \"01100100\", \"01100101\",\n    \"01100110\", \"01100111\", \"01101000\",\n    \"01101001\", \"01101010\", \"01101011\",\n    \"01101100\", \"01101101\", \"01101110\",\n    \"01101111\", \"01110000\", \"01110001\",\n    \"01110010\", \"01110011\", \"01110100\",\n    \"01110101\", \"01110110\", \"01110111\",\n    \"01111000\", \"01111001\", \"01111010\",\n    \"01111011\", \"01111100\", \"01111101\",\n    \"01111110\", \"01111111\", \"10000000\",\n    \"10000001\", \"10000010\", \"10000011\",\n    \"10000100\", \"10000101\", \"10000110\",\n    \"10000111\", \"10001000\", \"10001001\",\n    \"10001010\", \"10001011\", \"10001100\",\n    \"10001101\", \"10001110\", \"10001111\",\n    \"10010000\", \"10010001\", \"10010010\",\n    \"10010011\", \"10010100\", \"10010101\",\n    \"10010110\", \"10010111\", \"10011000\",\n    \"10011001\", \"10011010\", \"10011011\",\n    \"10011100\", \"10011101\", \"10011110\",\n    \"10011111\", \"10100000\", \"10100001\",\n    \"10100010\", \"10100011\", \"10100100\",\n    \"10100101\", \"10100110\", \"10100111\",\n    \"10101000\", \"10101001\", \"10101010\",\n    \"10101011\", \"10101100\", \"10101101\",\n    \"10101110\", \"10101111\", \"10110000\",\n    \"10110001\", \"10110010\", \"10110011\",\n    \"10110100\", \"10110101\", \"10110110\",\n    \"10110111\", \"10111000\", \"10111001\",\n    \"10111010\", \"10111011\", \"10111100\",\n    \"10111101\", \"10111110\", \"10111111\",\n    \"11000000\", \"11000001\", \"11000010\",\n    \"11000011\", \"11000100\", \"11000101\",\n    \"11000110\", \"11000111\", \"11001000\",\n    \"11001001\", \"11001010\", \"11001011\",\n    \"11001100\", \"11001101\", \"11001110\",\n    \"11001111\", \"11010000\", \"11010001\",\n    \"11010010\", \"11010011\", \"11010100\",\n    \"11010101\", \"11010110\", \"11010111\",\n    \"11011000\", \"11011001\", \"11011010\",\n    \"11011011\", \"11011100\", \"11011101\",\n    \"11011110\", \"11011111\", \"11100000\",\n    \"11100001\", \"11100010\", \"11100011\",\n    \"11100100\", \"11100101\", \"11100110\",\n    \"11100111\", \"11101000\", \"11101001\",\n    \"11101010\", \"11101011\", \"11101100\",\n    \"11101101\", \"11101110\", \"11101111\",\n    \"11110000\", \"11110001\", \"11110010\",\n    \"11110011\", \"11110100\", \"11110101\",\n    \"11110110\", \"11110111\", \"11111000\",\n    \"11111001\", \"11111010\", \"11111011\",\n    \"11111100\", \"11111101\", \"11111110\",\n    \"11111111\"\n];\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYnl0ZXN0cmVhbWpzL2J1aWxkL21qcy9iaXQuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvamVyZW1pYWgvRGVza3RvcC9jMnBhIHRvb2wvbm9kZV9tb2R1bGVzL2J5dGVzdHJlYW1qcy9idWlsZC9tanMvYml0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBiaXRzVG9TdHJpbmdBcnJheSA9IFtcbiAgICBcIjAwMDAwMDAwXCIsIFwiMDAwMDAwMDFcIiwgXCIwMDAwMDAxMFwiLFxuICAgIFwiMDAwMDAwMTFcIiwgXCIwMDAwMDEwMFwiLCBcIjAwMDAwMTAxXCIsXG4gICAgXCIwMDAwMDExMFwiLCBcIjAwMDAwMTExXCIsIFwiMDAwMDEwMDBcIixcbiAgICBcIjAwMDAxMDAxXCIsIFwiMDAwMDEwMTBcIiwgXCIwMDAwMTAxMVwiLFxuICAgIFwiMDAwMDExMDBcIiwgXCIwMDAwMTEwMVwiLCBcIjAwMDAxMTEwXCIsXG4gICAgXCIwMDAwMTExMVwiLCBcIjAwMDEwMDAwXCIsIFwiMDAwMTAwMDFcIixcbiAgICBcIjAwMDEwMDEwXCIsIFwiMDAwMTAwMTFcIiwgXCIwMDAxMDEwMFwiLFxuICAgIFwiMDAwMTAxMDFcIiwgXCIwMDAxMDExMFwiLCBcIjAwMDEwMTExXCIsXG4gICAgXCIwMDAxMTAwMFwiLCBcIjAwMDExMDAxXCIsIFwiMDAwMTEwMTBcIixcbiAgICBcIjAwMDExMDExXCIsIFwiMDAwMTExMDBcIiwgXCIwMDAxMTEwMVwiLFxuICAgIFwiMDAwMTExMTBcIiwgXCIwMDAxMTExMVwiLCBcIjAwMTAwMDAwXCIsXG4gICAgXCIwMDEwMDAwMVwiLCBcIjAwMTAwMDEwXCIsIFwiMDAxMDAwMTFcIixcbiAgICBcIjAwMTAwMTAwXCIsIFwiMDAxMDAxMDFcIiwgXCIwMDEwMDExMFwiLFxuICAgIFwiMDAxMDAxMTFcIiwgXCIwMDEwMTAwMFwiLCBcIjAwMTAxMDAxXCIsXG4gICAgXCIwMDEwMTAxMFwiLCBcIjAwMTAxMDExXCIsIFwiMDAxMDExMDBcIixcbiAgICBcIjAwMTAxMTAxXCIsIFwiMDAxMDExMTBcIiwgXCIwMDEwMTExMVwiLFxuICAgIFwiMDAxMTAwMDBcIiwgXCIwMDExMDAwMVwiLCBcIjAwMTEwMDEwXCIsXG4gICAgXCIwMDExMDAxMVwiLCBcIjAwMTEwMTAwXCIsIFwiMDAxMTAxMDFcIixcbiAgICBcIjAwMTEwMTEwXCIsIFwiMDAxMTAxMTFcIiwgXCIwMDExMTAwMFwiLFxuICAgIFwiMDAxMTEwMDFcIiwgXCIwMDExMTAxMFwiLCBcIjAwMTExMDExXCIsXG4gICAgXCIwMDExMTEwMFwiLCBcIjAwMTExMTAxXCIsIFwiMDAxMTExMTBcIixcbiAgICBcIjAwMTExMTExXCIsIFwiMDEwMDAwMDBcIiwgXCIwMTAwMDAwMVwiLFxuICAgIFwiMDEwMDAwMTBcIiwgXCIwMTAwMDAxMVwiLCBcIjAxMDAwMTAwXCIsXG4gICAgXCIwMTAwMDEwMVwiLCBcIjAxMDAwMTEwXCIsIFwiMDEwMDAxMTFcIixcbiAgICBcIjAxMDAxMDAwXCIsIFwiMDEwMDEwMDFcIiwgXCIwMTAwMTAxMFwiLFxuICAgIFwiMDEwMDEwMTFcIiwgXCIwMTAwMTEwMFwiLCBcIjAxMDAxMTAxXCIsXG4gICAgXCIwMTAwMTExMFwiLCBcIjAxMDAxMTExXCIsIFwiMDEwMTAwMDBcIixcbiAgICBcIjAxMDEwMDAxXCIsIFwiMDEwMTAwMTBcIiwgXCIwMTAxMDAxMVwiLFxuICAgIFwiMDEwMTAxMDBcIiwgXCIwMTAxMDEwMVwiLCBcIjAxMDEwMTEwXCIsXG4gICAgXCIwMTAxMDExMVwiLCBcIjAxMDExMDAwXCIsIFwiMDEwMTEwMDFcIixcbiAgICBcIjAxMDExMDEwXCIsIFwiMDEwMTEwMTFcIiwgXCIwMTAxMTEwMFwiLFxuICAgIFwiMDEwMTExMDFcIiwgXCIwMTAxMTExMFwiLCBcIjAxMDExMTExXCIsXG4gICAgXCIwMTEwMDAwMFwiLCBcIjAxMTAwMDAxXCIsIFwiMDExMDAwMTBcIixcbiAgICBcIjAxMTAwMDExXCIsIFwiMDExMDAxMDBcIiwgXCIwMTEwMDEwMVwiLFxuICAgIFwiMDExMDAxMTBcIiwgXCIwMTEwMDExMVwiLCBcIjAxMTAxMDAwXCIsXG4gICAgXCIwMTEwMTAwMVwiLCBcIjAxMTAxMDEwXCIsIFwiMDExMDEwMTFcIixcbiAgICBcIjAxMTAxMTAwXCIsIFwiMDExMDExMDFcIiwgXCIwMTEwMTExMFwiLFxuICAgIFwiMDExMDExMTFcIiwgXCIwMTExMDAwMFwiLCBcIjAxMTEwMDAxXCIsXG4gICAgXCIwMTExMDAxMFwiLCBcIjAxMTEwMDExXCIsIFwiMDExMTAxMDBcIixcbiAgICBcIjAxMTEwMTAxXCIsIFwiMDExMTAxMTBcIiwgXCIwMTExMDExMVwiLFxuICAgIFwiMDExMTEwMDBcIiwgXCIwMTExMTAwMVwiLCBcIjAxMTExMDEwXCIsXG4gICAgXCIwMTExMTAxMVwiLCBcIjAxMTExMTAwXCIsIFwiMDExMTExMDFcIixcbiAgICBcIjAxMTExMTEwXCIsIFwiMDExMTExMTFcIiwgXCIxMDAwMDAwMFwiLFxuICAgIFwiMTAwMDAwMDFcIiwgXCIxMDAwMDAxMFwiLCBcIjEwMDAwMDExXCIsXG4gICAgXCIxMDAwMDEwMFwiLCBcIjEwMDAwMTAxXCIsIFwiMTAwMDAxMTBcIixcbiAgICBcIjEwMDAwMTExXCIsIFwiMTAwMDEwMDBcIiwgXCIxMDAwMTAwMVwiLFxuICAgIFwiMTAwMDEwMTBcIiwgXCIxMDAwMTAxMVwiLCBcIjEwMDAxMTAwXCIsXG4gICAgXCIxMDAwMTEwMVwiLCBcIjEwMDAxMTEwXCIsIFwiMTAwMDExMTFcIixcbiAgICBcIjEwMDEwMDAwXCIsIFwiMTAwMTAwMDFcIiwgXCIxMDAxMDAxMFwiLFxuICAgIFwiMTAwMTAwMTFcIiwgXCIxMDAxMDEwMFwiLCBcIjEwMDEwMTAxXCIsXG4gICAgXCIxMDAxMDExMFwiLCBcIjEwMDEwMTExXCIsIFwiMTAwMTEwMDBcIixcbiAgICBcIjEwMDExMDAxXCIsIFwiMTAwMTEwMTBcIiwgXCIxMDAxMTAxMVwiLFxuICAgIFwiMTAwMTExMDBcIiwgXCIxMDAxMTEwMVwiLCBcIjEwMDExMTEwXCIsXG4gICAgXCIxMDAxMTExMVwiLCBcIjEwMTAwMDAwXCIsIFwiMTAxMDAwMDFcIixcbiAgICBcIjEwMTAwMDEwXCIsIFwiMTAxMDAwMTFcIiwgXCIxMDEwMDEwMFwiLFxuICAgIFwiMTAxMDAxMDFcIiwgXCIxMDEwMDExMFwiLCBcIjEwMTAwMTExXCIsXG4gICAgXCIxMDEwMTAwMFwiLCBcIjEwMTAxMDAxXCIsIFwiMTAxMDEwMTBcIixcbiAgICBcIjEwMTAxMDExXCIsIFwiMTAxMDExMDBcIiwgXCIxMDEwMTEwMVwiLFxuICAgIFwiMTAxMDExMTBcIiwgXCIxMDEwMTExMVwiLCBcIjEwMTEwMDAwXCIsXG4gICAgXCIxMDExMDAwMVwiLCBcIjEwMTEwMDEwXCIsIFwiMTAxMTAwMTFcIixcbiAgICBcIjEwMTEwMTAwXCIsIFwiMTAxMTAxMDFcIiwgXCIxMDExMDExMFwiLFxuICAgIFwiMTAxMTAxMTFcIiwgXCIxMDExMTAwMFwiLCBcIjEwMTExMDAxXCIsXG4gICAgXCIxMDExMTAxMFwiLCBcIjEwMTExMDExXCIsIFwiMTAxMTExMDBcIixcbiAgICBcIjEwMTExMTAxXCIsIFwiMTAxMTExMTBcIiwgXCIxMDExMTExMVwiLFxuICAgIFwiMTEwMDAwMDBcIiwgXCIxMTAwMDAwMVwiLCBcIjExMDAwMDEwXCIsXG4gICAgXCIxMTAwMDAxMVwiLCBcIjExMDAwMTAwXCIsIFwiMTEwMDAxMDFcIixcbiAgICBcIjExMDAwMTEwXCIsIFwiMTEwMDAxMTFcIiwgXCIxMTAwMTAwMFwiLFxuICAgIFwiMTEwMDEwMDFcIiwgXCIxMTAwMTAxMFwiLCBcIjExMDAxMDExXCIsXG4gICAgXCIxMTAwMTEwMFwiLCBcIjExMDAxMTAxXCIsIFwiMTEwMDExMTBcIixcbiAgICBcIjExMDAxMTExXCIsIFwiMTEwMTAwMDBcIiwgXCIxMTAxMDAwMVwiLFxuICAgIFwiMTEwMTAwMTBcIiwgXCIxMTAxMDAxMVwiLCBcIjExMDEwMTAwXCIsXG4gICAgXCIxMTAxMDEwMVwiLCBcIjExMDEwMTEwXCIsIFwiMTEwMTAxMTFcIixcbiAgICBcIjExMDExMDAwXCIsIFwiMTEwMTEwMDFcIiwgXCIxMTAxMTAxMFwiLFxuICAgIFwiMTEwMTEwMTFcIiwgXCIxMTAxMTEwMFwiLCBcIjExMDExMTAxXCIsXG4gICAgXCIxMTAxMTExMFwiLCBcIjExMDExMTExXCIsIFwiMTExMDAwMDBcIixcbiAgICBcIjExMTAwMDAxXCIsIFwiMTExMDAwMTBcIiwgXCIxMTEwMDAxMVwiLFxuICAgIFwiMTExMDAxMDBcIiwgXCIxMTEwMDEwMVwiLCBcIjExMTAwMTEwXCIsXG4gICAgXCIxMTEwMDExMVwiLCBcIjExMTAxMDAwXCIsIFwiMTExMDEwMDFcIixcbiAgICBcIjExMTAxMDEwXCIsIFwiMTExMDEwMTFcIiwgXCIxMTEwMTEwMFwiLFxuICAgIFwiMTExMDExMDFcIiwgXCIxMTEwMTExMFwiLCBcIjExMTAxMTExXCIsXG4gICAgXCIxMTExMDAwMFwiLCBcIjExMTEwMDAxXCIsIFwiMTExMTAwMTBcIixcbiAgICBcIjExMTEwMDExXCIsIFwiMTExMTAxMDBcIiwgXCIxMTExMDEwMVwiLFxuICAgIFwiMTExMTAxMTBcIiwgXCIxMTExMDExMVwiLCBcIjExMTExMDAwXCIsXG4gICAgXCIxMTExMTAwMVwiLCBcIjExMTExMDEwXCIsIFwiMTExMTEwMTFcIixcbiAgICBcIjExMTExMTAwXCIsIFwiMTExMTExMDFcIiwgXCIxMTExMTExMFwiLFxuICAgIFwiMTExMTExMTFcIlxuXTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/bytestreamjs/build/mjs/bit.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/bytestreamjs/build/mjs/bit_stream.js":
/*!***********************************************************!*\
  !*** ./node_modules/bytestreamjs/build/mjs/bit_stream.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BitStream: () => (/* binding */ BitStream)\n/* harmony export */ });\n/* harmony import */ var _bit__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bit */ \"(ssr)/./node_modules/bytestreamjs/build/mjs/bit.js\");\n/* harmony import */ var _byte_stream__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./byte_stream */ \"(ssr)/./node_modules/bytestreamjs/build/mjs/byte_stream.js\");\n\n\nclass BitStream {\n    constructor(parameters) {\n        this.buffer = new ArrayBuffer(0);\n        this.view = new Uint8Array(this.buffer);\n        this.bitsCount = 0;\n        if (parameters) {\n            if (\"byteStream\" in parameters) {\n                this.fromByteStream(parameters.byteStream);\n            }\n            if (\"view\" in parameters) {\n                this.fromUint8Array(parameters.view);\n            }\n            if (\"buffer\" in parameters) {\n                this.fromArrayBuffer(parameters.buffer);\n            }\n            if (\"string\" in parameters) {\n                this.fromString(parameters.string);\n            }\n            if (\"uint32\" in parameters) {\n                this.fromUint32(parameters.uint32);\n            }\n            if (\"bitsCount\" in parameters && parameters.bitsCount) {\n                this.bitsCount = parameters.bitsCount;\n            }\n        }\n    }\n    clear() {\n        this.buffer = new ArrayBuffer(0);\n        this.view = new Uint8Array(this.buffer);\n        this.bitsCount = 0;\n    }\n    fromByteStream(stream) {\n        this.fromUint8Array(stream.view);\n    }\n    fromArrayBuffer(array) {\n        this.buffer = array;\n        this.view = new Uint8Array(array);\n        this.bitsCount = this.view.length << 3;\n    }\n    fromUint8Array(array) {\n        this.fromArrayBuffer(new Uint8Array(array).buffer);\n    }\n    fromString(string) {\n        const stringLength = string.length;\n        this.buffer = new ArrayBuffer((stringLength >> 3) + ((stringLength % 8) ? 1 : 0));\n        this.view = new Uint8Array(this.buffer);\n        this.bitsCount = ((stringLength >> 3) + 1) << 3;\n        let byteIndex = 0;\n        for (let i = 0; i < stringLength; i++) {\n            if (string[i] == \"1\")\n                this.view[byteIndex] |= 1 << (7 - (i % 8));\n            if (i && (((i + 1) % 8) == 0))\n                byteIndex++;\n        }\n        if (stringLength % 8)\n            this.shiftRight(8 - (stringLength % 8));\n        this.bitsCount = stringLength;\n    }\n    fromUint32(uint32) {\n        this.buffer = new ArrayBuffer(4);\n        this.view = new Uint8Array(this.buffer);\n        const value = new Uint32Array([uint32]);\n        const view = new Uint8Array(value.buffer);\n        for (let i = 3; i >= 0; i--)\n            this.view[i] = view[3 - i];\n        this.bitsCount = 32;\n    }\n    toString(start, length) {\n        if (start == null) {\n            start = 0;\n        }\n        if ((start >= this.view.length) || (start < 0)) {\n            start = 0;\n        }\n        if (length == null) {\n            length = this.view.length - start;\n        }\n        if ((length >= this.view.length) || (length < 0)) {\n            length = this.view.length - start;\n        }\n        const result = [];\n        for (let i = start; i < (start + length); i++) {\n            result.push(_bit__WEBPACK_IMPORTED_MODULE_0__.bitsToStringArray[this.view[i]]);\n        }\n        return result.join(\"\").substring((this.view.length << 3) - this.bitsCount);\n    }\n    shiftRight(shift, needShrink = true) {\n        if (this.view.length == 0) {\n            return;\n        }\n        if ((shift < 0) || (shift > 8)) {\n            throw new Error(\"The \\\"shift\\\" parameter must be in range 0-8\");\n        }\n        if (shift > this.bitsCount) {\n            throw new Error(\"The \\\"shift\\\" parameter can not be bigger than \\\"this.bitsCount\\\"\");\n        }\n        const shiftMask = 0xFF >> (8 - shift);\n        this.view[this.view.length - 1] >>= shift;\n        for (let i = (this.view.length - 2); i >= 0; i--) {\n            this.view[i + 1] |= (this.view[i] & shiftMask) << (8 - shift);\n            this.view[i] >>= shift;\n        }\n        this.bitsCount -= shift;\n        if (this.bitsCount == 0) {\n            this.clear();\n        }\n        if (needShrink) {\n            this.shrink();\n        }\n    }\n    shiftLeft(shift) {\n        if (this.view.length == 0) {\n            return;\n        }\n        if ((shift < 0) || (shift > 8)) {\n            throw new Error(\"The \\\"shift\\\" parameter must be in range 0-8\");\n        }\n        if (shift > this.bitsCount) {\n            throw new Error(\"The \\\"shift\\\" parameter can not be bigger than \\\"this.bitsCount\\\"\");\n        }\n        const bitsOffset = this.bitsCount & 0x07;\n        if (bitsOffset > shift) {\n            this.view[0] &= 0xFF >> (bitsOffset + shift);\n        }\n        else {\n            const view = this.view.slice(1);\n            view[0] &= 0xFF >> (shift - bitsOffset);\n            this.buffer = view.buffer;\n            this.view = view;\n        }\n        this.bitsCount -= shift;\n        if (this.bitsCount == 0) {\n            this.clear();\n        }\n    }\n    slice(start = 0, end = 0) {\n        let valueShift = 0;\n        if (this.bitsCount % 8) {\n            valueShift = (8 - (this.bitsCount % 8));\n        }\n        start += valueShift;\n        end += valueShift;\n        const maxEnd = (this.view.length << 3) - 1;\n        if ((start < 0) || (start > maxEnd)) {\n            return new BitStream();\n        }\n        if (!end) {\n            end = maxEnd;\n        }\n        if ((end < 0) || (end > maxEnd)) {\n            return new BitStream();\n        }\n        if ((end - start + 1) > this.bitsCount) {\n            return new BitStream();\n        }\n        const startIndex = start >> 3;\n        const startOffset = start & 0x07;\n        const endIndex = end >> 3;\n        const endOffset = end & 0x07;\n        const bitsLength = ((endIndex - startIndex) == 0) ? 1 : (endIndex - startIndex + 1);\n        const result = new BitStream({\n            buffer: this.buffer.slice(startIndex, startIndex + bitsLength),\n            bitsCount: bitsLength << 3,\n        });\n        result.view[0] &= (0xFF >> startOffset);\n        result.view[bitsLength] &= (0xFF << (7 - endOffset));\n        if (7 - endOffset) {\n            result.shiftRight(7 - endOffset, false);\n        }\n        result.bitsCount = (end - start + 1);\n        result.shrink();\n        return result;\n    }\n    copy(start = 0, length = 0) {\n        const maxEnd = (this.view.length << 3) - 1;\n        if ((start < 0) || (start > maxEnd)) {\n            return new BitStream();\n        }\n        if (!length) {\n            length = (this.view.length << 3) - start - 1;\n        }\n        if (length > this.bitsCount) {\n            return new BitStream();\n        }\n        return this.slice(start, start + length - 1);\n    }\n    shrink() {\n        const currentLength = (this.bitsCount >> 3) + ((this.bitsCount % 8) ? 1 : 0);\n        if (currentLength < this.view.length) {\n            const view = this.view.slice(this.view.length - currentLength, (this.view.length - currentLength) + currentLength);\n            this.view = view;\n            this.buffer = view.buffer;\n        }\n    }\n    reverseBytes() {\n        for (let i = 0; i < this.view.length; i++) {\n            this.view[i] = ((this.view[i] * 0x0802 & 0x22110) | (this.view[i] * 0x8020 & 0x88440)) * 0x10101 >> 16;\n        }\n        if (this.bitsCount % 8) {\n            const currentLength = (this.bitsCount >> 3) + ((this.bitsCount % 8) ? 1 : 0);\n            this.view[this.view.length - currentLength] >>= (8 - (this.bitsCount & 0x07));\n        }\n    }\n    reverseValue() {\n        const initialValue = this.toString();\n        const initialValueLength = initialValue.length;\n        const reversedValue = new Array(initialValueLength);\n        for (let i = 0; i < initialValueLength; i++) {\n            reversedValue[initialValueLength - 1 - i] = initialValue[i];\n        }\n        this.fromString(reversedValue.join(\"\"));\n    }\n    getNumberValue() {\n        const byteLength = (this.view.length - 1);\n        if (byteLength > 3) {\n            return (-1);\n        }\n        if (byteLength == (-1)) {\n            return 0;\n        }\n        const value = new Uint32Array(1);\n        const view = new Uint8Array(value.buffer);\n        for (let i = byteLength; i >= 0; i--) {\n            view[byteLength - i] = this.view[i];\n        }\n        return value[0];\n    }\n    findPattern(pattern, start, length, backward) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString(),\n        });\n        const stringPattern = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: pattern.toString()\n        });\n        return stringStream.findPattern(stringPattern, start, length, backward);\n    }\n    findFirstIn(patterns, start, length, backward) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString(),\n        });\n        const stringPatterns = new Array(patterns.length);\n        for (let i = 0; i < patterns.length; i++) {\n            stringPatterns[i] = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n                string: patterns[i].toString()\n            });\n        }\n        return stringStream.findFirstIn(stringPatterns, start, length, backward);\n    }\n    findAllIn(patterns, start, length) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString()\n        });\n        const stringPatterns = new Array(patterns.length);\n        for (let i = 0; i < patterns.length; i++) {\n            stringPatterns[i] = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n                string: patterns[i].toString()\n            });\n        }\n        return stringStream.findAllIn(stringPatterns, start, length);\n    }\n    findAllPatternIn(pattern, start, length) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString()\n        });\n        const stringPattern = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: pattern.toString()\n        });\n        return stringStream.findAllPatternIn(stringPattern, start, length);\n    }\n    findFirstNotIn(patterns, start, length, backward) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString()\n        });\n        const stringPatterns = new Array(patterns.length);\n        for (let i = 0; i < patterns.length; i++) {\n            stringPatterns[i] = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n                string: patterns[i].toString()\n            });\n        }\n        return stringStream.findFirstNotIn(stringPatterns, start, length, backward);\n    }\n    findAllNotIn(patterns, start, length) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString()\n        });\n        const stringPatterns = new Array(patterns.length);\n        for (let i = 0; i < patterns.length; i++) {\n            stringPatterns[i] = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n                string: patterns[i].toString()\n            });\n        }\n        return stringStream.findAllNotIn(stringPatterns, start, length);\n    }\n    findFirstSequence(patterns, start, length, backward) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString()\n        });\n        const stringPatterns = new Array(patterns.length);\n        for (let i = 0; i < patterns.length; i++) {\n            stringPatterns[i] = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n                string: patterns[i].toString()\n            });\n        }\n        return stringStream.findFirstSequence(stringPatterns, start, length, backward);\n    }\n    findAllSequences(patterns, start, length) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString()\n        });\n        const stringPatterns = new Array(patterns.length);\n        for (let i = 0; i < patterns.length; i++) {\n            stringPatterns[i] = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n                string: patterns[i].toString()\n            });\n        }\n        return stringStream.findAllSequences(stringPatterns, start, length);\n    }\n    findPairedPatterns(leftPattern, rightPattern, start, length) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString()\n        });\n        const stringLeftPattern = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: leftPattern.toString()\n        });\n        const stringRightPattern = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: rightPattern.toString()\n        });\n        return stringStream.findPairedPatterns(stringLeftPattern, stringRightPattern, start, length);\n    }\n    findPairedArrays(inputLeftPatterns, inputRightPatterns, start, length) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString()\n        });\n        const stringLeftPatterns = new Array(inputLeftPatterns.length);\n        for (let i = 0; i < inputLeftPatterns.length; i++) {\n            stringLeftPatterns[i] = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n                string: inputLeftPatterns[i].toString()\n            });\n        }\n        const stringRightPatterns = new Array(inputRightPatterns.length);\n        for (let i = 0; i < inputRightPatterns.length; i++) {\n            stringRightPatterns[i] = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n                string: inputRightPatterns[i].toString()\n            });\n        }\n        return stringStream.findPairedArrays(stringLeftPatterns, stringRightPatterns, start, length);\n    }\n    replacePattern(searchPattern, replacePattern, start, length) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString()\n        });\n        const stringSearchPattern = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: searchPattern.toString()\n        });\n        const stringReplacePattern = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: replacePattern.toString()\n        });\n        if (stringStream.replacePattern(stringSearchPattern, stringReplacePattern, start, length)) {\n            this.fromString(stringStream.toString());\n            return true;\n        }\n        return false;\n    }\n    skipPatterns(patterns, start, length, backward) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString()\n        });\n        const stringPatterns = new Array(patterns.length);\n        for (let i = 0; i < patterns.length; i++) {\n            stringPatterns[i] = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n                string: patterns[i].toString()\n            });\n        }\n        return stringStream.skipPatterns(stringPatterns, start, length, backward);\n    }\n    skipNotPatterns(patterns, start, length, backward) {\n        const stringStream = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n            string: this.toString()\n        });\n        const stringPatterns = new Array(patterns.length);\n        for (let i = 0; i < patterns.length; i++) {\n            stringPatterns[i] = new _byte_stream__WEBPACK_IMPORTED_MODULE_1__.ByteStream({\n                string: patterns[i].toString()\n            });\n        }\n        return stringStream.skipNotPatterns(stringPatterns, start, length, backward);\n    }\n    append(stream) {\n        this.fromString([\n            this.toString(),\n            stream.toString()\n        ].join(\"\"));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYnl0ZXN0cmVhbWpzL2J1aWxkL21qcy9iaXRfc3RyZWFtLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEwQztBQUNDO0FBQ3BDO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsc0JBQXNCO0FBQ2xELHdCQUF3QixtREFBaUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLFFBQVE7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0JBQXNCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isd0JBQXdCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsUUFBUTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG9EQUFVO0FBQzNDO0FBQ0EsU0FBUztBQUNULGtDQUFrQyxvREFBVTtBQUM1QztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsb0RBQVU7QUFDM0M7QUFDQSxTQUFTO0FBQ1Q7QUFDQSx3QkFBd0IscUJBQXFCO0FBQzdDLG9DQUFvQyxvREFBVTtBQUM5QztBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxvREFBVTtBQUMzQztBQUNBLFNBQVM7QUFDVDtBQUNBLHdCQUF3QixxQkFBcUI7QUFDN0Msb0NBQW9DLG9EQUFVO0FBQzlDO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG9EQUFVO0FBQzNDO0FBQ0EsU0FBUztBQUNULGtDQUFrQyxvREFBVTtBQUM1QztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsb0RBQVU7QUFDM0M7QUFDQSxTQUFTO0FBQ1Q7QUFDQSx3QkFBd0IscUJBQXFCO0FBQzdDLG9DQUFvQyxvREFBVTtBQUM5QztBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxvREFBVTtBQUMzQztBQUNBLFNBQVM7QUFDVDtBQUNBLHdCQUF3QixxQkFBcUI7QUFDN0Msb0NBQW9DLG9EQUFVO0FBQzlDO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG9EQUFVO0FBQzNDO0FBQ0EsU0FBUztBQUNUO0FBQ0Esd0JBQXdCLHFCQUFxQjtBQUM3QyxvQ0FBb0Msb0RBQVU7QUFDOUM7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsb0RBQVU7QUFDM0M7QUFDQSxTQUFTO0FBQ1Q7QUFDQSx3QkFBd0IscUJBQXFCO0FBQzdDLG9DQUFvQyxvREFBVTtBQUM5QztBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxvREFBVTtBQUMzQztBQUNBLFNBQVM7QUFDVCxzQ0FBc0Msb0RBQVU7QUFDaEQ7QUFDQSxTQUFTO0FBQ1QsdUNBQXVDLG9EQUFVO0FBQ2pEO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxvREFBVTtBQUMzQztBQUNBLFNBQVM7QUFDVDtBQUNBLHdCQUF3Qiw4QkFBOEI7QUFDdEQsd0NBQXdDLG9EQUFVO0FBQ2xEO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSx3QkFBd0IsK0JBQStCO0FBQ3ZELHlDQUF5QyxvREFBVTtBQUNuRDtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxvREFBVTtBQUMzQztBQUNBLFNBQVM7QUFDVCx3Q0FBd0Msb0RBQVU7QUFDbEQ7QUFDQSxTQUFTO0FBQ1QseUNBQXlDLG9EQUFVO0FBQ25EO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG9EQUFVO0FBQzNDO0FBQ0EsU0FBUztBQUNUO0FBQ0Esd0JBQXdCLHFCQUFxQjtBQUM3QyxvQ0FBb0Msb0RBQVU7QUFDOUM7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsb0RBQVU7QUFDM0M7QUFDQSxTQUFTO0FBQ1Q7QUFDQSx3QkFBd0IscUJBQXFCO0FBQzdDLG9DQUFvQyxvREFBVTtBQUM5QztBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiL1VzZXJzL2plcmVtaWFoL0Rlc2t0b3AvYzJwYSB0b29sL25vZGVfbW9kdWxlcy9ieXRlc3RyZWFtanMvYnVpbGQvbWpzL2JpdF9zdHJlYW0uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYml0c1RvU3RyaW5nQXJyYXkgfSBmcm9tIFwiLi9iaXRcIjtcbmltcG9ydCB7IEJ5dGVTdHJlYW0gfSBmcm9tIFwiLi9ieXRlX3N0cmVhbVwiO1xuZXhwb3J0IGNsYXNzIEJpdFN0cmVhbSB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycykge1xuICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcigwKTtcbiAgICAgICAgdGhpcy52aWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5idWZmZXIpO1xuICAgICAgICB0aGlzLmJpdHNDb3VudCA9IDA7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICBpZiAoXCJieXRlU3RyZWFtXCIgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgICAgIHRoaXMuZnJvbUJ5dGVTdHJlYW0ocGFyYW1ldGVycy5ieXRlU3RyZWFtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcInZpZXdcIiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mcm9tVWludDhBcnJheShwYXJhbWV0ZXJzLnZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwiYnVmZmVyXCIgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgICAgIHRoaXMuZnJvbUFycmF5QnVmZmVyKHBhcmFtZXRlcnMuYnVmZmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcInN0cmluZ1wiIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZyb21TdHJpbmcocGFyYW1ldGVycy5zdHJpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwidWludDMyXCIgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgICAgIHRoaXMuZnJvbVVpbnQzMihwYXJhbWV0ZXJzLnVpbnQzMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoXCJiaXRzQ291bnRcIiBpbiBwYXJhbWV0ZXJzICYmIHBhcmFtZXRlcnMuYml0c0NvdW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5iaXRzQ291bnQgPSBwYXJhbWV0ZXJzLmJpdHNDb3VudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjbGVhcigpIHtcbiAgICAgICAgdGhpcy5idWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoMCk7XG4gICAgICAgIHRoaXMudmlldyA9IG5ldyBVaW50OEFycmF5KHRoaXMuYnVmZmVyKTtcbiAgICAgICAgdGhpcy5iaXRzQ291bnQgPSAwO1xuICAgIH1cbiAgICBmcm9tQnl0ZVN0cmVhbShzdHJlYW0pIHtcbiAgICAgICAgdGhpcy5mcm9tVWludDhBcnJheShzdHJlYW0udmlldyk7XG4gICAgfVxuICAgIGZyb21BcnJheUJ1ZmZlcihhcnJheSkge1xuICAgICAgICB0aGlzLmJ1ZmZlciA9IGFycmF5O1xuICAgICAgICB0aGlzLnZpZXcgPSBuZXcgVWludDhBcnJheShhcnJheSk7XG4gICAgICAgIHRoaXMuYml0c0NvdW50ID0gdGhpcy52aWV3Lmxlbmd0aCA8PCAzO1xuICAgIH1cbiAgICBmcm9tVWludDhBcnJheShhcnJheSkge1xuICAgICAgICB0aGlzLmZyb21BcnJheUJ1ZmZlcihuZXcgVWludDhBcnJheShhcnJheSkuYnVmZmVyKTtcbiAgICB9XG4gICAgZnJvbVN0cmluZyhzdHJpbmcpIHtcbiAgICAgICAgY29uc3Qgc3RyaW5nTGVuZ3RoID0gc3RyaW5nLmxlbmd0aDtcbiAgICAgICAgdGhpcy5idWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoKHN0cmluZ0xlbmd0aCA+PiAzKSArICgoc3RyaW5nTGVuZ3RoICUgOCkgPyAxIDogMCkpO1xuICAgICAgICB0aGlzLnZpZXcgPSBuZXcgVWludDhBcnJheSh0aGlzLmJ1ZmZlcik7XG4gICAgICAgIHRoaXMuYml0c0NvdW50ID0gKChzdHJpbmdMZW5ndGggPj4gMykgKyAxKSA8PCAzO1xuICAgICAgICBsZXQgYnl0ZUluZGV4ID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHJpbmdMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHN0cmluZ1tpXSA9PSBcIjFcIilcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdbYnl0ZUluZGV4XSB8PSAxIDw8ICg3IC0gKGkgJSA4KSk7XG4gICAgICAgICAgICBpZiAoaSAmJiAoKChpICsgMSkgJSA4KSA9PSAwKSlcbiAgICAgICAgICAgICAgICBieXRlSW5kZXgrKztcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RyaW5nTGVuZ3RoICUgOClcbiAgICAgICAgICAgIHRoaXMuc2hpZnRSaWdodCg4IC0gKHN0cmluZ0xlbmd0aCAlIDgpKTtcbiAgICAgICAgdGhpcy5iaXRzQ291bnQgPSBzdHJpbmdMZW5ndGg7XG4gICAgfVxuICAgIGZyb21VaW50MzIodWludDMyKSB7XG4gICAgICAgIHRoaXMuYnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKDQpO1xuICAgICAgICB0aGlzLnZpZXcgPSBuZXcgVWludDhBcnJheSh0aGlzLmJ1ZmZlcik7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gbmV3IFVpbnQzMkFycmF5KFt1aW50MzJdKTtcbiAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KHZhbHVlLmJ1ZmZlcik7XG4gICAgICAgIGZvciAobGV0IGkgPSAzOyBpID49IDA7IGktLSlcbiAgICAgICAgICAgIHRoaXMudmlld1tpXSA9IHZpZXdbMyAtIGldO1xuICAgICAgICB0aGlzLmJpdHNDb3VudCA9IDMyO1xuICAgIH1cbiAgICB0b1N0cmluZyhzdGFydCwgbGVuZ3RoKSB7XG4gICAgICAgIGlmIChzdGFydCA9PSBudWxsKSB7XG4gICAgICAgICAgICBzdGFydCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChzdGFydCA+PSB0aGlzLnZpZXcubGVuZ3RoKSB8fCAoc3RhcnQgPCAwKSkge1xuICAgICAgICAgICAgc3RhcnQgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsZW5ndGggPT0gbnVsbCkge1xuICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy52aWV3Lmxlbmd0aCAtIHN0YXJ0O1xuICAgICAgICB9XG4gICAgICAgIGlmICgobGVuZ3RoID49IHRoaXMudmlldy5sZW5ndGgpIHx8IChsZW5ndGggPCAwKSkge1xuICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy52aWV3Lmxlbmd0aCAtIHN0YXJ0O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gc3RhcnQ7IGkgPCAoc3RhcnQgKyBsZW5ndGgpOyBpKyspIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKGJpdHNUb1N0cmluZ0FycmF5W3RoaXMudmlld1tpXV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQuam9pbihcIlwiKS5zdWJzdHJpbmcoKHRoaXMudmlldy5sZW5ndGggPDwgMykgLSB0aGlzLmJpdHNDb3VudCk7XG4gICAgfVxuICAgIHNoaWZ0UmlnaHQoc2hpZnQsIG5lZWRTaHJpbmsgPSB0cnVlKSB7XG4gICAgICAgIGlmICh0aGlzLnZpZXcubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKHNoaWZ0IDwgMCkgfHwgKHNoaWZ0ID4gOCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBcXFwic2hpZnRcXFwiIHBhcmFtZXRlciBtdXN0IGJlIGluIHJhbmdlIDAtOFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2hpZnQgPiB0aGlzLmJpdHNDb3VudCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIFxcXCJzaGlmdFxcXCIgcGFyYW1ldGVyIGNhbiBub3QgYmUgYmlnZ2VyIHRoYW4gXFxcInRoaXMuYml0c0NvdW50XFxcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzaGlmdE1hc2sgPSAweEZGID4+ICg4IC0gc2hpZnQpO1xuICAgICAgICB0aGlzLnZpZXdbdGhpcy52aWV3Lmxlbmd0aCAtIDFdID4+PSBzaGlmdDtcbiAgICAgICAgZm9yIChsZXQgaSA9ICh0aGlzLnZpZXcubGVuZ3RoIC0gMik7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB0aGlzLnZpZXdbaSArIDFdIHw9ICh0aGlzLnZpZXdbaV0gJiBzaGlmdE1hc2spIDw8ICg4IC0gc2hpZnQpO1xuICAgICAgICAgICAgdGhpcy52aWV3W2ldID4+PSBzaGlmdDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmJpdHNDb3VudCAtPSBzaGlmdDtcbiAgICAgICAgaWYgKHRoaXMuYml0c0NvdW50ID09IDApIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmVlZFNocmluaykge1xuICAgICAgICAgICAgdGhpcy5zaHJpbmsoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzaGlmdExlZnQoc2hpZnQpIHtcbiAgICAgICAgaWYgKHRoaXMudmlldy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICgoc2hpZnQgPCAwKSB8fCAoc2hpZnQgPiA4KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIFxcXCJzaGlmdFxcXCIgcGFyYW1ldGVyIG11c3QgYmUgaW4gcmFuZ2UgMC04XCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzaGlmdCA+IHRoaXMuYml0c0NvdW50KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgXFxcInNoaWZ0XFxcIiBwYXJhbWV0ZXIgY2FuIG5vdCBiZSBiaWdnZXIgdGhhbiBcXFwidGhpcy5iaXRzQ291bnRcXFwiXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGJpdHNPZmZzZXQgPSB0aGlzLmJpdHNDb3VudCAmIDB4MDc7XG4gICAgICAgIGlmIChiaXRzT2Zmc2V0ID4gc2hpZnQpIHtcbiAgICAgICAgICAgIHRoaXMudmlld1swXSAmPSAweEZGID4+IChiaXRzT2Zmc2V0ICsgc2hpZnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IHRoaXMudmlldy5zbGljZSgxKTtcbiAgICAgICAgICAgIHZpZXdbMF0gJj0gMHhGRiA+PiAoc2hpZnQgLSBiaXRzT2Zmc2V0KTtcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyID0gdmlldy5idWZmZXI7XG4gICAgICAgICAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYml0c0NvdW50IC09IHNoaWZ0O1xuICAgICAgICBpZiAodGhpcy5iaXRzQ291bnQgPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5jbGVhcigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNsaWNlKHN0YXJ0ID0gMCwgZW5kID0gMCkge1xuICAgICAgICBsZXQgdmFsdWVTaGlmdCA9IDA7XG4gICAgICAgIGlmICh0aGlzLmJpdHNDb3VudCAlIDgpIHtcbiAgICAgICAgICAgIHZhbHVlU2hpZnQgPSAoOCAtICh0aGlzLmJpdHNDb3VudCAlIDgpKTtcbiAgICAgICAgfVxuICAgICAgICBzdGFydCArPSB2YWx1ZVNoaWZ0O1xuICAgICAgICBlbmQgKz0gdmFsdWVTaGlmdDtcbiAgICAgICAgY29uc3QgbWF4RW5kID0gKHRoaXMudmlldy5sZW5ndGggPDwgMykgLSAxO1xuICAgICAgICBpZiAoKHN0YXJ0IDwgMCkgfHwgKHN0YXJ0ID4gbWF4RW5kKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBCaXRTdHJlYW0oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWVuZCkge1xuICAgICAgICAgICAgZW5kID0gbWF4RW5kO1xuICAgICAgICB9XG4gICAgICAgIGlmICgoZW5kIDwgMCkgfHwgKGVuZCA+IG1heEVuZCkpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQml0U3RyZWFtKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChlbmQgLSBzdGFydCArIDEpID4gdGhpcy5iaXRzQ291bnQpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQml0U3RyZWFtKCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IHN0YXJ0ID4+IDM7XG4gICAgICAgIGNvbnN0IHN0YXJ0T2Zmc2V0ID0gc3RhcnQgJiAweDA3O1xuICAgICAgICBjb25zdCBlbmRJbmRleCA9IGVuZCA+PiAzO1xuICAgICAgICBjb25zdCBlbmRPZmZzZXQgPSBlbmQgJiAweDA3O1xuICAgICAgICBjb25zdCBiaXRzTGVuZ3RoID0gKChlbmRJbmRleCAtIHN0YXJ0SW5kZXgpID09IDApID8gMSA6IChlbmRJbmRleCAtIHN0YXJ0SW5kZXggKyAxKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IEJpdFN0cmVhbSh7XG4gICAgICAgICAgICBidWZmZXI6IHRoaXMuYnVmZmVyLnNsaWNlKHN0YXJ0SW5kZXgsIHN0YXJ0SW5kZXggKyBiaXRzTGVuZ3RoKSxcbiAgICAgICAgICAgIGJpdHNDb3VudDogYml0c0xlbmd0aCA8PCAzLFxuICAgICAgICB9KTtcbiAgICAgICAgcmVzdWx0LnZpZXdbMF0gJj0gKDB4RkYgPj4gc3RhcnRPZmZzZXQpO1xuICAgICAgICByZXN1bHQudmlld1tiaXRzTGVuZ3RoXSAmPSAoMHhGRiA8PCAoNyAtIGVuZE9mZnNldCkpO1xuICAgICAgICBpZiAoNyAtIGVuZE9mZnNldCkge1xuICAgICAgICAgICAgcmVzdWx0LnNoaWZ0UmlnaHQoNyAtIGVuZE9mZnNldCwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdC5iaXRzQ291bnQgPSAoZW5kIC0gc3RhcnQgKyAxKTtcbiAgICAgICAgcmVzdWx0LnNocmluaygpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBjb3B5KHN0YXJ0ID0gMCwgbGVuZ3RoID0gMCkge1xuICAgICAgICBjb25zdCBtYXhFbmQgPSAodGhpcy52aWV3Lmxlbmd0aCA8PCAzKSAtIDE7XG4gICAgICAgIGlmICgoc3RhcnQgPCAwKSB8fCAoc3RhcnQgPiBtYXhFbmQpKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEJpdFN0cmVhbSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghbGVuZ3RoKSB7XG4gICAgICAgICAgICBsZW5ndGggPSAodGhpcy52aWV3Lmxlbmd0aCA8PCAzKSAtIHN0YXJ0IC0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGVuZ3RoID4gdGhpcy5iaXRzQ291bnQpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQml0U3RyZWFtKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbGVuZ3RoIC0gMSk7XG4gICAgfVxuICAgIHNocmluaygpIHtcbiAgICAgICAgY29uc3QgY3VycmVudExlbmd0aCA9ICh0aGlzLmJpdHNDb3VudCA+PiAzKSArICgodGhpcy5iaXRzQ291bnQgJSA4KSA/IDEgOiAwKTtcbiAgICAgICAgaWYgKGN1cnJlbnRMZW5ndGggPCB0aGlzLnZpZXcubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy52aWV3LnNsaWNlKHRoaXMudmlldy5sZW5ndGggLSBjdXJyZW50TGVuZ3RoLCAodGhpcy52aWV3Lmxlbmd0aCAtIGN1cnJlbnRMZW5ndGgpICsgY3VycmVudExlbmd0aCk7XG4gICAgICAgICAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgICAgICAgICAgdGhpcy5idWZmZXIgPSB2aWV3LmJ1ZmZlcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXZlcnNlQnl0ZXMoKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy52aWV3Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLnZpZXdbaV0gPSAoKHRoaXMudmlld1tpXSAqIDB4MDgwMiAmIDB4MjIxMTApIHwgKHRoaXMudmlld1tpXSAqIDB4ODAyMCAmIDB4ODg0NDApKSAqIDB4MTAxMDEgPj4gMTY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYml0c0NvdW50ICUgOCkge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudExlbmd0aCA9ICh0aGlzLmJpdHNDb3VudCA+PiAzKSArICgodGhpcy5iaXRzQ291bnQgJSA4KSA/IDEgOiAwKTtcbiAgICAgICAgICAgIHRoaXMudmlld1t0aGlzLnZpZXcubGVuZ3RoIC0gY3VycmVudExlbmd0aF0gPj49ICg4IC0gKHRoaXMuYml0c0NvdW50ICYgMHgwNykpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldmVyc2VWYWx1ZSgpIHtcbiAgICAgICAgY29uc3QgaW5pdGlhbFZhbHVlID0gdGhpcy50b1N0cmluZygpO1xuICAgICAgICBjb25zdCBpbml0aWFsVmFsdWVMZW5ndGggPSBpbml0aWFsVmFsdWUubGVuZ3RoO1xuICAgICAgICBjb25zdCByZXZlcnNlZFZhbHVlID0gbmV3IEFycmF5KGluaXRpYWxWYWx1ZUxlbmd0aCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5pdGlhbFZhbHVlTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJldmVyc2VkVmFsdWVbaW5pdGlhbFZhbHVlTGVuZ3RoIC0gMSAtIGldID0gaW5pdGlhbFZhbHVlW2ldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZnJvbVN0cmluZyhyZXZlcnNlZFZhbHVlLmpvaW4oXCJcIikpO1xuICAgIH1cbiAgICBnZXROdW1iZXJWYWx1ZSgpIHtcbiAgICAgICAgY29uc3QgYnl0ZUxlbmd0aCA9ICh0aGlzLnZpZXcubGVuZ3RoIC0gMSk7XG4gICAgICAgIGlmIChieXRlTGVuZ3RoID4gMykge1xuICAgICAgICAgICAgcmV0dXJuICgtMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJ5dGVMZW5ndGggPT0gKC0xKSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmFsdWUgPSBuZXcgVWludDMyQXJyYXkoMSk7XG4gICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheSh2YWx1ZS5idWZmZXIpO1xuICAgICAgICBmb3IgKGxldCBpID0gYnl0ZUxlbmd0aDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZpZXdbYnl0ZUxlbmd0aCAtIGldID0gdGhpcy52aWV3W2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZVswXTtcbiAgICB9XG4gICAgZmluZFBhdHRlcm4ocGF0dGVybiwgc3RhcnQsIGxlbmd0aCwgYmFja3dhcmQpIHtcbiAgICAgICAgY29uc3Qgc3RyaW5nU3RyZWFtID0gbmV3IEJ5dGVTdHJlYW0oe1xuICAgICAgICAgICAgc3RyaW5nOiB0aGlzLnRvU3RyaW5nKCksXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzdHJpbmdQYXR0ZXJuID0gbmV3IEJ5dGVTdHJlYW0oe1xuICAgICAgICAgICAgc3RyaW5nOiBwYXR0ZXJuLnRvU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzdHJpbmdTdHJlYW0uZmluZFBhdHRlcm4oc3RyaW5nUGF0dGVybiwgc3RhcnQsIGxlbmd0aCwgYmFja3dhcmQpO1xuICAgIH1cbiAgICBmaW5kRmlyc3RJbihwYXR0ZXJucywgc3RhcnQsIGxlbmd0aCwgYmFja3dhcmQpIHtcbiAgICAgICAgY29uc3Qgc3RyaW5nU3RyZWFtID0gbmV3IEJ5dGVTdHJlYW0oe1xuICAgICAgICAgICAgc3RyaW5nOiB0aGlzLnRvU3RyaW5nKCksXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzdHJpbmdQYXR0ZXJucyA9IG5ldyBBcnJheShwYXR0ZXJucy5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdHRlcm5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzdHJpbmdQYXR0ZXJuc1tpXSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgICAgICBzdHJpbmc6IHBhdHRlcm5zW2ldLnRvU3RyaW5nKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHJpbmdTdHJlYW0uZmluZEZpcnN0SW4oc3RyaW5nUGF0dGVybnMsIHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkKTtcbiAgICB9XG4gICAgZmluZEFsbEluKHBhdHRlcm5zLCBzdGFydCwgbGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IHN0cmluZ1N0cmVhbSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgIHN0cmluZzogdGhpcy50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzdHJpbmdQYXR0ZXJucyA9IG5ldyBBcnJheShwYXR0ZXJucy5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdHRlcm5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzdHJpbmdQYXR0ZXJuc1tpXSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgICAgICBzdHJpbmc6IHBhdHRlcm5zW2ldLnRvU3RyaW5nKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHJpbmdTdHJlYW0uZmluZEFsbEluKHN0cmluZ1BhdHRlcm5zLCBzdGFydCwgbGVuZ3RoKTtcbiAgICB9XG4gICAgZmluZEFsbFBhdHRlcm5JbihwYXR0ZXJuLCBzdGFydCwgbGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IHN0cmluZ1N0cmVhbSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgIHN0cmluZzogdGhpcy50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzdHJpbmdQYXR0ZXJuID0gbmV3IEJ5dGVTdHJlYW0oe1xuICAgICAgICAgICAgc3RyaW5nOiBwYXR0ZXJuLnRvU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzdHJpbmdTdHJlYW0uZmluZEFsbFBhdHRlcm5JbihzdHJpbmdQYXR0ZXJuLCBzdGFydCwgbGVuZ3RoKTtcbiAgICB9XG4gICAgZmluZEZpcnN0Tm90SW4ocGF0dGVybnMsIHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkKSB7XG4gICAgICAgIGNvbnN0IHN0cmluZ1N0cmVhbSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgIHN0cmluZzogdGhpcy50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzdHJpbmdQYXR0ZXJucyA9IG5ldyBBcnJheShwYXR0ZXJucy5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdHRlcm5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzdHJpbmdQYXR0ZXJuc1tpXSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgICAgICBzdHJpbmc6IHBhdHRlcm5zW2ldLnRvU3RyaW5nKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHJpbmdTdHJlYW0uZmluZEZpcnN0Tm90SW4oc3RyaW5nUGF0dGVybnMsIHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkKTtcbiAgICB9XG4gICAgZmluZEFsbE5vdEluKHBhdHRlcm5zLCBzdGFydCwgbGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IHN0cmluZ1N0cmVhbSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgIHN0cmluZzogdGhpcy50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzdHJpbmdQYXR0ZXJucyA9IG5ldyBBcnJheShwYXR0ZXJucy5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdHRlcm5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzdHJpbmdQYXR0ZXJuc1tpXSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgICAgICBzdHJpbmc6IHBhdHRlcm5zW2ldLnRvU3RyaW5nKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHJpbmdTdHJlYW0uZmluZEFsbE5vdEluKHN0cmluZ1BhdHRlcm5zLCBzdGFydCwgbGVuZ3RoKTtcbiAgICB9XG4gICAgZmluZEZpcnN0U2VxdWVuY2UocGF0dGVybnMsIHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkKSB7XG4gICAgICAgIGNvbnN0IHN0cmluZ1N0cmVhbSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgIHN0cmluZzogdGhpcy50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzdHJpbmdQYXR0ZXJucyA9IG5ldyBBcnJheShwYXR0ZXJucy5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdHRlcm5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzdHJpbmdQYXR0ZXJuc1tpXSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgICAgICBzdHJpbmc6IHBhdHRlcm5zW2ldLnRvU3RyaW5nKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHJpbmdTdHJlYW0uZmluZEZpcnN0U2VxdWVuY2Uoc3RyaW5nUGF0dGVybnMsIHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkKTtcbiAgICB9XG4gICAgZmluZEFsbFNlcXVlbmNlcyhwYXR0ZXJucywgc3RhcnQsIGxlbmd0aCkge1xuICAgICAgICBjb25zdCBzdHJpbmdTdHJlYW0gPSBuZXcgQnl0ZVN0cmVhbSh7XG4gICAgICAgICAgICBzdHJpbmc6IHRoaXMudG9TdHJpbmcoKVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc3RyaW5nUGF0dGVybnMgPSBuZXcgQXJyYXkocGF0dGVybnMubGVuZ3RoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXR0ZXJucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgc3RyaW5nUGF0dGVybnNbaV0gPSBuZXcgQnl0ZVN0cmVhbSh7XG4gICAgICAgICAgICAgICAgc3RyaW5nOiBwYXR0ZXJuc1tpXS50b1N0cmluZygpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyaW5nU3RyZWFtLmZpbmRBbGxTZXF1ZW5jZXMoc3RyaW5nUGF0dGVybnMsIHN0YXJ0LCBsZW5ndGgpO1xuICAgIH1cbiAgICBmaW5kUGFpcmVkUGF0dGVybnMobGVmdFBhdHRlcm4sIHJpZ2h0UGF0dGVybiwgc3RhcnQsIGxlbmd0aCkge1xuICAgICAgICBjb25zdCBzdHJpbmdTdHJlYW0gPSBuZXcgQnl0ZVN0cmVhbSh7XG4gICAgICAgICAgICBzdHJpbmc6IHRoaXMudG9TdHJpbmcoKVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc3RyaW5nTGVmdFBhdHRlcm4gPSBuZXcgQnl0ZVN0cmVhbSh7XG4gICAgICAgICAgICBzdHJpbmc6IGxlZnRQYXR0ZXJuLnRvU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHN0cmluZ1JpZ2h0UGF0dGVybiA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgIHN0cmluZzogcmlnaHRQYXR0ZXJuLnRvU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzdHJpbmdTdHJlYW0uZmluZFBhaXJlZFBhdHRlcm5zKHN0cmluZ0xlZnRQYXR0ZXJuLCBzdHJpbmdSaWdodFBhdHRlcm4sIHN0YXJ0LCBsZW5ndGgpO1xuICAgIH1cbiAgICBmaW5kUGFpcmVkQXJyYXlzKGlucHV0TGVmdFBhdHRlcm5zLCBpbnB1dFJpZ2h0UGF0dGVybnMsIHN0YXJ0LCBsZW5ndGgpIHtcbiAgICAgICAgY29uc3Qgc3RyaW5nU3RyZWFtID0gbmV3IEJ5dGVTdHJlYW0oe1xuICAgICAgICAgICAgc3RyaW5nOiB0aGlzLnRvU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHN0cmluZ0xlZnRQYXR0ZXJucyA9IG5ldyBBcnJheShpbnB1dExlZnRQYXR0ZXJucy5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0TGVmdFBhdHRlcm5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzdHJpbmdMZWZ0UGF0dGVybnNbaV0gPSBuZXcgQnl0ZVN0cmVhbSh7XG4gICAgICAgICAgICAgICAgc3RyaW5nOiBpbnB1dExlZnRQYXR0ZXJuc1tpXS50b1N0cmluZygpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdHJpbmdSaWdodFBhdHRlcm5zID0gbmV3IEFycmF5KGlucHV0UmlnaHRQYXR0ZXJucy5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0UmlnaHRQYXR0ZXJucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgc3RyaW5nUmlnaHRQYXR0ZXJuc1tpXSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgICAgICBzdHJpbmc6IGlucHV0UmlnaHRQYXR0ZXJuc1tpXS50b1N0cmluZygpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyaW5nU3RyZWFtLmZpbmRQYWlyZWRBcnJheXMoc3RyaW5nTGVmdFBhdHRlcm5zLCBzdHJpbmdSaWdodFBhdHRlcm5zLCBzdGFydCwgbGVuZ3RoKTtcbiAgICB9XG4gICAgcmVwbGFjZVBhdHRlcm4oc2VhcmNoUGF0dGVybiwgcmVwbGFjZVBhdHRlcm4sIHN0YXJ0LCBsZW5ndGgpIHtcbiAgICAgICAgY29uc3Qgc3RyaW5nU3RyZWFtID0gbmV3IEJ5dGVTdHJlYW0oe1xuICAgICAgICAgICAgc3RyaW5nOiB0aGlzLnRvU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHN0cmluZ1NlYXJjaFBhdHRlcm4gPSBuZXcgQnl0ZVN0cmVhbSh7XG4gICAgICAgICAgICBzdHJpbmc6IHNlYXJjaFBhdHRlcm4udG9TdHJpbmcoKVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc3RyaW5nUmVwbGFjZVBhdHRlcm4gPSBuZXcgQnl0ZVN0cmVhbSh7XG4gICAgICAgICAgICBzdHJpbmc6IHJlcGxhY2VQYXR0ZXJuLnRvU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChzdHJpbmdTdHJlYW0ucmVwbGFjZVBhdHRlcm4oc3RyaW5nU2VhcmNoUGF0dGVybiwgc3RyaW5nUmVwbGFjZVBhdHRlcm4sIHN0YXJ0LCBsZW5ndGgpKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TdHJpbmcoc3RyaW5nU3RyZWFtLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBza2lwUGF0dGVybnMocGF0dGVybnMsIHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkKSB7XG4gICAgICAgIGNvbnN0IHN0cmluZ1N0cmVhbSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgIHN0cmluZzogdGhpcy50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzdHJpbmdQYXR0ZXJucyA9IG5ldyBBcnJheShwYXR0ZXJucy5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdHRlcm5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzdHJpbmdQYXR0ZXJuc1tpXSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgICAgICBzdHJpbmc6IHBhdHRlcm5zW2ldLnRvU3RyaW5nKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHJpbmdTdHJlYW0uc2tpcFBhdHRlcm5zKHN0cmluZ1BhdHRlcm5zLCBzdGFydCwgbGVuZ3RoLCBiYWNrd2FyZCk7XG4gICAgfVxuICAgIHNraXBOb3RQYXR0ZXJucyhwYXR0ZXJucywgc3RhcnQsIGxlbmd0aCwgYmFja3dhcmQpIHtcbiAgICAgICAgY29uc3Qgc3RyaW5nU3RyZWFtID0gbmV3IEJ5dGVTdHJlYW0oe1xuICAgICAgICAgICAgc3RyaW5nOiB0aGlzLnRvU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHN0cmluZ1BhdHRlcm5zID0gbmV3IEFycmF5KHBhdHRlcm5zLmxlbmd0aCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGF0dGVybnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHN0cmluZ1BhdHRlcm5zW2ldID0gbmV3IEJ5dGVTdHJlYW0oe1xuICAgICAgICAgICAgICAgIHN0cmluZzogcGF0dGVybnNbaV0udG9TdHJpbmcoKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0cmluZ1N0cmVhbS5za2lwTm90UGF0dGVybnMoc3RyaW5nUGF0dGVybnMsIHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkKTtcbiAgICB9XG4gICAgYXBwZW5kKHN0cmVhbSkge1xuICAgICAgICB0aGlzLmZyb21TdHJpbmcoW1xuICAgICAgICAgICAgdGhpcy50b1N0cmluZygpLFxuICAgICAgICAgICAgc3RyZWFtLnRvU3RyaW5nKClcbiAgICAgICAgXS5qb2luKFwiXCIpKTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/bytestreamjs/build/mjs/bit_stream.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/bytestreamjs/build/mjs/byte_stream.js":
/*!************************************************************!*\
  !*** ./node_modules/bytestreamjs/build/mjs/byte_stream.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ByteStream: () => (/* binding */ ByteStream)\n/* harmony export */ });\nclass ByteStream {\n    constructor(parameters = {}) {\n        if (\"view\" in parameters) {\n            this.fromUint8Array(parameters.view);\n        }\n        else if (\"buffer\" in parameters) {\n            this.fromArrayBuffer(parameters.buffer);\n        }\n        else if (\"string\" in parameters) {\n            this.fromString(parameters.string);\n        }\n        else if (\"hexstring\" in parameters) {\n            this.fromHexString(parameters.hexstring);\n        }\n        else {\n            if (\"length\" in parameters && parameters.length > 0) {\n                this.length = parameters.length;\n                if (parameters.stub) {\n                    for (let i = 0; i < this._view.length; i++) {\n                        this._view[i] = parameters.stub;\n                    }\n                }\n            }\n            else {\n                this.length = 0;\n            }\n        }\n    }\n    set buffer(value) {\n        this._buffer = value;\n        this._view = new Uint8Array(this._buffer);\n    }\n    get buffer() {\n        return this._buffer;\n    }\n    set view(value) {\n        this._buffer = new ArrayBuffer(value.length);\n        this._view = new Uint8Array(this._buffer);\n        this._view.set(value);\n    }\n    get view() {\n        return this._view;\n    }\n    get length() {\n        return this.view.byteLength;\n    }\n    set length(value) {\n        this._buffer = new ArrayBuffer(value);\n        this._view = new Uint8Array(this._buffer);\n    }\n    clear() {\n        this._buffer = new ArrayBuffer(0);\n        this._view = new Uint8Array(this._buffer);\n    }\n    fromArrayBuffer(array) {\n        this._buffer = array;\n        this._view = new Uint8Array(this._buffer);\n    }\n    fromUint8Array(array) {\n        this.fromArrayBuffer(new Uint8Array(array).buffer);\n    }\n    fromString(string) {\n        const stringLength = string.length;\n        this.length = stringLength;\n        for (let i = 0; i < stringLength; i++)\n            this.view[i] = string.charCodeAt(i);\n    }\n    toString(start = 0, length = (this.view.length - start)) {\n        let result = \"\";\n        if ((start >= this.view.length) || (start < 0)) {\n            start = 0;\n        }\n        if ((length >= this.view.length) || (length < 0)) {\n            length = this.view.length - start;\n        }\n        for (let i = start; i < (start + length); i++)\n            result += String.fromCharCode(this.view[i]);\n        return result;\n    }\n    fromHexString(hexString) {\n        const stringLength = hexString.length;\n        this.buffer = new ArrayBuffer(stringLength >> 1);\n        this.view = new Uint8Array(this.buffer);\n        const hexMap = new Map();\n        hexMap.set(\"0\", 0x00);\n        hexMap.set(\"1\", 0x01);\n        hexMap.set(\"2\", 0x02);\n        hexMap.set(\"3\", 0x03);\n        hexMap.set(\"4\", 0x04);\n        hexMap.set(\"5\", 0x05);\n        hexMap.set(\"6\", 0x06);\n        hexMap.set(\"7\", 0x07);\n        hexMap.set(\"8\", 0x08);\n        hexMap.set(\"9\", 0x09);\n        hexMap.set(\"A\", 0x0A);\n        hexMap.set(\"a\", 0x0A);\n        hexMap.set(\"B\", 0x0B);\n        hexMap.set(\"b\", 0x0B);\n        hexMap.set(\"C\", 0x0C);\n        hexMap.set(\"c\", 0x0C);\n        hexMap.set(\"D\", 0x0D);\n        hexMap.set(\"d\", 0x0D);\n        hexMap.set(\"E\", 0x0E);\n        hexMap.set(\"e\", 0x0E);\n        hexMap.set(\"F\", 0x0F);\n        hexMap.set(\"f\", 0x0F);\n        let j = 0;\n        let temp = 0x00;\n        for (let i = 0; i < stringLength; i++) {\n            if (!(i % 2)) {\n                temp = hexMap.get(hexString.charAt(i)) << 4;\n            }\n            else {\n                temp |= hexMap.get(hexString.charAt(i));\n                this.view[j] = temp;\n                j++;\n            }\n        }\n    }\n    toHexString(start = 0, length = (this.view.length - start)) {\n        let result = \"\";\n        if ((start >= this.view.length) || (start < 0)) {\n            start = 0;\n        }\n        if ((length >= this.view.length) || (length < 0)) {\n            length = this.view.length - start;\n        }\n        for (let i = start; i < (start + length); i++) {\n            const str = this.view[i].toString(16).toUpperCase();\n            result = result + ((str.length == 1) ? \"0\" : \"\") + str;\n        }\n        return result;\n    }\n    copy(start = 0, length = (this.length - start)) {\n        if (!start && !this.length) {\n            return new ByteStream();\n        }\n        if ((start < 0) || (start > (this.length - 1))) {\n            throw new Error(`Wrong start position: ${start}`);\n        }\n        const stream = new ByteStream({\n            buffer: this._buffer.slice(start, start + length)\n        });\n        return stream;\n    }\n    slice(start = 0, end = this.length) {\n        if (!start && !this.length) {\n            return new ByteStream();\n        }\n        if ((start < 0) || (start > (this.length - 1))) {\n            throw new Error(`Wrong start position: ${start}`);\n        }\n        const stream = new ByteStream({\n            buffer: this._buffer.slice(start, end),\n        });\n        return stream;\n    }\n    realloc(size) {\n        const buffer = new ArrayBuffer(size);\n        const view = new Uint8Array(buffer);\n        if (size > this._view.length)\n            view.set(this._view);\n        else {\n            view.set(new Uint8Array(this._buffer, 0, size));\n        }\n        this._buffer = buffer;\n        this._view = new Uint8Array(this._buffer);\n    }\n    append(stream) {\n        const initialSize = this.length;\n        const streamViewLength = stream.length;\n        const subarrayView = stream._view.subarray();\n        this.realloc(initialSize + streamViewLength);\n        this._view.set(subarrayView, initialSize);\n    }\n    insert(stream, start = 0, length = (this.length - start)) {\n        if (start > (this.length - 1))\n            return false;\n        if (length > (this.length - start)) {\n            length = this.length - start;\n        }\n        if (length > stream.length) {\n            length = stream.length;\n        }\n        if (length == stream.length)\n            this._view.set(stream._view, start);\n        else {\n            this._view.set(stream._view.subarray(0, length), start);\n        }\n        return true;\n    }\n    isEqual(stream) {\n        if (this.length != stream.length)\n            return false;\n        for (let i = 0; i < stream.length; i++) {\n            if (this.view[i] != stream.view[i])\n                return false;\n        }\n        return true;\n    }\n    isEqualView(view) {\n        if (view.length != this.view.length)\n            return false;\n        for (let i = 0; i < view.length; i++) {\n            if (this.view[i] != view[i])\n                return false;\n        }\n        return true;\n    }\n    findPattern(pattern, start_, length_, backward_) {\n        const { start, length, backward } = this.prepareFindParameters(start_, length_, backward_);\n        const patternLength = pattern.length;\n        if (patternLength > length) {\n            return (-1);\n        }\n        const patternArray = [];\n        for (let i = 0; i < patternLength; i++)\n            patternArray.push(pattern.view[i]);\n        for (let i = 0; i <= (length - patternLength); i++) {\n            let equal = true;\n            const equalStart = (backward) ? (start - patternLength - i) : (start + i);\n            for (let j = 0; j < patternLength; j++) {\n                if (this.view[j + equalStart] != patternArray[j]) {\n                    equal = false;\n                    break;\n                }\n            }\n            if (equal) {\n                return (backward) ? (start - patternLength - i) : (start + patternLength + i);\n            }\n        }\n        return (-1);\n    }\n    findFirstIn(patterns, start_, length_, backward_) {\n        const { start, length, backward } = this.prepareFindParameters(start_, length_, backward_);\n        const result = {\n            id: (-1),\n            position: (backward) ? 0 : (start + length),\n            length: 0\n        };\n        for (let i = 0; i < patterns.length; i++) {\n            const position = this.findPattern(patterns[i], start, length, backward);\n            if (position != (-1)) {\n                let valid = false;\n                const patternLength = patterns[i].length;\n                if (backward) {\n                    if ((position - patternLength) >= (result.position - result.length))\n                        valid = true;\n                }\n                else {\n                    if ((position - patternLength) <= (result.position - result.length))\n                        valid = true;\n                }\n                if (valid) {\n                    result.position = position;\n                    result.id = i;\n                    result.length = patternLength;\n                }\n            }\n        }\n        return result;\n    }\n    findAllIn(patterns, start_, length_) {\n        let { start, length } = this.prepareFindParameters(start_, length_);\n        const result = [];\n        let patternFound = {\n            id: (-1),\n            position: start\n        };\n        do {\n            const position = patternFound.position;\n            patternFound = this.findFirstIn(patterns, patternFound.position, length);\n            if (patternFound.id == (-1)) {\n                break;\n            }\n            length -= (patternFound.position - position);\n            result.push({\n                id: patternFound.id,\n                position: patternFound.position\n            });\n        } while (true);\n        return result;\n    }\n    findAllPatternIn(pattern, start_, length_) {\n        const { start, length } = this.prepareFindParameters(start_, length_);\n        const result = [];\n        const patternLength = pattern.length;\n        if (patternLength > length) {\n            return (-1);\n        }\n        const patternArray = Array.from(pattern.view);\n        for (let i = 0; i <= (length - patternLength); i++) {\n            let equal = true;\n            const equalStart = start + i;\n            for (let j = 0; j < patternLength; j++) {\n                if (this.view[j + equalStart] != patternArray[j]) {\n                    equal = false;\n                    break;\n                }\n            }\n            if (equal) {\n                result.push(start + patternLength + i);\n                i += (patternLength - 1);\n            }\n        }\n        return result;\n    }\n    findFirstNotIn(patterns, start_, length_, backward_) {\n        let { start, length, backward } = this.prepareFindParameters(start_, length_, backward_);\n        const result = {\n            left: {\n                id: (-1),\n                position: start\n            },\n            right: {\n                id: (-1),\n                position: 0\n            },\n            value: new ByteStream()\n        };\n        let currentLength = length;\n        while (currentLength > 0) {\n            result.right = this.findFirstIn(patterns, (backward) ? (start - length + currentLength) : (start + length - currentLength), currentLength, backward);\n            if (result.right.id == (-1)) {\n                length = currentLength;\n                if (backward) {\n                    start -= length;\n                }\n                else {\n                    start = result.left.position;\n                }\n                result.value = new ByteStream({\n                    buffer: this._buffer.slice(start, start + length),\n                });\n                break;\n            }\n            if (result.right.position != ((backward) ? (result.left.position - patterns[result.right.id].length) : (result.left.position + patterns[result.right.id].length))) {\n                if (backward) {\n                    start = result.right.position + patterns[result.right.id].length;\n                    length = result.left.position - result.right.position - patterns[result.right.id].length;\n                }\n                else {\n                    start = result.left.position;\n                    length = result.right.position - result.left.position - patterns[result.right.id].length;\n                }\n                result.value = new ByteStream({\n                    buffer: this._buffer.slice(start, start + length),\n                });\n                break;\n            }\n            result.left = result.right;\n            currentLength -= patterns[result.right.id].length;\n        }\n        if (backward) {\n            const temp = result.right;\n            result.right = result.left;\n            result.left = temp;\n        }\n        return result;\n    }\n    findAllNotIn(patterns, start_, length_) {\n        let { start, length } = this.prepareFindParameters(start_, length_);\n        const result = [];\n        let patternFound = {\n            left: {\n                id: (-1),\n                position: start\n            },\n            right: {\n                id: (-1),\n                position: start\n            },\n            value: new ByteStream()\n        };\n        do {\n            const position = patternFound.right.position;\n            patternFound = this.findFirstNotIn(patterns, patternFound.right.position, length);\n            length -= (patternFound.right.position - position);\n            result.push({\n                left: {\n                    id: patternFound.left.id,\n                    position: patternFound.left.position\n                },\n                right: {\n                    id: patternFound.right.id,\n                    position: patternFound.right.position\n                },\n                value: patternFound.value\n            });\n        } while (patternFound.right.id != (-1));\n        return result;\n    }\n    findFirstSequence(patterns, start_, length_, backward_) {\n        let { start, length, backward } = this.prepareFindParameters(start_, length_, backward_);\n        const firstIn = this.skipNotPatterns(patterns, start, length, backward);\n        if (firstIn == (-1)) {\n            return {\n                position: (-1),\n                value: new ByteStream()\n            };\n        }\n        const firstNotIn = this.skipPatterns(patterns, firstIn, length - ((backward) ? (start - firstIn) : (firstIn - start)), backward);\n        if (backward) {\n            start = firstNotIn;\n            length = (firstIn - firstNotIn);\n        }\n        else {\n            start = firstIn;\n            length = (firstNotIn - firstIn);\n        }\n        const value = new ByteStream({\n            buffer: this._buffer.slice(start, start + length),\n        });\n        return {\n            position: firstNotIn,\n            value\n        };\n    }\n    findAllSequences(patterns, start_, length_) {\n        let { start, length } = this.prepareFindParameters(start_, length_);\n        const result = [];\n        let patternFound = {\n            position: start,\n            value: new ByteStream()\n        };\n        do {\n            const position = patternFound.position;\n            patternFound = this.findFirstSequence(patterns, patternFound.position, length);\n            if (patternFound.position != (-1)) {\n                length -= (patternFound.position - position);\n                result.push({\n                    position: patternFound.position,\n                    value: patternFound.value,\n                });\n            }\n        } while (patternFound.position != (-1));\n        return result;\n    }\n    findPairedPatterns(leftPattern, rightPattern, start_, length_) {\n        const result = [];\n        if (leftPattern.isEqual(rightPattern))\n            return result;\n        const { start, length } = this.prepareFindParameters(start_, length_);\n        let currentPositionLeft = 0;\n        const leftPatterns = this.findAllPatternIn(leftPattern, start, length);\n        if (!Array.isArray(leftPatterns) || leftPatterns.length == 0) {\n            return result;\n        }\n        const rightPatterns = this.findAllPatternIn(rightPattern, start, length);\n        if (!Array.isArray(rightPatterns) || rightPatterns.length == 0) {\n            return result;\n        }\n        while (currentPositionLeft < leftPatterns.length) {\n            if (rightPatterns.length == 0) {\n                break;\n            }\n            if (leftPatterns[0] == rightPatterns[0]) {\n                result.push({\n                    left: leftPatterns[0],\n                    right: rightPatterns[0]\n                });\n                leftPatterns.splice(0, 1);\n                rightPatterns.splice(0, 1);\n                continue;\n            }\n            if (leftPatterns[currentPositionLeft] > rightPatterns[0]) {\n                break;\n            }\n            while (leftPatterns[currentPositionLeft] < rightPatterns[0]) {\n                currentPositionLeft++;\n                if (currentPositionLeft >= leftPatterns.length) {\n                    break;\n                }\n            }\n            result.push({\n                left: leftPatterns[currentPositionLeft - 1],\n                right: rightPatterns[0]\n            });\n            leftPatterns.splice(currentPositionLeft - 1, 1);\n            rightPatterns.splice(0, 1);\n            currentPositionLeft = 0;\n        }\n        result.sort((a, b) => (a.left - b.left));\n        return result;\n    }\n    findPairedArrays(inputLeftPatterns, inputRightPatterns, start_, length_) {\n        const { start, length } = this.prepareFindParameters(start_, length_);\n        const result = [];\n        let currentPositionLeft = 0;\n        const leftPatterns = this.findAllIn(inputLeftPatterns, start, length);\n        if (leftPatterns.length == 0)\n            return result;\n        const rightPatterns = this.findAllIn(inputRightPatterns, start, length);\n        if (rightPatterns.length == 0)\n            return result;\n        while (currentPositionLeft < leftPatterns.length) {\n            if (rightPatterns.length == 0) {\n                break;\n            }\n            if (leftPatterns[0].position == rightPatterns[0].position) {\n                result.push({\n                    left: leftPatterns[0],\n                    right: rightPatterns[0]\n                });\n                leftPatterns.splice(0, 1);\n                rightPatterns.splice(0, 1);\n                continue;\n            }\n            if (leftPatterns[currentPositionLeft].position > rightPatterns[0].position) {\n                break;\n            }\n            while (leftPatterns[currentPositionLeft].position < rightPatterns[0].position) {\n                currentPositionLeft++;\n                if (currentPositionLeft >= leftPatterns.length) {\n                    break;\n                }\n            }\n            result.push({\n                left: leftPatterns[currentPositionLeft - 1],\n                right: rightPatterns[0]\n            });\n            leftPatterns.splice(currentPositionLeft - 1, 1);\n            rightPatterns.splice(0, 1);\n            currentPositionLeft = 0;\n        }\n        result.sort((a, b) => (a.left.position - b.left.position));\n        return result;\n    }\n    replacePattern(searchPattern, replacePattern, start_, length_, findAllResult = null) {\n        let result = [];\n        let i;\n        const output = {\n            status: (-1),\n            searchPatternPositions: [],\n            replacePatternPositions: []\n        };\n        const { start, length } = this.prepareFindParameters(start_, length_);\n        if (findAllResult == null) {\n            result = this.findAllIn([searchPattern], start, length);\n            if (result.length == 0) {\n                return output;\n            }\n        }\n        else {\n            result = findAllResult;\n        }\n        output.searchPatternPositions.push(...Array.from(result, element => element.position));\n        const patternDifference = searchPattern.length - replacePattern.length;\n        const changedBuffer = new ArrayBuffer(this.view.length - (result.length * patternDifference));\n        const changedView = new Uint8Array(changedBuffer);\n        changedView.set(new Uint8Array(this.buffer, 0, start));\n        for (i = 0; i < result.length; i++) {\n            const currentPosition = (i == 0) ? start : result[i - 1].position;\n            changedView.set(new Uint8Array(this.buffer, currentPosition, result[i].position - searchPattern.length - currentPosition), currentPosition - i * patternDifference);\n            changedView.set(replacePattern.view, result[i].position - searchPattern.length - i * patternDifference);\n            output.replacePatternPositions.push(result[i].position - searchPattern.length - i * patternDifference);\n        }\n        i--;\n        changedView.set(new Uint8Array(this.buffer, result[i].position, this.length - result[i].position), result[i].position - searchPattern.length + replacePattern.length - i * patternDifference);\n        this.buffer = changedBuffer;\n        this.view = new Uint8Array(this.buffer);\n        output.status = 1;\n        return output;\n    }\n    skipPatterns(patterns, start_, length_, backward_) {\n        const { start, length, backward } = this.prepareFindParameters(start_, length_, backward_);\n        let result = start;\n        for (let k = 0; k < patterns.length; k++) {\n            const patternLength = patterns[k].length;\n            const equalStart = (backward) ? (result - patternLength) : (result);\n            let equal = true;\n            for (let j = 0; j < patternLength; j++) {\n                if (this.view[j + equalStart] != patterns[k].view[j]) {\n                    equal = false;\n                    break;\n                }\n            }\n            if (equal) {\n                k = (-1);\n                if (backward) {\n                    result -= patternLength;\n                    if (result <= 0)\n                        return result;\n                }\n                else {\n                    result += patternLength;\n                    if (result >= (start + length))\n                        return result;\n                }\n            }\n        }\n        return result;\n    }\n    skipNotPatterns(patterns, start_, length_, backward_) {\n        const { start, length, backward } = this.prepareFindParameters(start_, length_, backward_);\n        let result = (-1);\n        for (let i = 0; i < length; i++) {\n            for (let k = 0; k < patterns.length; k++) {\n                const patternLength = patterns[k].length;\n                const equalStart = (backward) ? (start - i - patternLength) : (start + i);\n                let equal = true;\n                for (let j = 0; j < patternLength; j++) {\n                    if (this.view[j + equalStart] != patterns[k].view[j]) {\n                        equal = false;\n                        break;\n                    }\n                }\n                if (equal) {\n                    result = (backward) ? (start - i) : (start + i);\n                    break;\n                }\n            }\n            if (result != (-1)) {\n                break;\n            }\n        }\n        return result;\n    }\n    prepareFindParameters(start = null, length = null, backward = false) {\n        if (start === null) {\n            start = (backward) ? this.length : 0;\n        }\n        if (start > this.length) {\n            start = this.length;\n        }\n        if (backward) {\n            if (length === null) {\n                length = start;\n            }\n            if (length > start) {\n                length = start;\n            }\n        }\n        else {\n            if (length === null) {\n                length = this.length - start;\n            }\n            if (length > (this.length - start)) {\n                length = this.length - start;\n            }\n        }\n        return { start, length, backward };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYnl0ZXN0cmVhbWpzL2J1aWxkL21qcy9ieXRlX3N0cmVhbS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQU87QUFDUCwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsdUJBQXVCO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsc0JBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixzQkFBc0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsTUFBTTtBQUMzRDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsTUFBTTtBQUMzRDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLG1CQUFtQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlCQUFpQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsMEJBQTBCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsbUJBQW1CO0FBQzNDO0FBQ0Esd0JBQXdCLCtCQUErQjtBQUN2RDtBQUNBO0FBQ0EsNEJBQTRCLG1CQUFtQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsMEJBQTBCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IscUJBQXFCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxnQkFBZ0I7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsZ0JBQWdCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwrQkFBK0I7QUFDdkQ7QUFDQTtBQUNBLDRCQUE0QixtQkFBbUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDBCQUEwQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxnQkFBZ0I7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsYUFBYTtBQUNiLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxjQUFjLDBCQUEwQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxnQkFBZ0I7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGdCQUFnQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsZ0JBQWdCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixnQkFBZ0I7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixtQkFBbUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsMEJBQTBCO0FBQzFDO0FBQ0Esd0JBQXdCLHFCQUFxQjtBQUM3QztBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsbUJBQW1CO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDBCQUEwQjtBQUMxQztBQUNBLHdCQUF3QixZQUFZO0FBQ3BDLDRCQUE0QixxQkFBcUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLG1CQUFtQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSIsInNvdXJjZXMiOlsiL1VzZXJzL2plcmVtaWFoL0Rlc2t0b3AvYzJwYSB0b29sL25vZGVfbW9kdWxlcy9ieXRlc3RyZWFtanMvYnVpbGQvbWpzL2J5dGVfc3RyZWFtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBCeXRlU3RyZWFtIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgaWYgKFwidmlld1wiIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVVpbnQ4QXJyYXkocGFyYW1ldGVycy52aWV3KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChcImJ1ZmZlclwiIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbUFycmF5QnVmZmVyKHBhcmFtZXRlcnMuYnVmZmVyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChcInN0cmluZ1wiIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVN0cmluZyhwYXJhbWV0ZXJzLnN0cmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoXCJoZXhzdHJpbmdcIiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21IZXhTdHJpbmcocGFyYW1ldGVycy5oZXhzdHJpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKFwibGVuZ3RoXCIgaW4gcGFyYW1ldGVycyAmJiBwYXJhbWV0ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxlbmd0aCA9IHBhcmFtZXRlcnMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmIChwYXJhbWV0ZXJzLnN0dWIpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl92aWV3Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl92aWV3W2ldID0gcGFyYW1ldGVycy5zdHViO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHNldCBidWZmZXIodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fYnVmZmVyID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX3ZpZXcgPSBuZXcgVWludDhBcnJheSh0aGlzLl9idWZmZXIpO1xuICAgIH1cbiAgICBnZXQgYnVmZmVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnVmZmVyO1xuICAgIH1cbiAgICBzZXQgdmlldyh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9idWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIodmFsdWUubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5fdmlldyA9IG5ldyBVaW50OEFycmF5KHRoaXMuX2J1ZmZlcik7XG4gICAgICAgIHRoaXMuX3ZpZXcuc2V0KHZhbHVlKTtcbiAgICB9XG4gICAgZ2V0IHZpZXcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl92aWV3O1xuICAgIH1cbiAgICBnZXQgbGVuZ3RoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3LmJ5dGVMZW5ndGg7XG4gICAgfVxuICAgIHNldCBsZW5ndGgodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fYnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKHZhbHVlKTtcbiAgICAgICAgdGhpcy5fdmlldyA9IG5ldyBVaW50OEFycmF5KHRoaXMuX2J1ZmZlcik7XG4gICAgfVxuICAgIGNsZWFyKCkge1xuICAgICAgICB0aGlzLl9idWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoMCk7XG4gICAgICAgIHRoaXMuX3ZpZXcgPSBuZXcgVWludDhBcnJheSh0aGlzLl9idWZmZXIpO1xuICAgIH1cbiAgICBmcm9tQXJyYXlCdWZmZXIoYXJyYXkpIHtcbiAgICAgICAgdGhpcy5fYnVmZmVyID0gYXJyYXk7XG4gICAgICAgIHRoaXMuX3ZpZXcgPSBuZXcgVWludDhBcnJheSh0aGlzLl9idWZmZXIpO1xuICAgIH1cbiAgICBmcm9tVWludDhBcnJheShhcnJheSkge1xuICAgICAgICB0aGlzLmZyb21BcnJheUJ1ZmZlcihuZXcgVWludDhBcnJheShhcnJheSkuYnVmZmVyKTtcbiAgICB9XG4gICAgZnJvbVN0cmluZyhzdHJpbmcpIHtcbiAgICAgICAgY29uc3Qgc3RyaW5nTGVuZ3RoID0gc3RyaW5nLmxlbmd0aDtcbiAgICAgICAgdGhpcy5sZW5ndGggPSBzdHJpbmdMZW5ndGg7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyaW5nTGVuZ3RoOyBpKyspXG4gICAgICAgICAgICB0aGlzLnZpZXdbaV0gPSBzdHJpbmcuY2hhckNvZGVBdChpKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoc3RhcnQgPSAwLCBsZW5ndGggPSAodGhpcy52aWV3Lmxlbmd0aCAtIHN0YXJ0KSkge1xuICAgICAgICBsZXQgcmVzdWx0ID0gXCJcIjtcbiAgICAgICAgaWYgKChzdGFydCA+PSB0aGlzLnZpZXcubGVuZ3RoKSB8fCAoc3RhcnQgPCAwKSkge1xuICAgICAgICAgICAgc3RhcnQgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICgobGVuZ3RoID49IHRoaXMudmlldy5sZW5ndGgpIHx8IChsZW5ndGggPCAwKSkge1xuICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy52aWV3Lmxlbmd0aCAtIHN0YXJ0O1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSBzdGFydDsgaSA8IChzdGFydCArIGxlbmd0aCk7IGkrKylcbiAgICAgICAgICAgIHJlc3VsdCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHRoaXMudmlld1tpXSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGZyb21IZXhTdHJpbmcoaGV4U3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IHN0cmluZ0xlbmd0aCA9IGhleFN0cmluZy5sZW5ndGg7XG4gICAgICAgIHRoaXMuYnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKHN0cmluZ0xlbmd0aCA+PiAxKTtcbiAgICAgICAgdGhpcy52aWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5idWZmZXIpO1xuICAgICAgICBjb25zdCBoZXhNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIGhleE1hcC5zZXQoXCIwXCIsIDB4MDApO1xuICAgICAgICBoZXhNYXAuc2V0KFwiMVwiLCAweDAxKTtcbiAgICAgICAgaGV4TWFwLnNldChcIjJcIiwgMHgwMik7XG4gICAgICAgIGhleE1hcC5zZXQoXCIzXCIsIDB4MDMpO1xuICAgICAgICBoZXhNYXAuc2V0KFwiNFwiLCAweDA0KTtcbiAgICAgICAgaGV4TWFwLnNldChcIjVcIiwgMHgwNSk7XG4gICAgICAgIGhleE1hcC5zZXQoXCI2XCIsIDB4MDYpO1xuICAgICAgICBoZXhNYXAuc2V0KFwiN1wiLCAweDA3KTtcbiAgICAgICAgaGV4TWFwLnNldChcIjhcIiwgMHgwOCk7XG4gICAgICAgIGhleE1hcC5zZXQoXCI5XCIsIDB4MDkpO1xuICAgICAgICBoZXhNYXAuc2V0KFwiQVwiLCAweDBBKTtcbiAgICAgICAgaGV4TWFwLnNldChcImFcIiwgMHgwQSk7XG4gICAgICAgIGhleE1hcC5zZXQoXCJCXCIsIDB4MEIpO1xuICAgICAgICBoZXhNYXAuc2V0KFwiYlwiLCAweDBCKTtcbiAgICAgICAgaGV4TWFwLnNldChcIkNcIiwgMHgwQyk7XG4gICAgICAgIGhleE1hcC5zZXQoXCJjXCIsIDB4MEMpO1xuICAgICAgICBoZXhNYXAuc2V0KFwiRFwiLCAweDBEKTtcbiAgICAgICAgaGV4TWFwLnNldChcImRcIiwgMHgwRCk7XG4gICAgICAgIGhleE1hcC5zZXQoXCJFXCIsIDB4MEUpO1xuICAgICAgICBoZXhNYXAuc2V0KFwiZVwiLCAweDBFKTtcbiAgICAgICAgaGV4TWFwLnNldChcIkZcIiwgMHgwRik7XG4gICAgICAgIGhleE1hcC5zZXQoXCJmXCIsIDB4MEYpO1xuICAgICAgICBsZXQgaiA9IDA7XG4gICAgICAgIGxldCB0ZW1wID0gMHgwMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHJpbmdMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKCEoaSAlIDIpKSB7XG4gICAgICAgICAgICAgICAgdGVtcCA9IGhleE1hcC5nZXQoaGV4U3RyaW5nLmNoYXJBdChpKSkgPDwgNDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRlbXAgfD0gaGV4TWFwLmdldChoZXhTdHJpbmcuY2hhckF0KGkpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdbal0gPSB0ZW1wO1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB0b0hleFN0cmluZyhzdGFydCA9IDAsIGxlbmd0aCA9ICh0aGlzLnZpZXcubGVuZ3RoIC0gc3RhcnQpKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSBcIlwiO1xuICAgICAgICBpZiAoKHN0YXJ0ID49IHRoaXMudmlldy5sZW5ndGgpIHx8IChzdGFydCA8IDApKSB7XG4gICAgICAgICAgICBzdGFydCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChsZW5ndGggPj0gdGhpcy52aWV3Lmxlbmd0aCkgfHwgKGxlbmd0aCA8IDApKSB7XG4gICAgICAgICAgICBsZW5ndGggPSB0aGlzLnZpZXcubGVuZ3RoIC0gc3RhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0OyBpIDwgKHN0YXJ0ICsgbGVuZ3RoKTsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBzdHIgPSB0aGlzLnZpZXdbaV0udG9TdHJpbmcoMTYpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgKyAoKHN0ci5sZW5ndGggPT0gMSkgPyBcIjBcIiA6IFwiXCIpICsgc3RyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGNvcHkoc3RhcnQgPSAwLCBsZW5ndGggPSAodGhpcy5sZW5ndGggLSBzdGFydCkpIHtcbiAgICAgICAgaWYgKCFzdGFydCAmJiAhdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQnl0ZVN0cmVhbSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgoc3RhcnQgPCAwKSB8fCAoc3RhcnQgPiAodGhpcy5sZW5ndGggLSAxKSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgV3Jvbmcgc3RhcnQgcG9zaXRpb246ICR7c3RhcnR9YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3RyZWFtID0gbmV3IEJ5dGVTdHJlYW0oe1xuICAgICAgICAgICAgYnVmZmVyOiB0aGlzLl9idWZmZXIuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbGVuZ3RoKVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHN0cmVhbTtcbiAgICB9XG4gICAgc2xpY2Uoc3RhcnQgPSAwLCBlbmQgPSB0aGlzLmxlbmd0aCkge1xuICAgICAgICBpZiAoIXN0YXJ0ICYmICF0aGlzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBCeXRlU3RyZWFtKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChzdGFydCA8IDApIHx8IChzdGFydCA+ICh0aGlzLmxlbmd0aCAtIDEpKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBXcm9uZyBzdGFydCBwb3NpdGlvbjogJHtzdGFydH1gKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdHJlYW0gPSBuZXcgQnl0ZVN0cmVhbSh7XG4gICAgICAgICAgICBidWZmZXI6IHRoaXMuX2J1ZmZlci5zbGljZShzdGFydCwgZW5kKSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzdHJlYW07XG4gICAgfVxuICAgIHJlYWxsb2Moc2l6ZSkge1xuICAgICAgICBjb25zdCBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoc2l6ZSk7XG4gICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xuICAgICAgICBpZiAoc2l6ZSA+IHRoaXMuX3ZpZXcubGVuZ3RoKVxuICAgICAgICAgICAgdmlldy5zZXQodGhpcy5fdmlldyk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmlldy5zZXQobmV3IFVpbnQ4QXJyYXkodGhpcy5fYnVmZmVyLCAwLCBzaXplKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYnVmZmVyID0gYnVmZmVyO1xuICAgICAgICB0aGlzLl92aWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fYnVmZmVyKTtcbiAgICB9XG4gICAgYXBwZW5kKHN0cmVhbSkge1xuICAgICAgICBjb25zdCBpbml0aWFsU2l6ZSA9IHRoaXMubGVuZ3RoO1xuICAgICAgICBjb25zdCBzdHJlYW1WaWV3TGVuZ3RoID0gc3RyZWFtLmxlbmd0aDtcbiAgICAgICAgY29uc3Qgc3ViYXJyYXlWaWV3ID0gc3RyZWFtLl92aWV3LnN1YmFycmF5KCk7XG4gICAgICAgIHRoaXMucmVhbGxvYyhpbml0aWFsU2l6ZSArIHN0cmVhbVZpZXdMZW5ndGgpO1xuICAgICAgICB0aGlzLl92aWV3LnNldChzdWJhcnJheVZpZXcsIGluaXRpYWxTaXplKTtcbiAgICB9XG4gICAgaW5zZXJ0KHN0cmVhbSwgc3RhcnQgPSAwLCBsZW5ndGggPSAodGhpcy5sZW5ndGggLSBzdGFydCkpIHtcbiAgICAgICAgaWYgKHN0YXJ0ID4gKHRoaXMubGVuZ3RoIC0gMSkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmIChsZW5ndGggPiAodGhpcy5sZW5ndGggLSBzdGFydCkpIHtcbiAgICAgICAgICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoIC0gc3RhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxlbmd0aCA+IHN0cmVhbS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxlbmd0aCA9IHN0cmVhbS5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxlbmd0aCA9PSBzdHJlYW0ubGVuZ3RoKVxuICAgICAgICAgICAgdGhpcy5fdmlldy5zZXQoc3RyZWFtLl92aWV3LCBzdGFydCk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdmlldy5zZXQoc3RyZWFtLl92aWV3LnN1YmFycmF5KDAsIGxlbmd0aCksIHN0YXJ0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaXNFcXVhbChzdHJlYW0pIHtcbiAgICAgICAgaWYgKHRoaXMubGVuZ3RoICE9IHN0cmVhbS5sZW5ndGgpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyZWFtLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy52aWV3W2ldICE9IHN0cmVhbS52aWV3W2ldKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaXNFcXVhbFZpZXcodmlldykge1xuICAgICAgICBpZiAodmlldy5sZW5ndGggIT0gdGhpcy52aWV3Lmxlbmd0aClcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2aWV3Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy52aWV3W2ldICE9IHZpZXdbaV0pXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBmaW5kUGF0dGVybihwYXR0ZXJuLCBzdGFydF8sIGxlbmd0aF8sIGJhY2t3YXJkXykge1xuICAgICAgICBjb25zdCB7IHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkIH0gPSB0aGlzLnByZXBhcmVGaW5kUGFyYW1ldGVycyhzdGFydF8sIGxlbmd0aF8sIGJhY2t3YXJkXyk7XG4gICAgICAgIGNvbnN0IHBhdHRlcm5MZW5ndGggPSBwYXR0ZXJuLmxlbmd0aDtcbiAgICAgICAgaWYgKHBhdHRlcm5MZW5ndGggPiBsZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiAoLTEpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBhdHRlcm5BcnJheSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdHRlcm5MZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHBhdHRlcm5BcnJheS5wdXNoKHBhdHRlcm4udmlld1tpXSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IChsZW5ndGggLSBwYXR0ZXJuTGVuZ3RoKTsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgZXF1YWwgPSB0cnVlO1xuICAgICAgICAgICAgY29uc3QgZXF1YWxTdGFydCA9IChiYWNrd2FyZCkgPyAoc3RhcnQgLSBwYXR0ZXJuTGVuZ3RoIC0gaSkgOiAoc3RhcnQgKyBpKTtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgcGF0dGVybkxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmlld1tqICsgZXF1YWxTdGFydF0gIT0gcGF0dGVybkFycmF5W2pdKSB7XG4gICAgICAgICAgICAgICAgICAgIGVxdWFsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlcXVhbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoYmFja3dhcmQpID8gKHN0YXJ0IC0gcGF0dGVybkxlbmd0aCAtIGkpIDogKHN0YXJ0ICsgcGF0dGVybkxlbmd0aCArIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoLTEpO1xuICAgIH1cbiAgICBmaW5kRmlyc3RJbihwYXR0ZXJucywgc3RhcnRfLCBsZW5ndGhfLCBiYWNrd2FyZF8pIHtcbiAgICAgICAgY29uc3QgeyBzdGFydCwgbGVuZ3RoLCBiYWNrd2FyZCB9ID0gdGhpcy5wcmVwYXJlRmluZFBhcmFtZXRlcnMoc3RhcnRfLCBsZW5ndGhfLCBiYWNrd2FyZF8pO1xuICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICBpZDogKC0xKSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiAoYmFja3dhcmQpID8gMCA6IChzdGFydCArIGxlbmd0aCksXG4gICAgICAgICAgICBsZW5ndGg6IDBcbiAgICAgICAgfTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXR0ZXJucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLmZpbmRQYXR0ZXJuKHBhdHRlcm5zW2ldLCBzdGFydCwgbGVuZ3RoLCBiYWNrd2FyZCk7XG4gICAgICAgICAgICBpZiAocG9zaXRpb24gIT0gKC0xKSkge1xuICAgICAgICAgICAgICAgIGxldCB2YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhdHRlcm5MZW5ndGggPSBwYXR0ZXJuc1tpXS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgaWYgKGJhY2t3YXJkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgocG9zaXRpb24gLSBwYXR0ZXJuTGVuZ3RoKSA+PSAocmVzdWx0LnBvc2l0aW9uIC0gcmVzdWx0Lmxlbmd0aCkpXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxpZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKHBvc2l0aW9uIC0gcGF0dGVybkxlbmd0aCkgPD0gKHJlc3VsdC5wb3NpdGlvbiAtIHJlc3VsdC5sZW5ndGgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5pZCA9IGk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5sZW5ndGggPSBwYXR0ZXJuTGVuZ3RoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBmaW5kQWxsSW4ocGF0dGVybnMsIHN0YXJ0XywgbGVuZ3RoXykge1xuICAgICAgICBsZXQgeyBzdGFydCwgbGVuZ3RoIH0gPSB0aGlzLnByZXBhcmVGaW5kUGFyYW1ldGVycyhzdGFydF8sIGxlbmd0aF8pO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgbGV0IHBhdHRlcm5Gb3VuZCA9IHtcbiAgICAgICAgICAgIGlkOiAoLTEpLFxuICAgICAgICAgICAgcG9zaXRpb246IHN0YXJ0XG4gICAgICAgIH07XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gcGF0dGVybkZvdW5kLnBvc2l0aW9uO1xuICAgICAgICAgICAgcGF0dGVybkZvdW5kID0gdGhpcy5maW5kRmlyc3RJbihwYXR0ZXJucywgcGF0dGVybkZvdW5kLnBvc2l0aW9uLCBsZW5ndGgpO1xuICAgICAgICAgICAgaWYgKHBhdHRlcm5Gb3VuZC5pZCA9PSAoLTEpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZW5ndGggLT0gKHBhdHRlcm5Gb3VuZC5wb3NpdGlvbiAtIHBvc2l0aW9uKTtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogcGF0dGVybkZvdW5kLmlkLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBwYXR0ZXJuRm91bmQucG9zaXRpb25cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IHdoaWxlICh0cnVlKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgZmluZEFsbFBhdHRlcm5JbihwYXR0ZXJuLCBzdGFydF8sIGxlbmd0aF8pIHtcbiAgICAgICAgY29uc3QgeyBzdGFydCwgbGVuZ3RoIH0gPSB0aGlzLnByZXBhcmVGaW5kUGFyYW1ldGVycyhzdGFydF8sIGxlbmd0aF8pO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgY29uc3QgcGF0dGVybkxlbmd0aCA9IHBhdHRlcm4ubGVuZ3RoO1xuICAgICAgICBpZiAocGF0dGVybkxlbmd0aCA+IGxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuICgtMSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcGF0dGVybkFycmF5ID0gQXJyYXkuZnJvbShwYXR0ZXJuLnZpZXcpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSAobGVuZ3RoIC0gcGF0dGVybkxlbmd0aCk7IGkrKykge1xuICAgICAgICAgICAgbGV0IGVxdWFsID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IGVxdWFsU3RhcnQgPSBzdGFydCArIGk7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHBhdHRlcm5MZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZpZXdbaiArIGVxdWFsU3RhcnRdICE9IHBhdHRlcm5BcnJheVtqXSkge1xuICAgICAgICAgICAgICAgICAgICBlcXVhbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXF1YWwpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChzdGFydCArIHBhdHRlcm5MZW5ndGggKyBpKTtcbiAgICAgICAgICAgICAgICBpICs9IChwYXR0ZXJuTGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgZmluZEZpcnN0Tm90SW4ocGF0dGVybnMsIHN0YXJ0XywgbGVuZ3RoXywgYmFja3dhcmRfKSB7XG4gICAgICAgIGxldCB7IHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkIH0gPSB0aGlzLnByZXBhcmVGaW5kUGFyYW1ldGVycyhzdGFydF8sIGxlbmd0aF8sIGJhY2t3YXJkXyk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgIGxlZnQ6IHtcbiAgICAgICAgICAgICAgICBpZDogKC0xKSxcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogc3RhcnRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByaWdodDoge1xuICAgICAgICAgICAgICAgIGlkOiAoLTEpLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdmFsdWU6IG5ldyBCeXRlU3RyZWFtKClcbiAgICAgICAgfTtcbiAgICAgICAgbGV0IGN1cnJlbnRMZW5ndGggPSBsZW5ndGg7XG4gICAgICAgIHdoaWxlIChjdXJyZW50TGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmVzdWx0LnJpZ2h0ID0gdGhpcy5maW5kRmlyc3RJbihwYXR0ZXJucywgKGJhY2t3YXJkKSA/IChzdGFydCAtIGxlbmd0aCArIGN1cnJlbnRMZW5ndGgpIDogKHN0YXJ0ICsgbGVuZ3RoIC0gY3VycmVudExlbmd0aCksIGN1cnJlbnRMZW5ndGgsIGJhY2t3YXJkKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQucmlnaHQuaWQgPT0gKC0xKSkge1xuICAgICAgICAgICAgICAgIGxlbmd0aCA9IGN1cnJlbnRMZW5ndGg7XG4gICAgICAgICAgICAgICAgaWYgKGJhY2t3YXJkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0IC09IGxlbmd0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gcmVzdWx0LmxlZnQucG9zaXRpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlc3VsdC52YWx1ZSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgICAgICAgICAgYnVmZmVyOiB0aGlzLl9idWZmZXIuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbGVuZ3RoKSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXN1bHQucmlnaHQucG9zaXRpb24gIT0gKChiYWNrd2FyZCkgPyAocmVzdWx0LmxlZnQucG9zaXRpb24gLSBwYXR0ZXJuc1tyZXN1bHQucmlnaHQuaWRdLmxlbmd0aCkgOiAocmVzdWx0LmxlZnQucG9zaXRpb24gKyBwYXR0ZXJuc1tyZXN1bHQucmlnaHQuaWRdLmxlbmd0aCkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGJhY2t3YXJkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gcmVzdWx0LnJpZ2h0LnBvc2l0aW9uICsgcGF0dGVybnNbcmVzdWx0LnJpZ2h0LmlkXS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGxlbmd0aCA9IHJlc3VsdC5sZWZ0LnBvc2l0aW9uIC0gcmVzdWx0LnJpZ2h0LnBvc2l0aW9uIC0gcGF0dGVybnNbcmVzdWx0LnJpZ2h0LmlkXS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGFydCA9IHJlc3VsdC5sZWZ0LnBvc2l0aW9uO1xuICAgICAgICAgICAgICAgICAgICBsZW5ndGggPSByZXN1bHQucmlnaHQucG9zaXRpb24gLSByZXN1bHQubGVmdC5wb3NpdGlvbiAtIHBhdHRlcm5zW3Jlc3VsdC5yaWdodC5pZF0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXN1bHQudmFsdWUgPSBuZXcgQnl0ZVN0cmVhbSh7XG4gICAgICAgICAgICAgICAgICAgIGJ1ZmZlcjogdGhpcy5fYnVmZmVyLnNsaWNlKHN0YXJ0LCBzdGFydCArIGxlbmd0aCksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHQubGVmdCA9IHJlc3VsdC5yaWdodDtcbiAgICAgICAgICAgIGN1cnJlbnRMZW5ndGggLT0gcGF0dGVybnNbcmVzdWx0LnJpZ2h0LmlkXS5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJhY2t3YXJkKSB7XG4gICAgICAgICAgICBjb25zdCB0ZW1wID0gcmVzdWx0LnJpZ2h0O1xuICAgICAgICAgICAgcmVzdWx0LnJpZ2h0ID0gcmVzdWx0LmxlZnQ7XG4gICAgICAgICAgICByZXN1bHQubGVmdCA9IHRlbXA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgZmluZEFsbE5vdEluKHBhdHRlcm5zLCBzdGFydF8sIGxlbmd0aF8pIHtcbiAgICAgICAgbGV0IHsgc3RhcnQsIGxlbmd0aCB9ID0gdGhpcy5wcmVwYXJlRmluZFBhcmFtZXRlcnMoc3RhcnRfLCBsZW5ndGhfKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgICAgIGxldCBwYXR0ZXJuRm91bmQgPSB7XG4gICAgICAgICAgICBsZWZ0OiB7XG4gICAgICAgICAgICAgICAgaWQ6ICgtMSksXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHN0YXJ0XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmlnaHQ6IHtcbiAgICAgICAgICAgICAgICBpZDogKC0xKSxcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogc3RhcnRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB2YWx1ZTogbmV3IEJ5dGVTdHJlYW0oKVxuICAgICAgICB9O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHBhdHRlcm5Gb3VuZC5yaWdodC5wb3NpdGlvbjtcbiAgICAgICAgICAgIHBhdHRlcm5Gb3VuZCA9IHRoaXMuZmluZEZpcnN0Tm90SW4ocGF0dGVybnMsIHBhdHRlcm5Gb3VuZC5yaWdodC5wb3NpdGlvbiwgbGVuZ3RoKTtcbiAgICAgICAgICAgIGxlbmd0aCAtPSAocGF0dGVybkZvdW5kLnJpZ2h0LnBvc2l0aW9uIC0gcG9zaXRpb24pO1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgIGxlZnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHBhdHRlcm5Gb3VuZC5sZWZ0LmlkLFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogcGF0dGVybkZvdW5kLmxlZnQucG9zaXRpb25cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJpZ2h0OiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBwYXR0ZXJuRm91bmQucmlnaHQuaWQsXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBwYXR0ZXJuRm91bmQucmlnaHQucG9zaXRpb25cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBwYXR0ZXJuRm91bmQudmFsdWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IHdoaWxlIChwYXR0ZXJuRm91bmQucmlnaHQuaWQgIT0gKC0xKSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGZpbmRGaXJzdFNlcXVlbmNlKHBhdHRlcm5zLCBzdGFydF8sIGxlbmd0aF8sIGJhY2t3YXJkXykge1xuICAgICAgICBsZXQgeyBzdGFydCwgbGVuZ3RoLCBiYWNrd2FyZCB9ID0gdGhpcy5wcmVwYXJlRmluZFBhcmFtZXRlcnMoc3RhcnRfLCBsZW5ndGhfLCBiYWNrd2FyZF8pO1xuICAgICAgICBjb25zdCBmaXJzdEluID0gdGhpcy5za2lwTm90UGF0dGVybnMocGF0dGVybnMsIHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkKTtcbiAgICAgICAgaWYgKGZpcnN0SW4gPT0gKC0xKSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogKC0xKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogbmV3IEJ5dGVTdHJlYW0oKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaXJzdE5vdEluID0gdGhpcy5za2lwUGF0dGVybnMocGF0dGVybnMsIGZpcnN0SW4sIGxlbmd0aCAtICgoYmFja3dhcmQpID8gKHN0YXJ0IC0gZmlyc3RJbikgOiAoZmlyc3RJbiAtIHN0YXJ0KSksIGJhY2t3YXJkKTtcbiAgICAgICAgaWYgKGJhY2t3YXJkKSB7XG4gICAgICAgICAgICBzdGFydCA9IGZpcnN0Tm90SW47XG4gICAgICAgICAgICBsZW5ndGggPSAoZmlyc3RJbiAtIGZpcnN0Tm90SW4pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RhcnQgPSBmaXJzdEluO1xuICAgICAgICAgICAgbGVuZ3RoID0gKGZpcnN0Tm90SW4gLSBmaXJzdEluKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyBCeXRlU3RyZWFtKHtcbiAgICAgICAgICAgIGJ1ZmZlcjogdGhpcy5fYnVmZmVyLnNsaWNlKHN0YXJ0LCBzdGFydCArIGxlbmd0aCksXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcG9zaXRpb246IGZpcnN0Tm90SW4sXG4gICAgICAgICAgICB2YWx1ZVxuICAgICAgICB9O1xuICAgIH1cbiAgICBmaW5kQWxsU2VxdWVuY2VzKHBhdHRlcm5zLCBzdGFydF8sIGxlbmd0aF8pIHtcbiAgICAgICAgbGV0IHsgc3RhcnQsIGxlbmd0aCB9ID0gdGhpcy5wcmVwYXJlRmluZFBhcmFtZXRlcnMoc3RhcnRfLCBsZW5ndGhfKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgICAgIGxldCBwYXR0ZXJuRm91bmQgPSB7XG4gICAgICAgICAgICBwb3NpdGlvbjogc3RhcnQsXG4gICAgICAgICAgICB2YWx1ZTogbmV3IEJ5dGVTdHJlYW0oKVxuICAgICAgICB9O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHBhdHRlcm5Gb3VuZC5wb3NpdGlvbjtcbiAgICAgICAgICAgIHBhdHRlcm5Gb3VuZCA9IHRoaXMuZmluZEZpcnN0U2VxdWVuY2UocGF0dGVybnMsIHBhdHRlcm5Gb3VuZC5wb3NpdGlvbiwgbGVuZ3RoKTtcbiAgICAgICAgICAgIGlmIChwYXR0ZXJuRm91bmQucG9zaXRpb24gIT0gKC0xKSkge1xuICAgICAgICAgICAgICAgIGxlbmd0aCAtPSAocGF0dGVybkZvdW5kLnBvc2l0aW9uIC0gcG9zaXRpb24pO1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHBhdHRlcm5Gb3VuZC5wb3NpdGlvbixcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHBhdHRlcm5Gb3VuZC52YWx1ZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSB3aGlsZSAocGF0dGVybkZvdW5kLnBvc2l0aW9uICE9ICgtMSkpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBmaW5kUGFpcmVkUGF0dGVybnMobGVmdFBhdHRlcm4sIHJpZ2h0UGF0dGVybiwgc3RhcnRfLCBsZW5ndGhfKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xuICAgICAgICBpZiAobGVmdFBhdHRlcm4uaXNFcXVhbChyaWdodFBhdHRlcm4pKVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgY29uc3QgeyBzdGFydCwgbGVuZ3RoIH0gPSB0aGlzLnByZXBhcmVGaW5kUGFyYW1ldGVycyhzdGFydF8sIGxlbmd0aF8pO1xuICAgICAgICBsZXQgY3VycmVudFBvc2l0aW9uTGVmdCA9IDA7XG4gICAgICAgIGNvbnN0IGxlZnRQYXR0ZXJucyA9IHRoaXMuZmluZEFsbFBhdHRlcm5JbihsZWZ0UGF0dGVybiwgc3RhcnQsIGxlbmd0aCk7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShsZWZ0UGF0dGVybnMpIHx8IGxlZnRQYXR0ZXJucy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByaWdodFBhdHRlcm5zID0gdGhpcy5maW5kQWxsUGF0dGVybkluKHJpZ2h0UGF0dGVybiwgc3RhcnQsIGxlbmd0aCk7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShyaWdodFBhdHRlcm5zKSB8fCByaWdodFBhdHRlcm5zLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChjdXJyZW50UG9zaXRpb25MZWZ0IDwgbGVmdFBhdHRlcm5zLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKHJpZ2h0UGF0dGVybnMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsZWZ0UGF0dGVybnNbMF0gPT0gcmlnaHRQYXR0ZXJuc1swXSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogbGVmdFBhdHRlcm5zWzBdLFxuICAgICAgICAgICAgICAgICAgICByaWdodDogcmlnaHRQYXR0ZXJuc1swXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGxlZnRQYXR0ZXJucy5zcGxpY2UoMCwgMSk7XG4gICAgICAgICAgICAgICAgcmlnaHRQYXR0ZXJucy5zcGxpY2UoMCwgMSk7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGVmdFBhdHRlcm5zW2N1cnJlbnRQb3NpdGlvbkxlZnRdID4gcmlnaHRQYXR0ZXJuc1swXSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKGxlZnRQYXR0ZXJuc1tjdXJyZW50UG9zaXRpb25MZWZ0XSA8IHJpZ2h0UGF0dGVybnNbMF0pIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UG9zaXRpb25MZWZ0Kys7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRQb3NpdGlvbkxlZnQgPj0gbGVmdFBhdHRlcm5zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgbGVmdDogbGVmdFBhdHRlcm5zW2N1cnJlbnRQb3NpdGlvbkxlZnQgLSAxXSxcbiAgICAgICAgICAgICAgICByaWdodDogcmlnaHRQYXR0ZXJuc1swXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsZWZ0UGF0dGVybnMuc3BsaWNlKGN1cnJlbnRQb3NpdGlvbkxlZnQgLSAxLCAxKTtcbiAgICAgICAgICAgIHJpZ2h0UGF0dGVybnMuc3BsaWNlKDAsIDEpO1xuICAgICAgICAgICAgY3VycmVudFBvc2l0aW9uTGVmdCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0LnNvcnQoKGEsIGIpID0+IChhLmxlZnQgLSBiLmxlZnQpKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgZmluZFBhaXJlZEFycmF5cyhpbnB1dExlZnRQYXR0ZXJucywgaW5wdXRSaWdodFBhdHRlcm5zLCBzdGFydF8sIGxlbmd0aF8pIHtcbiAgICAgICAgY29uc3QgeyBzdGFydCwgbGVuZ3RoIH0gPSB0aGlzLnByZXBhcmVGaW5kUGFyYW1ldGVycyhzdGFydF8sIGxlbmd0aF8pO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgbGV0IGN1cnJlbnRQb3NpdGlvbkxlZnQgPSAwO1xuICAgICAgICBjb25zdCBsZWZ0UGF0dGVybnMgPSB0aGlzLmZpbmRBbGxJbihpbnB1dExlZnRQYXR0ZXJucywgc3RhcnQsIGxlbmd0aCk7XG4gICAgICAgIGlmIChsZWZ0UGF0dGVybnMubGVuZ3RoID09IDApXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICBjb25zdCByaWdodFBhdHRlcm5zID0gdGhpcy5maW5kQWxsSW4oaW5wdXRSaWdodFBhdHRlcm5zLCBzdGFydCwgbGVuZ3RoKTtcbiAgICAgICAgaWYgKHJpZ2h0UGF0dGVybnMubGVuZ3RoID09IDApXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB3aGlsZSAoY3VycmVudFBvc2l0aW9uTGVmdCA8IGxlZnRQYXR0ZXJucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChyaWdodFBhdHRlcm5zLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGVmdFBhdHRlcm5zWzBdLnBvc2l0aW9uID09IHJpZ2h0UGF0dGVybnNbMF0ucG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6IGxlZnRQYXR0ZXJuc1swXSxcbiAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IHJpZ2h0UGF0dGVybnNbMF1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBsZWZ0UGF0dGVybnMuc3BsaWNlKDAsIDEpO1xuICAgICAgICAgICAgICAgIHJpZ2h0UGF0dGVybnMuc3BsaWNlKDAsIDEpO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxlZnRQYXR0ZXJuc1tjdXJyZW50UG9zaXRpb25MZWZ0XS5wb3NpdGlvbiA+IHJpZ2h0UGF0dGVybnNbMF0ucG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlIChsZWZ0UGF0dGVybnNbY3VycmVudFBvc2l0aW9uTGVmdF0ucG9zaXRpb24gPCByaWdodFBhdHRlcm5zWzBdLnBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFBvc2l0aW9uTGVmdCsrO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50UG9zaXRpb25MZWZ0ID49IGxlZnRQYXR0ZXJucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgIGxlZnQ6IGxlZnRQYXR0ZXJuc1tjdXJyZW50UG9zaXRpb25MZWZ0IC0gMV0sXG4gICAgICAgICAgICAgICAgcmlnaHQ6IHJpZ2h0UGF0dGVybnNbMF1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGVmdFBhdHRlcm5zLnNwbGljZShjdXJyZW50UG9zaXRpb25MZWZ0IC0gMSwgMSk7XG4gICAgICAgICAgICByaWdodFBhdHRlcm5zLnNwbGljZSgwLCAxKTtcbiAgICAgICAgICAgIGN1cnJlbnRQb3NpdGlvbkxlZnQgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdC5zb3J0KChhLCBiKSA9PiAoYS5sZWZ0LnBvc2l0aW9uIC0gYi5sZWZ0LnBvc2l0aW9uKSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHJlcGxhY2VQYXR0ZXJuKHNlYXJjaFBhdHRlcm4sIHJlcGxhY2VQYXR0ZXJuLCBzdGFydF8sIGxlbmd0aF8sIGZpbmRBbGxSZXN1bHQgPSBudWxsKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSBbXTtcbiAgICAgICAgbGV0IGk7XG4gICAgICAgIGNvbnN0IG91dHB1dCA9IHtcbiAgICAgICAgICAgIHN0YXR1czogKC0xKSxcbiAgICAgICAgICAgIHNlYXJjaFBhdHRlcm5Qb3NpdGlvbnM6IFtdLFxuICAgICAgICAgICAgcmVwbGFjZVBhdHRlcm5Qb3NpdGlvbnM6IFtdXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHsgc3RhcnQsIGxlbmd0aCB9ID0gdGhpcy5wcmVwYXJlRmluZFBhcmFtZXRlcnMoc3RhcnRfLCBsZW5ndGhfKTtcbiAgICAgICAgaWYgKGZpbmRBbGxSZXN1bHQgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5maW5kQWxsSW4oW3NlYXJjaFBhdHRlcm5dLCBzdGFydCwgbGVuZ3RoKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gZmluZEFsbFJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXQuc2VhcmNoUGF0dGVyblBvc2l0aW9ucy5wdXNoKC4uLkFycmF5LmZyb20ocmVzdWx0LCBlbGVtZW50ID0+IGVsZW1lbnQucG9zaXRpb24pKTtcbiAgICAgICAgY29uc3QgcGF0dGVybkRpZmZlcmVuY2UgPSBzZWFyY2hQYXR0ZXJuLmxlbmd0aCAtIHJlcGxhY2VQYXR0ZXJuLmxlbmd0aDtcbiAgICAgICAgY29uc3QgY2hhbmdlZEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcih0aGlzLnZpZXcubGVuZ3RoIC0gKHJlc3VsdC5sZW5ndGggKiBwYXR0ZXJuRGlmZmVyZW5jZSkpO1xuICAgICAgICBjb25zdCBjaGFuZ2VkVmlldyA9IG5ldyBVaW50OEFycmF5KGNoYW5nZWRCdWZmZXIpO1xuICAgICAgICBjaGFuZ2VkVmlldy5zZXQobmV3IFVpbnQ4QXJyYXkodGhpcy5idWZmZXIsIDAsIHN0YXJ0KSk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQb3NpdGlvbiA9IChpID09IDApID8gc3RhcnQgOiByZXN1bHRbaSAtIDFdLnBvc2l0aW9uO1xuICAgICAgICAgICAgY2hhbmdlZFZpZXcuc2V0KG5ldyBVaW50OEFycmF5KHRoaXMuYnVmZmVyLCBjdXJyZW50UG9zaXRpb24sIHJlc3VsdFtpXS5wb3NpdGlvbiAtIHNlYXJjaFBhdHRlcm4ubGVuZ3RoIC0gY3VycmVudFBvc2l0aW9uKSwgY3VycmVudFBvc2l0aW9uIC0gaSAqIHBhdHRlcm5EaWZmZXJlbmNlKTtcbiAgICAgICAgICAgIGNoYW5nZWRWaWV3LnNldChyZXBsYWNlUGF0dGVybi52aWV3LCByZXN1bHRbaV0ucG9zaXRpb24gLSBzZWFyY2hQYXR0ZXJuLmxlbmd0aCAtIGkgKiBwYXR0ZXJuRGlmZmVyZW5jZSk7XG4gICAgICAgICAgICBvdXRwdXQucmVwbGFjZVBhdHRlcm5Qb3NpdGlvbnMucHVzaChyZXN1bHRbaV0ucG9zaXRpb24gLSBzZWFyY2hQYXR0ZXJuLmxlbmd0aCAtIGkgKiBwYXR0ZXJuRGlmZmVyZW5jZSk7XG4gICAgICAgIH1cbiAgICAgICAgaS0tO1xuICAgICAgICBjaGFuZ2VkVmlldy5zZXQobmV3IFVpbnQ4QXJyYXkodGhpcy5idWZmZXIsIHJlc3VsdFtpXS5wb3NpdGlvbiwgdGhpcy5sZW5ndGggLSByZXN1bHRbaV0ucG9zaXRpb24pLCByZXN1bHRbaV0ucG9zaXRpb24gLSBzZWFyY2hQYXR0ZXJuLmxlbmd0aCArIHJlcGxhY2VQYXR0ZXJuLmxlbmd0aCAtIGkgKiBwYXR0ZXJuRGlmZmVyZW5jZSk7XG4gICAgICAgIHRoaXMuYnVmZmVyID0gY2hhbmdlZEJ1ZmZlcjtcbiAgICAgICAgdGhpcy52aWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5idWZmZXIpO1xuICAgICAgICBvdXRwdXQuc3RhdHVzID0gMTtcbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgc2tpcFBhdHRlcm5zKHBhdHRlcm5zLCBzdGFydF8sIGxlbmd0aF8sIGJhY2t3YXJkXykge1xuICAgICAgICBjb25zdCB7IHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkIH0gPSB0aGlzLnByZXBhcmVGaW5kUGFyYW1ldGVycyhzdGFydF8sIGxlbmd0aF8sIGJhY2t3YXJkXyk7XG4gICAgICAgIGxldCByZXN1bHQgPSBzdGFydDtcbiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBwYXR0ZXJucy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgY29uc3QgcGF0dGVybkxlbmd0aCA9IHBhdHRlcm5zW2tdLmxlbmd0aDtcbiAgICAgICAgICAgIGNvbnN0IGVxdWFsU3RhcnQgPSAoYmFja3dhcmQpID8gKHJlc3VsdCAtIHBhdHRlcm5MZW5ndGgpIDogKHJlc3VsdCk7XG4gICAgICAgICAgICBsZXQgZXF1YWwgPSB0cnVlO1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwYXR0ZXJuTGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy52aWV3W2ogKyBlcXVhbFN0YXJ0XSAhPSBwYXR0ZXJuc1trXS52aWV3W2pdKSB7XG4gICAgICAgICAgICAgICAgICAgIGVxdWFsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlcXVhbCkge1xuICAgICAgICAgICAgICAgIGsgPSAoLTEpO1xuICAgICAgICAgICAgICAgIGlmIChiYWNrd2FyZCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgLT0gcGF0dGVybkxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA8PSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBwYXR0ZXJuTGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID49IChzdGFydCArIGxlbmd0aCkpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBza2lwTm90UGF0dGVybnMocGF0dGVybnMsIHN0YXJ0XywgbGVuZ3RoXywgYmFja3dhcmRfKSB7XG4gICAgICAgIGNvbnN0IHsgc3RhcnQsIGxlbmd0aCwgYmFja3dhcmQgfSA9IHRoaXMucHJlcGFyZUZpbmRQYXJhbWV0ZXJzKHN0YXJ0XywgbGVuZ3RoXywgYmFja3dhcmRfKTtcbiAgICAgICAgbGV0IHJlc3VsdCA9ICgtMSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgcGF0dGVybnMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXR0ZXJuTGVuZ3RoID0gcGF0dGVybnNba10ubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVxdWFsU3RhcnQgPSAoYmFja3dhcmQpID8gKHN0YXJ0IC0gaSAtIHBhdHRlcm5MZW5ndGgpIDogKHN0YXJ0ICsgaSk7XG4gICAgICAgICAgICAgICAgbGV0IGVxdWFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHBhdHRlcm5MZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52aWV3W2ogKyBlcXVhbFN0YXJ0XSAhPSBwYXR0ZXJuc1trXS52aWV3W2pdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcXVhbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGVxdWFsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IChiYWNrd2FyZCkgPyAoc3RhcnQgLSBpKSA6IChzdGFydCArIGkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVzdWx0ICE9ICgtMSkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBwcmVwYXJlRmluZFBhcmFtZXRlcnMoc3RhcnQgPSBudWxsLCBsZW5ndGggPSBudWxsLCBiYWNrd2FyZCA9IGZhbHNlKSB7XG4gICAgICAgIGlmIChzdGFydCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgc3RhcnQgPSAoYmFja3dhcmQpID8gdGhpcy5sZW5ndGggOiAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydCA+IHRoaXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBzdGFydCA9IHRoaXMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiYWNrd2FyZCkge1xuICAgICAgICAgICAgaWYgKGxlbmd0aCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGxlbmd0aCA9IHN0YXJ0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxlbmd0aCA+IHN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gc3RhcnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAobGVuZ3RoID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5sZW5ndGggLSBzdGFydDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsZW5ndGggPiAodGhpcy5sZW5ndGggLSBzdGFydCkpIHtcbiAgICAgICAgICAgICAgICBsZW5ndGggPSB0aGlzLmxlbmd0aCAtIHN0YXJ0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHN0YXJ0LCBsZW5ndGgsIGJhY2t3YXJkIH07XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/bytestreamjs/build/mjs/byte_stream.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/bytestreamjs/build/mjs/helpers.js":
/*!********************************************************!*\
  !*** ./node_modules/bytestreamjs/build/mjs/helpers.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseByteMap: () => (/* binding */ parseByteMap)\n/* harmony export */ });\nfunction parseByteMap(stream, map, elements, start = null, length = null) {\n    if (start === null) {\n        start = 0;\n    }\n    if (start > (stream.length - 1)) {\n        return [];\n    }\n    if (length === null) {\n        length = stream.length - start;\n    }\n    if (length > (stream.length - start)) {\n        length = stream.length - start;\n    }\n    let dataView;\n    if ((start == 0) && (length == stream.length)) {\n        dataView = stream.view;\n    }\n    else {\n        dataView = new Uint8Array(stream.buffer, start, length);\n    }\n    const resultArray = new Array(elements);\n    let elementsCount = 0;\n    let count = 0;\n    const mapLength = map.length;\n    while (count < length) {\n        let structureLength = 0;\n        resultArray[elementsCount] = {};\n        for (let i = 0; i < mapLength; i++) {\n            if (map[i].maxlength == 0) {\n                if (\"defaultValue\" in map[i]) {\n                    (resultArray[elementsCount])[map[i].name] = map[i].defaultValue;\n                }\n                continue;\n            }\n            const array = new Uint8Array(map[i].maxlength);\n            for (let j = 0; j < map[i].maxlength; j++) {\n                array[j] = dataView[count++];\n            }\n            const result = (map[i].func)(array);\n            if (result.status == (-1)) {\n                if (resultArray.length == 1) {\n                    return [];\n                }\n                return resultArray.slice(0, resultArray.length - 1);\n            }\n            if (map[i].type != \"check\") {\n                (resultArray[elementsCount])[map[i].name] = result.value;\n            }\n            count -= (map[i].maxlength - result.length);\n            structureLength += result.length;\n        }\n        (resultArray[elementsCount++]).structureLength = structureLength;\n    }\n    return resultArray;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYnl0ZXN0cmVhbWpzL2J1aWxkL21qcy9oZWxwZXJzLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZUFBZTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixzQkFBc0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qZXJlbWlhaC9EZXNrdG9wL2MycGEgdG9vbC9ub2RlX21vZHVsZXMvYnl0ZXN0cmVhbWpzL2J1aWxkL21qcy9oZWxwZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBwYXJzZUJ5dGVNYXAoc3RyZWFtLCBtYXAsIGVsZW1lbnRzLCBzdGFydCA9IG51bGwsIGxlbmd0aCA9IG51bGwpIHtcbiAgICBpZiAoc3RhcnQgPT09IG51bGwpIHtcbiAgICAgICAgc3RhcnQgPSAwO1xuICAgIH1cbiAgICBpZiAoc3RhcnQgPiAoc3RyZWFtLmxlbmd0aCAtIDEpKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgaWYgKGxlbmd0aCA9PT0gbnVsbCkge1xuICAgICAgICBsZW5ndGggPSBzdHJlYW0ubGVuZ3RoIC0gc3RhcnQ7XG4gICAgfVxuICAgIGlmIChsZW5ndGggPiAoc3RyZWFtLmxlbmd0aCAtIHN0YXJ0KSkge1xuICAgICAgICBsZW5ndGggPSBzdHJlYW0ubGVuZ3RoIC0gc3RhcnQ7XG4gICAgfVxuICAgIGxldCBkYXRhVmlldztcbiAgICBpZiAoKHN0YXJ0ID09IDApICYmIChsZW5ndGggPT0gc3RyZWFtLmxlbmd0aCkpIHtcbiAgICAgICAgZGF0YVZpZXcgPSBzdHJlYW0udmlldztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGRhdGFWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoc3RyZWFtLmJ1ZmZlciwgc3RhcnQsIGxlbmd0aCk7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdEFycmF5ID0gbmV3IEFycmF5KGVsZW1lbnRzKTtcbiAgICBsZXQgZWxlbWVudHNDb3VudCA9IDA7XG4gICAgbGV0IGNvdW50ID0gMDtcbiAgICBjb25zdCBtYXBMZW5ndGggPSBtYXAubGVuZ3RoO1xuICAgIHdoaWxlIChjb3VudCA8IGxlbmd0aCkge1xuICAgICAgICBsZXQgc3RydWN0dXJlTGVuZ3RoID0gMDtcbiAgICAgICAgcmVzdWx0QXJyYXlbZWxlbWVudHNDb3VudF0gPSB7fTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXBMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKG1hcFtpXS5tYXhsZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgIGlmIChcImRlZmF1bHRWYWx1ZVwiIGluIG1hcFtpXSkge1xuICAgICAgICAgICAgICAgICAgICAocmVzdWx0QXJyYXlbZWxlbWVudHNDb3VudF0pW21hcFtpXS5uYW1lXSA9IG1hcFtpXS5kZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYXJyYXkgPSBuZXcgVWludDhBcnJheShtYXBbaV0ubWF4bGVuZ3RoKTtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbWFwW2ldLm1heGxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgYXJyYXlbal0gPSBkYXRhVmlld1tjb3VudCsrXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IChtYXBbaV0uZnVuYykoYXJyYXkpO1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT0gKC0xKSkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRBcnJheS5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRBcnJheS5zbGljZSgwLCByZXN1bHRBcnJheS5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtYXBbaV0udHlwZSAhPSBcImNoZWNrXCIpIHtcbiAgICAgICAgICAgICAgICAocmVzdWx0QXJyYXlbZWxlbWVudHNDb3VudF0pW21hcFtpXS5uYW1lXSA9IHJlc3VsdC52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvdW50IC09IChtYXBbaV0ubWF4bGVuZ3RoIC0gcmVzdWx0Lmxlbmd0aCk7XG4gICAgICAgICAgICBzdHJ1Y3R1cmVMZW5ndGggKz0gcmVzdWx0Lmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICAocmVzdWx0QXJyYXlbZWxlbWVudHNDb3VudCsrXSkuc3RydWN0dXJlTGVuZ3RoID0gc3RydWN0dXJlTGVuZ3RoO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0QXJyYXk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/bytestreamjs/build/mjs/helpers.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/bytestreamjs/build/mjs/index.js":
/*!******************************************************!*\
  !*** ./node_modules/bytestreamjs/build/mjs/index.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BitStream: () => (/* reexport safe */ _bit_stream__WEBPACK_IMPORTED_MODULE_3__.BitStream),\n/* harmony export */   ByteStream: () => (/* reexport safe */ _byte_stream__WEBPACK_IMPORTED_MODULE_0__.ByteStream),\n/* harmony export */   SeqBitStream: () => (/* reexport safe */ _seq_bit_stream__WEBPACK_IMPORTED_MODULE_4__.SeqBitStream),\n/* harmony export */   SeqStream: () => (/* reexport safe */ _seq_stream__WEBPACK_IMPORTED_MODULE_1__.SeqStream),\n/* harmony export */   parseByteMap: () => (/* reexport safe */ _helpers__WEBPACK_IMPORTED_MODULE_2__.parseByteMap)\n/* harmony export */ });\n/* harmony import */ var _byte_stream__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./byte_stream */ \"(ssr)/./node_modules/bytestreamjs/build/mjs/byte_stream.js\");\n/* harmony import */ var _seq_stream__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./seq_stream */ \"(ssr)/./node_modules/bytestreamjs/build/mjs/seq_stream.js\");\n/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./helpers */ \"(ssr)/./node_modules/bytestreamjs/build/mjs/helpers.js\");\n/* harmony import */ var _bit_stream__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./bit_stream */ \"(ssr)/./node_modules/bytestreamjs/build/mjs/bit_stream.js\");\n/* harmony import */ var _seq_bit_stream__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./seq_bit_stream */ \"(ssr)/./node_modules/bytestreamjs/build/mjs/seq_bit_stream.js\");\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYnl0ZXN0cmVhbWpzL2J1aWxkL21qcy9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQThCO0FBQ0Q7QUFDSDtBQUNHO0FBQ0kiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qZXJlbWlhaC9EZXNrdG9wL2MycGEgdG9vbC9ub2RlX21vZHVsZXMvYnl0ZXN0cmVhbWpzL2J1aWxkL21qcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgKiBmcm9tIFwiLi9ieXRlX3N0cmVhbVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vc2VxX3N0cmVhbVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vaGVscGVyc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vYml0X3N0cmVhbVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vc2VxX2JpdF9zdHJlYW1cIjtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/bytestreamjs/build/mjs/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/bytestreamjs/build/mjs/seq_bit_stream.js":
/*!***************************************************************!*\
  !*** ./node_modules/bytestreamjs/build/mjs/seq_bit_stream.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SeqBitStream: () => (/* binding */ SeqBitStream)\n/* harmony export */ });\n/* harmony import */ var _bit_stream__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bit_stream */ \"(ssr)/./node_modules/bytestreamjs/build/mjs/bit_stream.js\");\n\nclass SeqBitStream {\n    constructor(parameters = {}) {\n        var _a;\n        this._length = 0;\n        this._start = 0;\n        this.prevLength = 0;\n        this.prevStart = 0;\n        this.stream = ((_a = parameters.stream) === null || _a === void 0 ? void 0 : _a.slice()) || new _bit_stream__WEBPACK_IMPORTED_MODULE_0__.BitStream();\n        this.appendBlock = parameters.appendBlock || 0;\n        if (parameters.start && parameters.start > 0) {\n            this.start = parameters.start;\n        }\n        if (parameters.length && parameters.length > 0) {\n            this.length = parameters.length;\n        }\n        this.backward = parameters.backward || false;\n    }\n    set start(value) {\n        if (value > this.stream.bitsCount) {\n            return;\n        }\n        this._length -= ((this.backward) ? (this._start - value) : (value - this._start));\n        this._start = value;\n        this.prevStart = this._start;\n        this.prevLength = this._length;\n    }\n    get start() {\n        return this._start;\n    }\n    set length(value) {\n        if (value > this.stream.bitsCount) {\n            return;\n        }\n        this.prevLength = this._length;\n        this._length = value;\n    }\n    get length() {\n        return this._length;\n    }\n    set stream(value) {\n        this._stream = value;\n        this.prevLength = this._length;\n        this._length = value.bitsCount;\n        this.prevStart = this._start;\n        this._start = (this.backward) ? this.length : 0;\n    }\n    get stream() {\n        return this._stream;\n    }\n    getBits(length = null) {\n        if (length === null) {\n            length = 0;\n        }\n        else if (length === 0) {\n            return new _bit_stream__WEBPACK_IMPORTED_MODULE_0__.BitStream();\n        }\n        if ((this.start + length) > this.stream.bitsCount) {\n            length = (this.stream.bitsCount - this.start);\n        }\n        let result;\n        if (this.backward) {\n            result = this.stream.copy(this.start - length, length);\n            this.start -= result.bitsCount;\n        }\n        else {\n            result = this.stream.copy(this.start, length);\n            this.start += result.bitsCount;\n        }\n        return result;\n    }\n    getBitsString(length) {\n        return this.getBits(length).toString();\n    }\n    getBitsReversedValue(length) {\n        const initialValue = this.getBitsString(length);\n        const initialValueLength = initialValue.length;\n        let byteIndex;\n        const initialOffset = 8 - (initialValueLength % 8);\n        const reversedValue = new Array(initialValueLength);\n        const value = new Uint32Array(1);\n        const valueView = new Uint8Array(value.buffer, 0, 4);\n        let i;\n        if (initialValueLength > 32) {\n            return (-1);\n        }\n        if (length == 32) {\n            byteIndex = 3;\n        }\n        else {\n            byteIndex = ((initialValueLength - 1) >> 3);\n        }\n        for (i = 0; i < initialValueLength; i++) {\n            reversedValue[initialValueLength - 1 - i] = initialValue[i];\n        }\n        for (i = initialOffset; i < (initialOffset + initialValueLength); i++) {\n            if (reversedValue[i - initialOffset] == \"1\") {\n                valueView[byteIndex] |= 0x01 << (7 - (i % 8));\n            }\n            if (i && (((i + 1) % 8) == 0)) {\n                byteIndex--;\n            }\n        }\n        return value[0];\n    }\n    toString() {\n        const streamToDisplay = this.stream.copy(this.start, this.length);\n        return streamToDisplay.toString();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYnl0ZXN0cmVhbWpzL2J1aWxkL21qcy9zZXFfYml0X3N0cmVhbS5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUF5QztBQUNsQztBQUNQLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0dBQXdHLGtEQUFTO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtEQUFTO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQix3QkFBd0I7QUFDNUM7QUFDQTtBQUNBLGdDQUFnQywwQ0FBMEM7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiL1VzZXJzL2plcmVtaWFoL0Rlc2t0b3AvYzJwYSB0b29sL25vZGVfbW9kdWxlcy9ieXRlc3RyZWFtanMvYnVpbGQvbWpzL3NlcV9iaXRfc3RyZWFtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJpdFN0cmVhbSB9IGZyb20gXCIuL2JpdF9zdHJlYW1cIjtcbmV4cG9ydCBjbGFzcyBTZXFCaXRTdHJlYW0ge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHRoaXMuX2xlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuX3N0YXJ0ID0gMDtcbiAgICAgICAgdGhpcy5wcmV2TGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5wcmV2U3RhcnQgPSAwO1xuICAgICAgICB0aGlzLnN0cmVhbSA9ICgoX2EgPSBwYXJhbWV0ZXJzLnN0cmVhbSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNsaWNlKCkpIHx8IG5ldyBCaXRTdHJlYW0oKTtcbiAgICAgICAgdGhpcy5hcHBlbmRCbG9jayA9IHBhcmFtZXRlcnMuYXBwZW5kQmxvY2sgfHwgMDtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc3RhcnQgJiYgcGFyYW1ldGVycy5zdGFydCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnQgPSBwYXJhbWV0ZXJzLnN0YXJ0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLmxlbmd0aCAmJiBwYXJhbWV0ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMubGVuZ3RoID0gcGFyYW1ldGVycy5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5iYWNrd2FyZCA9IHBhcmFtZXRlcnMuYmFja3dhcmQgfHwgZmFsc2U7XG4gICAgfVxuICAgIHNldCBzdGFydCh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgPiB0aGlzLnN0cmVhbS5iaXRzQ291bnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sZW5ndGggLT0gKCh0aGlzLmJhY2t3YXJkKSA/ICh0aGlzLl9zdGFydCAtIHZhbHVlKSA6ICh2YWx1ZSAtIHRoaXMuX3N0YXJ0KSk7XG4gICAgICAgIHRoaXMuX3N0YXJ0ID0gdmFsdWU7XG4gICAgICAgIHRoaXMucHJldlN0YXJ0ID0gdGhpcy5fc3RhcnQ7XG4gICAgICAgIHRoaXMucHJldkxlbmd0aCA9IHRoaXMuX2xlbmd0aDtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RhcnQ7XG4gICAgfVxuICAgIHNldCBsZW5ndGgodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlID4gdGhpcy5zdHJlYW0uYml0c0NvdW50KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcmV2TGVuZ3RoID0gdGhpcy5fbGVuZ3RoO1xuICAgICAgICB0aGlzLl9sZW5ndGggPSB2YWx1ZTtcbiAgICB9XG4gICAgZ2V0IGxlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xlbmd0aDtcbiAgICB9XG4gICAgc2V0IHN0cmVhbSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zdHJlYW0gPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5wcmV2TGVuZ3RoID0gdGhpcy5fbGVuZ3RoO1xuICAgICAgICB0aGlzLl9sZW5ndGggPSB2YWx1ZS5iaXRzQ291bnQ7XG4gICAgICAgIHRoaXMucHJldlN0YXJ0ID0gdGhpcy5fc3RhcnQ7XG4gICAgICAgIHRoaXMuX3N0YXJ0ID0gKHRoaXMuYmFja3dhcmQpID8gdGhpcy5sZW5ndGggOiAwO1xuICAgIH1cbiAgICBnZXQgc3RyZWFtKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RyZWFtO1xuICAgIH1cbiAgICBnZXRCaXRzKGxlbmd0aCA9IG51bGwpIHtcbiAgICAgICAgaWYgKGxlbmd0aCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgbGVuZ3RoID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChsZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQml0U3RyZWFtKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCh0aGlzLnN0YXJ0ICsgbGVuZ3RoKSA+IHRoaXMuc3RyZWFtLmJpdHNDb3VudCkge1xuICAgICAgICAgICAgbGVuZ3RoID0gKHRoaXMuc3RyZWFtLmJpdHNDb3VudCAtIHRoaXMuc3RhcnQpO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXN1bHQ7XG4gICAgICAgIGlmICh0aGlzLmJhY2t3YXJkKSB7XG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLnN0cmVhbS5jb3B5KHRoaXMuc3RhcnQgLSBsZW5ndGgsIGxlbmd0aCk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0IC09IHJlc3VsdC5iaXRzQ291bnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLnN0cmVhbS5jb3B5KHRoaXMuc3RhcnQsIGxlbmd0aCk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ICs9IHJlc3VsdC5iaXRzQ291bnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgZ2V0Qml0c1N0cmluZyhsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Qml0cyhsZW5ndGgpLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIGdldEJpdHNSZXZlcnNlZFZhbHVlKGxlbmd0aCkge1xuICAgICAgICBjb25zdCBpbml0aWFsVmFsdWUgPSB0aGlzLmdldEJpdHNTdHJpbmcobGVuZ3RoKTtcbiAgICAgICAgY29uc3QgaW5pdGlhbFZhbHVlTGVuZ3RoID0gaW5pdGlhbFZhbHVlLmxlbmd0aDtcbiAgICAgICAgbGV0IGJ5dGVJbmRleDtcbiAgICAgICAgY29uc3QgaW5pdGlhbE9mZnNldCA9IDggLSAoaW5pdGlhbFZhbHVlTGVuZ3RoICUgOCk7XG4gICAgICAgIGNvbnN0IHJldmVyc2VkVmFsdWUgPSBuZXcgQXJyYXkoaW5pdGlhbFZhbHVlTGVuZ3RoKTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBuZXcgVWludDMyQXJyYXkoMSk7XG4gICAgICAgIGNvbnN0IHZhbHVlVmlldyA9IG5ldyBVaW50OEFycmF5KHZhbHVlLmJ1ZmZlciwgMCwgNCk7XG4gICAgICAgIGxldCBpO1xuICAgICAgICBpZiAoaW5pdGlhbFZhbHVlTGVuZ3RoID4gMzIpIHtcbiAgICAgICAgICAgIHJldHVybiAoLTEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsZW5ndGggPT0gMzIpIHtcbiAgICAgICAgICAgIGJ5dGVJbmRleCA9IDM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBieXRlSW5kZXggPSAoKGluaXRpYWxWYWx1ZUxlbmd0aCAtIDEpID4+IDMpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBpbml0aWFsVmFsdWVMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcmV2ZXJzZWRWYWx1ZVtpbml0aWFsVmFsdWVMZW5ndGggLSAxIC0gaV0gPSBpbml0aWFsVmFsdWVbaV07XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChpID0gaW5pdGlhbE9mZnNldDsgaSA8IChpbml0aWFsT2Zmc2V0ICsgaW5pdGlhbFZhbHVlTGVuZ3RoKTsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocmV2ZXJzZWRWYWx1ZVtpIC0gaW5pdGlhbE9mZnNldF0gPT0gXCIxXCIpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZVZpZXdbYnl0ZUluZGV4XSB8PSAweDAxIDw8ICg3IC0gKGkgJSA4KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaSAmJiAoKChpICsgMSkgJSA4KSA9PSAwKSkge1xuICAgICAgICAgICAgICAgIGJ5dGVJbmRleC0tO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZVswXTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGNvbnN0IHN0cmVhbVRvRGlzcGxheSA9IHRoaXMuc3RyZWFtLmNvcHkodGhpcy5zdGFydCwgdGhpcy5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gc3RyZWFtVG9EaXNwbGF5LnRvU3RyaW5nKCk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/bytestreamjs/build/mjs/seq_bit_stream.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/bytestreamjs/build/mjs/seq_stream.js":
/*!***********************************************************!*\
  !*** ./node_modules/bytestreamjs/build/mjs/seq_stream.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SeqStream: () => (/* binding */ SeqStream)\n/* harmony export */ });\n/* harmony import */ var _byte_stream__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./byte_stream */ \"(ssr)/./node_modules/bytestreamjs/build/mjs/byte_stream.js\");\n\nconst pow2_24 = 16777216;\nclass SeqStream {\n    constructor(parameters = {}) {\n        this._stream = new _byte_stream__WEBPACK_IMPORTED_MODULE_0__.ByteStream();\n        this._length = 0;\n        this._start = 0;\n        this.backward = false;\n        this.appendBlock = 0;\n        this.prevLength = 0;\n        this.prevStart = 0;\n        if (\"view\" in parameters) {\n            this.stream = new _byte_stream__WEBPACK_IMPORTED_MODULE_0__.ByteStream({ view: parameters.view });\n        }\n        else if (\"buffer\" in parameters) {\n            this.stream = new _byte_stream__WEBPACK_IMPORTED_MODULE_0__.ByteStream({ buffer: parameters.buffer });\n        }\n        else if (\"string\" in parameters) {\n            this.stream = new _byte_stream__WEBPACK_IMPORTED_MODULE_0__.ByteStream({ string: parameters.string });\n        }\n        else if (\"hexstring\" in parameters) {\n            this.stream = new _byte_stream__WEBPACK_IMPORTED_MODULE_0__.ByteStream({ hexstring: parameters.hexstring });\n        }\n        else if (\"stream\" in parameters) {\n            this.stream = parameters.stream.slice();\n        }\n        else {\n            this.stream = new _byte_stream__WEBPACK_IMPORTED_MODULE_0__.ByteStream();\n        }\n        if (\"backward\" in parameters && parameters.backward) {\n            this.backward = parameters.backward;\n            this._start = this.stream.length;\n        }\n        if (\"length\" in parameters && parameters.length > 0) {\n            this._length = parameters.length;\n        }\n        if (\"start\" in parameters && parameters.start && parameters.start > 0) {\n            this._start = parameters.start;\n        }\n        if (\"appendBlock\" in parameters && parameters.appendBlock && parameters.appendBlock > 0) {\n            this.appendBlock = parameters.appendBlock;\n        }\n    }\n    set stream(value) {\n        this._stream = value;\n        this.prevLength = this._length;\n        this._length = value.length;\n        this.prevStart = this._start;\n        this._start = 0;\n    }\n    get stream() {\n        return this._stream;\n    }\n    set length(value) {\n        this.prevLength = this._length;\n        this._length = value;\n    }\n    get length() {\n        if (this.appendBlock) {\n            return this.start;\n        }\n        return this._length;\n    }\n    set start(value) {\n        if (value > this.stream.length)\n            return;\n        this.prevStart = this._start;\n        this.prevLength = this._length;\n        this._length -= (this.backward) ? (this._start - value) : (value - this._start);\n        this._start = value;\n    }\n    get start() {\n        return this._start;\n    }\n    get buffer() {\n        return this._stream.buffer.slice(0, this._length);\n    }\n    resetPosition() {\n        this._start = this.prevStart;\n        this._length = this.prevLength;\n    }\n    findPattern(pattern, gap = null) {\n        if ((gap == null) || (gap > this.length)) {\n            gap = this.length;\n        }\n        const result = this.stream.findPattern(pattern, this.start, this.length, this.backward);\n        if (result == (-1))\n            return result;\n        if (this.backward) {\n            if (result < (this.start - pattern.length - gap)) {\n                return (-1);\n            }\n        }\n        else {\n            if (result > (this.start + pattern.length + gap)) {\n                return (-1);\n            }\n        }\n        this.start = result;\n        return result;\n    }\n    findFirstIn(patterns, gap = null) {\n        if ((gap == null) || (gap > this.length)) {\n            gap = this.length;\n        }\n        const result = this.stream.findFirstIn(patterns, this.start, this.length, this.backward);\n        if (result.id == (-1))\n            return result;\n        if (this.backward) {\n            if (result.position < (this.start - patterns[result.id].length - gap)) {\n                return {\n                    id: (-1),\n                    position: (this.backward) ? 0 : (this.start + this.length)\n                };\n            }\n        }\n        else {\n            if (result.position > (this.start + patterns[result.id].length + gap)) {\n                return {\n                    id: (-1),\n                    position: (this.backward) ? 0 : (this.start + this.length)\n                };\n            }\n        }\n        this.start = result.position;\n        return result;\n    }\n    findAllIn(patterns) {\n        const start = (this.backward) ? (this.start - this.length) : this.start;\n        return this.stream.findAllIn(patterns, start, this.length);\n    }\n    findFirstNotIn(patterns, gap = null) {\n        if ((gap == null) || (gap > this._length)) {\n            gap = this._length;\n        }\n        const result = this._stream.findFirstNotIn(patterns, this._start, this._length, this.backward);\n        if ((result.left.id == (-1)) && (result.right.id == (-1))) {\n            return result;\n        }\n        if (this.backward) {\n            if (result.right.id != (-1)) {\n                if (result.right.position < (this._start - patterns[result.right.id].length - gap)) {\n                    return {\n                        left: {\n                            id: (-1),\n                            position: this._start\n                        },\n                        right: {\n                            id: (-1),\n                            position: 0\n                        },\n                        value: new _byte_stream__WEBPACK_IMPORTED_MODULE_0__.ByteStream()\n                    };\n                }\n            }\n        }\n        else {\n            if (result.left.id != (-1)) {\n                if (result.left.position > (this._start + patterns[result.left.id].length + gap)) {\n                    return {\n                        left: {\n                            id: (-1),\n                            position: this._start\n                        },\n                        right: {\n                            id: (-1),\n                            position: 0\n                        },\n                        value: new _byte_stream__WEBPACK_IMPORTED_MODULE_0__.ByteStream()\n                    };\n                }\n            }\n        }\n        if (this.backward) {\n            if (result.left.id == (-1)) {\n                this.start = 0;\n            }\n            else {\n                this.start = result.left.position;\n            }\n        }\n        else {\n            if (result.right.id == (-1)) {\n                this.start = (this._start + this._length);\n            }\n            else {\n                this.start = result.right.position;\n            }\n        }\n        return result;\n    }\n    findAllNotIn(patterns) {\n        const start = (this.backward) ? (this._start - this._length) : this._start;\n        return this._stream.findAllNotIn(patterns, start, this._length);\n    }\n    findFirstSequence(patterns, length = null, gap = null) {\n        if ((length == null) || (length > this._length)) {\n            length = this._length;\n        }\n        if ((gap == null) || (gap > length)) {\n            gap = length;\n        }\n        const result = this._stream.findFirstSequence(patterns, this._start, length, this.backward);\n        if (result.value.length == 0) {\n            return result;\n        }\n        if (this.backward) {\n            if (result.position < (this._start - result.value.length - gap)) {\n                return {\n                    position: (-1),\n                    value: new _byte_stream__WEBPACK_IMPORTED_MODULE_0__.ByteStream()\n                };\n            }\n        }\n        else {\n            if (result.position > (this._start + result.value.length + gap)) {\n                return {\n                    position: (-1),\n                    value: new _byte_stream__WEBPACK_IMPORTED_MODULE_0__.ByteStream()\n                };\n            }\n        }\n        this.start = result.position;\n        return result;\n    }\n    findAllSequences(patterns) {\n        const start = (this.backward) ? (this.start - this.length) : this.start;\n        return this.stream.findAllSequences(patterns, start, this.length);\n    }\n    findPairedPatterns(leftPattern, rightPattern, gap = null) {\n        if ((gap == null) || (gap > this.length)) {\n            gap = this.length;\n        }\n        const start = (this.backward) ? (this.start - this.length) : this.start;\n        const result = this.stream.findPairedPatterns(leftPattern, rightPattern, start, this.length);\n        if (result.length) {\n            if (this.backward) {\n                if (result[0].right < (this.start - rightPattern.length - gap)) {\n                    return [];\n                }\n            }\n            else {\n                if (result[0].left > (this.start + leftPattern.length + gap)) {\n                    return [];\n                }\n            }\n        }\n        return result;\n    }\n    findPairedArrays(leftPatterns, rightPatterns, gap = null) {\n        if ((gap == null) || (gap > this.length)) {\n            gap = this.length;\n        }\n        const start = (this.backward) ? (this.start - this.length) : this.start;\n        const result = this.stream.findPairedArrays(leftPatterns, rightPatterns, start, this.length);\n        if (result.length) {\n            if (this.backward) {\n                if (result[0].right.position < (this.start - rightPatterns[result[0].right.id].length - gap)) {\n                    return [];\n                }\n            }\n            else {\n                if (result[0].left.position > (this.start + leftPatterns[result[0].left.id].length + gap)) {\n                    return [];\n                }\n            }\n        }\n        return result;\n    }\n    replacePattern(searchPattern, replacePattern) {\n        const start = (this.backward) ? (this.start - this.length) : this.start;\n        return this.stream.replacePattern(searchPattern, replacePattern, start, this.length);\n    }\n    skipPatterns(patterns) {\n        const result = this.stream.skipPatterns(patterns, this.start, this.length, this.backward);\n        this.start = result;\n        return result;\n    }\n    skipNotPatterns(patterns) {\n        const result = this.stream.skipNotPatterns(patterns, this.start, this.length, this.backward);\n        if (result == (-1))\n            return (-1);\n        this.start = result;\n        return result;\n    }\n    append(stream) {\n        this.beforeAppend(stream.length);\n        this._stream.view.set(stream.view, this._start);\n        this._length += (stream.length * 2);\n        this.start = (this._start + stream.length);\n        this.prevLength -= (stream.length * 2);\n    }\n    appendView(view) {\n        this.beforeAppend(view.length);\n        this._stream.view.set(view, this._start);\n        this._length += (view.length * 2);\n        this.start = (this._start + view.length);\n        this.prevLength -= (view.length * 2);\n    }\n    appendChar(char) {\n        this.beforeAppend(1);\n        this._stream.view[this._start] = char;\n        this._length += 2;\n        this.start = (this._start + 1);\n        this.prevLength -= 2;\n    }\n    appendUint16(number) {\n        this.beforeAppend(2);\n        const value = new Uint16Array([number]);\n        const view = new Uint8Array(value.buffer);\n        this.stream.view[this._start] = view[1];\n        this._stream.view[this._start + 1] = view[0];\n        this._length += 4;\n        this.start = this._start + 2;\n        this.prevLength -= 4;\n    }\n    appendUint24(number) {\n        this.beforeAppend(3);\n        const value = new Uint32Array([number]);\n        const view = new Uint8Array(value.buffer);\n        this._stream.view[this._start] = view[2];\n        this._stream.view[this._start + 1] = view[1];\n        this._stream.view[this._start + 2] = view[0];\n        this._length += 6;\n        this.start = (this._start + 3);\n        this.prevLength -= 6;\n    }\n    appendUint32(number) {\n        this.beforeAppend(4);\n        const value = new Uint32Array([number]);\n        const view = new Uint8Array(value.buffer);\n        this._stream.view[this._start] = view[3];\n        this._stream.view[this._start + 1] = view[2];\n        this._stream.view[this._start + 2] = view[1];\n        this._stream.view[this._start + 3] = view[0];\n        this._length += 8;\n        this.start = (this._start + 4);\n        this.prevLength -= 8;\n    }\n    appendInt16(number) {\n        this.beforeAppend(2);\n        const value = new Int16Array([number]);\n        const view = new Uint8Array(value.buffer);\n        this._stream.view[this._start] = view[1];\n        this._stream.view[this._start + 1] = view[0];\n        this._length += 4;\n        this.start = (this._start + 2);\n        this.prevLength -= 4;\n    }\n    appendInt32(number) {\n        this.beforeAppend(4);\n        const value = new Int32Array([number]);\n        const view = new Uint8Array(value.buffer);\n        this._stream.view[this._start] = view[3];\n        this._stream.view[this._start + 1] = view[2];\n        this._stream.view[this._start + 2] = view[1];\n        this._stream.view[this._start + 3] = view[0];\n        this._length += 8;\n        this.start = (this._start + 4);\n        this.prevLength -= 8;\n    }\n    getBlock(size, changeLength = true) {\n        if (this._length <= 0) {\n            return new Uint8Array(0);\n        }\n        if (this._length < size) {\n            size = this._length;\n        }\n        let result;\n        if (this.backward) {\n            const view = this._stream.view.subarray(this._length - size, this._length);\n            result = new Uint8Array(size);\n            for (let i = 0; i < size; i++) {\n                result[size - 1 - i] = view[i];\n            }\n        }\n        else {\n            result = this._stream.view.subarray(this._start, this._start + size);\n        }\n        if (changeLength) {\n            this.start += ((this.backward) ? ((-1) * size) : size);\n        }\n        return result;\n    }\n    getUint16(changeLength = true) {\n        const block = this.getBlock(2, changeLength);\n        if (block.length < 2)\n            return 0;\n        return (block[0] << 8) | block[1];\n    }\n    getInt16(changeLength = true) {\n        const num = this.getUint16(changeLength);\n        const negative = 0x8000;\n        if (num & negative) {\n            return -(negative - (num ^ negative));\n        }\n        return num;\n    }\n    getUint24(changeLength = true) {\n        const block = this.getBlock(4, changeLength);\n        if (block.length < 3)\n            return 0;\n        return (block[0] << 16) |\n            (block[1] << 8) |\n            block[2];\n    }\n    getUint32(changeLength = true) {\n        const block = this.getBlock(4, changeLength);\n        if (block.length < 4)\n            return 0;\n        return (block[0] * pow2_24) +\n            (block[1] << 16) +\n            (block[2] << 8) +\n            block[3];\n    }\n    getInt32(changeLength = true) {\n        const num = this.getUint32(changeLength);\n        const negative = 0x80000000;\n        if (num & negative) {\n            return -(negative - (num ^ negative));\n        }\n        return num;\n    }\n    beforeAppend(size) {\n        if ((this._start + size) > this._stream.length) {\n            if (size > this.appendBlock) {\n                this.appendBlock = size + SeqStream.APPEND_BLOCK;\n            }\n            this._stream.realloc(this._stream.length + this.appendBlock);\n        }\n    }\n}\nSeqStream.APPEND_BLOCK = 1000;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYnl0ZXN0cmVhbWpzL2J1aWxkL21qcy9zZXFfc3RyZWFtLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQTJDO0FBQzNDO0FBQ087QUFDUCwrQkFBK0I7QUFDL0IsMkJBQTJCLG9EQUFVO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLG9EQUFVLEdBQUcsdUJBQXVCO0FBQ2xFO0FBQ0E7QUFDQSw4QkFBOEIsb0RBQVUsR0FBRywyQkFBMkI7QUFDdEU7QUFDQTtBQUNBLDhCQUE4QixvREFBVSxHQUFHLDJCQUEyQjtBQUN0RTtBQUNBO0FBQ0EsOEJBQThCLG9EQUFVLEdBQUcsaUNBQWlDO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsb0RBQVU7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCLG1DQUFtQyxvREFBVTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QixtQ0FBbUMsb0RBQVU7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixvREFBVTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixvREFBVTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsVUFBVTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qZXJlbWlhaC9EZXNrdG9wL2MycGEgdG9vbC9ub2RlX21vZHVsZXMvYnl0ZXN0cmVhbWpzL2J1aWxkL21qcy9zZXFfc3RyZWFtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJ5dGVTdHJlYW0gfSBmcm9tIFwiLi9ieXRlX3N0cmVhbVwiO1xuY29uc3QgcG93Ml8yNCA9IDE2Nzc3MjE2O1xuZXhwb3J0IGNsYXNzIFNlcVN0cmVhbSB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHRoaXMuX3N0cmVhbSA9IG5ldyBCeXRlU3RyZWFtKCk7XG4gICAgICAgIHRoaXMuX2xlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuX3N0YXJ0ID0gMDtcbiAgICAgICAgdGhpcy5iYWNrd2FyZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmFwcGVuZEJsb2NrID0gMDtcbiAgICAgICAgdGhpcy5wcmV2TGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5wcmV2U3RhcnQgPSAwO1xuICAgICAgICBpZiAoXCJ2aWV3XCIgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5zdHJlYW0gPSBuZXcgQnl0ZVN0cmVhbSh7IHZpZXc6IHBhcmFtZXRlcnMudmlldyB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChcImJ1ZmZlclwiIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc3RyZWFtID0gbmV3IEJ5dGVTdHJlYW0oeyBidWZmZXI6IHBhcmFtZXRlcnMuYnVmZmVyIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKFwic3RyaW5nXCIgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5zdHJlYW0gPSBuZXcgQnl0ZVN0cmVhbSh7IHN0cmluZzogcGFyYW1ldGVycy5zdHJpbmcgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoXCJoZXhzdHJpbmdcIiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnN0cmVhbSA9IG5ldyBCeXRlU3RyZWFtKHsgaGV4c3RyaW5nOiBwYXJhbWV0ZXJzLmhleHN0cmluZyB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChcInN0cmVhbVwiIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc3RyZWFtID0gcGFyYW1ldGVycy5zdHJlYW0uc2xpY2UoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3RyZWFtID0gbmV3IEJ5dGVTdHJlYW0oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJiYWNrd2FyZFwiIGluIHBhcmFtZXRlcnMgJiYgcGFyYW1ldGVycy5iYWNrd2FyZCkge1xuICAgICAgICAgICAgdGhpcy5iYWNrd2FyZCA9IHBhcmFtZXRlcnMuYmFja3dhcmQ7XG4gICAgICAgICAgICB0aGlzLl9zdGFydCA9IHRoaXMuc3RyZWFtLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJsZW5ndGhcIiBpbiBwYXJhbWV0ZXJzICYmIHBhcmFtZXRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5fbGVuZ3RoID0gcGFyYW1ldGVycy5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwic3RhcnRcIiBpbiBwYXJhbWV0ZXJzICYmIHBhcmFtZXRlcnMuc3RhcnQgJiYgcGFyYW1ldGVycy5zdGFydCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXJ0ID0gcGFyYW1ldGVycy5zdGFydDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJhcHBlbmRCbG9ja1wiIGluIHBhcmFtZXRlcnMgJiYgcGFyYW1ldGVycy5hcHBlbmRCbG9jayAmJiBwYXJhbWV0ZXJzLmFwcGVuZEJsb2NrID4gMCkge1xuICAgICAgICAgICAgdGhpcy5hcHBlbmRCbG9jayA9IHBhcmFtZXRlcnMuYXBwZW5kQmxvY2s7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0IHN0cmVhbSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zdHJlYW0gPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5wcmV2TGVuZ3RoID0gdGhpcy5fbGVuZ3RoO1xuICAgICAgICB0aGlzLl9sZW5ndGggPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgIHRoaXMucHJldlN0YXJ0ID0gdGhpcy5fc3RhcnQ7XG4gICAgICAgIHRoaXMuX3N0YXJ0ID0gMDtcbiAgICB9XG4gICAgZ2V0IHN0cmVhbSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0cmVhbTtcbiAgICB9XG4gICAgc2V0IGxlbmd0aCh2YWx1ZSkge1xuICAgICAgICB0aGlzLnByZXZMZW5ndGggPSB0aGlzLl9sZW5ndGg7XG4gICAgICAgIHRoaXMuX2xlbmd0aCA9IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgbGVuZ3RoKCkge1xuICAgICAgICBpZiAodGhpcy5hcHBlbmRCbG9jaykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2xlbmd0aDtcbiAgICB9XG4gICAgc2V0IHN0YXJ0KHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA+IHRoaXMuc3RyZWFtLmxlbmd0aClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5wcmV2U3RhcnQgPSB0aGlzLl9zdGFydDtcbiAgICAgICAgdGhpcy5wcmV2TGVuZ3RoID0gdGhpcy5fbGVuZ3RoO1xuICAgICAgICB0aGlzLl9sZW5ndGggLT0gKHRoaXMuYmFja3dhcmQpID8gKHRoaXMuX3N0YXJ0IC0gdmFsdWUpIDogKHZhbHVlIC0gdGhpcy5fc3RhcnQpO1xuICAgICAgICB0aGlzLl9zdGFydCA9IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgc3RhcnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdGFydDtcbiAgICB9XG4gICAgZ2V0IGJ1ZmZlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0cmVhbS5idWZmZXIuc2xpY2UoMCwgdGhpcy5fbGVuZ3RoKTtcbiAgICB9XG4gICAgcmVzZXRQb3NpdGlvbigpIHtcbiAgICAgICAgdGhpcy5fc3RhcnQgPSB0aGlzLnByZXZTdGFydDtcbiAgICAgICAgdGhpcy5fbGVuZ3RoID0gdGhpcy5wcmV2TGVuZ3RoO1xuICAgIH1cbiAgICBmaW5kUGF0dGVybihwYXR0ZXJuLCBnYXAgPSBudWxsKSB7XG4gICAgICAgIGlmICgoZ2FwID09IG51bGwpIHx8IChnYXAgPiB0aGlzLmxlbmd0aCkpIHtcbiAgICAgICAgICAgIGdhcCA9IHRoaXMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuc3RyZWFtLmZpbmRQYXR0ZXJuKHBhdHRlcm4sIHRoaXMuc3RhcnQsIHRoaXMubGVuZ3RoLCB0aGlzLmJhY2t3YXJkKTtcbiAgICAgICAgaWYgKHJlc3VsdCA9PSAoLTEpKVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgaWYgKHRoaXMuYmFja3dhcmQpIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPCAodGhpcy5zdGFydCAtIHBhdHRlcm4ubGVuZ3RoIC0gZ2FwKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoLTEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHJlc3VsdCA+ICh0aGlzLnN0YXJ0ICsgcGF0dGVybi5sZW5ndGggKyBnYXApKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICgtMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGFydCA9IHJlc3VsdDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgZmluZEZpcnN0SW4ocGF0dGVybnMsIGdhcCA9IG51bGwpIHtcbiAgICAgICAgaWYgKChnYXAgPT0gbnVsbCkgfHwgKGdhcCA+IHRoaXMubGVuZ3RoKSkge1xuICAgICAgICAgICAgZ2FwID0gdGhpcy5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5zdHJlYW0uZmluZEZpcnN0SW4ocGF0dGVybnMsIHRoaXMuc3RhcnQsIHRoaXMubGVuZ3RoLCB0aGlzLmJhY2t3YXJkKTtcbiAgICAgICAgaWYgKHJlc3VsdC5pZCA9PSAoLTEpKVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgaWYgKHRoaXMuYmFja3dhcmQpIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQucG9zaXRpb24gPCAodGhpcy5zdGFydCAtIHBhdHRlcm5zW3Jlc3VsdC5pZF0ubGVuZ3RoIC0gZ2FwKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiAoLTEpLFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogKHRoaXMuYmFja3dhcmQpID8gMCA6ICh0aGlzLnN0YXJ0ICsgdGhpcy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQucG9zaXRpb24gPiAodGhpcy5zdGFydCArIHBhdHRlcm5zW3Jlc3VsdC5pZF0ubGVuZ3RoICsgZ2FwKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiAoLTEpLFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogKHRoaXMuYmFja3dhcmQpID8gMCA6ICh0aGlzLnN0YXJ0ICsgdGhpcy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN0YXJ0ID0gcmVzdWx0LnBvc2l0aW9uO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBmaW5kQWxsSW4ocGF0dGVybnMpIHtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSAodGhpcy5iYWNrd2FyZCkgPyAodGhpcy5zdGFydCAtIHRoaXMubGVuZ3RoKSA6IHRoaXMuc3RhcnQ7XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmVhbS5maW5kQWxsSW4ocGF0dGVybnMsIHN0YXJ0LCB0aGlzLmxlbmd0aCk7XG4gICAgfVxuICAgIGZpbmRGaXJzdE5vdEluKHBhdHRlcm5zLCBnYXAgPSBudWxsKSB7XG4gICAgICAgIGlmICgoZ2FwID09IG51bGwpIHx8IChnYXAgPiB0aGlzLl9sZW5ndGgpKSB7XG4gICAgICAgICAgICBnYXAgPSB0aGlzLl9sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5fc3RyZWFtLmZpbmRGaXJzdE5vdEluKHBhdHRlcm5zLCB0aGlzLl9zdGFydCwgdGhpcy5fbGVuZ3RoLCB0aGlzLmJhY2t3YXJkKTtcbiAgICAgICAgaWYgKChyZXN1bHQubGVmdC5pZCA9PSAoLTEpKSAmJiAocmVzdWx0LnJpZ2h0LmlkID09ICgtMSkpKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmJhY2t3YXJkKSB7XG4gICAgICAgICAgICBpZiAocmVzdWx0LnJpZ2h0LmlkICE9ICgtMSkpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnJpZ2h0LnBvc2l0aW9uIDwgKHRoaXMuX3N0YXJ0IC0gcGF0dGVybnNbcmVzdWx0LnJpZ2h0LmlkXS5sZW5ndGggLSBnYXApKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICgtMSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHRoaXMuX3N0YXJ0XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogKC0xKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogMFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuZXcgQnl0ZVN0cmVhbSgpXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5sZWZ0LmlkICE9ICgtMSkpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmxlZnQucG9zaXRpb24gPiAodGhpcy5fc3RhcnQgKyBwYXR0ZXJuc1tyZXN1bHQubGVmdC5pZF0ubGVuZ3RoICsgZ2FwKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAoLTEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0aGlzLl9zdGFydFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICgtMSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IDBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbmV3IEJ5dGVTdHJlYW0oKVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5iYWNrd2FyZCkge1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5sZWZ0LmlkID09ICgtMSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQgPSByZXN1bHQubGVmdC5wb3NpdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQucmlnaHQuaWQgPT0gKC0xKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQgPSAodGhpcy5fc3RhcnQgKyB0aGlzLl9sZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydCA9IHJlc3VsdC5yaWdodC5wb3NpdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBmaW5kQWxsTm90SW4ocGF0dGVybnMpIHtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSAodGhpcy5iYWNrd2FyZCkgPyAodGhpcy5fc3RhcnQgLSB0aGlzLl9sZW5ndGgpIDogdGhpcy5fc3RhcnQ7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdHJlYW0uZmluZEFsbE5vdEluKHBhdHRlcm5zLCBzdGFydCwgdGhpcy5fbGVuZ3RoKTtcbiAgICB9XG4gICAgZmluZEZpcnN0U2VxdWVuY2UocGF0dGVybnMsIGxlbmd0aCA9IG51bGwsIGdhcCA9IG51bGwpIHtcbiAgICAgICAgaWYgKChsZW5ndGggPT0gbnVsbCkgfHwgKGxlbmd0aCA+IHRoaXMuX2xlbmd0aCkpIHtcbiAgICAgICAgICAgIGxlbmd0aCA9IHRoaXMuX2xlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKGdhcCA9PSBudWxsKSB8fCAoZ2FwID4gbGVuZ3RoKSkge1xuICAgICAgICAgICAgZ2FwID0gbGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuX3N0cmVhbS5maW5kRmlyc3RTZXF1ZW5jZShwYXR0ZXJucywgdGhpcy5fc3RhcnQsIGxlbmd0aCwgdGhpcy5iYWNrd2FyZCk7XG4gICAgICAgIGlmIChyZXN1bHQudmFsdWUubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYmFja3dhcmQpIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQucG9zaXRpb24gPCAodGhpcy5fc3RhcnQgLSByZXN1bHQudmFsdWUubGVuZ3RoIC0gZ2FwKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAoLTEpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbmV3IEJ5dGVTdHJlYW0oKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAocmVzdWx0LnBvc2l0aW9uID4gKHRoaXMuX3N0YXJ0ICsgcmVzdWx0LnZhbHVlLmxlbmd0aCArIGdhcCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogKC0xKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG5ldyBCeXRlU3RyZWFtKClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhcnQgPSByZXN1bHQucG9zaXRpb247XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGZpbmRBbGxTZXF1ZW5jZXMocGF0dGVybnMpIHtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSAodGhpcy5iYWNrd2FyZCkgPyAodGhpcy5zdGFydCAtIHRoaXMubGVuZ3RoKSA6IHRoaXMuc3RhcnQ7XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmVhbS5maW5kQWxsU2VxdWVuY2VzKHBhdHRlcm5zLCBzdGFydCwgdGhpcy5sZW5ndGgpO1xuICAgIH1cbiAgICBmaW5kUGFpcmVkUGF0dGVybnMobGVmdFBhdHRlcm4sIHJpZ2h0UGF0dGVybiwgZ2FwID0gbnVsbCkge1xuICAgICAgICBpZiAoKGdhcCA9PSBudWxsKSB8fCAoZ2FwID4gdGhpcy5sZW5ndGgpKSB7XG4gICAgICAgICAgICBnYXAgPSB0aGlzLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdGFydCA9ICh0aGlzLmJhY2t3YXJkKSA/ICh0aGlzLnN0YXJ0IC0gdGhpcy5sZW5ndGgpIDogdGhpcy5zdGFydDtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5zdHJlYW0uZmluZFBhaXJlZFBhdHRlcm5zKGxlZnRQYXR0ZXJuLCByaWdodFBhdHRlcm4sIHN0YXJ0LCB0aGlzLmxlbmd0aCk7XG4gICAgICAgIGlmIChyZXN1bHQubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5iYWNrd2FyZCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbMF0ucmlnaHQgPCAodGhpcy5zdGFydCAtIHJpZ2h0UGF0dGVybi5sZW5ndGggLSBnYXApKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0WzBdLmxlZnQgPiAodGhpcy5zdGFydCArIGxlZnRQYXR0ZXJuLmxlbmd0aCArIGdhcCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBmaW5kUGFpcmVkQXJyYXlzKGxlZnRQYXR0ZXJucywgcmlnaHRQYXR0ZXJucywgZ2FwID0gbnVsbCkge1xuICAgICAgICBpZiAoKGdhcCA9PSBudWxsKSB8fCAoZ2FwID4gdGhpcy5sZW5ndGgpKSB7XG4gICAgICAgICAgICBnYXAgPSB0aGlzLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdGFydCA9ICh0aGlzLmJhY2t3YXJkKSA/ICh0aGlzLnN0YXJ0IC0gdGhpcy5sZW5ndGgpIDogdGhpcy5zdGFydDtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5zdHJlYW0uZmluZFBhaXJlZEFycmF5cyhsZWZ0UGF0dGVybnMsIHJpZ2h0UGF0dGVybnMsIHN0YXJ0LCB0aGlzLmxlbmd0aCk7XG4gICAgICAgIGlmIChyZXN1bHQubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5iYWNrd2FyZCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbMF0ucmlnaHQucG9zaXRpb24gPCAodGhpcy5zdGFydCAtIHJpZ2h0UGF0dGVybnNbcmVzdWx0WzBdLnJpZ2h0LmlkXS5sZW5ndGggLSBnYXApKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0WzBdLmxlZnQucG9zaXRpb24gPiAodGhpcy5zdGFydCArIGxlZnRQYXR0ZXJuc1tyZXN1bHRbMF0ubGVmdC5pZF0ubGVuZ3RoICsgZ2FwKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHJlcGxhY2VQYXR0ZXJuKHNlYXJjaFBhdHRlcm4sIHJlcGxhY2VQYXR0ZXJuKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gKHRoaXMuYmFja3dhcmQpID8gKHRoaXMuc3RhcnQgLSB0aGlzLmxlbmd0aCkgOiB0aGlzLnN0YXJ0O1xuICAgICAgICByZXR1cm4gdGhpcy5zdHJlYW0ucmVwbGFjZVBhdHRlcm4oc2VhcmNoUGF0dGVybiwgcmVwbGFjZVBhdHRlcm4sIHN0YXJ0LCB0aGlzLmxlbmd0aCk7XG4gICAgfVxuICAgIHNraXBQYXR0ZXJucyhwYXR0ZXJucykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnN0cmVhbS5za2lwUGF0dGVybnMocGF0dGVybnMsIHRoaXMuc3RhcnQsIHRoaXMubGVuZ3RoLCB0aGlzLmJhY2t3YXJkKTtcbiAgICAgICAgdGhpcy5zdGFydCA9IHJlc3VsdDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgc2tpcE5vdFBhdHRlcm5zKHBhdHRlcm5zKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuc3RyZWFtLnNraXBOb3RQYXR0ZXJucyhwYXR0ZXJucywgdGhpcy5zdGFydCwgdGhpcy5sZW5ndGgsIHRoaXMuYmFja3dhcmQpO1xuICAgICAgICBpZiAocmVzdWx0ID09ICgtMSkpXG4gICAgICAgICAgICByZXR1cm4gKC0xKTtcbiAgICAgICAgdGhpcy5zdGFydCA9IHJlc3VsdDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgYXBwZW5kKHN0cmVhbSkge1xuICAgICAgICB0aGlzLmJlZm9yZUFwcGVuZChzdHJlYW0ubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5fc3RyZWFtLnZpZXcuc2V0KHN0cmVhbS52aWV3LCB0aGlzLl9zdGFydCk7XG4gICAgICAgIHRoaXMuX2xlbmd0aCArPSAoc3RyZWFtLmxlbmd0aCAqIDIpO1xuICAgICAgICB0aGlzLnN0YXJ0ID0gKHRoaXMuX3N0YXJ0ICsgc3RyZWFtLmxlbmd0aCk7XG4gICAgICAgIHRoaXMucHJldkxlbmd0aCAtPSAoc3RyZWFtLmxlbmd0aCAqIDIpO1xuICAgIH1cbiAgICBhcHBlbmRWaWV3KHZpZXcpIHtcbiAgICAgICAgdGhpcy5iZWZvcmVBcHBlbmQodmlldy5sZW5ndGgpO1xuICAgICAgICB0aGlzLl9zdHJlYW0udmlldy5zZXQodmlldywgdGhpcy5fc3RhcnQpO1xuICAgICAgICB0aGlzLl9sZW5ndGggKz0gKHZpZXcubGVuZ3RoICogMik7XG4gICAgICAgIHRoaXMuc3RhcnQgPSAodGhpcy5fc3RhcnQgKyB2aWV3Lmxlbmd0aCk7XG4gICAgICAgIHRoaXMucHJldkxlbmd0aCAtPSAodmlldy5sZW5ndGggKiAyKTtcbiAgICB9XG4gICAgYXBwZW5kQ2hhcihjaGFyKSB7XG4gICAgICAgIHRoaXMuYmVmb3JlQXBwZW5kKDEpO1xuICAgICAgICB0aGlzLl9zdHJlYW0udmlld1t0aGlzLl9zdGFydF0gPSBjaGFyO1xuICAgICAgICB0aGlzLl9sZW5ndGggKz0gMjtcbiAgICAgICAgdGhpcy5zdGFydCA9ICh0aGlzLl9zdGFydCArIDEpO1xuICAgICAgICB0aGlzLnByZXZMZW5ndGggLT0gMjtcbiAgICB9XG4gICAgYXBwZW5kVWludDE2KG51bWJlcikge1xuICAgICAgICB0aGlzLmJlZm9yZUFwcGVuZCgyKTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBuZXcgVWludDE2QXJyYXkoW251bWJlcl0pO1xuICAgICAgICBjb25zdCB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkodmFsdWUuYnVmZmVyKTtcbiAgICAgICAgdGhpcy5zdHJlYW0udmlld1t0aGlzLl9zdGFydF0gPSB2aWV3WzFdO1xuICAgICAgICB0aGlzLl9zdHJlYW0udmlld1t0aGlzLl9zdGFydCArIDFdID0gdmlld1swXTtcbiAgICAgICAgdGhpcy5fbGVuZ3RoICs9IDQ7XG4gICAgICAgIHRoaXMuc3RhcnQgPSB0aGlzLl9zdGFydCArIDI7XG4gICAgICAgIHRoaXMucHJldkxlbmd0aCAtPSA0O1xuICAgIH1cbiAgICBhcHBlbmRVaW50MjQobnVtYmVyKSB7XG4gICAgICAgIHRoaXMuYmVmb3JlQXBwZW5kKDMpO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyBVaW50MzJBcnJheShbbnVtYmVyXSk7XG4gICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheSh2YWx1ZS5idWZmZXIpO1xuICAgICAgICB0aGlzLl9zdHJlYW0udmlld1t0aGlzLl9zdGFydF0gPSB2aWV3WzJdO1xuICAgICAgICB0aGlzLl9zdHJlYW0udmlld1t0aGlzLl9zdGFydCArIDFdID0gdmlld1sxXTtcbiAgICAgICAgdGhpcy5fc3RyZWFtLnZpZXdbdGhpcy5fc3RhcnQgKyAyXSA9IHZpZXdbMF07XG4gICAgICAgIHRoaXMuX2xlbmd0aCArPSA2O1xuICAgICAgICB0aGlzLnN0YXJ0ID0gKHRoaXMuX3N0YXJ0ICsgMyk7XG4gICAgICAgIHRoaXMucHJldkxlbmd0aCAtPSA2O1xuICAgIH1cbiAgICBhcHBlbmRVaW50MzIobnVtYmVyKSB7XG4gICAgICAgIHRoaXMuYmVmb3JlQXBwZW5kKDQpO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyBVaW50MzJBcnJheShbbnVtYmVyXSk7XG4gICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheSh2YWx1ZS5idWZmZXIpO1xuICAgICAgICB0aGlzLl9zdHJlYW0udmlld1t0aGlzLl9zdGFydF0gPSB2aWV3WzNdO1xuICAgICAgICB0aGlzLl9zdHJlYW0udmlld1t0aGlzLl9zdGFydCArIDFdID0gdmlld1syXTtcbiAgICAgICAgdGhpcy5fc3RyZWFtLnZpZXdbdGhpcy5fc3RhcnQgKyAyXSA9IHZpZXdbMV07XG4gICAgICAgIHRoaXMuX3N0cmVhbS52aWV3W3RoaXMuX3N0YXJ0ICsgM10gPSB2aWV3WzBdO1xuICAgICAgICB0aGlzLl9sZW5ndGggKz0gODtcbiAgICAgICAgdGhpcy5zdGFydCA9ICh0aGlzLl9zdGFydCArIDQpO1xuICAgICAgICB0aGlzLnByZXZMZW5ndGggLT0gODtcbiAgICB9XG4gICAgYXBwZW5kSW50MTYobnVtYmVyKSB7XG4gICAgICAgIHRoaXMuYmVmb3JlQXBwZW5kKDIpO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyBJbnQxNkFycmF5KFtudW1iZXJdKTtcbiAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KHZhbHVlLmJ1ZmZlcik7XG4gICAgICAgIHRoaXMuX3N0cmVhbS52aWV3W3RoaXMuX3N0YXJ0XSA9IHZpZXdbMV07XG4gICAgICAgIHRoaXMuX3N0cmVhbS52aWV3W3RoaXMuX3N0YXJ0ICsgMV0gPSB2aWV3WzBdO1xuICAgICAgICB0aGlzLl9sZW5ndGggKz0gNDtcbiAgICAgICAgdGhpcy5zdGFydCA9ICh0aGlzLl9zdGFydCArIDIpO1xuICAgICAgICB0aGlzLnByZXZMZW5ndGggLT0gNDtcbiAgICB9XG4gICAgYXBwZW5kSW50MzIobnVtYmVyKSB7XG4gICAgICAgIHRoaXMuYmVmb3JlQXBwZW5kKDQpO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyBJbnQzMkFycmF5KFtudW1iZXJdKTtcbiAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KHZhbHVlLmJ1ZmZlcik7XG4gICAgICAgIHRoaXMuX3N0cmVhbS52aWV3W3RoaXMuX3N0YXJ0XSA9IHZpZXdbM107XG4gICAgICAgIHRoaXMuX3N0cmVhbS52aWV3W3RoaXMuX3N0YXJ0ICsgMV0gPSB2aWV3WzJdO1xuICAgICAgICB0aGlzLl9zdHJlYW0udmlld1t0aGlzLl9zdGFydCArIDJdID0gdmlld1sxXTtcbiAgICAgICAgdGhpcy5fc3RyZWFtLnZpZXdbdGhpcy5fc3RhcnQgKyAzXSA9IHZpZXdbMF07XG4gICAgICAgIHRoaXMuX2xlbmd0aCArPSA4O1xuICAgICAgICB0aGlzLnN0YXJ0ID0gKHRoaXMuX3N0YXJ0ICsgNCk7XG4gICAgICAgIHRoaXMucHJldkxlbmd0aCAtPSA4O1xuICAgIH1cbiAgICBnZXRCbG9jayhzaXplLCBjaGFuZ2VMZW5ndGggPSB0cnVlKSB7XG4gICAgICAgIGlmICh0aGlzLl9sZW5ndGggPD0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KDApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9sZW5ndGggPCBzaXplKSB7XG4gICAgICAgICAgICBzaXplID0gdGhpcy5fbGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXN1bHQ7XG4gICAgICAgIGlmICh0aGlzLmJhY2t3YXJkKSB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5fc3RyZWFtLnZpZXcuc3ViYXJyYXkodGhpcy5fbGVuZ3RoIC0gc2l6ZSwgdGhpcy5fbGVuZ3RoKTtcbiAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KHNpemUpO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbc2l6ZSAtIDEgLSBpXSA9IHZpZXdbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLl9zdHJlYW0udmlldy5zdWJhcnJheSh0aGlzLl9zdGFydCwgdGhpcy5fc3RhcnQgKyBzaXplKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hhbmdlTGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ICs9ICgodGhpcy5iYWNrd2FyZCkgPyAoKC0xKSAqIHNpemUpIDogc2l6ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgZ2V0VWludDE2KGNoYW5nZUxlbmd0aCA9IHRydWUpIHtcbiAgICAgICAgY29uc3QgYmxvY2sgPSB0aGlzLmdldEJsb2NrKDIsIGNoYW5nZUxlbmd0aCk7XG4gICAgICAgIGlmIChibG9jay5sZW5ndGggPCAyKVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIHJldHVybiAoYmxvY2tbMF0gPDwgOCkgfCBibG9ja1sxXTtcbiAgICB9XG4gICAgZ2V0SW50MTYoY2hhbmdlTGVuZ3RoID0gdHJ1ZSkge1xuICAgICAgICBjb25zdCBudW0gPSB0aGlzLmdldFVpbnQxNihjaGFuZ2VMZW5ndGgpO1xuICAgICAgICBjb25zdCBuZWdhdGl2ZSA9IDB4ODAwMDtcbiAgICAgICAgaWYgKG51bSAmIG5lZ2F0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm4gLShuZWdhdGl2ZSAtIChudW0gXiBuZWdhdGl2ZSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudW07XG4gICAgfVxuICAgIGdldFVpbnQyNChjaGFuZ2VMZW5ndGggPSB0cnVlKSB7XG4gICAgICAgIGNvbnN0IGJsb2NrID0gdGhpcy5nZXRCbG9jayg0LCBjaGFuZ2VMZW5ndGgpO1xuICAgICAgICBpZiAoYmxvY2subGVuZ3RoIDwgMylcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICByZXR1cm4gKGJsb2NrWzBdIDw8IDE2KSB8XG4gICAgICAgICAgICAoYmxvY2tbMV0gPDwgOCkgfFxuICAgICAgICAgICAgYmxvY2tbMl07XG4gICAgfVxuICAgIGdldFVpbnQzMihjaGFuZ2VMZW5ndGggPSB0cnVlKSB7XG4gICAgICAgIGNvbnN0IGJsb2NrID0gdGhpcy5nZXRCbG9jayg0LCBjaGFuZ2VMZW5ndGgpO1xuICAgICAgICBpZiAoYmxvY2subGVuZ3RoIDwgNClcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICByZXR1cm4gKGJsb2NrWzBdICogcG93Ml8yNCkgK1xuICAgICAgICAgICAgKGJsb2NrWzFdIDw8IDE2KSArXG4gICAgICAgICAgICAoYmxvY2tbMl0gPDwgOCkgK1xuICAgICAgICAgICAgYmxvY2tbM107XG4gICAgfVxuICAgIGdldEludDMyKGNoYW5nZUxlbmd0aCA9IHRydWUpIHtcbiAgICAgICAgY29uc3QgbnVtID0gdGhpcy5nZXRVaW50MzIoY2hhbmdlTGVuZ3RoKTtcbiAgICAgICAgY29uc3QgbmVnYXRpdmUgPSAweDgwMDAwMDAwO1xuICAgICAgICBpZiAobnVtICYgbmVnYXRpdmUpIHtcbiAgICAgICAgICAgIHJldHVybiAtKG5lZ2F0aXZlIC0gKG51bSBeIG5lZ2F0aXZlKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bTtcbiAgICB9XG4gICAgYmVmb3JlQXBwZW5kKHNpemUpIHtcbiAgICAgICAgaWYgKCh0aGlzLl9zdGFydCArIHNpemUpID4gdGhpcy5fc3RyZWFtLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKHNpemUgPiB0aGlzLmFwcGVuZEJsb2NrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmRCbG9jayA9IHNpemUgKyBTZXFTdHJlYW0uQVBQRU5EX0JMT0NLO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc3RyZWFtLnJlYWxsb2ModGhpcy5fc3RyZWFtLmxlbmd0aCArIHRoaXMuYXBwZW5kQmxvY2spO1xuICAgICAgICB9XG4gICAgfVxufVxuU2VxU3RyZWFtLkFQUEVORF9CTE9DSyA9IDEwMDA7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/bytestreamjs/build/mjs/seq_stream.js\n");

/***/ })

};
;