"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/pkijs";
exports.ids = ["vendor-chunks/pkijs"];
exports.modules = {

/***/ "(ssr)/./node_modules/pkijs/build/index.es.js":
/*!**********************************************!*\
  !*** ./node_modules/pkijs/build/index.es.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AbstractCryptoEngine: () => (/* binding */ AbstractCryptoEngine),\n/* harmony export */   AccessDescription: () => (/* binding */ AccessDescription),\n/* harmony export */   Accuracy: () => (/* binding */ Accuracy),\n/* harmony export */   AlgorithmIdentifier: () => (/* binding */ AlgorithmIdentifier),\n/* harmony export */   AltName: () => (/* binding */ AltName),\n/* harmony export */   ArgumentError: () => (/* binding */ ArgumentError),\n/* harmony export */   AsnError: () => (/* binding */ AsnError),\n/* harmony export */   AttCertValidityPeriod: () => (/* binding */ AttCertValidityPeriod),\n/* harmony export */   Attribute: () => (/* binding */ Attribute),\n/* harmony export */   AttributeCertificateInfoV1: () => (/* binding */ AttributeCertificateInfoV1),\n/* harmony export */   AttributeCertificateInfoV2: () => (/* binding */ AttributeCertificateInfoV2),\n/* harmony export */   AttributeCertificateV1: () => (/* binding */ AttributeCertificateV1),\n/* harmony export */   AttributeCertificateV2: () => (/* binding */ AttributeCertificateV2),\n/* harmony export */   AttributeTypeAndValue: () => (/* binding */ AttributeTypeAndValue),\n/* harmony export */   AuthenticatedSafe: () => (/* binding */ AuthenticatedSafe),\n/* harmony export */   AuthorityKeyIdentifier: () => (/* binding */ AuthorityKeyIdentifier),\n/* harmony export */   BasicConstraints: () => (/* binding */ BasicConstraints),\n/* harmony export */   BasicOCSPResponse: () => (/* binding */ BasicOCSPResponse),\n/* harmony export */   CAVersion: () => (/* binding */ CAVersion),\n/* harmony export */   CRLBag: () => (/* binding */ CRLBag),\n/* harmony export */   CRLDistributionPoints: () => (/* binding */ CRLDistributionPoints),\n/* harmony export */   CertBag: () => (/* binding */ CertBag),\n/* harmony export */   CertID: () => (/* binding */ CertID),\n/* harmony export */   Certificate: () => (/* binding */ Certificate),\n/* harmony export */   CertificateChainValidationEngine: () => (/* binding */ CertificateChainValidationEngine),\n/* harmony export */   CertificatePolicies: () => (/* binding */ CertificatePolicies),\n/* harmony export */   CertificateRevocationList: () => (/* binding */ CertificateRevocationList),\n/* harmony export */   CertificateSet: () => (/* binding */ CertificateSet),\n/* harmony export */   CertificateTemplate: () => (/* binding */ CertificateTemplate),\n/* harmony export */   CertificationRequest: () => (/* binding */ CertificationRequest),\n/* harmony export */   ChainValidationCode: () => (/* binding */ ChainValidationCode),\n/* harmony export */   ChainValidationError: () => (/* binding */ ChainValidationError),\n/* harmony export */   ContentInfo: () => (/* binding */ ContentInfo),\n/* harmony export */   CryptoEngine: () => (/* binding */ CryptoEngine),\n/* harmony export */   DigestInfo: () => (/* binding */ DigestInfo),\n/* harmony export */   DistributionPoint: () => (/* binding */ DistributionPoint),\n/* harmony export */   ECCCMSSharedInfo: () => (/* binding */ ECCCMSSharedInfo),\n/* harmony export */   ECNamedCurves: () => (/* binding */ ECNamedCurves),\n/* harmony export */   ECPrivateKey: () => (/* binding */ ECPrivateKey),\n/* harmony export */   ECPublicKey: () => (/* binding */ ECPublicKey),\n/* harmony export */   EncapsulatedContentInfo: () => (/* binding */ EncapsulatedContentInfo),\n/* harmony export */   EncryptedContentInfo: () => (/* binding */ EncryptedContentInfo),\n/* harmony export */   EncryptedData: () => (/* binding */ EncryptedData),\n/* harmony export */   EnvelopedData: () => (/* binding */ EnvelopedData),\n/* harmony export */   ExtKeyUsage: () => (/* binding */ ExtKeyUsage),\n/* harmony export */   Extension: () => (/* binding */ Extension),\n/* harmony export */   ExtensionValueFactory: () => (/* binding */ ExtensionValueFactory),\n/* harmony export */   Extensions: () => (/* binding */ Extensions),\n/* harmony export */   GeneralName: () => (/* binding */ GeneralName),\n/* harmony export */   GeneralNames: () => (/* binding */ GeneralNames),\n/* harmony export */   GeneralSubtree: () => (/* binding */ GeneralSubtree),\n/* harmony export */   HASHED_MESSAGE: () => (/* binding */ HASHED_MESSAGE),\n/* harmony export */   HASH_ALGORITHM: () => (/* binding */ HASH_ALGORITHM),\n/* harmony export */   Holder: () => (/* binding */ Holder),\n/* harmony export */   InfoAccess: () => (/* binding */ InfoAccess),\n/* harmony export */   IssuerAndSerialNumber: () => (/* binding */ IssuerAndSerialNumber),\n/* harmony export */   IssuerSerial: () => (/* binding */ IssuerSerial),\n/* harmony export */   IssuingDistributionPoint: () => (/* binding */ IssuingDistributionPoint),\n/* harmony export */   KEKIdentifier: () => (/* binding */ KEKIdentifier),\n/* harmony export */   KEKRecipientInfo: () => (/* binding */ KEKRecipientInfo),\n/* harmony export */   KeyAgreeRecipientIdentifier: () => (/* binding */ KeyAgreeRecipientIdentifier),\n/* harmony export */   KeyAgreeRecipientInfo: () => (/* binding */ KeyAgreeRecipientInfo),\n/* harmony export */   KeyBag: () => (/* binding */ KeyBag),\n/* harmony export */   KeyTransRecipientInfo: () => (/* binding */ KeyTransRecipientInfo),\n/* harmony export */   MICROS: () => (/* binding */ MICROS),\n/* harmony export */   MILLIS: () => (/* binding */ MILLIS),\n/* harmony export */   MacData: () => (/* binding */ MacData),\n/* harmony export */   MessageImprint: () => (/* binding */ MessageImprint),\n/* harmony export */   NameConstraints: () => (/* binding */ NameConstraints),\n/* harmony export */   OCSPRequest: () => (/* binding */ OCSPRequest),\n/* harmony export */   OCSPResponse: () => (/* binding */ OCSPResponse),\n/* harmony export */   ObjectDigestInfo: () => (/* binding */ ObjectDigestInfo),\n/* harmony export */   OriginatorIdentifierOrKey: () => (/* binding */ OriginatorIdentifierOrKey),\n/* harmony export */   OriginatorInfo: () => (/* binding */ OriginatorInfo),\n/* harmony export */   OriginatorPublicKey: () => (/* binding */ OriginatorPublicKey),\n/* harmony export */   OtherCertificateFormat: () => (/* binding */ OtherCertificateFormat),\n/* harmony export */   OtherKeyAttribute: () => (/* binding */ OtherKeyAttribute),\n/* harmony export */   OtherPrimeInfo: () => (/* binding */ OtherPrimeInfo),\n/* harmony export */   OtherRecipientInfo: () => (/* binding */ OtherRecipientInfo),\n/* harmony export */   OtherRevocationInfoFormat: () => (/* binding */ OtherRevocationInfoFormat),\n/* harmony export */   PBES2Params: () => (/* binding */ PBES2Params),\n/* harmony export */   PBKDF2Params: () => (/* binding */ PBKDF2Params),\n/* harmony export */   PFX: () => (/* binding */ PFX),\n/* harmony export */   PKCS8ShroudedKeyBag: () => (/* binding */ PKCS8ShroudedKeyBag),\n/* harmony export */   PKIStatus: () => (/* binding */ PKIStatus),\n/* harmony export */   PKIStatusInfo: () => (/* binding */ PKIStatusInfo),\n/* harmony export */   POLICY_IDENTIFIER: () => (/* binding */ POLICY_IDENTIFIER),\n/* harmony export */   POLICY_QUALIFIERS: () => (/* binding */ POLICY_QUALIFIERS),\n/* harmony export */   ParameterError: () => (/* binding */ ParameterError),\n/* harmony export */   PasswordRecipientinfo: () => (/* binding */ PasswordRecipientinfo),\n/* harmony export */   PkiObject: () => (/* binding */ PkiObject),\n/* harmony export */   PolicyConstraints: () => (/* binding */ PolicyConstraints),\n/* harmony export */   PolicyInformation: () => (/* binding */ PolicyInformation),\n/* harmony export */   PolicyMapping: () => (/* binding */ PolicyMapping),\n/* harmony export */   PolicyMappings: () => (/* binding */ PolicyMappings),\n/* harmony export */   PolicyQualifierInfo: () => (/* binding */ PolicyQualifierInfo),\n/* harmony export */   PrivateKeyInfo: () => (/* binding */ PrivateKeyInfo),\n/* harmony export */   PrivateKeyUsagePeriod: () => (/* binding */ PrivateKeyUsagePeriod),\n/* harmony export */   PublicKeyInfo: () => (/* binding */ PublicKeyInfo),\n/* harmony export */   QCStatement: () => (/* binding */ QCStatement),\n/* harmony export */   QCStatements: () => (/* binding */ QCStatements),\n/* harmony export */   RDN: () => (/* binding */ RDN),\n/* harmony export */   RSAESOAEPParams: () => (/* binding */ RSAESOAEPParams),\n/* harmony export */   RSAPrivateKey: () => (/* binding */ RSAPrivateKey),\n/* harmony export */   RSAPublicKey: () => (/* binding */ RSAPublicKey),\n/* harmony export */   RSASSAPSSParams: () => (/* binding */ RSASSAPSSParams),\n/* harmony export */   RecipientEncryptedKey: () => (/* binding */ RecipientEncryptedKey),\n/* harmony export */   RecipientEncryptedKeys: () => (/* binding */ RecipientEncryptedKeys),\n/* harmony export */   RecipientIdentifier: () => (/* binding */ RecipientIdentifier),\n/* harmony export */   RecipientInfo: () => (/* binding */ RecipientInfo),\n/* harmony export */   RecipientKeyIdentifier: () => (/* binding */ RecipientKeyIdentifier),\n/* harmony export */   RelativeDistinguishedNames: () => (/* binding */ RelativeDistinguishedNames),\n/* harmony export */   Request: () => (/* binding */ Request),\n/* harmony export */   ResponseBytes: () => (/* binding */ ResponseBytes),\n/* harmony export */   ResponseData: () => (/* binding */ ResponseData),\n/* harmony export */   RevocationInfoChoices: () => (/* binding */ RevocationInfoChoices),\n/* harmony export */   RevokedCertificate: () => (/* binding */ RevokedCertificate),\n/* harmony export */   SECONDS: () => (/* binding */ SECONDS),\n/* harmony export */   SafeBag: () => (/* binding */ SafeBag),\n/* harmony export */   SafeBagValueFactory: () => (/* binding */ SafeBagValueFactory),\n/* harmony export */   SafeContents: () => (/* binding */ SafeContents),\n/* harmony export */   SecretBag: () => (/* binding */ SecretBag),\n/* harmony export */   Signature: () => (/* binding */ Signature),\n/* harmony export */   SignedAndUnsignedAttributes: () => (/* binding */ SignedAndUnsignedAttributes),\n/* harmony export */   SignedCertificateTimestamp: () => (/* binding */ SignedCertificateTimestamp),\n/* harmony export */   SignedCertificateTimestampList: () => (/* binding */ SignedCertificateTimestampList),\n/* harmony export */   SignedData: () => (/* binding */ SignedData),\n/* harmony export */   SignedDataVerifyError: () => (/* binding */ SignedDataVerifyError),\n/* harmony export */   SignerInfo: () => (/* binding */ SignerInfo),\n/* harmony export */   SingleResponse: () => (/* binding */ SingleResponse),\n/* harmony export */   SubjectDirectoryAttributes: () => (/* binding */ SubjectDirectoryAttributes),\n/* harmony export */   TBSRequest: () => (/* binding */ TBSRequest),\n/* harmony export */   TSTInfo: () => (/* binding */ TSTInfo),\n/* harmony export */   TYPE: () => (/* binding */ TYPE$4),\n/* harmony export */   TYPE_AND_VALUES: () => (/* binding */ TYPE_AND_VALUES),\n/* harmony export */   Time: () => (/* binding */ Time),\n/* harmony export */   TimeStampReq: () => (/* binding */ TimeStampReq),\n/* harmony export */   TimeStampResp: () => (/* binding */ TimeStampResp),\n/* harmony export */   TimeType: () => (/* binding */ TimeType),\n/* harmony export */   V2Form: () => (/* binding */ V2Form),\n/* harmony export */   VALUE: () => (/* binding */ VALUE$5),\n/* harmony export */   VALUE_BEFORE_DECODE: () => (/* binding */ VALUE_BEFORE_DECODE),\n/* harmony export */   checkCA: () => (/* binding */ checkCA),\n/* harmony export */   createCMSECDSASignature: () => (/* binding */ createCMSECDSASignature),\n/* harmony export */   createECDSASignatureFromCMS: () => (/* binding */ createECDSASignatureFromCMS),\n/* harmony export */   engine: () => (/* binding */ engine),\n/* harmony export */   getAlgorithmByOID: () => (/* binding */ getAlgorithmByOID),\n/* harmony export */   getAlgorithmParameters: () => (/* binding */ getAlgorithmParameters),\n/* harmony export */   getCrypto: () => (/* binding */ getCrypto),\n/* harmony export */   getEngine: () => (/* binding */ getEngine),\n/* harmony export */   getHashAlgorithm: () => (/* binding */ getHashAlgorithm),\n/* harmony export */   getOIDByAlgorithm: () => (/* binding */ getOIDByAlgorithm),\n/* harmony export */   getRandomValues: () => (/* binding */ getRandomValues),\n/* harmony export */   id_AnyPolicy: () => (/* binding */ id_AnyPolicy),\n/* harmony export */   id_AuthorityInfoAccess: () => (/* binding */ id_AuthorityInfoAccess),\n/* harmony export */   id_AuthorityKeyIdentifier: () => (/* binding */ id_AuthorityKeyIdentifier),\n/* harmony export */   id_BaseCRLNumber: () => (/* binding */ id_BaseCRLNumber),\n/* harmony export */   id_BasicConstraints: () => (/* binding */ id_BasicConstraints),\n/* harmony export */   id_CRLBag_X509CRL: () => (/* binding */ id_CRLBag_X509CRL),\n/* harmony export */   id_CRLDistributionPoints: () => (/* binding */ id_CRLDistributionPoints),\n/* harmony export */   id_CRLNumber: () => (/* binding */ id_CRLNumber),\n/* harmony export */   id_CRLReason: () => (/* binding */ id_CRLReason),\n/* harmony export */   id_CertBag_AttributeCertificate: () => (/* binding */ id_CertBag_AttributeCertificate),\n/* harmony export */   id_CertBag_SDSICertificate: () => (/* binding */ id_CertBag_SDSICertificate),\n/* harmony export */   id_CertBag_X509Certificate: () => (/* binding */ id_CertBag_X509Certificate),\n/* harmony export */   id_CertificateIssuer: () => (/* binding */ id_CertificateIssuer),\n/* harmony export */   id_CertificatePolicies: () => (/* binding */ id_CertificatePolicies),\n/* harmony export */   id_ContentType_Data: () => (/* binding */ id_ContentType_Data),\n/* harmony export */   id_ContentType_EncryptedData: () => (/* binding */ id_ContentType_EncryptedData),\n/* harmony export */   id_ContentType_EnvelopedData: () => (/* binding */ id_ContentType_EnvelopedData),\n/* harmony export */   id_ContentType_SignedData: () => (/* binding */ id_ContentType_SignedData),\n/* harmony export */   id_ExtKeyUsage: () => (/* binding */ id_ExtKeyUsage),\n/* harmony export */   id_FreshestCRL: () => (/* binding */ id_FreshestCRL),\n/* harmony export */   id_InhibitAnyPolicy: () => (/* binding */ id_InhibitAnyPolicy),\n/* harmony export */   id_InvalidityDate: () => (/* binding */ id_InvalidityDate),\n/* harmony export */   id_IssuerAltName: () => (/* binding */ id_IssuerAltName),\n/* harmony export */   id_IssuingDistributionPoint: () => (/* binding */ id_IssuingDistributionPoint),\n/* harmony export */   id_KeyUsage: () => (/* binding */ id_KeyUsage),\n/* harmony export */   id_MicrosoftAppPolicies: () => (/* binding */ id_MicrosoftAppPolicies),\n/* harmony export */   id_MicrosoftCaVersion: () => (/* binding */ id_MicrosoftCaVersion),\n/* harmony export */   id_MicrosoftCertTemplateV1: () => (/* binding */ id_MicrosoftCertTemplateV1),\n/* harmony export */   id_MicrosoftCertTemplateV2: () => (/* binding */ id_MicrosoftCertTemplateV2),\n/* harmony export */   id_MicrosoftPrevCaCertHash: () => (/* binding */ id_MicrosoftPrevCaCertHash),\n/* harmony export */   id_NameConstraints: () => (/* binding */ id_NameConstraints),\n/* harmony export */   id_PKIX_OCSP_Basic: () => (/* binding */ id_PKIX_OCSP_Basic),\n/* harmony export */   id_PolicyConstraints: () => (/* binding */ id_PolicyConstraints),\n/* harmony export */   id_PolicyMappings: () => (/* binding */ id_PolicyMappings),\n/* harmony export */   id_PrivateKeyUsagePeriod: () => (/* binding */ id_PrivateKeyUsagePeriod),\n/* harmony export */   id_QCStatements: () => (/* binding */ id_QCStatements),\n/* harmony export */   id_SignedCertificateTimestampList: () => (/* binding */ id_SignedCertificateTimestampList),\n/* harmony export */   id_SubjectAltName: () => (/* binding */ id_SubjectAltName),\n/* harmony export */   id_SubjectDirectoryAttributes: () => (/* binding */ id_SubjectDirectoryAttributes),\n/* harmony export */   id_SubjectInfoAccess: () => (/* binding */ id_SubjectInfoAccess),\n/* harmony export */   id_SubjectKeyIdentifier: () => (/* binding */ id_SubjectKeyIdentifier),\n/* harmony export */   id_ad: () => (/* binding */ id_ad),\n/* harmony export */   id_ad_caIssuers: () => (/* binding */ id_ad_caIssuers),\n/* harmony export */   id_ad_ocsp: () => (/* binding */ id_ad_ocsp),\n/* harmony export */   id_eContentType_TSTInfo: () => (/* binding */ id_eContentType_TSTInfo),\n/* harmony export */   id_pkix: () => (/* binding */ id_pkix),\n/* harmony export */   id_sha1: () => (/* binding */ id_sha1),\n/* harmony export */   id_sha256: () => (/* binding */ id_sha256),\n/* harmony export */   id_sha384: () => (/* binding */ id_sha384),\n/* harmony export */   id_sha512: () => (/* binding */ id_sha512),\n/* harmony export */   kdf: () => (/* binding */ kdf),\n/* harmony export */   setEngine: () => (/* binding */ setEngine),\n/* harmony export */   stringPrep: () => (/* binding */ stringPrep),\n/* harmony export */   verifySCTsForCertificate: () => (/* binding */ verifySCTsForCertificate)\n/* harmony export */ });\n/* harmony import */ var asn1js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! asn1js */ \"(ssr)/./node_modules/asn1js/build/index.es.js\");\n/* harmony import */ var pvtsutils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pvtsutils */ \"(ssr)/./node_modules/pvtsutils/build/index.es.js\");\n/* harmony import */ var pvutils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pvutils */ \"(ssr)/./node_modules/pvutils/build/utils.es.js\");\n/* harmony import */ var bytestreamjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! bytestreamjs */ \"(ssr)/./node_modules/bytestreamjs/build/mjs/index.js\");\n/* harmony import */ var _noble_hashes_sha1__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @noble/hashes/sha1 */ \"(ssr)/./node_modules/@noble/hashes/esm/sha1.js\");\n/* harmony import */ var _noble_hashes_sha256__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @noble/hashes/sha256 */ \"(ssr)/./node_modules/@noble/hashes/esm/sha256.js\");\n/* harmony import */ var _noble_hashes_sha512__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @noble/hashes/sha512 */ \"(ssr)/./node_modules/@noble/hashes/esm/sha512.js\");\n/*!\n * Copyright (c) 2014, GlobalSign\n * Copyright (c) 2015-2019, Peculiar Ventures\n * All rights reserved.\n * \n * Author 2014-2019, Yury Strozhevsky\n * \n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n * \n * * Redistributions of source code must retain the above copyright notice, this\n *   list of conditions and the following disclaimer.\n * \n * * Redistributions in binary form must reproduce the above copyright notice, this\n *   list of conditions and the following disclaimer in the documentation and/or\n *   other materials provided with the distribution.\n * \n * * Neither the name of the {organization} nor the names of its\n *   contributors may be used to endorse or promote products derived from\n *   this software without specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n * \n */\n\n\n\n\n\n\n\n\n\n\nconst EMPTY_BUFFER = new ArrayBuffer(0);\nconst EMPTY_STRING = \"\";\n\nclass ArgumentError extends TypeError {\n    constructor() {\n        super(...arguments);\n        this.name = ArgumentError.NAME;\n    }\n    static isType(value, type) {\n        if (typeof type === \"string\") {\n            if (type === \"Array\" && Array.isArray(value)) {\n                return true;\n            }\n            else if (type === \"ArrayBuffer\" && value instanceof ArrayBuffer) {\n                return true;\n            }\n            else if (type === \"ArrayBufferView\" && ArrayBuffer.isView(value)) {\n                return true;\n            }\n            else if (typeof value === type) {\n                return true;\n            }\n        }\n        else if (value instanceof type) {\n            return true;\n        }\n        return false;\n    }\n    static assert(value, name, ...types) {\n        for (const type of types) {\n            if (this.isType(value, type)) {\n                return;\n            }\n        }\n        const typeNames = types.map(o => o instanceof Function && \"name\" in o ? o.name : `${o}`);\n        throw new ArgumentError(`Parameter '${name}' is not of type ${typeNames.length > 1 ? `(${typeNames.join(\" or \")})` : typeNames[0]}`);\n    }\n}\nArgumentError.NAME = \"ArgumentError\";\n\nclass ParameterError extends TypeError {\n    static assert(...args) {\n        let target = null;\n        let params;\n        let fields;\n        if (typeof args[0] === \"string\") {\n            target = args[0];\n            params = args[1];\n            fields = args.slice(2);\n        }\n        else {\n            params = args[0];\n            fields = args.slice(1);\n        }\n        ArgumentError.assert(params, \"parameters\", \"object\");\n        for (const field of fields) {\n            const value = params[field];\n            if (value === undefined || value === null) {\n                throw new ParameterError(field, target);\n            }\n        }\n    }\n    static assertEmpty(value, name, target) {\n        if (value === undefined || value === null) {\n            throw new ParameterError(name, target);\n        }\n    }\n    constructor(field, target = null, message) {\n        super();\n        this.name = ParameterError.NAME;\n        this.field = field;\n        if (target) {\n            this.target = target;\n        }\n        if (message) {\n            this.message = message;\n        }\n        else {\n            this.message = `Absent mandatory parameter '${field}' ${target ? ` in '${target}'` : EMPTY_STRING}`;\n        }\n    }\n}\nParameterError.NAME = \"ParameterError\";\n\nclass AsnError extends Error {\n    static assertSchema(asn1, target) {\n        if (!asn1.verified) {\n            throw new Error(`Object's schema was not verified against input data for ${target}`);\n        }\n    }\n    static assert(asn, target) {\n        if (asn.offset === -1) {\n            throw new AsnError(`Error during parsing of ASN.1 data. Data is not correct for '${target}'.`);\n        }\n    }\n    constructor(message) {\n        super(message);\n        this.name = \"AsnError\";\n    }\n}\n\nclass PkiObject {\n    static blockName() {\n        return this.CLASS_NAME;\n    }\n    static fromBER(raw) {\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(raw);\n        AsnError.assert(asn1, this.name);\n        try {\n            return new this({ schema: asn1.result });\n        }\n        catch (e) {\n            throw new AsnError(`Cannot create '${this.CLASS_NAME}' from ASN.1 object`);\n        }\n    }\n    static defaultValues(memberName) {\n        throw new Error(`Invalid member name for ${this.CLASS_NAME} class: ${memberName}`);\n    }\n    static schema(parameters = {}) {\n        throw new Error(`Method '${this.CLASS_NAME}.schema' should be overridden`);\n    }\n    get className() {\n        return this.constructor.CLASS_NAME;\n    }\n    toString(encoding = \"hex\") {\n        let schema;\n        try {\n            schema = this.toSchema();\n        }\n        catch {\n            schema = this.toSchema(true);\n        }\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToString(schema.toBER(), encoding);\n    }\n}\nPkiObject.CLASS_NAME = \"PkiObject\";\n\nfunction stringPrep(inputString) {\n    let isSpace = false;\n    let cutResult = EMPTY_STRING;\n    const result = inputString.trim();\n    for (let i = 0; i < result.length; i++) {\n        if (result.charCodeAt(i) === 32) {\n            if (isSpace === false)\n                isSpace = true;\n        }\n        else {\n            if (isSpace) {\n                cutResult += \" \";\n                isSpace = false;\n            }\n            cutResult += result[i];\n        }\n    }\n    return cutResult.toLowerCase();\n}\n\nconst TYPE$5 = \"type\";\nconst VALUE$6 = \"value\";\nclass AttributeTypeAndValue extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE$5, AttributeTypeAndValue.defaultValues(TYPE$5));\n        this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$6, AttributeTypeAndValue.defaultValues(VALUE$6));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE$5:\n                return EMPTY_STRING;\n            case VALUE$6:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.type || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.value || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            TYPE$5,\n            \"typeValue\"\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttributeTypeAndValue.schema({\n            names: {\n                type: TYPE$5,\n                value: \"typeValue\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.type = asn1.result.type.valueBlock.toString();\n        this.value = asn1.result.typeValue;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.type }),\n                this.value\n            ]\n        }));\n    }\n    toJSON() {\n        const _object = {\n            type: this.type\n        };\n        if (Object.keys(this.value).length !== 0) {\n            _object.value = (this.value).toJSON();\n        }\n        else {\n            _object.value = this.value;\n        }\n        return _object;\n    }\n    isEqual(compareTo) {\n        const stringBlockNames = [\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.Utf8String.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.BmpString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.UniversalString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.NumericString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.TeletexString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.VideotexString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.IA5String.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.GraphicString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.VisibleString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralString.blockName(),\n            asn1js__WEBPACK_IMPORTED_MODULE_0__.CharacterString.blockName()\n        ];\n        if (compareTo instanceof ArrayBuffer) {\n            return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(this.value.valueBeforeDecodeView, compareTo);\n        }\n        if (compareTo.constructor.blockName() === AttributeTypeAndValue.blockName()) {\n            if (this.type !== compareTo.type)\n                return false;\n            const isStringPair = [false, false];\n            const thisName = this.value.constructor.blockName();\n            for (const name of stringBlockNames) {\n                if (thisName === name) {\n                    isStringPair[0] = true;\n                }\n                if (compareTo.value.constructor.blockName() === name) {\n                    isStringPair[1] = true;\n                }\n            }\n            if (isStringPair[0] !== isStringPair[1]) {\n                return false;\n            }\n            const isString = (isStringPair[0] && isStringPair[1]);\n            if (isString) {\n                const value1 = stringPrep(this.value.valueBlock.value);\n                const value2 = stringPrep(compareTo.value.valueBlock.value);\n                if (value1.localeCompare(value2) !== 0)\n                    return false;\n            }\n            else {\n                if (!pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(this.value.valueBeforeDecodeView, compareTo.value.valueBeforeDecodeView))\n                    return false;\n            }\n            return true;\n        }\n        return false;\n    }\n}\nAttributeTypeAndValue.CLASS_NAME = \"AttributeTypeAndValue\";\n\nconst TYPE_AND_VALUES = \"typesAndValues\";\nconst VALUE_BEFORE_DECODE = \"valueBeforeDecode\";\nconst RDN = \"RDN\";\nclass RelativeDistinguishedNames extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.typesAndValues = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE_AND_VALUES, RelativeDistinguishedNames.defaultValues(TYPE_AND_VALUES));\n        this.valueBeforeDecode = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE_BEFORE_DECODE, RelativeDistinguishedNames.defaultValues(VALUE_BEFORE_DECODE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE_AND_VALUES:\n                return [];\n            case VALUE_BEFORE_DECODE:\n                return EMPTY_BUFFER;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TYPE_AND_VALUES:\n                return (memberValue.length === 0);\n            case VALUE_BEFORE_DECODE:\n                return (memberValue.byteLength === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.repeatedSequence || EMPTY_STRING),\n                    value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                        value: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                name: (names.repeatedSet || EMPTY_STRING),\n                                value: AttributeTypeAndValue.schema(names.typeAndValue || {})\n                            })\n                        ]\n                    })\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            RDN,\n            TYPE_AND_VALUES\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RelativeDistinguishedNames.schema({\n            names: {\n                blockName: RDN,\n                repeatedSet: TYPE_AND_VALUES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (TYPE_AND_VALUES in asn1.result) {\n            this.typesAndValues = Array.from(asn1.result.typesAndValues, element => new AttributeTypeAndValue({ schema: element }));\n        }\n        this.valueBeforeDecode = asn1.result.RDN.valueBeforeDecodeView.slice().buffer;\n    }\n    toSchema() {\n        if (this.valueBeforeDecode.byteLength === 0) {\n            return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                        value: Array.from(this.typesAndValues, o => o.toSchema())\n                    })]\n            }));\n        }\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.valueBeforeDecode);\n        AsnError.assert(asn1, \"RelativeDistinguishedNames\");\n        if (!(asn1.result instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence)) {\n            throw new Error(\"ASN.1 result should be SEQUENCE\");\n        }\n        return asn1.result;\n    }\n    toJSON() {\n        return {\n            typesAndValues: Array.from(this.typesAndValues, o => o.toJSON())\n        };\n    }\n    isEqual(compareTo) {\n        if (compareTo instanceof RelativeDistinguishedNames) {\n            if (this.typesAndValues.length !== compareTo.typesAndValues.length)\n                return false;\n            for (const [index, typeAndValue] of this.typesAndValues.entries()) {\n                if (typeAndValue.isEqual(compareTo.typesAndValues[index]) === false)\n                    return false;\n            }\n            return true;\n        }\n        if (compareTo instanceof ArrayBuffer) {\n            return pvutils__WEBPACK_IMPORTED_MODULE_2__.isEqualBuffer(this.valueBeforeDecode, compareTo);\n        }\n        return false;\n    }\n}\nRelativeDistinguishedNames.CLASS_NAME = \"RelativeDistinguishedNames\";\n\nconst TYPE$4 = \"type\";\nconst VALUE$5 = \"value\";\nfunction builtInStandardAttributes(parameters = {}, optional = false) {\n    const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        optional,\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 2,\n                    tagNumber: 1\n                },\n                name: (names.country_name || EMPTY_STRING),\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                        value: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.NumericString(),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString()\n                        ]\n                    })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 2,\n                    tagNumber: 2\n                },\n                name: (names.administration_domain_name || EMPTY_STRING),\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                        value: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.NumericString(),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString()\n                        ]\n                    })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                name: (names.network_address || EMPTY_STRING),\n                isHexOnly: true\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                name: (names.terminal_identifier || EMPTY_STRING),\n                isHexOnly: true\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                name: (names.private_domain_name || EMPTY_STRING),\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                        value: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.NumericString(),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString()\n                        ]\n                    })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 3\n                },\n                name: (names.organization_name || EMPTY_STRING),\n                isHexOnly: true\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                name: (names.numeric_user_identifier || EMPTY_STRING),\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 4\n                },\n                isHexOnly: true\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                name: (names.personal_name || EMPTY_STRING),\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 5\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                        idBlock: {\n                            tagClass: 3,\n                            tagNumber: 0\n                        },\n                        isHexOnly: true\n                    }),\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                        optional: true,\n                        idBlock: {\n                            tagClass: 3,\n                            tagNumber: 1\n                        },\n                        isHexOnly: true\n                    }),\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                        optional: true,\n                        idBlock: {\n                            tagClass: 3,\n                            tagNumber: 2\n                        },\n                        isHexOnly: true\n                    }),\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                        optional: true,\n                        idBlock: {\n                            tagClass: 3,\n                            tagNumber: 3\n                        },\n                        isHexOnly: true\n                    })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                name: (names.organizational_unit_names || EMPTY_STRING),\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 6\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                        value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString()\n                    })\n                ]\n            })\n        ]\n    }));\n}\nfunction builtInDomainDefinedAttributes(optional = false) {\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        optional,\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString(),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString()\n        ]\n    }));\n}\nfunction extensionAttributes(optional = false) {\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n        optional,\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                isHexOnly: true\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any()]\n            })\n        ]\n    }));\n}\nclass GeneralName extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE$4, GeneralName.defaultValues(TYPE$4));\n        this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$5, GeneralName.defaultValues(VALUE$5));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE$4:\n                return 9;\n            case VALUE$5:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TYPE$4:\n                return (memberValue === GeneralName.defaultValues(memberName));\n            case VALUE$5:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    name: (names.blockName || EMPTY_STRING),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier(),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                            value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any()]\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 3\n                    },\n                    name: (names.blockName || EMPTY_STRING),\n                    value: [\n                        builtInStandardAttributes((names.builtInStandardAttributes || {}), false),\n                        builtInDomainDefinedAttributes(true),\n                        extensionAttributes(true)\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 4\n                    },\n                    name: (names.blockName || EMPTY_STRING),\n                    value: [RelativeDistinguishedNames.schema(names.directoryName || {})]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 5\n                    },\n                    name: (names.blockName || EMPTY_STRING),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            optional: true,\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                                    value: [\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.TeletexString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.UniversalString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Utf8String(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.BmpString()\n                                    ]\n                                })\n                            ]\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 1\n                            },\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                                    value: [\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.TeletexString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.PrintableString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.UniversalString(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Utf8String(),\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.BmpString()\n                                    ]\n                                })\n                            ]\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 6\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 7\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 8\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            \"blockName\",\n            \"otherName\",\n            \"rfc822Name\",\n            \"dNSName\",\n            \"x400Address\",\n            \"directoryName\",\n            \"ediPartyName\",\n            \"uniformResourceIdentifier\",\n            \"iPAddress\",\n            \"registeredID\"\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, GeneralName.schema({\n            names: {\n                blockName: \"blockName\",\n                otherName: \"otherName\",\n                rfc822Name: \"rfc822Name\",\n                dNSName: \"dNSName\",\n                x400Address: \"x400Address\",\n                directoryName: {\n                    names: {\n                        blockName: \"directoryName\"\n                    }\n                },\n                ediPartyName: \"ediPartyName\",\n                uniformResourceIdentifier: \"uniformResourceIdentifier\",\n                iPAddress: \"iPAddress\",\n                registeredID: \"registeredID\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.type = asn1.result.blockName.idBlock.tagNumber;\n        switch (this.type) {\n            case 0:\n                this.value = asn1.result.blockName;\n                break;\n            case 1:\n            case 2:\n            case 6:\n                {\n                    const value = asn1.result.blockName;\n                    value.idBlock.tagClass = 1;\n                    value.idBlock.tagNumber = 22;\n                    const valueBER = value.toBER(false);\n                    const asnValue = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(valueBER);\n                    AsnError.assert(asnValue, \"GeneralName value\");\n                    this.value = asnValue.result.valueBlock.value;\n                }\n                break;\n            case 3:\n                this.value = asn1.result.blockName;\n                break;\n            case 4:\n                this.value = new RelativeDistinguishedNames({ schema: asn1.result.directoryName });\n                break;\n            case 5:\n                this.value = asn1.result.ediPartyName;\n                break;\n            case 7:\n                this.value = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: asn1.result.blockName.valueBlock.valueHex });\n                break;\n            case 8:\n                {\n                    const value = asn1.result.blockName;\n                    value.idBlock.tagClass = 1;\n                    value.idBlock.tagNumber = 6;\n                    const valueBER = value.toBER(false);\n                    const asnValue = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(valueBER);\n                    AsnError.assert(asnValue, \"GeneralName registeredID\");\n                    this.value = asnValue.result.valueBlock.toString();\n                }\n                break;\n        }\n    }\n    toSchema() {\n        switch (this.type) {\n            case 0:\n            case 3:\n            case 5:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: this.type\n                    },\n                    value: [\n                        this.value\n                    ]\n                });\n            case 1:\n            case 2:\n            case 6:\n                {\n                    const value = new asn1js__WEBPACK_IMPORTED_MODULE_0__.IA5String({ value: this.value });\n                    value.idBlock.tagClass = 3;\n                    value.idBlock.tagNumber = this.type;\n                    return value;\n                }\n            case 4:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 4\n                    },\n                    value: [this.value.toSchema()]\n                });\n            case 7:\n                {\n                    const value = this.value;\n                    value.idBlock.tagClass = 3;\n                    value.idBlock.tagNumber = this.type;\n                    return value;\n                }\n            case 8:\n                {\n                    const value = new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.value });\n                    value.idBlock.tagClass = 3;\n                    value.idBlock.tagNumber = this.type;\n                    return value;\n                }\n            default:\n                return GeneralName.schema();\n        }\n    }\n    toJSON() {\n        const _object = {\n            type: this.type,\n            value: EMPTY_STRING\n        };\n        if ((typeof this.value) === \"string\")\n            _object.value = this.value;\n        else {\n            try {\n                _object.value = this.value.toJSON();\n            }\n            catch (ex) {\n            }\n        }\n        return _object;\n    }\n}\nGeneralName.CLASS_NAME = \"GeneralName\";\n\nconst ACCESS_METHOD = \"accessMethod\";\nconst ACCESS_LOCATION = \"accessLocation\";\nconst CLEAR_PROPS$1v = [\n    ACCESS_METHOD,\n    ACCESS_LOCATION,\n];\nclass AccessDescription extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.accessMethod = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACCESS_METHOD, AccessDescription.defaultValues(ACCESS_METHOD));\n        this.accessLocation = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACCESS_LOCATION, AccessDescription.defaultValues(ACCESS_LOCATION));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ACCESS_METHOD:\n                return EMPTY_STRING;\n            case ACCESS_LOCATION:\n                return new GeneralName();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.accessMethod || EMPTY_STRING) }),\n                GeneralName.schema(names.accessLocation || {})\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1v);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AccessDescription.schema({\n            names: {\n                accessMethod: ACCESS_METHOD,\n                accessLocation: {\n                    names: {\n                        blockName: ACCESS_LOCATION\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.accessMethod = asn1.result.accessMethod.valueBlock.toString();\n        this.accessLocation = new GeneralName({ schema: asn1.result.accessLocation });\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.accessMethod }),\n                this.accessLocation.toSchema()\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            accessMethod: this.accessMethod,\n            accessLocation: this.accessLocation.toJSON()\n        };\n    }\n}\nAccessDescription.CLASS_NAME = \"AccessDescription\";\n\nconst SECONDS = \"seconds\";\nconst MILLIS = \"millis\";\nconst MICROS = \"micros\";\nclass Accuracy extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (SECONDS in parameters) {\n            this.seconds = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SECONDS, Accuracy.defaultValues(SECONDS));\n        }\n        if (MILLIS in parameters) {\n            this.millis = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MILLIS, Accuracy.defaultValues(MILLIS));\n        }\n        if (MICROS in parameters) {\n            this.micros = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MICROS, Accuracy.defaultValues(MICROS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SECONDS:\n            case MILLIS:\n            case MICROS:\n                return 0;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SECONDS:\n            case MILLIS:\n            case MICROS:\n                return (memberValue === Accuracy.defaultValues(memberName));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            optional: true,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    optional: true,\n                    name: (names.seconds || EMPTY_STRING)\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.millis || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.micros || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            SECONDS,\n            MILLIS,\n            MICROS,\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Accuracy.schema({\n            names: {\n                seconds: SECONDS,\n                millis: MILLIS,\n                micros: MICROS,\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (\"seconds\" in asn1.result) {\n            this.seconds = asn1.result.seconds.valueBlock.valueDec;\n        }\n        if (\"millis\" in asn1.result) {\n            const intMillis = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: asn1.result.millis.valueBlock.valueHex });\n            this.millis = intMillis.valueBlock.valueDec;\n        }\n        if (\"micros\" in asn1.result) {\n            const intMicros = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: asn1.result.micros.valueBlock.valueHex });\n            this.micros = intMicros.valueBlock.valueDec;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.seconds !== undefined)\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.seconds }));\n        if (this.millis !== undefined) {\n            const intMillis = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.millis });\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                valueHex: intMillis.valueBlock.valueHexView\n            }));\n        }\n        if (this.micros !== undefined) {\n            const intMicros = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.micros });\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                valueHex: intMicros.valueBlock.valueHexView\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const _object = {};\n        if (this.seconds !== undefined)\n            _object.seconds = this.seconds;\n        if (this.millis !== undefined)\n            _object.millis = this.millis;\n        if (this.micros !== undefined)\n            _object.micros = this.micros;\n        return _object;\n    }\n}\nAccuracy.CLASS_NAME = \"Accuracy\";\n\nconst ALGORITHM_ID = \"algorithmId\";\nconst ALGORITHM_PARAMS = \"algorithmParams\";\nconst ALGORITHM$2 = \"algorithm\";\nconst PARAMS = \"params\";\nconst CLEAR_PROPS$1u = [\n    ALGORITHM$2,\n    PARAMS\n];\nclass AlgorithmIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.algorithmId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ALGORITHM_ID, AlgorithmIdentifier.defaultValues(ALGORITHM_ID));\n        if (ALGORITHM_PARAMS in parameters) {\n            this.algorithmParams = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ALGORITHM_PARAMS, AlgorithmIdentifier.defaultValues(ALGORITHM_PARAMS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ALGORITHM_ID:\n                return EMPTY_STRING;\n            case ALGORITHM_PARAMS:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ALGORITHM_ID:\n                return (memberValue === EMPTY_STRING);\n            case ALGORITHM_PARAMS:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            optional: (names.optional || false),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.algorithmIdentifier || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.algorithmParams || EMPTY_STRING), optional: true })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1u);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AlgorithmIdentifier.schema({\n            names: {\n                algorithmIdentifier: ALGORITHM$2,\n                algorithmParams: PARAMS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.algorithmId = asn1.result.algorithm.valueBlock.toString();\n        if (PARAMS in asn1.result) {\n            this.algorithmParams = asn1.result.params;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.algorithmId }));\n        if (this.algorithmParams && !(this.algorithmParams instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any)) {\n            outputArray.push(this.algorithmParams);\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {\n            algorithmId: this.algorithmId\n        };\n        if (this.algorithmParams && !(this.algorithmParams instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any)) {\n            object.algorithmParams = this.algorithmParams.toJSON();\n        }\n        return object;\n    }\n    isEqual(algorithmIdentifier) {\n        if (!(algorithmIdentifier instanceof AlgorithmIdentifier)) {\n            return false;\n        }\n        if (this.algorithmId !== algorithmIdentifier.algorithmId) {\n            return false;\n        }\n        if (this.algorithmParams) {\n            if (algorithmIdentifier.algorithmParams) {\n                return JSON.stringify(this.algorithmParams) === JSON.stringify(algorithmIdentifier.algorithmParams);\n            }\n            return false;\n        }\n        if (algorithmIdentifier.algorithmParams) {\n            return false;\n        }\n        return true;\n    }\n}\nAlgorithmIdentifier.CLASS_NAME = \"AlgorithmIdentifier\";\n\nconst ALT_NAMES = \"altNames\";\nconst CLEAR_PROPS$1t = [\n    ALT_NAMES\n];\nclass AltName extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.altNames = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ALT_NAMES, AltName.defaultValues(ALT_NAMES));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ALT_NAMES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.altNames || EMPTY_STRING),\n                    value: GeneralName.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1t);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AltName.schema({\n            names: {\n                altNames: ALT_NAMES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (ALT_NAMES in asn1.result) {\n            this.altNames = Array.from(asn1.result.altNames, element => new GeneralName({ schema: element }));\n        }\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.altNames, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            altNames: Array.from(this.altNames, o => o.toJSON())\n        };\n    }\n}\nAltName.CLASS_NAME = \"AltName\";\n\nconst TYPE$3 = \"type\";\nconst VALUES$1 = \"values\";\nconst CLEAR_PROPS$1s = [\n    TYPE$3,\n    VALUES$1\n];\nclass Attribute extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE$3, Attribute.defaultValues(TYPE$3));\n        this.values = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUES$1, Attribute.defaultValues(VALUES$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE$3:\n                return EMPTY_STRING;\n            case VALUES$1:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TYPE$3:\n                return (memberValue === EMPTY_STRING);\n            case VALUES$1:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.type || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    name: (names.setName || EMPTY_STRING),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.values || EMPTY_STRING),\n                            value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1s);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Attribute.schema({\n            names: {\n                type: TYPE$3,\n                values: VALUES$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.type = asn1.result.type.valueBlock.toString();\n        this.values = asn1.result.values;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.type }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: this.values\n                })\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            type: this.type,\n            values: Array.from(this.values, o => o.toJSON())\n        };\n    }\n}\nAttribute.CLASS_NAME = \"Attribute\";\n\nconst NOT_BEFORE_TIME = \"notBeforeTime\";\nconst NOT_AFTER_TIME = \"notAfterTime\";\nconst CLEAR_PROPS$1r = [\n    NOT_BEFORE_TIME,\n    NOT_AFTER_TIME,\n];\nclass AttCertValidityPeriod extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.notBeforeTime = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_BEFORE_TIME, AttCertValidityPeriod.defaultValues(NOT_BEFORE_TIME));\n        this.notAfterTime = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_AFTER_TIME, AttCertValidityPeriod.defaultValues(NOT_AFTER_TIME));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case NOT_BEFORE_TIME:\n            case NOT_AFTER_TIME:\n                return new Date(0, 0, 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.notBeforeTime || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.notAfterTime || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1r);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttCertValidityPeriod.schema({\n            names: {\n                notBeforeTime: NOT_BEFORE_TIME,\n                notAfterTime: NOT_AFTER_TIME\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.notBeforeTime = asn1.result.notBeforeTime.toDate();\n        this.notAfterTime = asn1.result.notAfterTime.toDate();\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.notBeforeTime }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.notAfterTime }),\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            notBeforeTime: this.notBeforeTime,\n            notAfterTime: this.notAfterTime\n        };\n    }\n}\nAttCertValidityPeriod.CLASS_NAME = \"AttCertValidityPeriod\";\n\nconst NAMES = \"names\";\nconst GENERAL_NAMES = \"generalNames\";\nclass GeneralNames extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NAMES, GeneralNames.defaultValues(NAMES));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case \"names\":\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}, optional = false) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NAMES, {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            optional,\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.generalNames || EMPTY_STRING),\n                    value: GeneralName.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            NAMES,\n            GENERAL_NAMES\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, GeneralNames.schema({\n            names: {\n                blockName: NAMES,\n                generalNames: GENERAL_NAMES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.names = Array.from(asn1.result.generalNames, element => new GeneralName({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.names, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            names: Array.from(this.names, o => o.toJSON())\n        };\n    }\n}\nGeneralNames.CLASS_NAME = \"GeneralNames\";\n\nconst id_SubjectDirectoryAttributes = \"2.5.29.9\";\nconst id_SubjectKeyIdentifier = \"2.5.29.14\";\nconst id_KeyUsage = \"2.5.29.15\";\nconst id_PrivateKeyUsagePeriod = \"2.5.29.16\";\nconst id_SubjectAltName = \"2.5.29.17\";\nconst id_IssuerAltName = \"2.5.29.18\";\nconst id_BasicConstraints = \"2.5.29.19\";\nconst id_CRLNumber = \"2.5.29.20\";\nconst id_BaseCRLNumber = \"2.5.29.27\";\nconst id_CRLReason = \"2.5.29.21\";\nconst id_InvalidityDate = \"2.5.29.24\";\nconst id_IssuingDistributionPoint = \"2.5.29.28\";\nconst id_CertificateIssuer = \"2.5.29.29\";\nconst id_NameConstraints = \"2.5.29.30\";\nconst id_CRLDistributionPoints = \"2.5.29.31\";\nconst id_FreshestCRL = \"2.5.29.46\";\nconst id_CertificatePolicies = \"2.5.29.32\";\nconst id_AnyPolicy = \"2.5.29.32.0\";\nconst id_MicrosoftAppPolicies = \"1.3.6.1.4.1.311.21.10\";\nconst id_PolicyMappings = \"2.5.29.33\";\nconst id_AuthorityKeyIdentifier = \"2.5.29.35\";\nconst id_PolicyConstraints = \"2.5.29.36\";\nconst id_ExtKeyUsage = \"2.5.29.37\";\nconst id_InhibitAnyPolicy = \"2.5.29.54\";\nconst id_AuthorityInfoAccess = \"1.3.6.1.5.5.7.1.1\";\nconst id_SubjectInfoAccess = \"1.3.6.1.5.5.7.1.11\";\nconst id_SignedCertificateTimestampList = \"1.3.6.1.4.1.11129.2.4.2\";\nconst id_MicrosoftCertTemplateV1 = \"1.3.6.1.4.1.311.20.2\";\nconst id_MicrosoftPrevCaCertHash = \"1.3.6.1.4.1.311.21.2\";\nconst id_MicrosoftCertTemplateV2 = \"1.3.6.1.4.1.311.21.7\";\nconst id_MicrosoftCaVersion = \"1.3.6.1.4.1.311.21.1\";\nconst id_QCStatements = \"1.3.6.1.5.5.7.1.3\";\nconst id_ContentType_Data = \"1.2.840.113549.1.7.1\";\nconst id_ContentType_SignedData = \"1.2.840.113549.1.7.2\";\nconst id_ContentType_EnvelopedData = \"1.2.840.113549.1.7.3\";\nconst id_ContentType_EncryptedData = \"1.2.840.113549.1.7.6\";\nconst id_eContentType_TSTInfo = \"1.2.840.113549.1.9.16.1.4\";\nconst id_CertBag_X509Certificate = \"1.2.840.113549.1.9.22.1\";\nconst id_CertBag_SDSICertificate = \"1.2.840.113549.1.9.22.2\";\nconst id_CertBag_AttributeCertificate = \"1.2.840.113549.1.9.22.3\";\nconst id_CRLBag_X509CRL = \"1.2.840.113549.1.9.23.1\";\nconst id_pkix = \"1.3.6.1.5.5.7\";\nconst id_ad = `${id_pkix}.48`;\nconst id_PKIX_OCSP_Basic = `${id_ad}.1.1`;\nconst id_ad_caIssuers = `${id_ad}.2`;\nconst id_ad_ocsp = `${id_ad}.1`;\nconst id_sha1 = \"1.3.14.3.2.26\";\nconst id_sha256 = \"2.16.840.1.101.3.4.2.1\";\nconst id_sha384 = \"2.16.840.1.101.3.4.2.2\";\nconst id_sha512 = \"2.16.840.1.101.3.4.2.3\";\n\nconst KEY_IDENTIFIER$1 = \"keyIdentifier\";\nconst AUTHORITY_CERT_ISSUER = \"authorityCertIssuer\";\nconst AUTHORITY_CERT_SERIAL_NUMBER = \"authorityCertSerialNumber\";\nconst CLEAR_PROPS$1q = [\n    KEY_IDENTIFIER$1,\n    AUTHORITY_CERT_ISSUER,\n    AUTHORITY_CERT_SERIAL_NUMBER,\n];\nclass AuthorityKeyIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (KEY_IDENTIFIER$1 in parameters) {\n            this.keyIdentifier = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_IDENTIFIER$1, AuthorityKeyIdentifier.defaultValues(KEY_IDENTIFIER$1));\n        }\n        if (AUTHORITY_CERT_ISSUER in parameters) {\n            this.authorityCertIssuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, AUTHORITY_CERT_ISSUER, AuthorityKeyIdentifier.defaultValues(AUTHORITY_CERT_ISSUER));\n        }\n        if (AUTHORITY_CERT_SERIAL_NUMBER in parameters) {\n            this.authorityCertSerialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, AUTHORITY_CERT_SERIAL_NUMBER, AuthorityKeyIdentifier.defaultValues(AUTHORITY_CERT_SERIAL_NUMBER));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_IDENTIFIER$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case AUTHORITY_CERT_ISSUER:\n                return [];\n            case AUTHORITY_CERT_SERIAL_NUMBER:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.keyIdentifier || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.authorityCertIssuer || EMPTY_STRING),\n                            value: GeneralName.schema()\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.authorityCertSerialNumber || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1q);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AuthorityKeyIdentifier.schema({\n            names: {\n                keyIdentifier: KEY_IDENTIFIER$1,\n                authorityCertIssuer: AUTHORITY_CERT_ISSUER,\n                authorityCertSerialNumber: AUTHORITY_CERT_SERIAL_NUMBER\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (KEY_IDENTIFIER$1 in asn1.result)\n            this.keyIdentifier = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: asn1.result.keyIdentifier.valueBlock.valueHex });\n        if (AUTHORITY_CERT_ISSUER in asn1.result)\n            this.authorityCertIssuer = Array.from(asn1.result.authorityCertIssuer, o => new GeneralName({ schema: o }));\n        if (AUTHORITY_CERT_SERIAL_NUMBER in asn1.result)\n            this.authorityCertSerialNumber = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: asn1.result.authorityCertSerialNumber.valueBlock.valueHex });\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.keyIdentifier) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                valueHex: this.keyIdentifier.valueBlock.valueHexView\n            }));\n        }\n        if (this.authorityCertIssuer) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.authorityCertIssuer, o => o.toSchema())\n            }));\n        }\n        if (this.authorityCertSerialNumber) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                valueHex: this.authorityCertSerialNumber.valueBlock.valueHexView\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {};\n        if (this.keyIdentifier) {\n            object.keyIdentifier = this.keyIdentifier.toJSON();\n        }\n        if (this.authorityCertIssuer) {\n            object.authorityCertIssuer = Array.from(this.authorityCertIssuer, o => o.toJSON());\n        }\n        if (this.authorityCertSerialNumber) {\n            object.authorityCertSerialNumber = this.authorityCertSerialNumber.toJSON();\n        }\n        return object;\n    }\n}\nAuthorityKeyIdentifier.CLASS_NAME = \"AuthorityKeyIdentifier\";\n\nconst PATH_LENGTH_CONSTRAINT = \"pathLenConstraint\";\nconst CA = \"cA\";\nclass BasicConstraints extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.cA = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CA, false);\n        if (PATH_LENGTH_CONSTRAINT in parameters) {\n            this.pathLenConstraint = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PATH_LENGTH_CONSTRAINT, 0);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CA:\n                return false;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({\n                    optional: true,\n                    name: (names.cA || EMPTY_STRING)\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    optional: true,\n                    name: (names.pathLenConstraint || EMPTY_STRING)\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            CA,\n            PATH_LENGTH_CONSTRAINT\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, BasicConstraints.schema({\n            names: {\n                cA: CA,\n                pathLenConstraint: PATH_LENGTH_CONSTRAINT\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (CA in asn1.result) {\n            this.cA = asn1.result.cA.valueBlock.value;\n        }\n        if (PATH_LENGTH_CONSTRAINT in asn1.result) {\n            if (asn1.result.pathLenConstraint.valueBlock.isHexOnly) {\n                this.pathLenConstraint = asn1.result.pathLenConstraint;\n            }\n            else {\n                this.pathLenConstraint = asn1.result.pathLenConstraint.valueBlock.valueDec;\n            }\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.cA !== BasicConstraints.defaultValues(CA))\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({ value: this.cA }));\n        if (PATH_LENGTH_CONSTRAINT in this) {\n            if (this.pathLenConstraint instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer) {\n                outputArray.push(this.pathLenConstraint);\n            }\n            else {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.pathLenConstraint }));\n            }\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {};\n        if (this.cA !== BasicConstraints.defaultValues(CA)) {\n            object.cA = this.cA;\n        }\n        if (PATH_LENGTH_CONSTRAINT in this) {\n            if (this.pathLenConstraint instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer) {\n                object.pathLenConstraint = this.pathLenConstraint.toJSON();\n            }\n            else {\n                object.pathLenConstraint = this.pathLenConstraint;\n            }\n        }\n        return object;\n    }\n}\nBasicConstraints.CLASS_NAME = \"BasicConstraints\";\n\nconst CERTIFICATE_INDEX = \"certificateIndex\";\nconst KEY_INDEX = \"keyIndex\";\nclass CAVersion extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.certificateIndex = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTIFICATE_INDEX, CAVersion.defaultValues(CERTIFICATE_INDEX));\n        this.keyIndex = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_INDEX, CAVersion.defaultValues(KEY_INDEX));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERTIFICATE_INDEX:\n            case KEY_INDEX:\n                return 0;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer());\n    }\n    fromSchema(schema) {\n        if (schema.constructor.blockName() !== asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer.blockName()) {\n            throw new Error(\"Object's schema was not verified against input data for CAVersion\");\n        }\n        let value = schema.valueBlock.valueHex.slice(0);\n        const valueView = new Uint8Array(value);\n        switch (true) {\n            case (value.byteLength < 4):\n                {\n                    const tempValue = new ArrayBuffer(4);\n                    const tempValueView = new Uint8Array(tempValue);\n                    tempValueView.set(valueView, 4 - value.byteLength);\n                    value = tempValue.slice(0);\n                }\n                break;\n            case (value.byteLength > 4):\n                {\n                    const tempValue = new ArrayBuffer(4);\n                    const tempValueView = new Uint8Array(tempValue);\n                    tempValueView.set(valueView.slice(0, 4));\n                    value = tempValue.slice(0);\n                }\n                break;\n        }\n        const keyIndexBuffer = value.slice(0, 2);\n        const keyIndexView8 = new Uint8Array(keyIndexBuffer);\n        let temp = keyIndexView8[0];\n        keyIndexView8[0] = keyIndexView8[1];\n        keyIndexView8[1] = temp;\n        const keyIndexView16 = new Uint16Array(keyIndexBuffer);\n        this.keyIndex = keyIndexView16[0];\n        const certificateIndexBuffer = value.slice(2);\n        const certificateIndexView8 = new Uint8Array(certificateIndexBuffer);\n        temp = certificateIndexView8[0];\n        certificateIndexView8[0] = certificateIndexView8[1];\n        certificateIndexView8[1] = temp;\n        const certificateIndexView16 = new Uint16Array(certificateIndexBuffer);\n        this.certificateIndex = certificateIndexView16[0];\n    }\n    toSchema() {\n        const certificateIndexBuffer = new ArrayBuffer(2);\n        const certificateIndexView = new Uint16Array(certificateIndexBuffer);\n        certificateIndexView[0] = this.certificateIndex;\n        const certificateIndexView8 = new Uint8Array(certificateIndexBuffer);\n        let temp = certificateIndexView8[0];\n        certificateIndexView8[0] = certificateIndexView8[1];\n        certificateIndexView8[1] = temp;\n        const keyIndexBuffer = new ArrayBuffer(2);\n        const keyIndexView = new Uint16Array(keyIndexBuffer);\n        keyIndexView[0] = this.keyIndex;\n        const keyIndexView8 = new Uint8Array(keyIndexBuffer);\n        temp = keyIndexView8[0];\n        keyIndexView8[0] = keyIndexView8[1];\n        keyIndexView8[1] = temp;\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n            valueHex: pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf(keyIndexBuffer, certificateIndexBuffer)\n        }));\n    }\n    toJSON() {\n        return {\n            certificateIndex: this.certificateIndex,\n            keyIndex: this.keyIndex\n        };\n    }\n}\nCAVersion.CLASS_NAME = \"CAVersion\";\n\nconst POLICY_QUALIFIER_ID = \"policyQualifierId\";\nconst QUALIFIER = \"qualifier\";\nconst CLEAR_PROPS$1p = [\n    POLICY_QUALIFIER_ID,\n    QUALIFIER\n];\nclass PolicyQualifierInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.policyQualifierId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, POLICY_QUALIFIER_ID, PolicyQualifierInfo.defaultValues(POLICY_QUALIFIER_ID));\n        this.qualifier = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, QUALIFIER, PolicyQualifierInfo.defaultValues(QUALIFIER));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case POLICY_QUALIFIER_ID:\n                return EMPTY_STRING;\n            case QUALIFIER:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.policyQualifierId || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.qualifier || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1p);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PolicyQualifierInfo.schema({\n            names: {\n                policyQualifierId: POLICY_QUALIFIER_ID,\n                qualifier: QUALIFIER\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.policyQualifierId = asn1.result.policyQualifierId.valueBlock.toString();\n        this.qualifier = asn1.result.qualifier;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.policyQualifierId }),\n                this.qualifier\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            policyQualifierId: this.policyQualifierId,\n            qualifier: this.qualifier.toJSON()\n        };\n    }\n}\nPolicyQualifierInfo.CLASS_NAME = \"PolicyQualifierInfo\";\n\nconst POLICY_IDENTIFIER = \"policyIdentifier\";\nconst POLICY_QUALIFIERS = \"policyQualifiers\";\nconst CLEAR_PROPS$1o = [\n    POLICY_IDENTIFIER,\n    POLICY_QUALIFIERS\n];\nclass PolicyInformation extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.policyIdentifier = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, POLICY_IDENTIFIER, PolicyInformation.defaultValues(POLICY_IDENTIFIER));\n        if (POLICY_QUALIFIERS in parameters) {\n            this.policyQualifiers = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, POLICY_QUALIFIERS, PolicyInformation.defaultValues(POLICY_QUALIFIERS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case POLICY_IDENTIFIER:\n                return EMPTY_STRING;\n            case POLICY_QUALIFIERS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.policyIdentifier || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    optional: true,\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.policyQualifiers || EMPTY_STRING),\n                            value: PolicyQualifierInfo.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1o);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PolicyInformation.schema({\n            names: {\n                policyIdentifier: POLICY_IDENTIFIER,\n                policyQualifiers: POLICY_QUALIFIERS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.policyIdentifier = asn1.result.policyIdentifier.valueBlock.toString();\n        if (POLICY_QUALIFIERS in asn1.result) {\n            this.policyQualifiers = Array.from(asn1.result.policyQualifiers, element => new PolicyQualifierInfo({ schema: element }));\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.policyIdentifier }));\n        if (this.policyQualifiers) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.policyQualifiers, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            policyIdentifier: this.policyIdentifier\n        };\n        if (this.policyQualifiers)\n            res.policyQualifiers = Array.from(this.policyQualifiers, o => o.toJSON());\n        return res;\n    }\n}\nPolicyInformation.CLASS_NAME = \"PolicyInformation\";\n\nconst CERTIFICATE_POLICIES = \"certificatePolicies\";\nconst CLEAR_PROPS$1n = [\n    CERTIFICATE_POLICIES,\n];\nclass CertificatePolicies extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.certificatePolicies = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTIFICATE_POLICIES, CertificatePolicies.defaultValues(CERTIFICATE_POLICIES));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERTIFICATE_POLICIES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.certificatePolicies || EMPTY_STRING),\n                    value: PolicyInformation.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1n);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertificatePolicies.schema({\n            names: {\n                certificatePolicies: CERTIFICATE_POLICIES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.certificatePolicies = Array.from(asn1.result.certificatePolicies, element => new PolicyInformation({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.certificatePolicies, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            certificatePolicies: Array.from(this.certificatePolicies, o => o.toJSON())\n        };\n    }\n}\nCertificatePolicies.CLASS_NAME = \"CertificatePolicies\";\n\nconst TEMPLATE_ID = \"templateID\";\nconst TEMPLATE_MAJOR_VERSION = \"templateMajorVersion\";\nconst TEMPLATE_MINOR_VERSION = \"templateMinorVersion\";\nconst CLEAR_PROPS$1m = [\n    TEMPLATE_ID,\n    TEMPLATE_MAJOR_VERSION,\n    TEMPLATE_MINOR_VERSION\n];\nclass CertificateTemplate extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.templateID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TEMPLATE_ID, CertificateTemplate.defaultValues(TEMPLATE_ID));\n        if (TEMPLATE_MAJOR_VERSION in parameters) {\n            this.templateMajorVersion = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TEMPLATE_MAJOR_VERSION, CertificateTemplate.defaultValues(TEMPLATE_MAJOR_VERSION));\n        }\n        if (TEMPLATE_MINOR_VERSION in parameters) {\n            this.templateMinorVersion = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TEMPLATE_MINOR_VERSION, CertificateTemplate.defaultValues(TEMPLATE_MINOR_VERSION));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TEMPLATE_ID:\n                return EMPTY_STRING;\n            case TEMPLATE_MAJOR_VERSION:\n            case TEMPLATE_MINOR_VERSION:\n                return 0;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.templateID || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    name: (names.templateMajorVersion || EMPTY_STRING),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    name: (names.templateMinorVersion || EMPTY_STRING),\n                    optional: true\n                }),\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1m);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertificateTemplate.schema({\n            names: {\n                templateID: TEMPLATE_ID,\n                templateMajorVersion: TEMPLATE_MAJOR_VERSION,\n                templateMinorVersion: TEMPLATE_MINOR_VERSION\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.templateID = asn1.result.templateID.valueBlock.toString();\n        if (TEMPLATE_MAJOR_VERSION in asn1.result) {\n            this.templateMajorVersion = asn1.result.templateMajorVersion.valueBlock.valueDec;\n        }\n        if (TEMPLATE_MINOR_VERSION in asn1.result) {\n            this.templateMinorVersion = asn1.result.templateMinorVersion.valueBlock.valueDec;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.templateID }));\n        if (TEMPLATE_MAJOR_VERSION in this) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.templateMajorVersion }));\n        }\n        if (TEMPLATE_MINOR_VERSION in this) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.templateMinorVersion }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            templateID: this.templateID\n        };\n        if (TEMPLATE_MAJOR_VERSION in this)\n            res.templateMajorVersion = this.templateMajorVersion;\n        if (TEMPLATE_MINOR_VERSION in this)\n            res.templateMinorVersion = this.templateMinorVersion;\n        return res;\n    }\n}\n\nconst DISTRIBUTION_POINT$1 = \"distributionPoint\";\nconst DISTRIBUTION_POINT_NAMES$1 = \"distributionPointNames\";\nconst REASONS = \"reasons\";\nconst CRL_ISSUER = \"cRLIssuer\";\nconst CRL_ISSUER_NAMES = \"cRLIssuerNames\";\nconst CLEAR_PROPS$1l = [\n    DISTRIBUTION_POINT$1,\n    DISTRIBUTION_POINT_NAMES$1,\n    REASONS,\n    CRL_ISSUER,\n    CRL_ISSUER_NAMES,\n];\nclass DistributionPoint extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (DISTRIBUTION_POINT$1 in parameters) {\n            this.distributionPoint = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DISTRIBUTION_POINT$1, DistributionPoint.defaultValues(DISTRIBUTION_POINT$1));\n        }\n        if (REASONS in parameters) {\n            this.reasons = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REASONS, DistributionPoint.defaultValues(REASONS));\n        }\n        if (CRL_ISSUER in parameters) {\n            this.cRLIssuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRL_ISSUER, DistributionPoint.defaultValues(CRL_ISSUER));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case DISTRIBUTION_POINT$1:\n                return [];\n            case REASONS:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            case CRL_ISSUER:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    name: (names.distributionPoint || EMPTY_STRING),\n                                    optional: true,\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 0\n                                    },\n                                    value: [\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                            name: (names.distributionPointNames || EMPTY_STRING),\n                                            value: GeneralName.schema()\n                                        })\n                                    ]\n                                }),\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    name: (names.distributionPoint || EMPTY_STRING),\n                                    optional: true,\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 1\n                                    },\n                                    value: RelativeDistinguishedNames.schema().valueBlock.value\n                                })\n                            ]\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.reasons || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.cRLIssuer || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.cRLIssuerNames || EMPTY_STRING),\n                            value: GeneralName.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1l);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, DistributionPoint.schema({\n            names: {\n                distributionPoint: DISTRIBUTION_POINT$1,\n                distributionPointNames: DISTRIBUTION_POINT_NAMES$1,\n                reasons: REASONS,\n                cRLIssuer: CRL_ISSUER,\n                cRLIssuerNames: CRL_ISSUER_NAMES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (DISTRIBUTION_POINT$1 in asn1.result) {\n            if (asn1.result.distributionPoint.idBlock.tagNumber === 0) {\n                this.distributionPoint = Array.from(asn1.result.distributionPointNames, element => new GeneralName({ schema: element }));\n            }\n            if (asn1.result.distributionPoint.idBlock.tagNumber === 1) {\n                this.distributionPoint = new RelativeDistinguishedNames({\n                    schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: asn1.result.distributionPoint.valueBlock.value\n                    })\n                });\n            }\n        }\n        if (REASONS in asn1.result) {\n            this.reasons = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: asn1.result.reasons.valueBlock.valueHex });\n        }\n        if (CRL_ISSUER in asn1.result) {\n            this.cRLIssuer = Array.from(asn1.result.cRLIssuerNames, element => new GeneralName({ schema: element }));\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.distributionPoint) {\n            let internalValue;\n            if (this.distributionPoint instanceof Array) {\n                internalValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: Array.from(this.distributionPoint, o => o.toSchema())\n                });\n            }\n            else {\n                internalValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [this.distributionPoint.toSchema()]\n                });\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [internalValue]\n            }));\n        }\n        if (this.reasons) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                valueHex: this.reasons.valueBlock.valueHexView\n            }));\n        }\n        if (this.cRLIssuer) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                value: Array.from(this.cRLIssuer, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {};\n        if (this.distributionPoint) {\n            if (this.distributionPoint instanceof Array) {\n                object.distributionPoint = Array.from(this.distributionPoint, o => o.toJSON());\n            }\n            else {\n                object.distributionPoint = this.distributionPoint.toJSON();\n            }\n        }\n        if (this.reasons) {\n            object.reasons = this.reasons.toJSON();\n        }\n        if (this.cRLIssuer) {\n            object.cRLIssuer = Array.from(this.cRLIssuer, o => o.toJSON());\n        }\n        return object;\n    }\n}\nDistributionPoint.CLASS_NAME = \"DistributionPoint\";\n\nconst DISTRIBUTION_POINTS = \"distributionPoints\";\nconst CLEAR_PROPS$1k = [\n    DISTRIBUTION_POINTS\n];\nclass CRLDistributionPoints extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.distributionPoints = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DISTRIBUTION_POINTS, CRLDistributionPoints.defaultValues(DISTRIBUTION_POINTS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case DISTRIBUTION_POINTS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.distributionPoints || EMPTY_STRING),\n                    value: DistributionPoint.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1k);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CRLDistributionPoints.schema({\n            names: {\n                distributionPoints: DISTRIBUTION_POINTS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.distributionPoints = Array.from(asn1.result.distributionPoints, element => new DistributionPoint({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.distributionPoints, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            distributionPoints: Array.from(this.distributionPoints, o => o.toJSON())\n        };\n    }\n}\nCRLDistributionPoints.CLASS_NAME = \"CRLDistributionPoints\";\n\nconst KEY_PURPOSES = \"keyPurposes\";\nconst CLEAR_PROPS$1j = [\n    KEY_PURPOSES,\n];\nclass ExtKeyUsage extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.keyPurposes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_PURPOSES, ExtKeyUsage.defaultValues(KEY_PURPOSES));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_PURPOSES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.keyPurposes || EMPTY_STRING),\n                    value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1j);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ExtKeyUsage.schema({\n            names: {\n                keyPurposes: KEY_PURPOSES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.keyPurposes = Array.from(asn1.result.keyPurposes, (element) => element.valueBlock.toString());\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.keyPurposes, element => new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: element }))\n        }));\n    }\n    toJSON() {\n        return {\n            keyPurposes: Array.from(this.keyPurposes)\n        };\n    }\n}\nExtKeyUsage.CLASS_NAME = \"ExtKeyUsage\";\n\nconst ACCESS_DESCRIPTIONS = \"accessDescriptions\";\nclass InfoAccess extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.accessDescriptions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACCESS_DESCRIPTIONS, InfoAccess.defaultValues(ACCESS_DESCRIPTIONS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ACCESS_DESCRIPTIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.accessDescriptions || EMPTY_STRING),\n                    value: AccessDescription.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            ACCESS_DESCRIPTIONS\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, InfoAccess.schema({\n            names: {\n                accessDescriptions: ACCESS_DESCRIPTIONS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.accessDescriptions = Array.from(asn1.result.accessDescriptions, element => new AccessDescription({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.accessDescriptions, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            accessDescriptions: Array.from(this.accessDescriptions, o => o.toJSON())\n        };\n    }\n}\nInfoAccess.CLASS_NAME = \"InfoAccess\";\n\nconst DISTRIBUTION_POINT = \"distributionPoint\";\nconst DISTRIBUTION_POINT_NAMES = \"distributionPointNames\";\nconst ONLY_CONTAINS_USER_CERTS = \"onlyContainsUserCerts\";\nconst ONLY_CONTAINS_CA_CERTS = \"onlyContainsCACerts\";\nconst ONLY_SOME_REASON = \"onlySomeReasons\";\nconst INDIRECT_CRL = \"indirectCRL\";\nconst ONLY_CONTAINS_ATTRIBUTE_CERTS = \"onlyContainsAttributeCerts\";\nconst CLEAR_PROPS$1i = [\n    DISTRIBUTION_POINT,\n    DISTRIBUTION_POINT_NAMES,\n    ONLY_CONTAINS_USER_CERTS,\n    ONLY_CONTAINS_CA_CERTS,\n    ONLY_SOME_REASON,\n    INDIRECT_CRL,\n    ONLY_CONTAINS_ATTRIBUTE_CERTS,\n];\nclass IssuingDistributionPoint extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (DISTRIBUTION_POINT in parameters) {\n            this.distributionPoint = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DISTRIBUTION_POINT, IssuingDistributionPoint.defaultValues(DISTRIBUTION_POINT));\n        }\n        this.onlyContainsUserCerts = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ONLY_CONTAINS_USER_CERTS, IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_USER_CERTS));\n        this.onlyContainsCACerts = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ONLY_CONTAINS_CA_CERTS, IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_CA_CERTS));\n        if (ONLY_SOME_REASON in parameters) {\n            this.onlySomeReasons = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ONLY_SOME_REASON, IssuingDistributionPoint.defaultValues(ONLY_SOME_REASON));\n        }\n        this.indirectCRL = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, INDIRECT_CRL, IssuingDistributionPoint.defaultValues(INDIRECT_CRL));\n        this.onlyContainsAttributeCerts = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ONLY_CONTAINS_ATTRIBUTE_CERTS, IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_ATTRIBUTE_CERTS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case DISTRIBUTION_POINT:\n                return [];\n            case ONLY_CONTAINS_USER_CERTS:\n                return false;\n            case ONLY_CONTAINS_CA_CERTS:\n                return false;\n            case ONLY_SOME_REASON:\n                return 0;\n            case INDIRECT_CRL:\n                return false;\n            case ONLY_CONTAINS_ATTRIBUTE_CERTS:\n                return false;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    name: (names.distributionPoint || EMPTY_STRING),\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 0\n                                    },\n                                    value: [\n                                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                            name: (names.distributionPointNames || EMPTY_STRING),\n                                            value: GeneralName.schema()\n                                        })\n                                    ]\n                                }),\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    name: (names.distributionPoint || EMPTY_STRING),\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 1\n                                    },\n                                    value: RelativeDistinguishedNames.schema().valueBlock.value\n                                })\n                            ]\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.onlyContainsUserCerts || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.onlyContainsCACerts || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.onlySomeReasons || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 3\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.indirectCRL || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 4\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.onlyContainsAttributeCerts || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 5\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1i);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, IssuingDistributionPoint.schema({\n            names: {\n                distributionPoint: DISTRIBUTION_POINT,\n                distributionPointNames: DISTRIBUTION_POINT_NAMES,\n                onlyContainsUserCerts: ONLY_CONTAINS_USER_CERTS,\n                onlyContainsCACerts: ONLY_CONTAINS_CA_CERTS,\n                onlySomeReasons: ONLY_SOME_REASON,\n                indirectCRL: INDIRECT_CRL,\n                onlyContainsAttributeCerts: ONLY_CONTAINS_ATTRIBUTE_CERTS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (DISTRIBUTION_POINT in asn1.result) {\n            switch (true) {\n                case (asn1.result.distributionPoint.idBlock.tagNumber === 0):\n                    this.distributionPoint = Array.from(asn1.result.distributionPointNames, element => new GeneralName({ schema: element }));\n                    break;\n                case (asn1.result.distributionPoint.idBlock.tagNumber === 1):\n                    {\n                        this.distributionPoint = new RelativeDistinguishedNames({\n                            schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                                value: asn1.result.distributionPoint.valueBlock.value\n                            })\n                        });\n                    }\n                    break;\n                default:\n                    throw new Error(\"Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}\");\n            }\n        }\n        if (ONLY_CONTAINS_USER_CERTS in asn1.result) {\n            const view = new Uint8Array(asn1.result.onlyContainsUserCerts.valueBlock.valueHex);\n            this.onlyContainsUserCerts = (view[0] !== 0x00);\n        }\n        if (ONLY_CONTAINS_CA_CERTS in asn1.result) {\n            const view = new Uint8Array(asn1.result.onlyContainsCACerts.valueBlock.valueHex);\n            this.onlyContainsCACerts = (view[0] !== 0x00);\n        }\n        if (ONLY_SOME_REASON in asn1.result) {\n            const view = new Uint8Array(asn1.result.onlySomeReasons.valueBlock.valueHex);\n            this.onlySomeReasons = view[0];\n        }\n        if (INDIRECT_CRL in asn1.result) {\n            const view = new Uint8Array(asn1.result.indirectCRL.valueBlock.valueHex);\n            this.indirectCRL = (view[0] !== 0x00);\n        }\n        if (ONLY_CONTAINS_ATTRIBUTE_CERTS in asn1.result) {\n            const view = new Uint8Array(asn1.result.onlyContainsAttributeCerts.valueBlock.valueHex);\n            this.onlyContainsAttributeCerts = (view[0] !== 0x00);\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.distributionPoint) {\n            let value;\n            if (this.distributionPoint instanceof Array) {\n                value = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: Array.from(this.distributionPoint, o => o.toSchema())\n                });\n            }\n            else {\n                value = this.distributionPoint.toSchema();\n                value.idBlock.tagClass = 3;\n                value.idBlock.tagNumber = 1;\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [value]\n            }));\n        }\n        if (this.onlyContainsUserCerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_USER_CERTS)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                valueHex: (new Uint8Array([0xFF])).buffer\n            }));\n        }\n        if (this.onlyContainsCACerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_CA_CERTS)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                valueHex: (new Uint8Array([0xFF])).buffer\n            }));\n        }\n        if (this.onlySomeReasons !== undefined) {\n            const buffer = new ArrayBuffer(1);\n            const view = new Uint8Array(buffer);\n            view[0] = this.onlySomeReasons;\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 3\n                },\n                valueHex: buffer\n            }));\n        }\n        if (this.indirectCRL !== IssuingDistributionPoint.defaultValues(INDIRECT_CRL)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 4\n                },\n                valueHex: (new Uint8Array([0xFF])).buffer\n            }));\n        }\n        if (this.onlyContainsAttributeCerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_ATTRIBUTE_CERTS)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 5\n                },\n                valueHex: (new Uint8Array([0xFF])).buffer\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const obj = {};\n        if (this.distributionPoint) {\n            if (this.distributionPoint instanceof Array) {\n                obj.distributionPoint = Array.from(this.distributionPoint, o => o.toJSON());\n            }\n            else {\n                obj.distributionPoint = this.distributionPoint.toJSON();\n            }\n        }\n        if (this.onlyContainsUserCerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_USER_CERTS)) {\n            obj.onlyContainsUserCerts = this.onlyContainsUserCerts;\n        }\n        if (this.onlyContainsCACerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_CA_CERTS)) {\n            obj.onlyContainsCACerts = this.onlyContainsCACerts;\n        }\n        if (ONLY_SOME_REASON in this) {\n            obj.onlySomeReasons = this.onlySomeReasons;\n        }\n        if (this.indirectCRL !== IssuingDistributionPoint.defaultValues(INDIRECT_CRL)) {\n            obj.indirectCRL = this.indirectCRL;\n        }\n        if (this.onlyContainsAttributeCerts !== IssuingDistributionPoint.defaultValues(ONLY_CONTAINS_ATTRIBUTE_CERTS)) {\n            obj.onlyContainsAttributeCerts = this.onlyContainsAttributeCerts;\n        }\n        return obj;\n    }\n}\nIssuingDistributionPoint.CLASS_NAME = \"IssuingDistributionPoint\";\n\nconst BASE = \"base\";\nconst MINIMUM = \"minimum\";\nconst MAXIMUM = \"maximum\";\nconst CLEAR_PROPS$1h = [\n    BASE,\n    MINIMUM,\n    MAXIMUM\n];\nclass GeneralSubtree extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.base = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BASE, GeneralSubtree.defaultValues(BASE));\n        this.minimum = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MINIMUM, GeneralSubtree.defaultValues(MINIMUM));\n        if (MAXIMUM in parameters) {\n            this.maximum = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MAXIMUM, GeneralSubtree.defaultValues(MAXIMUM));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case BASE:\n                return new GeneralName();\n            case MINIMUM:\n                return 0;\n            case MAXIMUM:\n                return 0;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                GeneralName.schema(names.base || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.minimum || EMPTY_STRING) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.maximum || EMPTY_STRING) })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1h);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, GeneralSubtree.schema({\n            names: {\n                base: {\n                    names: {\n                        blockName: BASE\n                    }\n                },\n                minimum: MINIMUM,\n                maximum: MAXIMUM\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.base = new GeneralName({ schema: asn1.result.base });\n        if (MINIMUM in asn1.result) {\n            if (asn1.result.minimum.valueBlock.isHexOnly)\n                this.minimum = asn1.result.minimum;\n            else\n                this.minimum = asn1.result.minimum.valueBlock.valueDec;\n        }\n        if (MAXIMUM in asn1.result) {\n            if (asn1.result.maximum.valueBlock.isHexOnly)\n                this.maximum = asn1.result.maximum;\n            else\n                this.maximum = asn1.result.maximum.valueBlock.valueDec;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.base.toSchema());\n        if (this.minimum !== 0) {\n            let valueMinimum = 0;\n            if (this.minimum instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer) {\n                valueMinimum = this.minimum;\n            }\n            else {\n                valueMinimum = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.minimum });\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [valueMinimum]\n            }));\n        }\n        if (MAXIMUM in this) {\n            let valueMaximum = 0;\n            if (this.maximum instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer) {\n                valueMaximum = this.maximum;\n            }\n            else {\n                valueMaximum = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.maximum });\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [valueMaximum]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            base: this.base.toJSON()\n        };\n        if (this.minimum !== 0) {\n            if (typeof this.minimum === \"number\") {\n                res.minimum = this.minimum;\n            }\n            else {\n                res.minimum = this.minimum.toJSON();\n            }\n        }\n        if (this.maximum !== undefined) {\n            if (typeof this.maximum === \"number\") {\n                res.maximum = this.maximum;\n            }\n            else {\n                res.maximum = this.maximum.toJSON();\n            }\n        }\n        return res;\n    }\n}\nGeneralSubtree.CLASS_NAME = \"GeneralSubtree\";\n\nconst PERMITTED_SUBTREES = \"permittedSubtrees\";\nconst EXCLUDED_SUBTREES = \"excludedSubtrees\";\nconst CLEAR_PROPS$1g = [\n    PERMITTED_SUBTREES,\n    EXCLUDED_SUBTREES\n];\nclass NameConstraints extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (PERMITTED_SUBTREES in parameters) {\n            this.permittedSubtrees = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PERMITTED_SUBTREES, NameConstraints.defaultValues(PERMITTED_SUBTREES));\n        }\n        if (EXCLUDED_SUBTREES in parameters) {\n            this.excludedSubtrees = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXCLUDED_SUBTREES, NameConstraints.defaultValues(EXCLUDED_SUBTREES));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case PERMITTED_SUBTREES:\n            case EXCLUDED_SUBTREES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.permittedSubtrees || EMPTY_STRING),\n                            value: GeneralSubtree.schema()\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.excludedSubtrees || EMPTY_STRING),\n                            value: GeneralSubtree.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1g);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, NameConstraints.schema({\n            names: {\n                permittedSubtrees: PERMITTED_SUBTREES,\n                excludedSubtrees: EXCLUDED_SUBTREES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (PERMITTED_SUBTREES in asn1.result)\n            this.permittedSubtrees = Array.from(asn1.result.permittedSubtrees, element => new GeneralSubtree({ schema: element }));\n        if (EXCLUDED_SUBTREES in asn1.result)\n            this.excludedSubtrees = Array.from(asn1.result.excludedSubtrees, element => new GeneralSubtree({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.permittedSubtrees) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: Array.from(this.permittedSubtrees, o => o.toSchema())\n            }));\n        }\n        if (this.excludedSubtrees) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.excludedSubtrees, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {};\n        if (this.permittedSubtrees) {\n            object.permittedSubtrees = Array.from(this.permittedSubtrees, o => o.toJSON());\n        }\n        if (this.excludedSubtrees) {\n            object.excludedSubtrees = Array.from(this.excludedSubtrees, o => o.toJSON());\n        }\n        return object;\n    }\n}\nNameConstraints.CLASS_NAME = \"NameConstraints\";\n\nconst REQUIRE_EXPLICIT_POLICY = \"requireExplicitPolicy\";\nconst INHIBIT_POLICY_MAPPING = \"inhibitPolicyMapping\";\nconst CLEAR_PROPS$1f = [\n    REQUIRE_EXPLICIT_POLICY,\n    INHIBIT_POLICY_MAPPING,\n];\nclass PolicyConstraints extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (REQUIRE_EXPLICIT_POLICY in parameters) {\n            this.requireExplicitPolicy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQUIRE_EXPLICIT_POLICY, PolicyConstraints.defaultValues(REQUIRE_EXPLICIT_POLICY));\n        }\n        if (INHIBIT_POLICY_MAPPING in parameters) {\n            this.inhibitPolicyMapping = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, INHIBIT_POLICY_MAPPING, PolicyConstraints.defaultValues(INHIBIT_POLICY_MAPPING));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case REQUIRE_EXPLICIT_POLICY:\n                return 0;\n            case INHIBIT_POLICY_MAPPING:\n                return 0;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.requireExplicitPolicy || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.inhibitPolicyMapping || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1f);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PolicyConstraints.schema({\n            names: {\n                requireExplicitPolicy: REQUIRE_EXPLICIT_POLICY,\n                inhibitPolicyMapping: INHIBIT_POLICY_MAPPING\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (REQUIRE_EXPLICIT_POLICY in asn1.result) {\n            const field1 = asn1.result.requireExplicitPolicy;\n            field1.idBlock.tagClass = 1;\n            field1.idBlock.tagNumber = 2;\n            const ber1 = field1.toBER(false);\n            const int1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(ber1);\n            AsnError.assert(int1, \"Integer\");\n            this.requireExplicitPolicy = int1.result.valueBlock.valueDec;\n        }\n        if (INHIBIT_POLICY_MAPPING in asn1.result) {\n            const field2 = asn1.result.inhibitPolicyMapping;\n            field2.idBlock.tagClass = 1;\n            field2.idBlock.tagNumber = 2;\n            const ber2 = field2.toBER(false);\n            const int2 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(ber2);\n            AsnError.assert(int2, \"Integer\");\n            this.inhibitPolicyMapping = int2.result.valueBlock.valueDec;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (REQUIRE_EXPLICIT_POLICY in this) {\n            const int1 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.requireExplicitPolicy });\n            int1.idBlock.tagClass = 3;\n            int1.idBlock.tagNumber = 0;\n            outputArray.push(int1);\n        }\n        if (INHIBIT_POLICY_MAPPING in this) {\n            const int2 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.inhibitPolicyMapping });\n            int2.idBlock.tagClass = 3;\n            int2.idBlock.tagNumber = 1;\n            outputArray.push(int2);\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {};\n        if (REQUIRE_EXPLICIT_POLICY in this) {\n            res.requireExplicitPolicy = this.requireExplicitPolicy;\n        }\n        if (INHIBIT_POLICY_MAPPING in this) {\n            res.inhibitPolicyMapping = this.inhibitPolicyMapping;\n        }\n        return res;\n    }\n}\nPolicyConstraints.CLASS_NAME = \"PolicyConstraints\";\n\nconst ISSUER_DOMAIN_POLICY = \"issuerDomainPolicy\";\nconst SUBJECT_DOMAIN_POLICY = \"subjectDomainPolicy\";\nconst CLEAR_PROPS$1e = [\n    ISSUER_DOMAIN_POLICY,\n    SUBJECT_DOMAIN_POLICY\n];\nclass PolicyMapping extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.issuerDomainPolicy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_DOMAIN_POLICY, PolicyMapping.defaultValues(ISSUER_DOMAIN_POLICY));\n        this.subjectDomainPolicy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_DOMAIN_POLICY, PolicyMapping.defaultValues(SUBJECT_DOMAIN_POLICY));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ISSUER_DOMAIN_POLICY:\n                return EMPTY_STRING;\n            case SUBJECT_DOMAIN_POLICY:\n                return EMPTY_STRING;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.issuerDomainPolicy || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.subjectDomainPolicy || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1e);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PolicyMapping.schema({\n            names: {\n                issuerDomainPolicy: ISSUER_DOMAIN_POLICY,\n                subjectDomainPolicy: SUBJECT_DOMAIN_POLICY\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.issuerDomainPolicy = asn1.result.issuerDomainPolicy.valueBlock.toString();\n        this.subjectDomainPolicy = asn1.result.subjectDomainPolicy.valueBlock.toString();\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.issuerDomainPolicy }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.subjectDomainPolicy })\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            issuerDomainPolicy: this.issuerDomainPolicy,\n            subjectDomainPolicy: this.subjectDomainPolicy\n        };\n    }\n}\nPolicyMapping.CLASS_NAME = \"PolicyMapping\";\n\nconst MAPPINGS = \"mappings\";\nconst CLEAR_PROPS$1d = [\n    MAPPINGS,\n];\nclass PolicyMappings extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.mappings = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MAPPINGS, PolicyMappings.defaultValues(MAPPINGS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case MAPPINGS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.mappings || EMPTY_STRING),\n                    value: PolicyMapping.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1d);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PolicyMappings.schema({\n            names: {\n                mappings: MAPPINGS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.mappings = Array.from(asn1.result.mappings, element => new PolicyMapping({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.mappings, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            mappings: Array.from(this.mappings, o => o.toJSON())\n        };\n    }\n}\nPolicyMappings.CLASS_NAME = \"PolicyMappings\";\n\nconst NOT_BEFORE$1 = \"notBefore\";\nconst NOT_AFTER$1 = \"notAfter\";\nconst CLEAR_PROPS$1c = [\n    NOT_BEFORE$1,\n    NOT_AFTER$1\n];\nclass PrivateKeyUsagePeriod extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (NOT_BEFORE$1 in parameters) {\n            this.notBefore = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_BEFORE$1, PrivateKeyUsagePeriod.defaultValues(NOT_BEFORE$1));\n        }\n        if (NOT_AFTER$1 in parameters) {\n            this.notAfter = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_AFTER$1, PrivateKeyUsagePeriod.defaultValues(NOT_AFTER$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case NOT_BEFORE$1:\n                return new Date();\n            case NOT_AFTER$1:\n                return new Date();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.notBefore || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.notAfter || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1c);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PrivateKeyUsagePeriod.schema({\n            names: {\n                notBefore: NOT_BEFORE$1,\n                notAfter: NOT_AFTER$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (NOT_BEFORE$1 in asn1.result) {\n            const localNotBefore = new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime();\n            localNotBefore.fromBuffer(asn1.result.notBefore.valueBlock.valueHex);\n            this.notBefore = localNotBefore.toDate();\n        }\n        if (NOT_AFTER$1 in asn1.result) {\n            const localNotAfter = new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueHex: asn1.result.notAfter.valueBlock.valueHex });\n            localNotAfter.fromBuffer(asn1.result.notAfter.valueBlock.valueHex);\n            this.notAfter = localNotAfter.toDate();\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        if (NOT_BEFORE$1 in this) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                valueHex: (new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.notBefore })).valueBlock.valueHexView\n            }));\n        }\n        if (NOT_AFTER$1 in this) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                valueHex: (new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.notAfter })).valueBlock.valueHexView\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {};\n        if (this.notBefore) {\n            res.notBefore = this.notBefore;\n        }\n        if (this.notAfter) {\n            res.notAfter = this.notAfter;\n        }\n        return res;\n    }\n}\nPrivateKeyUsagePeriod.CLASS_NAME = \"PrivateKeyUsagePeriod\";\n\nconst ID = \"id\";\nconst TYPE$2 = \"type\";\nconst VALUES = \"values\";\nconst QC_STATEMENT_CLEAR_PROPS = [\n    ID,\n    TYPE$2\n];\nconst QC_STATEMENTS_CLEAR_PROPS = [\n    VALUES\n];\nclass QCStatement extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.id = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ID, QCStatement.defaultValues(ID));\n        if (TYPE$2 in parameters) {\n            this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE$2, QCStatement.defaultValues(TYPE$2));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ID:\n                return EMPTY_STRING;\n            case TYPE$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ID:\n                return (memberValue === EMPTY_STRING);\n            case TYPE$2:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Null);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.id || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({\n                    name: (names.type || EMPTY_STRING),\n                    optional: true\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, QC_STATEMENT_CLEAR_PROPS);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, QCStatement.schema({\n            names: {\n                id: ID,\n                type: TYPE$2\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.id = asn1.result.id.valueBlock.toString();\n        if (TYPE$2 in asn1.result)\n            this.type = asn1.result.type;\n    }\n    toSchema() {\n        const value = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.id })\n        ];\n        if (TYPE$2 in this)\n            value.push(this.type);\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value,\n        }));\n    }\n    toJSON() {\n        const object = {\n            id: this.id\n        };\n        if (this.type) {\n            object.type = this.type.toJSON();\n        }\n        return object;\n    }\n}\nQCStatement.CLASS_NAME = \"QCStatement\";\nclass QCStatements extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.values = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUES, QCStatements.defaultValues(VALUES));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VALUES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VALUES:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.values || EMPTY_STRING),\n                    value: QCStatement.schema(names.value || {})\n                }),\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, QC_STATEMENTS_CLEAR_PROPS);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, QCStatements.schema({\n            names: {\n                values: VALUES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.values = Array.from(asn1.result.values, element => new QCStatement({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.values, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            values: Array.from(this.values, o => o.toJSON())\n        };\n    }\n}\nQCStatements.CLASS_NAME = \"QCStatements\";\n\nvar _a;\nclass ECNamedCurves {\n    static register(name, id, size) {\n        this.namedCurves[name.toLowerCase()] = this.namedCurves[id] = { name, id, size };\n    }\n    static find(nameOrId) {\n        return this.namedCurves[nameOrId.toLowerCase()] || null;\n    }\n}\n_a = ECNamedCurves;\nECNamedCurves.namedCurves = {};\n(() => {\n    _a.register(\"P-256\", \"1.2.840.10045.3.1.7\", 32);\n    _a.register(\"P-384\", \"1.3.132.0.34\", 48);\n    _a.register(\"P-521\", \"1.3.132.0.35\", 66);\n    _a.register(\"brainpoolP256r1\", \"1.3.36.3.3.2.8.1.1.7\", 32);\n    _a.register(\"brainpoolP384r1\", \"1.3.36.3.3.2.8.1.1.11\", 48);\n    _a.register(\"brainpoolP512r1\", \"1.3.36.3.3.2.8.1.1.13\", 64);\n})();\n\nconst X = \"x\";\nconst Y = \"y\";\nconst NAMED_CURVE$1 = \"namedCurve\";\nclass ECPublicKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.x = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, X, ECPublicKey.defaultValues(X));\n        this.y = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, Y, ECPublicKey.defaultValues(Y));\n        this.namedCurve = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NAMED_CURVE$1, ECPublicKey.defaultValues(NAMED_CURVE$1));\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case X:\n            case Y:\n                return EMPTY_BUFFER;\n            case NAMED_CURVE$1:\n                return EMPTY_STRING;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case X:\n            case Y:\n                return memberValue instanceof ArrayBuffer &&\n                    (pvutils__WEBPACK_IMPORTED_MODULE_2__.isEqualBuffer(memberValue, ECPublicKey.defaultValues(memberName)));\n            case NAMED_CURVE$1:\n                return typeof memberValue === \"string\" &&\n                    memberValue === ECPublicKey.defaultValues(memberName);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema() {\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.RawData();\n    }\n    fromSchema(schema1) {\n        const view = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toUint8Array(schema1);\n        if (view[0] !== 0x04) {\n            throw new Error(\"Object's schema was not verified against input data for ECPublicKey\");\n        }\n        const namedCurve = ECNamedCurves.find(this.namedCurve);\n        if (!namedCurve) {\n            throw new Error(`Incorrect curve OID: ${this.namedCurve}`);\n        }\n        const coordinateLength = namedCurve.size;\n        if (view.byteLength !== (coordinateLength * 2 + 1)) {\n            throw new Error(\"Object's schema was not verified against input data for ECPublicKey\");\n        }\n        this.namedCurve = namedCurve.name;\n        this.x = view.slice(1, coordinateLength + 1).buffer;\n        this.y = view.slice(1 + coordinateLength, coordinateLength * 2 + 1).buffer;\n    }\n    toSchema() {\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.RawData({\n            data: pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf((new Uint8Array([0x04])).buffer, this.x, this.y)\n        });\n    }\n    toJSON() {\n        const namedCurve = ECNamedCurves.find(this.namedCurve);\n        return {\n            crv: namedCurve ? namedCurve.name : this.namedCurve,\n            x: pvutils__WEBPACK_IMPORTED_MODULE_2__.toBase64(pvutils__WEBPACK_IMPORTED_MODULE_2__.arrayBufferToString(this.x), true, true, false),\n            y: pvutils__WEBPACK_IMPORTED_MODULE_2__.toBase64(pvutils__WEBPACK_IMPORTED_MODULE_2__.arrayBufferToString(this.y), true, true, false)\n        };\n    }\n    fromJSON(json) {\n        ParameterError.assert(\"json\", json, \"crv\", \"x\", \"y\");\n        let coordinateLength = 0;\n        const namedCurve = ECNamedCurves.find(json.crv);\n        if (namedCurve) {\n            this.namedCurve = namedCurve.id;\n            coordinateLength = namedCurve.size;\n        }\n        const xConvertBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(pvutils__WEBPACK_IMPORTED_MODULE_2__.fromBase64(json.x, true));\n        if (xConvertBuffer.byteLength < coordinateLength) {\n            this.x = new ArrayBuffer(coordinateLength);\n            const view = new Uint8Array(this.x);\n            const convertBufferView = new Uint8Array(xConvertBuffer);\n            view.set(convertBufferView, 1);\n        }\n        else {\n            this.x = xConvertBuffer.slice(0, coordinateLength);\n        }\n        const yConvertBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(pvutils__WEBPACK_IMPORTED_MODULE_2__.fromBase64(json.y, true));\n        if (yConvertBuffer.byteLength < coordinateLength) {\n            this.y = new ArrayBuffer(coordinateLength);\n            const view = new Uint8Array(this.y);\n            const convertBufferView = new Uint8Array(yConvertBuffer);\n            view.set(convertBufferView, 1);\n        }\n        else {\n            this.y = yConvertBuffer.slice(0, coordinateLength);\n        }\n    }\n}\nECPublicKey.CLASS_NAME = \"ECPublicKey\";\n\nconst MODULUS$1 = \"modulus\";\nconst PUBLIC_EXPONENT$1 = \"publicExponent\";\nconst CLEAR_PROPS$1b = [MODULUS$1, PUBLIC_EXPONENT$1];\nclass RSAPublicKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.modulus = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MODULUS$1, RSAPublicKey.defaultValues(MODULUS$1));\n        this.publicExponent = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PUBLIC_EXPONENT$1, RSAPublicKey.defaultValues(PUBLIC_EXPONENT$1));\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case MODULUS$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case PUBLIC_EXPONENT$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.modulus || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.publicExponent || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1b);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RSAPublicKey.schema({\n            names: {\n                modulus: MODULUS$1,\n                publicExponent: PUBLIC_EXPONENT$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.modulus = asn1.result.modulus.convertFromDER(256);\n        this.publicExponent = asn1.result.publicExponent;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.modulus.convertToDER(),\n                this.publicExponent\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            n: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.modulus.valueBlock.valueHexView),\n            e: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.publicExponent.valueBlock.valueHexView),\n        };\n    }\n    fromJSON(json) {\n        ParameterError.assert(\"json\", json, \"n\", \"e\");\n        const array = pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(pvutils__WEBPACK_IMPORTED_MODULE_2__.fromBase64(json.n, true));\n        this.modulus = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: array.slice(0, Math.pow(2, pvutils__WEBPACK_IMPORTED_MODULE_2__.nearestPowerOf2(array.byteLength))) });\n        this.publicExponent = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(pvutils__WEBPACK_IMPORTED_MODULE_2__.fromBase64(json.e, true)).slice(0, 3) });\n    }\n}\nRSAPublicKey.CLASS_NAME = \"RSAPublicKey\";\n\nconst ALGORITHM$1 = \"algorithm\";\nconst SUBJECT_PUBLIC_KEY = \"subjectPublicKey\";\nconst CLEAR_PROPS$1a = [ALGORITHM$1, SUBJECT_PUBLIC_KEY];\nclass PublicKeyInfo extends PkiObject {\n    get parsedKey() {\n        if (this._parsedKey === undefined) {\n            switch (this.algorithm.algorithmId) {\n                case \"1.2.840.10045.2.1\":\n                    if (\"algorithmParams\" in this.algorithm) {\n                        if (this.algorithm.algorithmParams.constructor.blockName() === asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier.blockName()) {\n                            try {\n                                this._parsedKey = new ECPublicKey({\n                                    namedCurve: this.algorithm.algorithmParams.valueBlock.toString(),\n                                    schema: this.subjectPublicKey.valueBlock.valueHexView\n                                });\n                            }\n                            catch (ex) {\n                            }\n                        }\n                    }\n                    break;\n                case \"1.2.840.113549.1.1.1\":\n                    {\n                        const publicKeyASN1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.subjectPublicKey.valueBlock.valueHexView);\n                        if (publicKeyASN1.offset !== -1) {\n                            try {\n                                this._parsedKey = new RSAPublicKey({ schema: publicKeyASN1.result });\n                            }\n                            catch (ex) {\n                            }\n                        }\n                    }\n                    break;\n            }\n            this._parsedKey || (this._parsedKey = null);\n        }\n        return this._parsedKey || undefined;\n    }\n    set parsedKey(value) {\n        this._parsedKey = value;\n    }\n    constructor(parameters = {}) {\n        super();\n        this.algorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ALGORITHM$1, PublicKeyInfo.defaultValues(ALGORITHM$1));\n        this.subjectPublicKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_PUBLIC_KEY, PublicKeyInfo.defaultValues(SUBJECT_PUBLIC_KEY));\n        const parsedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"parsedKey\", null);\n        if (parsedKey) {\n            this.parsedKey = parsedKey;\n        }\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ALGORITHM$1:\n                return new AlgorithmIdentifier();\n            case SUBJECT_PUBLIC_KEY:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.algorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.subjectPublicKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1a);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PublicKeyInfo.schema({\n            names: {\n                algorithm: {\n                    names: {\n                        blockName: ALGORITHM$1\n                    }\n                },\n                subjectPublicKey: SUBJECT_PUBLIC_KEY\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.algorithm = new AlgorithmIdentifier({ schema: asn1.result.algorithm });\n        this.subjectPublicKey = asn1.result.subjectPublicKey;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.algorithm.toSchema(),\n                this.subjectPublicKey\n            ]\n        }));\n    }\n    toJSON() {\n        if (!this.parsedKey) {\n            return {\n                algorithm: this.algorithm.toJSON(),\n                subjectPublicKey: this.subjectPublicKey.toJSON(),\n            };\n        }\n        const jwk = {};\n        switch (this.algorithm.algorithmId) {\n            case \"1.2.840.10045.2.1\":\n                jwk.kty = \"EC\";\n                break;\n            case \"1.2.840.113549.1.1.1\":\n                jwk.kty = \"RSA\";\n                break;\n        }\n        const publicKeyJWK = this.parsedKey.toJSON();\n        Object.assign(jwk, publicKeyJWK);\n        return jwk;\n    }\n    fromJSON(json) {\n        if (\"kty\" in json) {\n            switch (json.kty.toUpperCase()) {\n                case \"EC\":\n                    this.parsedKey = new ECPublicKey({ json });\n                    this.algorithm = new AlgorithmIdentifier({\n                        algorithmId: \"1.2.840.10045.2.1\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.parsedKey.namedCurve })\n                    });\n                    break;\n                case \"RSA\":\n                    this.parsedKey = new RSAPublicKey({ json });\n                    this.algorithm = new AlgorithmIdentifier({\n                        algorithmId: \"1.2.840.113549.1.1.1\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                    });\n                    break;\n                default:\n                    throw new Error(`Invalid value for \"kty\" parameter: ${json.kty}`);\n            }\n            this.subjectPublicKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: this.parsedKey.toSchema().toBER(false) });\n        }\n    }\n    async importKey(publicKey, crypto = getCrypto(true)) {\n        try {\n            if (!publicKey) {\n                throw new Error(\"Need to provide publicKey input parameter\");\n            }\n            const exportedKey = await crypto.exportKey(\"spki\", publicKey);\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(exportedKey);\n            try {\n                this.fromSchema(asn1.result);\n            }\n            catch (exception) {\n                throw new Error(\"Error during initializing object from schema\");\n            }\n        }\n        catch (e) {\n            const message = e instanceof Error ? e.message : `${e}`;\n            throw new Error(`Error during exporting public key: ${message}`);\n        }\n    }\n}\nPublicKeyInfo.CLASS_NAME = \"PublicKeyInfo\";\n\nconst VERSION$l = \"version\";\nconst PRIVATE_KEY$1 = \"privateKey\";\nconst NAMED_CURVE = \"namedCurve\";\nconst PUBLIC_KEY$1 = \"publicKey\";\nconst CLEAR_PROPS$19 = [\n    VERSION$l,\n    PRIVATE_KEY$1,\n    NAMED_CURVE,\n    PUBLIC_KEY$1\n];\nclass ECPrivateKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$l, ECPrivateKey.defaultValues(VERSION$l));\n        this.privateKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIVATE_KEY$1, ECPrivateKey.defaultValues(PRIVATE_KEY$1));\n        if (NAMED_CURVE in parameters) {\n            this.namedCurve = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NAMED_CURVE, ECPrivateKey.defaultValues(NAMED_CURVE));\n        }\n        if (PUBLIC_KEY$1 in parameters) {\n            this.publicKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PUBLIC_KEY$1, ECPrivateKey.defaultValues(PUBLIC_KEY$1));\n        }\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$l:\n                return 1;\n            case PRIVATE_KEY$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case NAMED_CURVE:\n                return EMPTY_STRING;\n            case PUBLIC_KEY$1:\n                return new ECPublicKey();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$l:\n                return (memberValue === ECPrivateKey.defaultValues(memberName));\n            case PRIVATE_KEY$1:\n                return (memberValue.isEqual(ECPrivateKey.defaultValues(memberName)));\n            case NAMED_CURVE:\n                return (memberValue === EMPTY_STRING);\n            case PUBLIC_KEY$1:\n                return ((ECPublicKey.compareWithDefault(NAMED_CURVE, memberValue.namedCurve)) &&\n                    (ECPublicKey.compareWithDefault(\"x\", memberValue.x)) &&\n                    (ECPublicKey.compareWithDefault(\"y\", memberValue.y)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.privateKey || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.namedCurve || EMPTY_STRING) })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.publicKey || EMPTY_STRING) })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$19);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ECPrivateKey.schema({\n            names: {\n                version: VERSION$l,\n                privateKey: PRIVATE_KEY$1,\n                namedCurve: NAMED_CURVE,\n                publicKey: PUBLIC_KEY$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.privateKey = asn1.result.privateKey;\n        if (NAMED_CURVE in asn1.result) {\n            this.namedCurve = asn1.result.namedCurve.valueBlock.toString();\n        }\n        if (PUBLIC_KEY$1 in asn1.result) {\n            const publicKeyData = { schema: asn1.result.publicKey.valueBlock.valueHex };\n            if (NAMED_CURVE in this) {\n                publicKeyData.namedCurve = this.namedCurve;\n            }\n            this.publicKey = new ECPublicKey(publicKeyData);\n        }\n    }\n    toSchema() {\n        const outputArray = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n            this.privateKey\n        ];\n        if (this.namedCurve) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.namedCurve })\n                ]\n            }));\n        }\n        if (this.publicKey) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: this.publicKey.toSchema().toBER(false) })\n                ]\n            }));\n        }\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        });\n    }\n    toJSON() {\n        if (!this.namedCurve || ECPrivateKey.compareWithDefault(NAMED_CURVE, this.namedCurve)) {\n            throw new Error(\"Not enough information for making JSON: absent \\\"namedCurve\\\" value\");\n        }\n        const curve = ECNamedCurves.find(this.namedCurve);\n        const privateKeyJSON = {\n            crv: curve ? curve.name : this.namedCurve,\n            d: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.privateKey.valueBlock.valueHexView),\n        };\n        if (this.publicKey) {\n            const publicKeyJSON = this.publicKey.toJSON();\n            privateKeyJSON.x = publicKeyJSON.x;\n            privateKeyJSON.y = publicKeyJSON.y;\n        }\n        return privateKeyJSON;\n    }\n    fromJSON(json) {\n        ParameterError.assert(\"json\", json, \"crv\", \"d\");\n        let coordinateLength = 0;\n        const curve = ECNamedCurves.find(json.crv);\n        if (curve) {\n            this.namedCurve = curve.id;\n            coordinateLength = curve.size;\n        }\n        const convertBuffer = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.d);\n        if (convertBuffer.byteLength < coordinateLength) {\n            const buffer = new ArrayBuffer(coordinateLength);\n            const view = new Uint8Array(buffer);\n            const convertBufferView = new Uint8Array(convertBuffer);\n            view.set(convertBufferView, 1);\n            this.privateKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: buffer });\n        }\n        else {\n            this.privateKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: convertBuffer.slice(0, coordinateLength) });\n        }\n        if (json.x && json.y) {\n            this.publicKey = new ECPublicKey({ json });\n        }\n    }\n}\nECPrivateKey.CLASS_NAME = \"ECPrivateKey\";\n\nconst PRIME = \"prime\";\nconst EXPONENT = \"exponent\";\nconst COEFFICIENT$1 = \"coefficient\";\nconst CLEAR_PROPS$18 = [\n    PRIME,\n    EXPONENT,\n    COEFFICIENT$1,\n];\nclass OtherPrimeInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.prime = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIME, OtherPrimeInfo.defaultValues(PRIME));\n        this.exponent = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXPONENT, OtherPrimeInfo.defaultValues(EXPONENT));\n        this.coefficient = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, COEFFICIENT$1, OtherPrimeInfo.defaultValues(COEFFICIENT$1));\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case PRIME:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case EXPONENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case COEFFICIENT$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.prime || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.exponent || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.coefficient || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$18);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OtherPrimeInfo.schema({\n            names: {\n                prime: PRIME,\n                exponent: EXPONENT,\n                coefficient: COEFFICIENT$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.prime = asn1.result.prime.convertFromDER();\n        this.exponent = asn1.result.exponent.convertFromDER();\n        this.coefficient = asn1.result.coefficient.convertFromDER();\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.prime.convertToDER(),\n                this.exponent.convertToDER(),\n                this.coefficient.convertToDER()\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            r: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.prime.valueBlock.valueHexView),\n            d: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.exponent.valueBlock.valueHexView),\n            t: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.coefficient.valueBlock.valueHexView),\n        };\n    }\n    fromJSON(json) {\n        ParameterError.assert(\"json\", json, \"r\", \"d\", \"r\");\n        this.prime = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.r) });\n        this.exponent = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.d) });\n        this.coefficient = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.t) });\n    }\n}\nOtherPrimeInfo.CLASS_NAME = \"OtherPrimeInfo\";\n\nconst VERSION$k = \"version\";\nconst MODULUS = \"modulus\";\nconst PUBLIC_EXPONENT = \"publicExponent\";\nconst PRIVATE_EXPONENT = \"privateExponent\";\nconst PRIME1 = \"prime1\";\nconst PRIME2 = \"prime2\";\nconst EXPONENT1 = \"exponent1\";\nconst EXPONENT2 = \"exponent2\";\nconst COEFFICIENT = \"coefficient\";\nconst OTHER_PRIME_INFOS = \"otherPrimeInfos\";\nconst CLEAR_PROPS$17 = [\n    VERSION$k,\n    MODULUS,\n    PUBLIC_EXPONENT,\n    PRIVATE_EXPONENT,\n    PRIME1,\n    PRIME2,\n    EXPONENT1,\n    EXPONENT2,\n    COEFFICIENT,\n    OTHER_PRIME_INFOS\n];\nclass RSAPrivateKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$k, RSAPrivateKey.defaultValues(VERSION$k));\n        this.modulus = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MODULUS, RSAPrivateKey.defaultValues(MODULUS));\n        this.publicExponent = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PUBLIC_EXPONENT, RSAPrivateKey.defaultValues(PUBLIC_EXPONENT));\n        this.privateExponent = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIVATE_EXPONENT, RSAPrivateKey.defaultValues(PRIVATE_EXPONENT));\n        this.prime1 = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIME1, RSAPrivateKey.defaultValues(PRIME1));\n        this.prime2 = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIME2, RSAPrivateKey.defaultValues(PRIME2));\n        this.exponent1 = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXPONENT1, RSAPrivateKey.defaultValues(EXPONENT1));\n        this.exponent2 = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXPONENT2, RSAPrivateKey.defaultValues(EXPONENT2));\n        this.coefficient = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, COEFFICIENT, RSAPrivateKey.defaultValues(COEFFICIENT));\n        if (OTHER_PRIME_INFOS in parameters) {\n            this.otherPrimeInfos = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_PRIME_INFOS, RSAPrivateKey.defaultValues(OTHER_PRIME_INFOS));\n        }\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$k:\n                return 0;\n            case MODULUS:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case PUBLIC_EXPONENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case PRIVATE_EXPONENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case PRIME1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case PRIME2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case EXPONENT1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case EXPONENT2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case COEFFICIENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case OTHER_PRIME_INFOS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.modulus || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.publicExponent || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.privateExponent || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.prime1 || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.prime2 || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.exponent1 || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.exponent2 || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.coefficient || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    optional: true,\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.otherPrimeInfosName || EMPTY_STRING),\n                            value: OtherPrimeInfo.schema(names.otherPrimeInfo || {})\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$17);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RSAPrivateKey.schema({\n            names: {\n                version: VERSION$k,\n                modulus: MODULUS,\n                publicExponent: PUBLIC_EXPONENT,\n                privateExponent: PRIVATE_EXPONENT,\n                prime1: PRIME1,\n                prime2: PRIME2,\n                exponent1: EXPONENT1,\n                exponent2: EXPONENT2,\n                coefficient: COEFFICIENT,\n                otherPrimeInfo: {\n                    names: {\n                        blockName: OTHER_PRIME_INFOS\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.modulus = asn1.result.modulus.convertFromDER(256);\n        this.publicExponent = asn1.result.publicExponent;\n        this.privateExponent = asn1.result.privateExponent.convertFromDER(256);\n        this.prime1 = asn1.result.prime1.convertFromDER(128);\n        this.prime2 = asn1.result.prime2.convertFromDER(128);\n        this.exponent1 = asn1.result.exponent1.convertFromDER(128);\n        this.exponent2 = asn1.result.exponent2.convertFromDER(128);\n        this.coefficient = asn1.result.coefficient.convertFromDER(128);\n        if (OTHER_PRIME_INFOS in asn1.result)\n            this.otherPrimeInfos = Array.from(asn1.result.otherPrimeInfos, element => new OtherPrimeInfo({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(this.modulus.convertToDER());\n        outputArray.push(this.publicExponent);\n        outputArray.push(this.privateExponent.convertToDER());\n        outputArray.push(this.prime1.convertToDER());\n        outputArray.push(this.prime2.convertToDER());\n        outputArray.push(this.exponent1.convertToDER());\n        outputArray.push(this.exponent2.convertToDER());\n        outputArray.push(this.coefficient.convertToDER());\n        if (this.otherPrimeInfos) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.otherPrimeInfos, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const jwk = {\n            n: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.modulus.valueBlock.valueHexView),\n            e: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.publicExponent.valueBlock.valueHexView),\n            d: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.privateExponent.valueBlock.valueHexView),\n            p: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.prime1.valueBlock.valueHexView),\n            q: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.prime2.valueBlock.valueHexView),\n            dp: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.exponent1.valueBlock.valueHexView),\n            dq: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.exponent2.valueBlock.valueHexView),\n            qi: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToBase64Url(this.coefficient.valueBlock.valueHexView),\n        };\n        if (this.otherPrimeInfos) {\n            jwk.oth = Array.from(this.otherPrimeInfos, o => o.toJSON());\n        }\n        return jwk;\n    }\n    fromJSON(json) {\n        ParameterError.assert(\"json\", json, \"n\", \"e\", \"d\", \"p\", \"q\", \"dp\", \"dq\", \"qi\");\n        this.modulus = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.n) });\n        this.publicExponent = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.e) });\n        this.privateExponent = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.d) });\n        this.prime1 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.p) });\n        this.prime2 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.q) });\n        this.exponent1 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.dp) });\n        this.exponent2 = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.dq) });\n        this.coefficient = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.FromBase64Url(json.qi) });\n        if (json.oth) {\n            this.otherPrimeInfos = Array.from(json.oth, (element) => new OtherPrimeInfo({ json: element }));\n        }\n    }\n}\nRSAPrivateKey.CLASS_NAME = \"RSAPrivateKey\";\n\nconst VERSION$j = \"version\";\nconst PRIVATE_KEY_ALGORITHM = \"privateKeyAlgorithm\";\nconst PRIVATE_KEY = \"privateKey\";\nconst ATTRIBUTES$5 = \"attributes\";\nconst PARSED_KEY = \"parsedKey\";\nconst CLEAR_PROPS$16 = [\n    VERSION$j,\n    PRIVATE_KEY_ALGORITHM,\n    PRIVATE_KEY,\n    ATTRIBUTES$5\n];\nclass PrivateKeyInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$j, PrivateKeyInfo.defaultValues(VERSION$j));\n        this.privateKeyAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIVATE_KEY_ALGORITHM, PrivateKeyInfo.defaultValues(PRIVATE_KEY_ALGORITHM));\n        this.privateKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRIVATE_KEY, PrivateKeyInfo.defaultValues(PRIVATE_KEY));\n        if (ATTRIBUTES$5 in parameters) {\n            this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES$5, PrivateKeyInfo.defaultValues(ATTRIBUTES$5));\n        }\n        if (PARSED_KEY in parameters) {\n            this.parsedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_KEY, PrivateKeyInfo.defaultValues(PARSED_KEY));\n        }\n        if (parameters.json) {\n            this.fromJSON(parameters.json);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$j:\n                return 0;\n            case PRIVATE_KEY_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case PRIVATE_KEY:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case ATTRIBUTES$5:\n                return [];\n            case PARSED_KEY:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                AlgorithmIdentifier.schema(names.privateKeyAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.privateKey || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.attributes || EMPTY_STRING),\n                            value: Attribute.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$16);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PrivateKeyInfo.schema({\n            names: {\n                version: VERSION$j,\n                privateKeyAlgorithm: {\n                    names: {\n                        blockName: PRIVATE_KEY_ALGORITHM\n                    }\n                },\n                privateKey: PRIVATE_KEY,\n                attributes: ATTRIBUTES$5\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.privateKeyAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.privateKeyAlgorithm });\n        this.privateKey = asn1.result.privateKey;\n        if (ATTRIBUTES$5 in asn1.result)\n            this.attributes = Array.from(asn1.result.attributes, element => new Attribute({ schema: element }));\n        switch (this.privateKeyAlgorithm.algorithmId) {\n            case \"1.2.840.113549.1.1.1\":\n                {\n                    const privateKeyASN1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.privateKey.valueBlock.valueHexView);\n                    if (privateKeyASN1.offset !== -1)\n                        this.parsedKey = new RSAPrivateKey({ schema: privateKeyASN1.result });\n                }\n                break;\n            case \"1.2.840.10045.2.1\":\n                if (\"algorithmParams\" in this.privateKeyAlgorithm) {\n                    if (this.privateKeyAlgorithm.algorithmParams instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier) {\n                        const privateKeyASN1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.privateKey.valueBlock.valueHexView);\n                        if (privateKeyASN1.offset !== -1) {\n                            this.parsedKey = new ECPrivateKey({\n                                namedCurve: this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),\n                                schema: privateKeyASN1.result\n                            });\n                        }\n                    }\n                }\n                break;\n        }\n    }\n    toSchema() {\n        const outputArray = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n            this.privateKeyAlgorithm.toSchema(),\n            this.privateKey\n        ];\n        if (this.attributes) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: Array.from(this.attributes, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        if (!this.parsedKey) {\n            const object = {\n                version: this.version,\n                privateKeyAlgorithm: this.privateKeyAlgorithm.toJSON(),\n                privateKey: this.privateKey.toJSON(),\n            };\n            if (this.attributes) {\n                object.attributes = Array.from(this.attributes, o => o.toJSON());\n            }\n            return object;\n        }\n        const jwk = {};\n        switch (this.privateKeyAlgorithm.algorithmId) {\n            case \"1.2.840.10045.2.1\":\n                jwk.kty = \"EC\";\n                break;\n            case \"1.2.840.113549.1.1.1\":\n                jwk.kty = \"RSA\";\n                break;\n        }\n        const publicKeyJWK = this.parsedKey.toJSON();\n        Object.assign(jwk, publicKeyJWK);\n        return jwk;\n    }\n    fromJSON(json) {\n        if (\"kty\" in json) {\n            switch (json.kty.toUpperCase()) {\n                case \"EC\":\n                    this.parsedKey = new ECPrivateKey({ json });\n                    this.privateKeyAlgorithm = new AlgorithmIdentifier({\n                        algorithmId: \"1.2.840.10045.2.1\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.parsedKey.namedCurve })\n                    });\n                    break;\n                case \"RSA\":\n                    this.parsedKey = new RSAPrivateKey({ json });\n                    this.privateKeyAlgorithm = new AlgorithmIdentifier({\n                        algorithmId: \"1.2.840.113549.1.1.1\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                    });\n                    break;\n                default:\n                    throw new Error(`Invalid value for \"kty\" parameter: ${json.kty}`);\n            }\n            this.privateKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: this.parsedKey.toSchema().toBER(false) });\n        }\n    }\n}\nPrivateKeyInfo.CLASS_NAME = \"PrivateKeyInfo\";\n\nconst CONTENT_TYPE$1 = \"contentType\";\nconst CONTENT_ENCRYPTION_ALGORITHM = \"contentEncryptionAlgorithm\";\nconst ENCRYPTED_CONTENT = \"encryptedContent\";\nconst CLEAR_PROPS$15 = [\n    CONTENT_TYPE$1,\n    CONTENT_ENCRYPTION_ALGORITHM,\n    ENCRYPTED_CONTENT,\n];\nconst PIECE_SIZE = 1024;\nclass EncryptedContentInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.contentType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CONTENT_TYPE$1, EncryptedContentInfo.defaultValues(CONTENT_TYPE$1));\n        this.contentEncryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CONTENT_ENCRYPTION_ALGORITHM, EncryptedContentInfo.defaultValues(CONTENT_ENCRYPTION_ALGORITHM));\n        if (ENCRYPTED_CONTENT in parameters && parameters.encryptedContent) {\n            this.encryptedContent = parameters.encryptedContent;\n            if ((this.encryptedContent.idBlock.tagClass === 1) &&\n                (this.encryptedContent.idBlock.tagNumber === 4)) {\n                if (this.encryptedContent.idBlock.isConstructed === false && !parameters.disableSplit) {\n                    const constrString = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({\n                        idBlock: { isConstructed: true },\n                        isConstructed: true\n                    });\n                    let offset = 0;\n                    const valueHex = this.encryptedContent.valueBlock.valueHexView.slice().buffer;\n                    let length = valueHex.byteLength;\n                    while (length > 0) {\n                        const pieceView = new Uint8Array(valueHex, offset, ((offset + PIECE_SIZE) > valueHex.byteLength) ? (valueHex.byteLength - offset) : PIECE_SIZE);\n                        const _array = new ArrayBuffer(pieceView.length);\n                        const _view = new Uint8Array(_array);\n                        for (let i = 0; i < _view.length; i++)\n                            _view[i] = pieceView[i];\n                        constrString.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: _array }));\n                        length -= pieceView.length;\n                        offset += pieceView.length;\n                    }\n                    this.encryptedContent = constrString;\n                }\n            }\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CONTENT_TYPE$1:\n                return EMPTY_STRING;\n            case CONTENT_ENCRYPTION_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case ENCRYPTED_CONTENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CONTENT_TYPE$1:\n                return (memberValue === EMPTY_STRING);\n            case CONTENT_ENCRYPTION_ALGORITHM:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case ENCRYPTED_CONTENT:\n                return (memberValue.isEqual(EncryptedContentInfo.defaultValues(ENCRYPTED_CONTENT)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.contentType || EMPTY_STRING) }),\n                AlgorithmIdentifier.schema(names.contentEncryptionAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.encryptedContent || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                    value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString()\n                                })\n                            ]\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                            name: (names.encryptedContent || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            }\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$15);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, EncryptedContentInfo.schema({\n            names: {\n                contentType: CONTENT_TYPE$1,\n                contentEncryptionAlgorithm: {\n                    names: {\n                        blockName: CONTENT_ENCRYPTION_ALGORITHM\n                    }\n                },\n                encryptedContent: ENCRYPTED_CONTENT\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.contentType = asn1.result.contentType.valueBlock.toString();\n        this.contentEncryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.contentEncryptionAlgorithm });\n        if (ENCRYPTED_CONTENT in asn1.result) {\n            this.encryptedContent = asn1.result.encryptedContent;\n            this.encryptedContent.idBlock.tagClass = 1;\n            this.encryptedContent.idBlock.tagNumber = 4;\n        }\n    }\n    toSchema() {\n        const sequenceLengthBlock = {\n            isIndefiniteForm: false\n        };\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.contentType }));\n        outputArray.push(this.contentEncryptionAlgorithm.toSchema());\n        if (this.encryptedContent) {\n            sequenceLengthBlock.isIndefiniteForm = this.encryptedContent.idBlock.isConstructed;\n            const encryptedValue = this.encryptedContent;\n            encryptedValue.idBlock.tagClass = 3;\n            encryptedValue.idBlock.tagNumber = 0;\n            encryptedValue.lenBlock.isIndefiniteForm = this.encryptedContent.idBlock.isConstructed;\n            outputArray.push(encryptedValue);\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            lenBlock: sequenceLengthBlock,\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            contentType: this.contentType,\n            contentEncryptionAlgorithm: this.contentEncryptionAlgorithm.toJSON()\n        };\n        if (this.encryptedContent) {\n            res.encryptedContent = this.encryptedContent.toJSON();\n        }\n        return res;\n    }\n    getEncryptedContent() {\n        if (!this.encryptedContent) {\n            throw new Error(\"Parameter 'encryptedContent' is undefined\");\n        }\n        return asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString.prototype.getValue.call(this.encryptedContent);\n    }\n}\nEncryptedContentInfo.CLASS_NAME = \"EncryptedContentInfo\";\n\nconst HASH_ALGORITHM$4 = \"hashAlgorithm\";\nconst MASK_GEN_ALGORITHM$1 = \"maskGenAlgorithm\";\nconst SALT_LENGTH = \"saltLength\";\nconst TRAILER_FIELD = \"trailerField\";\nconst CLEAR_PROPS$14 = [\n    HASH_ALGORITHM$4,\n    MASK_GEN_ALGORITHM$1,\n    SALT_LENGTH,\n    TRAILER_FIELD\n];\nclass RSASSAPSSParams extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.hashAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASH_ALGORITHM$4, RSASSAPSSParams.defaultValues(HASH_ALGORITHM$4));\n        this.maskGenAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MASK_GEN_ALGORITHM$1, RSASSAPSSParams.defaultValues(MASK_GEN_ALGORITHM$1));\n        this.saltLength = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SALT_LENGTH, RSASSAPSSParams.defaultValues(SALT_LENGTH));\n        this.trailerField = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TRAILER_FIELD, RSASSAPSSParams.defaultValues(TRAILER_FIELD));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case HASH_ALGORITHM$4:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.3.14.3.2.26\",\n                    algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                });\n            case MASK_GEN_ALGORITHM$1:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.2.840.113549.1.1.8\",\n                    algorithmParams: (new AlgorithmIdentifier({\n                        algorithmId: \"1.3.14.3.2.26\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                    })).toSchema()\n                });\n            case SALT_LENGTH:\n                return 20;\n            case TRAILER_FIELD:\n                return 1;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    optional: true,\n                    value: [AlgorithmIdentifier.schema(names.hashAlgorithm || {})]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    optional: true,\n                    value: [AlgorithmIdentifier.schema(names.maskGenAlgorithm || {})]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    optional: true,\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.saltLength || EMPTY_STRING) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 3\n                    },\n                    optional: true,\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.trailerField || EMPTY_STRING) })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$14);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RSASSAPSSParams.schema({\n            names: {\n                hashAlgorithm: {\n                    names: {\n                        blockName: HASH_ALGORITHM$4\n                    }\n                },\n                maskGenAlgorithm: {\n                    names: {\n                        blockName: MASK_GEN_ALGORITHM$1\n                    }\n                },\n                saltLength: SALT_LENGTH,\n                trailerField: TRAILER_FIELD\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (HASH_ALGORITHM$4 in asn1.result)\n            this.hashAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.hashAlgorithm });\n        if (MASK_GEN_ALGORITHM$1 in asn1.result)\n            this.maskGenAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.maskGenAlgorithm });\n        if (SALT_LENGTH in asn1.result)\n            this.saltLength = asn1.result.saltLength.valueBlock.valueDec;\n        if (TRAILER_FIELD in asn1.result)\n            this.trailerField = asn1.result.trailerField.valueBlock.valueDec;\n    }\n    toSchema() {\n        const outputArray = [];\n        if (!this.hashAlgorithm.isEqual(RSASSAPSSParams.defaultValues(HASH_ALGORITHM$4))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.hashAlgorithm.toSchema()]\n            }));\n        }\n        if (!this.maskGenAlgorithm.isEqual(RSASSAPSSParams.defaultValues(MASK_GEN_ALGORITHM$1))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [this.maskGenAlgorithm.toSchema()]\n            }));\n        }\n        if (this.saltLength !== RSASSAPSSParams.defaultValues(SALT_LENGTH)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.saltLength })]\n            }));\n        }\n        if (this.trailerField !== RSASSAPSSParams.defaultValues(TRAILER_FIELD)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 3\n                },\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.trailerField })]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {};\n        if (!this.hashAlgorithm.isEqual(RSASSAPSSParams.defaultValues(HASH_ALGORITHM$4))) {\n            res.hashAlgorithm = this.hashAlgorithm.toJSON();\n        }\n        if (!this.maskGenAlgorithm.isEqual(RSASSAPSSParams.defaultValues(MASK_GEN_ALGORITHM$1))) {\n            res.maskGenAlgorithm = this.maskGenAlgorithm.toJSON();\n        }\n        if (this.saltLength !== RSASSAPSSParams.defaultValues(SALT_LENGTH)) {\n            res.saltLength = this.saltLength;\n        }\n        if (this.trailerField !== RSASSAPSSParams.defaultValues(TRAILER_FIELD)) {\n            res.trailerField = this.trailerField;\n        }\n        return res;\n    }\n}\nRSASSAPSSParams.CLASS_NAME = \"RSASSAPSSParams\";\n\nconst SALT = \"salt\";\nconst ITERATION_COUNT = \"iterationCount\";\nconst KEY_LENGTH = \"keyLength\";\nconst PRF = \"prf\";\nconst CLEAR_PROPS$13 = [\n    SALT,\n    ITERATION_COUNT,\n    KEY_LENGTH,\n    PRF\n];\nclass PBKDF2Params extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.salt = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SALT, PBKDF2Params.defaultValues(SALT));\n        this.iterationCount = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ITERATION_COUNT, PBKDF2Params.defaultValues(ITERATION_COUNT));\n        if (KEY_LENGTH in parameters) {\n            this.keyLength = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_LENGTH, PBKDF2Params.defaultValues(KEY_LENGTH));\n        }\n        if (PRF in parameters) {\n            this.prf = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRF, PBKDF2Params.defaultValues(PRF));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SALT:\n                return {};\n            case ITERATION_COUNT:\n                return (-1);\n            case KEY_LENGTH:\n                return 0;\n            case PRF:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.3.14.3.2.26\",\n                    algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                });\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.saltPrimitive || EMPTY_STRING) }),\n                        AlgorithmIdentifier.schema(names.saltConstructed || {})\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.iterationCount || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    name: (names.keyLength || EMPTY_STRING),\n                    optional: true\n                }),\n                AlgorithmIdentifier.schema(names.prf || {\n                    names: {\n                        optional: true\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$13);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PBKDF2Params.schema({\n            names: {\n                saltPrimitive: SALT,\n                saltConstructed: {\n                    names: {\n                        blockName: SALT\n                    }\n                },\n                iterationCount: ITERATION_COUNT,\n                keyLength: KEY_LENGTH,\n                prf: {\n                    names: {\n                        blockName: PRF,\n                        optional: true\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.salt = asn1.result.salt;\n        this.iterationCount = asn1.result.iterationCount.valueBlock.valueDec;\n        if (KEY_LENGTH in asn1.result)\n            this.keyLength = asn1.result.keyLength.valueBlock.valueDec;\n        if (PRF in asn1.result)\n            this.prf = new AlgorithmIdentifier({ schema: asn1.result.prf });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.salt);\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.iterationCount }));\n        if (KEY_LENGTH in this) {\n            if (PBKDF2Params.defaultValues(KEY_LENGTH) !== this.keyLength)\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.keyLength }));\n        }\n        if (this.prf) {\n            if (PBKDF2Params.defaultValues(PRF).isEqual(this.prf) === false)\n                outputArray.push(this.prf.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            salt: this.salt.toJSON(),\n            iterationCount: this.iterationCount\n        };\n        if (KEY_LENGTH in this) {\n            if (PBKDF2Params.defaultValues(KEY_LENGTH) !== this.keyLength)\n                res.keyLength = this.keyLength;\n        }\n        if (this.prf) {\n            if (PBKDF2Params.defaultValues(PRF).isEqual(this.prf) === false)\n                res.prf = this.prf.toJSON();\n        }\n        return res;\n    }\n}\nPBKDF2Params.CLASS_NAME = \"PBKDF2Params\";\n\nconst KEY_DERIVATION_FUNC = \"keyDerivationFunc\";\nconst ENCRYPTION_SCHEME = \"encryptionScheme\";\nconst CLEAR_PROPS$12 = [\n    KEY_DERIVATION_FUNC,\n    ENCRYPTION_SCHEME\n];\nclass PBES2Params extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.keyDerivationFunc = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_DERIVATION_FUNC, PBES2Params.defaultValues(KEY_DERIVATION_FUNC));\n        this.encryptionScheme = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTION_SCHEME, PBES2Params.defaultValues(ENCRYPTION_SCHEME));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_DERIVATION_FUNC:\n                return new AlgorithmIdentifier();\n            case ENCRYPTION_SCHEME:\n                return new AlgorithmIdentifier();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.keyDerivationFunc || {}),\n                AlgorithmIdentifier.schema(names.encryptionScheme || {})\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$12);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PBES2Params.schema({\n            names: {\n                keyDerivationFunc: {\n                    names: {\n                        blockName: KEY_DERIVATION_FUNC\n                    }\n                },\n                encryptionScheme: {\n                    names: {\n                        blockName: ENCRYPTION_SCHEME\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.keyDerivationFunc = new AlgorithmIdentifier({ schema: asn1.result.keyDerivationFunc });\n        this.encryptionScheme = new AlgorithmIdentifier({ schema: asn1.result.encryptionScheme });\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.keyDerivationFunc.toSchema(),\n                this.encryptionScheme.toSchema()\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            keyDerivationFunc: this.keyDerivationFunc.toJSON(),\n            encryptionScheme: this.encryptionScheme.toJSON()\n        };\n    }\n}\nPBES2Params.CLASS_NAME = \"PBES2Params\";\n\nclass AbstractCryptoEngine {\n    constructor(parameters) {\n        this.crypto = parameters.crypto;\n        this.subtle = \"webkitSubtle\" in parameters.crypto\n            ? parameters.crypto.webkitSubtle\n            : parameters.crypto.subtle;\n        this.name = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"name\", EMPTY_STRING);\n    }\n    async encrypt(...args) {\n        return this.subtle.encrypt(...args);\n    }\n    async decrypt(...args) {\n        return this.subtle.decrypt(...args);\n    }\n    sign(...args) {\n        return this.subtle.sign(...args);\n    }\n    async verify(...args) {\n        return this.subtle.verify(...args);\n    }\n    async digest(...args) {\n        return this.subtle.digest(...args);\n    }\n    async generateKey(...args) {\n        return this.subtle.generateKey(...args);\n    }\n    async deriveKey(...args) {\n        return this.subtle.deriveKey(...args);\n    }\n    async deriveBits(...args) {\n        return this.subtle.deriveBits(...args);\n    }\n    async wrapKey(...args) {\n        return this.subtle.wrapKey(...args);\n    }\n    async unwrapKey(...args) {\n        return this.subtle.unwrapKey(...args);\n    }\n    exportKey(...args) {\n        return this.subtle.exportKey(...args);\n    }\n    importKey(...args) {\n        return this.subtle.importKey(...args);\n    }\n    getRandomValues(array) {\n        return this.crypto.getRandomValues(array);\n    }\n}\n\nasync function makePKCS12B2Key(hashAlgorithm, keyLength, password, salt, iterationCount) {\n    let u;\n    let v;\n    let md;\n    switch (hashAlgorithm.toUpperCase()) {\n        case \"SHA-1\":\n            u = 20;\n            v = 64;\n            md = _noble_hashes_sha1__WEBPACK_IMPORTED_MODULE_4__.sha1;\n            break;\n        case \"SHA-256\":\n            u = 32;\n            v = 64;\n            md = _noble_hashes_sha256__WEBPACK_IMPORTED_MODULE_5__.sha256;\n            break;\n        case \"SHA-384\":\n            u = 48;\n            v = 128;\n            md = _noble_hashes_sha512__WEBPACK_IMPORTED_MODULE_6__.sha384;\n            break;\n        case \"SHA-512\":\n            u = 64;\n            v = 128;\n            md = _noble_hashes_sha512__WEBPACK_IMPORTED_MODULE_6__.sha512;\n            break;\n        default:\n            throw new Error(\"Unsupported hashing algorithm\");\n    }\n    const originalPassword = new Uint8Array(password);\n    let decodedPassword = new TextDecoder().decode(password);\n    const encodedPassword = new TextEncoder().encode(decodedPassword);\n    if (encodedPassword.some((byte, i) => byte !== originalPassword[i])) {\n        decodedPassword = String.fromCharCode(...originalPassword);\n    }\n    const passwordTransformed = new Uint8Array(decodedPassword.length * 2 + 2);\n    const passwordView = new DataView(passwordTransformed.buffer);\n    for (let i = 0; i < decodedPassword.length; i++) {\n        passwordView.setUint16(i * 2, decodedPassword.charCodeAt(i), false);\n    }\n    passwordView.setUint16(decodedPassword.length * 2, 0, false);\n    const D = new Uint8Array(v).fill(3);\n    const saltView = new Uint8Array(salt);\n    const S = new Uint8Array(v * Math.ceil(saltView.length / v)).map((_, i) => saltView[i % saltView.length]);\n    const P = new Uint8Array(v * Math.ceil(passwordTransformed.length / v)).map((_, i) => passwordTransformed[i % passwordTransformed.length]);\n    let I = new Uint8Array(S.length + P.length);\n    I.set(S);\n    I.set(P, S.length);\n    const c = Math.ceil((keyLength >> 3) / u);\n    const result = [];\n    for (let i = 0; i < c; i++) {\n        let A = new Uint8Array(D.length + I.length);\n        A.set(D);\n        A.set(I, D.length);\n        for (let j = 0; j < iterationCount; j++) {\n            A = md(A);\n        }\n        const B = new Uint8Array(v).map((_, i) => A[i % A.length]);\n        const k = Math.ceil(saltView.length / v) + Math.ceil(passwordTransformed.length / v);\n        const iRound = [];\n        for (let j = 0; j < k; j++) {\n            const chunk = Array.from(I.slice(j * v, (j + 1) * v));\n            let x = 0x1ff;\n            for (let l = B.length - 1; l >= 0; l--) {\n                x >>= 8;\n                x += B[l] + (chunk[l] || 0);\n                chunk[l] = x & 0xff;\n            }\n            iRound.push(...chunk);\n        }\n        I = new Uint8Array(iRound);\n        result.push(...A);\n    }\n    return new Uint8Array(result.slice(0, keyLength >> 3)).buffer;\n}\nfunction prepareAlgorithm(data) {\n    const res = typeof data === \"string\"\n        ? { name: data }\n        : data;\n    if (\"hash\" in res) {\n        return {\n            ...res,\n            hash: prepareAlgorithm(res.hash)\n        };\n    }\n    return res;\n}\nclass CryptoEngine extends AbstractCryptoEngine {\n    async importKey(format, keyData, algorithm, extractable, keyUsages) {\n        var _a, _b, _c, _d, _e, _f;\n        let jwk = {};\n        const alg = prepareAlgorithm(algorithm);\n        switch (format.toLowerCase()) {\n            case \"raw\":\n                return this.subtle.importKey(\"raw\", keyData, algorithm, extractable, keyUsages);\n            case \"spki\":\n                {\n                    const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(keyData));\n                    AsnError.assert(asn1, \"keyData\");\n                    const publicKeyInfo = new PublicKeyInfo();\n                    try {\n                        publicKeyInfo.fromSchema(asn1.result);\n                    }\n                    catch {\n                        throw new ArgumentError(\"Incorrect keyData\");\n                    }\n                    switch (alg.name.toUpperCase()) {\n                        case \"RSA-PSS\":\n                            {\n                                if (!alg.hash) {\n                                    throw new ParameterError(\"hash\", \"algorithm.hash\", \"Incorrect hash algorithm: Hash algorithm is missed\");\n                                }\n                                switch (alg.hash.name.toUpperCase()) {\n                                    case \"SHA-1\":\n                                        jwk.alg = \"PS1\";\n                                        break;\n                                    case \"SHA-256\":\n                                        jwk.alg = \"PS256\";\n                                        break;\n                                    case \"SHA-384\":\n                                        jwk.alg = \"PS384\";\n                                        break;\n                                    case \"SHA-512\":\n                                        jwk.alg = \"PS512\";\n                                        break;\n                                    default:\n                                        throw new Error(`Incorrect hash algorithm: ${alg.hash.name.toUpperCase()}`);\n                                }\n                            }\n                        case \"RSASSA-PKCS1-V1_5\":\n                            {\n                                keyUsages = [\"verify\"];\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                if (publicKeyInfo.algorithm.algorithmId !== \"1.2.840.113549.1.1.1\")\n                                    throw new Error(`Incorrect public key algorithm: ${publicKeyInfo.algorithm.algorithmId}`);\n                                if (!jwk.alg) {\n                                    if (!alg.hash) {\n                                        throw new ParameterError(\"hash\", \"algorithm.hash\", \"Incorrect hash algorithm: Hash algorithm is missed\");\n                                    }\n                                    switch (alg.hash.name.toUpperCase()) {\n                                        case \"SHA-1\":\n                                            jwk.alg = \"RS1\";\n                                            break;\n                                        case \"SHA-256\":\n                                            jwk.alg = \"RS256\";\n                                            break;\n                                        case \"SHA-384\":\n                                            jwk.alg = \"RS384\";\n                                            break;\n                                        case \"SHA-512\":\n                                            jwk.alg = \"RS512\";\n                                            break;\n                                        default:\n                                            throw new Error(`Incorrect hash algorithm: ${alg.hash.name.toUpperCase()}`);\n                                    }\n                                }\n                                const publicKeyJSON = publicKeyInfo.toJSON();\n                                Object.assign(jwk, publicKeyJSON);\n                            }\n                            break;\n                        case \"ECDSA\":\n                            keyUsages = [\"verify\"];\n                        case \"ECDH\":\n                            {\n                                jwk = {\n                                    kty: \"EC\",\n                                    ext: extractable,\n                                    key_ops: keyUsages\n                                };\n                                if (publicKeyInfo.algorithm.algorithmId !== \"1.2.840.10045.2.1\") {\n                                    throw new Error(`Incorrect public key algorithm: ${publicKeyInfo.algorithm.algorithmId}`);\n                                }\n                                const publicKeyJSON = publicKeyInfo.toJSON();\n                                Object.assign(jwk, publicKeyJSON);\n                            }\n                            break;\n                        case \"RSA-OAEP\":\n                            {\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                if (this.name.toLowerCase() === \"safari\")\n                                    jwk.alg = \"RSA-OAEP\";\n                                else {\n                                    if (!alg.hash) {\n                                        throw new ParameterError(\"hash\", \"algorithm.hash\", \"Incorrect hash algorithm: Hash algorithm is missed\");\n                                    }\n                                    switch (alg.hash.name.toUpperCase()) {\n                                        case \"SHA-1\":\n                                            jwk.alg = \"RSA-OAEP\";\n                                            break;\n                                        case \"SHA-256\":\n                                            jwk.alg = \"RSA-OAEP-256\";\n                                            break;\n                                        case \"SHA-384\":\n                                            jwk.alg = \"RSA-OAEP-384\";\n                                            break;\n                                        case \"SHA-512\":\n                                            jwk.alg = \"RSA-OAEP-512\";\n                                            break;\n                                        default:\n                                            throw new Error(`Incorrect hash algorithm: ${alg.hash.name.toUpperCase()}`);\n                                    }\n                                }\n                                const publicKeyJSON = publicKeyInfo.toJSON();\n                                Object.assign(jwk, publicKeyJSON);\n                            }\n                            break;\n                        case \"RSAES-PKCS1-V1_5\":\n                            {\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                jwk.alg = \"PS1\";\n                                const publicKeyJSON = publicKeyInfo.toJSON();\n                                Object.assign(jwk, publicKeyJSON);\n                            }\n                            break;\n                        default:\n                            throw new Error(`Incorrect algorithm name: ${alg.name.toUpperCase()}`);\n                    }\n                }\n                break;\n            case \"pkcs8\":\n                {\n                    const privateKeyInfo = new PrivateKeyInfo();\n                    const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(keyData));\n                    AsnError.assert(asn1, \"keyData\");\n                    try {\n                        privateKeyInfo.fromSchema(asn1.result);\n                    }\n                    catch (ex) {\n                        throw new Error(\"Incorrect keyData\");\n                    }\n                    if (!privateKeyInfo.parsedKey)\n                        throw new Error(\"Incorrect keyData\");\n                    switch (alg.name.toUpperCase()) {\n                        case \"RSA-PSS\":\n                            {\n                                switch ((_a = alg.hash) === null || _a === void 0 ? void 0 : _a.name.toUpperCase()) {\n                                    case \"SHA-1\":\n                                        jwk.alg = \"PS1\";\n                                        break;\n                                    case \"SHA-256\":\n                                        jwk.alg = \"PS256\";\n                                        break;\n                                    case \"SHA-384\":\n                                        jwk.alg = \"PS384\";\n                                        break;\n                                    case \"SHA-512\":\n                                        jwk.alg = \"PS512\";\n                                        break;\n                                    default:\n                                        throw new Error(`Incorrect hash algorithm: ${(_b = alg.hash) === null || _b === void 0 ? void 0 : _b.name.toUpperCase()}`);\n                                }\n                            }\n                        case \"RSASSA-PKCS1-V1_5\":\n                            {\n                                keyUsages = [\"sign\"];\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                if (privateKeyInfo.privateKeyAlgorithm.algorithmId !== \"1.2.840.113549.1.1.1\")\n                                    throw new Error(`Incorrect private key algorithm: ${privateKeyInfo.privateKeyAlgorithm.algorithmId}`);\n                                if ((\"alg\" in jwk) === false) {\n                                    switch ((_c = alg.hash) === null || _c === void 0 ? void 0 : _c.name.toUpperCase()) {\n                                        case \"SHA-1\":\n                                            jwk.alg = \"RS1\";\n                                            break;\n                                        case \"SHA-256\":\n                                            jwk.alg = \"RS256\";\n                                            break;\n                                        case \"SHA-384\":\n                                            jwk.alg = \"RS384\";\n                                            break;\n                                        case \"SHA-512\":\n                                            jwk.alg = \"RS512\";\n                                            break;\n                                        default:\n                                            throw new Error(`Incorrect hash algorithm: ${(_d = alg.hash) === null || _d === void 0 ? void 0 : _d.name.toUpperCase()}`);\n                                    }\n                                }\n                                const privateKeyJSON = privateKeyInfo.toJSON();\n                                Object.assign(jwk, privateKeyJSON);\n                            }\n                            break;\n                        case \"ECDSA\":\n                            keyUsages = [\"sign\"];\n                        case \"ECDH\":\n                            {\n                                jwk = {\n                                    kty: \"EC\",\n                                    ext: extractable,\n                                    key_ops: keyUsages\n                                };\n                                if (privateKeyInfo.privateKeyAlgorithm.algorithmId !== \"1.2.840.10045.2.1\")\n                                    throw new Error(`Incorrect algorithm: ${privateKeyInfo.privateKeyAlgorithm.algorithmId}`);\n                                const privateKeyJSON = privateKeyInfo.toJSON();\n                                Object.assign(jwk, privateKeyJSON);\n                            }\n                            break;\n                        case \"RSA-OAEP\":\n                            {\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                if (this.name.toLowerCase() === \"safari\")\n                                    jwk.alg = \"RSA-OAEP\";\n                                else {\n                                    switch ((_e = alg.hash) === null || _e === void 0 ? void 0 : _e.name.toUpperCase()) {\n                                        case \"SHA-1\":\n                                            jwk.alg = \"RSA-OAEP\";\n                                            break;\n                                        case \"SHA-256\":\n                                            jwk.alg = \"RSA-OAEP-256\";\n                                            break;\n                                        case \"SHA-384\":\n                                            jwk.alg = \"RSA-OAEP-384\";\n                                            break;\n                                        case \"SHA-512\":\n                                            jwk.alg = \"RSA-OAEP-512\";\n                                            break;\n                                        default:\n                                            throw new Error(`Incorrect hash algorithm: ${(_f = alg.hash) === null || _f === void 0 ? void 0 : _f.name.toUpperCase()}`);\n                                    }\n                                }\n                                const privateKeyJSON = privateKeyInfo.toJSON();\n                                Object.assign(jwk, privateKeyJSON);\n                            }\n                            break;\n                        case \"RSAES-PKCS1-V1_5\":\n                            {\n                                keyUsages = [\"decrypt\"];\n                                jwk.kty = \"RSA\";\n                                jwk.ext = extractable;\n                                jwk.key_ops = keyUsages;\n                                jwk.alg = \"PS1\";\n                                const privateKeyJSON = privateKeyInfo.toJSON();\n                                Object.assign(jwk, privateKeyJSON);\n                            }\n                            break;\n                        default:\n                            throw new Error(`Incorrect algorithm name: ${alg.name.toUpperCase()}`);\n                    }\n                }\n                break;\n            case \"jwk\":\n                jwk = keyData;\n                break;\n            default:\n                throw new Error(`Incorrect format: ${format}`);\n        }\n        if (this.name.toLowerCase() === \"safari\") {\n            try {\n                return this.subtle.importKey(\"jwk\", pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(JSON.stringify(jwk)), algorithm, extractable, keyUsages);\n            }\n            catch {\n                return this.subtle.importKey(\"jwk\", jwk, algorithm, extractable, keyUsages);\n            }\n        }\n        return this.subtle.importKey(\"jwk\", jwk, algorithm, extractable, keyUsages);\n    }\n    async exportKey(format, key) {\n        let jwk = await this.subtle.exportKey(\"jwk\", key);\n        if (this.name.toLowerCase() === \"safari\") {\n            if (jwk instanceof ArrayBuffer) {\n                jwk = JSON.parse(pvutils__WEBPACK_IMPORTED_MODULE_2__.arrayBufferToString(jwk));\n            }\n        }\n        switch (format.toLowerCase()) {\n            case \"raw\":\n                return this.subtle.exportKey(\"raw\", key);\n            case \"spki\": {\n                const publicKeyInfo = new PublicKeyInfo();\n                try {\n                    publicKeyInfo.fromJSON(jwk);\n                }\n                catch (ex) {\n                    throw new Error(\"Incorrect key data\");\n                }\n                return publicKeyInfo.toSchema().toBER(false);\n            }\n            case \"pkcs8\": {\n                const privateKeyInfo = new PrivateKeyInfo();\n                try {\n                    privateKeyInfo.fromJSON(jwk);\n                }\n                catch (ex) {\n                    throw new Error(\"Incorrect key data\");\n                }\n                return privateKeyInfo.toSchema().toBER(false);\n            }\n            case \"jwk\":\n                return jwk;\n            default:\n                throw new Error(`Incorrect format: ${format}`);\n        }\n    }\n    async convert(inputFormat, outputFormat, keyData, algorithm, extractable, keyUsages) {\n        if (inputFormat.toLowerCase() === outputFormat.toLowerCase()) {\n            return keyData;\n        }\n        const key = await this.importKey(inputFormat, keyData, algorithm, extractable, keyUsages);\n        return this.exportKey(outputFormat, key);\n    }\n    getAlgorithmByOID(oid, safety = false, target) {\n        switch (oid) {\n            case \"1.2.840.113549.1.1.1\":\n                return {\n                    name: \"RSAES-PKCS1-v1_5\"\n                };\n            case \"1.2.840.113549.1.1.5\":\n                return {\n                    name: \"RSASSA-PKCS1-v1_5\",\n                    hash: {\n                        name: \"SHA-1\"\n                    }\n                };\n            case \"1.2.840.113549.1.1.11\":\n                return {\n                    name: \"RSASSA-PKCS1-v1_5\",\n                    hash: {\n                        name: \"SHA-256\"\n                    }\n                };\n            case \"1.2.840.113549.1.1.12\":\n                return {\n                    name: \"RSASSA-PKCS1-v1_5\",\n                    hash: {\n                        name: \"SHA-384\"\n                    }\n                };\n            case \"1.2.840.113549.1.1.13\":\n                return {\n                    name: \"RSASSA-PKCS1-v1_5\",\n                    hash: {\n                        name: \"SHA-512\"\n                    }\n                };\n            case \"1.2.840.113549.1.1.10\":\n                return {\n                    name: \"RSA-PSS\"\n                };\n            case \"1.2.840.113549.1.1.7\":\n                return {\n                    name: \"RSA-OAEP\"\n                };\n            case \"1.2.840.10045.2.1\":\n            case \"1.2.840.10045.4.1\":\n                return {\n                    name: \"ECDSA\",\n                    hash: {\n                        name: \"SHA-1\"\n                    }\n                };\n            case \"1.2.840.10045.4.3.2\":\n                return {\n                    name: \"ECDSA\",\n                    hash: {\n                        name: \"SHA-256\"\n                    }\n                };\n            case \"1.2.840.10045.4.3.3\":\n                return {\n                    name: \"ECDSA\",\n                    hash: {\n                        name: \"SHA-384\"\n                    }\n                };\n            case \"1.2.840.10045.4.3.4\":\n                return {\n                    name: \"ECDSA\",\n                    hash: {\n                        name: \"SHA-512\"\n                    }\n                };\n            case \"1.3.133.16.840.63.0.2\":\n                return {\n                    name: \"ECDH\",\n                    kdf: \"SHA-1\"\n                };\n            case \"1.3.132.1.11.1\":\n                return {\n                    name: \"ECDH\",\n                    kdf: \"SHA-256\"\n                };\n            case \"1.3.132.1.11.2\":\n                return {\n                    name: \"ECDH\",\n                    kdf: \"SHA-384\"\n                };\n            case \"1.3.132.1.11.3\":\n                return {\n                    name: \"ECDH\",\n                    kdf: \"SHA-512\"\n                };\n            case \"2.16.840.1.101.3.4.1.2\":\n                return {\n                    name: \"AES-CBC\",\n                    length: 128\n                };\n            case \"2.16.840.1.101.3.4.1.22\":\n                return {\n                    name: \"AES-CBC\",\n                    length: 192\n                };\n            case \"2.16.840.1.101.3.4.1.42\":\n                return {\n                    name: \"AES-CBC\",\n                    length: 256\n                };\n            case \"2.16.840.1.101.3.4.1.6\":\n                return {\n                    name: \"AES-GCM\",\n                    length: 128\n                };\n            case \"2.16.840.1.101.3.4.1.26\":\n                return {\n                    name: \"AES-GCM\",\n                    length: 192\n                };\n            case \"2.16.840.1.101.3.4.1.46\":\n                return {\n                    name: \"AES-GCM\",\n                    length: 256\n                };\n            case \"2.16.840.1.101.3.4.1.4\":\n                return {\n                    name: \"AES-CFB\",\n                    length: 128\n                };\n            case \"2.16.840.1.101.3.4.1.24\":\n                return {\n                    name: \"AES-CFB\",\n                    length: 192\n                };\n            case \"2.16.840.1.101.3.4.1.44\":\n                return {\n                    name: \"AES-CFB\",\n                    length: 256\n                };\n            case \"2.16.840.1.101.3.4.1.5\":\n                return {\n                    name: \"AES-KW\",\n                    length: 128\n                };\n            case \"2.16.840.1.101.3.4.1.25\":\n                return {\n                    name: \"AES-KW\",\n                    length: 192\n                };\n            case \"2.16.840.1.101.3.4.1.45\":\n                return {\n                    name: \"AES-KW\",\n                    length: 256\n                };\n            case \"1.2.840.113549.2.7\":\n                return {\n                    name: \"HMAC\",\n                    hash: {\n                        name: \"SHA-1\"\n                    }\n                };\n            case \"1.2.840.113549.2.9\":\n                return {\n                    name: \"HMAC\",\n                    hash: {\n                        name: \"SHA-256\"\n                    }\n                };\n            case \"1.2.840.113549.2.10\":\n                return {\n                    name: \"HMAC\",\n                    hash: {\n                        name: \"SHA-384\"\n                    }\n                };\n            case \"1.2.840.113549.2.11\":\n                return {\n                    name: \"HMAC\",\n                    hash: {\n                        name: \"SHA-512\"\n                    }\n                };\n            case \"1.2.840.113549.1.9.16.3.5\":\n                return {\n                    name: \"DH\"\n                };\n            case \"1.3.14.3.2.26\":\n                return {\n                    name: \"SHA-1\"\n                };\n            case \"2.16.840.1.101.3.4.2.1\":\n                return {\n                    name: \"SHA-256\"\n                };\n            case \"2.16.840.1.101.3.4.2.2\":\n                return {\n                    name: \"SHA-384\"\n                };\n            case \"2.16.840.1.101.3.4.2.3\":\n                return {\n                    name: \"SHA-512\"\n                };\n            case \"1.2.840.113549.1.5.12\":\n                return {\n                    name: \"PBKDF2\"\n                };\n            case \"1.2.840.10045.3.1.7\":\n                return {\n                    name: \"P-256\"\n                };\n            case \"1.3.132.0.34\":\n                return {\n                    name: \"P-384\"\n                };\n            case \"1.3.132.0.35\":\n                return {\n                    name: \"P-521\"\n                };\n        }\n        if (safety) {\n            throw new Error(`Unsupported algorithm identifier ${target ? `for ${target} ` : EMPTY_STRING}: ${oid}`);\n        }\n        return {};\n    }\n    getOIDByAlgorithm(algorithm, safety = false, target) {\n        let result = EMPTY_STRING;\n        switch (algorithm.name.toUpperCase()) {\n            case \"RSAES-PKCS1-V1_5\":\n                result = \"1.2.840.113549.1.1.1\";\n                break;\n            case \"RSASSA-PKCS1-V1_5\":\n                switch (algorithm.hash.name.toUpperCase()) {\n                    case \"SHA-1\":\n                        result = \"1.2.840.113549.1.1.5\";\n                        break;\n                    case \"SHA-256\":\n                        result = \"1.2.840.113549.1.1.11\";\n                        break;\n                    case \"SHA-384\":\n                        result = \"1.2.840.113549.1.1.12\";\n                        break;\n                    case \"SHA-512\":\n                        result = \"1.2.840.113549.1.1.13\";\n                        break;\n                }\n                break;\n            case \"RSA-PSS\":\n                result = \"1.2.840.113549.1.1.10\";\n                break;\n            case \"RSA-OAEP\":\n                result = \"1.2.840.113549.1.1.7\";\n                break;\n            case \"ECDSA\":\n                switch (algorithm.hash.name.toUpperCase()) {\n                    case \"SHA-1\":\n                        result = \"1.2.840.10045.4.1\";\n                        break;\n                    case \"SHA-256\":\n                        result = \"1.2.840.10045.4.3.2\";\n                        break;\n                    case \"SHA-384\":\n                        result = \"1.2.840.10045.4.3.3\";\n                        break;\n                    case \"SHA-512\":\n                        result = \"1.2.840.10045.4.3.4\";\n                        break;\n                }\n                break;\n            case \"ECDH\":\n                switch (algorithm.kdf.toUpperCase()) {\n                    case \"SHA-1\":\n                        result = \"1.3.133.16.840.63.0.2\";\n                        break;\n                    case \"SHA-256\":\n                        result = \"1.3.132.1.11.1\";\n                        break;\n                    case \"SHA-384\":\n                        result = \"1.3.132.1.11.2\";\n                        break;\n                    case \"SHA-512\":\n                        result = \"1.3.132.1.11.3\";\n                        break;\n                }\n                break;\n            case \"AES-CTR\":\n                break;\n            case \"AES-CBC\":\n                switch (algorithm.length) {\n                    case 128:\n                        result = \"2.16.840.1.101.3.4.1.2\";\n                        break;\n                    case 192:\n                        result = \"2.16.840.1.101.3.4.1.22\";\n                        break;\n                    case 256:\n                        result = \"2.16.840.1.101.3.4.1.42\";\n                        break;\n                }\n                break;\n            case \"AES-CMAC\":\n                break;\n            case \"AES-GCM\":\n                switch (algorithm.length) {\n                    case 128:\n                        result = \"2.16.840.1.101.3.4.1.6\";\n                        break;\n                    case 192:\n                        result = \"2.16.840.1.101.3.4.1.26\";\n                        break;\n                    case 256:\n                        result = \"2.16.840.1.101.3.4.1.46\";\n                        break;\n                }\n                break;\n            case \"AES-CFB\":\n                switch (algorithm.length) {\n                    case 128:\n                        result = \"2.16.840.1.101.3.4.1.4\";\n                        break;\n                    case 192:\n                        result = \"2.16.840.1.101.3.4.1.24\";\n                        break;\n                    case 256:\n                        result = \"2.16.840.1.101.3.4.1.44\";\n                        break;\n                }\n                break;\n            case \"AES-KW\":\n                switch (algorithm.length) {\n                    case 128:\n                        result = \"2.16.840.1.101.3.4.1.5\";\n                        break;\n                    case 192:\n                        result = \"2.16.840.1.101.3.4.1.25\";\n                        break;\n                    case 256:\n                        result = \"2.16.840.1.101.3.4.1.45\";\n                        break;\n                }\n                break;\n            case \"HMAC\":\n                switch (algorithm.hash.name.toUpperCase()) {\n                    case \"SHA-1\":\n                        result = \"1.2.840.113549.2.7\";\n                        break;\n                    case \"SHA-256\":\n                        result = \"1.2.840.113549.2.9\";\n                        break;\n                    case \"SHA-384\":\n                        result = \"1.2.840.113549.2.10\";\n                        break;\n                    case \"SHA-512\":\n                        result = \"1.2.840.113549.2.11\";\n                        break;\n                }\n                break;\n            case \"DH\":\n                result = \"1.2.840.113549.1.9.16.3.5\";\n                break;\n            case \"SHA-1\":\n                result = \"1.3.14.3.2.26\";\n                break;\n            case \"SHA-256\":\n                result = \"2.16.840.1.101.3.4.2.1\";\n                break;\n            case \"SHA-384\":\n                result = \"2.16.840.1.101.3.4.2.2\";\n                break;\n            case \"SHA-512\":\n                result = \"2.16.840.1.101.3.4.2.3\";\n                break;\n            case \"CONCAT\":\n                break;\n            case \"HKDF\":\n                break;\n            case \"PBKDF2\":\n                result = \"1.2.840.113549.1.5.12\";\n                break;\n            case \"P-256\":\n                result = \"1.2.840.10045.3.1.7\";\n                break;\n            case \"P-384\":\n                result = \"1.3.132.0.34\";\n                break;\n            case \"P-521\":\n                result = \"1.3.132.0.35\";\n                break;\n        }\n        if (!result && safety) {\n            throw new Error(`Unsupported algorithm ${target ? `for ${target} ` : EMPTY_STRING}: ${algorithm.name}`);\n        }\n        return result;\n    }\n    getAlgorithmParameters(algorithmName, operation) {\n        let result = {\n            algorithm: {},\n            usages: []\n        };\n        switch (algorithmName.toUpperCase()) {\n            case \"RSAES-PKCS1-V1_5\":\n            case \"RSASSA-PKCS1-V1_5\":\n                switch (operation.toLowerCase()) {\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSASSA-PKCS1-v1_5\",\n                                modulusLength: 2048,\n                                publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    case \"verify\":\n                    case \"sign\":\n                    case \"importkey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSASSA-PKCS1-v1_5\",\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"verify\"]\n                        };\n                        break;\n                    case \"exportkey\":\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"RSASSA-PKCS1-v1_5\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"RSA-PSS\":\n                switch (operation.toLowerCase()) {\n                    case \"sign\":\n                    case \"verify\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-PSS\",\n                                hash: {\n                                    name: \"SHA-1\"\n                                },\n                                saltLength: 20\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-PSS\",\n                                modulusLength: 2048,\n                                publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n                                hash: {\n                                    name: \"SHA-1\"\n                                }\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    case \"importkey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-PSS\",\n                                hash: {\n                                    name: \"SHA-1\"\n                                }\n                            },\n                            usages: [\"verify\"]\n                        };\n                        break;\n                    case \"exportkey\":\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"RSA-PSS\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"RSA-OAEP\":\n                switch (operation.toLowerCase()) {\n                    case \"encrypt\":\n                    case \"decrypt\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-OAEP\"\n                            },\n                            usages: [\"encrypt\", \"decrypt\"]\n                        };\n                        break;\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-OAEP\",\n                                modulusLength: 2048,\n                                publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    case \"importkey\":\n                        result = {\n                            algorithm: {\n                                name: \"RSA-OAEP\",\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"encrypt\"]\n                        };\n                        break;\n                    case \"exportkey\":\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"RSA-OAEP\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"ECDSA\":\n                switch (operation.toLowerCase()) {\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"ECDSA\",\n                                namedCurve: \"P-256\"\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    case \"importkey\":\n                        result = {\n                            algorithm: {\n                                name: \"ECDSA\",\n                                namedCurve: \"P-256\"\n                            },\n                            usages: [\"verify\"]\n                        };\n                        break;\n                    case \"verify\":\n                    case \"sign\":\n                        result = {\n                            algorithm: {\n                                name: \"ECDSA\",\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"sign\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"ECDSA\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"ECDH\":\n                switch (operation.toLowerCase()) {\n                    case \"exportkey\":\n                    case \"importkey\":\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"ECDH\",\n                                namedCurve: \"P-256\"\n                            },\n                            usages: [\"deriveKey\", \"deriveBits\"]\n                        };\n                        break;\n                    case \"derivekey\":\n                    case \"derivebits\":\n                        result = {\n                            algorithm: {\n                                name: \"ECDH\",\n                                namedCurve: \"P-256\",\n                                public: []\n                            },\n                            usages: [\"encrypt\", \"decrypt\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"ECDH\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"AES-CTR\":\n                switch (operation.toLowerCase()) {\n                    case \"importkey\":\n                    case \"exportkey\":\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-CTR\",\n                                length: 256\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    case \"decrypt\":\n                    case \"encrypt\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-CTR\",\n                                counter: new Uint8Array(16),\n                                length: 10\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"AES-CTR\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"AES-CBC\":\n                switch (operation.toLowerCase()) {\n                    case \"importkey\":\n                    case \"exportkey\":\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-CBC\",\n                                length: 256\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    case \"decrypt\":\n                    case \"encrypt\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-CBC\",\n                                iv: this.getRandomValues(new Uint8Array(16))\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"AES-CBC\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"AES-GCM\":\n                switch (operation.toLowerCase()) {\n                    case \"importkey\":\n                    case \"exportkey\":\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-GCM\",\n                                length: 256\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    case \"decrypt\":\n                    case \"encrypt\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-GCM\",\n                                iv: this.getRandomValues(new Uint8Array(16))\n                            },\n                            usages: [\"encrypt\", \"decrypt\", \"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"AES-GCM\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"AES-KW\":\n                switch (operation.toLowerCase()) {\n                    case \"importkey\":\n                    case \"exportkey\":\n                    case \"generatekey\":\n                    case \"wrapkey\":\n                    case \"unwrapkey\":\n                        result = {\n                            algorithm: {\n                                name: \"AES-KW\",\n                                length: 256\n                            },\n                            usages: [\"wrapKey\", \"unwrapKey\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"AES-KW\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"HMAC\":\n                switch (operation.toLowerCase()) {\n                    case \"sign\":\n                    case \"verify\":\n                        result = {\n                            algorithm: {\n                                name: \"HMAC\"\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    case \"importkey\":\n                    case \"exportkey\":\n                    case \"generatekey\":\n                        result = {\n                            algorithm: {\n                                name: \"HMAC\",\n                                length: 32,\n                                hash: {\n                                    name: \"SHA-256\"\n                                }\n                            },\n                            usages: [\"sign\", \"verify\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"HMAC\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"HKDF\":\n                switch (operation.toLowerCase()) {\n                    case \"derivekey\":\n                        result = {\n                            algorithm: {\n                                name: \"HKDF\",\n                                hash: \"SHA-256\",\n                                salt: new Uint8Array([]),\n                                info: new Uint8Array([])\n                            },\n                            usages: [\"encrypt\", \"decrypt\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"HKDF\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n            case \"PBKDF2\":\n                switch (operation.toLowerCase()) {\n                    case \"derivekey\":\n                        result = {\n                            algorithm: {\n                                name: \"PBKDF2\",\n                                hash: { name: \"SHA-256\" },\n                                salt: new Uint8Array([]),\n                                iterations: 10000\n                            },\n                            usages: [\"encrypt\", \"decrypt\"]\n                        };\n                        break;\n                    default:\n                        return {\n                            algorithm: {\n                                name: \"PBKDF2\"\n                            },\n                            usages: []\n                        };\n                }\n                break;\n        }\n        return result;\n    }\n    getHashAlgorithm(signatureAlgorithm) {\n        let result = EMPTY_STRING;\n        switch (signatureAlgorithm.algorithmId) {\n            case \"1.2.840.10045.4.1\":\n            case \"1.2.840.113549.1.1.5\":\n                result = \"SHA-1\";\n                break;\n            case \"1.2.840.10045.4.3.2\":\n            case \"1.2.840.113549.1.1.11\":\n                result = \"SHA-256\";\n                break;\n            case \"1.2.840.10045.4.3.3\":\n            case \"1.2.840.113549.1.1.12\":\n                result = \"SHA-384\";\n                break;\n            case \"1.2.840.10045.4.3.4\":\n            case \"1.2.840.113549.1.1.13\":\n                result = \"SHA-512\";\n                break;\n            case \"1.2.840.113549.1.1.10\":\n                {\n                    try {\n                        const params = new RSASSAPSSParams({ schema: signatureAlgorithm.algorithmParams });\n                        if (params.hashAlgorithm) {\n                            const algorithm = this.getAlgorithmByOID(params.hashAlgorithm.algorithmId);\n                            if (\"name\" in algorithm) {\n                                result = algorithm.name;\n                            }\n                            else {\n                                return EMPTY_STRING;\n                            }\n                        }\n                        else\n                            result = \"SHA-1\";\n                    }\n                    catch {\n                    }\n                }\n                break;\n        }\n        return result;\n    }\n    async encryptEncryptedContentInfo(parameters) {\n        ParameterError.assert(parameters, \"password\", \"contentEncryptionAlgorithm\", \"hmacHashAlgorithm\", \"iterationCount\", \"contentToEncrypt\", \"contentToEncrypt\", \"contentType\");\n        const contentEncryptionOID = this.getOIDByAlgorithm(parameters.contentEncryptionAlgorithm, true, \"contentEncryptionAlgorithm\");\n        const pbkdf2OID = this.getOIDByAlgorithm({\n            name: \"PBKDF2\"\n        }, true, \"PBKDF2\");\n        const hmacOID = this.getOIDByAlgorithm({\n            name: \"HMAC\",\n            hash: {\n                name: parameters.hmacHashAlgorithm\n            }\n        }, true, \"hmacHashAlgorithm\");\n        const ivBuffer = new ArrayBuffer(16);\n        const ivView = new Uint8Array(ivBuffer);\n        this.getRandomValues(ivView);\n        const saltBuffer = new ArrayBuffer(64);\n        const saltView = new Uint8Array(saltBuffer);\n        this.getRandomValues(saltView);\n        const contentView = new Uint8Array(parameters.contentToEncrypt);\n        const pbkdf2Params = new PBKDF2Params({\n            salt: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: saltBuffer }),\n            iterationCount: parameters.iterationCount,\n            prf: new AlgorithmIdentifier({\n                algorithmId: hmacOID,\n                algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n            })\n        });\n        const passwordView = new Uint8Array(parameters.password);\n        const pbkdfKey = await this.importKey(\"raw\", passwordView, \"PBKDF2\", false, [\"deriveKey\"]);\n        const derivedKey = await this.deriveKey({\n            name: \"PBKDF2\",\n            hash: {\n                name: parameters.hmacHashAlgorithm\n            },\n            salt: saltView,\n            iterations: parameters.iterationCount\n        }, pbkdfKey, parameters.contentEncryptionAlgorithm, false, [\"encrypt\"]);\n        const encryptedData = await this.encrypt({\n            name: parameters.contentEncryptionAlgorithm.name,\n            iv: ivView\n        }, derivedKey, contentView);\n        const pbes2Parameters = new PBES2Params({\n            keyDerivationFunc: new AlgorithmIdentifier({\n                algorithmId: pbkdf2OID,\n                algorithmParams: pbkdf2Params.toSchema()\n            }),\n            encryptionScheme: new AlgorithmIdentifier({\n                algorithmId: contentEncryptionOID,\n                algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: ivBuffer })\n            })\n        });\n        return new EncryptedContentInfo({\n            contentType: parameters.contentType,\n            contentEncryptionAlgorithm: new AlgorithmIdentifier({\n                algorithmId: \"1.2.840.113549.1.5.13\",\n                algorithmParams: pbes2Parameters.toSchema()\n            }),\n            encryptedContent: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: encryptedData })\n        });\n    }\n    async decryptEncryptedContentInfo(parameters) {\n        ParameterError.assert(parameters, \"password\", \"encryptedContentInfo\");\n        if (parameters.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId !== \"1.2.840.113549.1.5.13\")\n            throw new Error(`Unknown \"contentEncryptionAlgorithm\": ${parameters.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId}`);\n        let pbes2Parameters;\n        try {\n            pbes2Parameters = new PBES2Params({ schema: parameters.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams });\n        }\n        catch (ex) {\n            throw new Error(\"Incorrectly encoded \\\"pbes2Parameters\\\"\");\n        }\n        let pbkdf2Params;\n        try {\n            pbkdf2Params = new PBKDF2Params({ schema: pbes2Parameters.keyDerivationFunc.algorithmParams });\n        }\n        catch (ex) {\n            throw new Error(\"Incorrectly encoded \\\"pbkdf2Params\\\"\");\n        }\n        const contentEncryptionAlgorithm = this.getAlgorithmByOID(pbes2Parameters.encryptionScheme.algorithmId, true);\n        const ivBuffer = pbes2Parameters.encryptionScheme.algorithmParams.valueBlock.valueHex;\n        const ivView = new Uint8Array(ivBuffer);\n        const saltBuffer = pbkdf2Params.salt.valueBlock.valueHex;\n        const saltView = new Uint8Array(saltBuffer);\n        const iterationCount = pbkdf2Params.iterationCount;\n        let hmacHashAlgorithm = \"SHA-1\";\n        if (pbkdf2Params.prf) {\n            const algorithm = this.getAlgorithmByOID(pbkdf2Params.prf.algorithmId, true);\n            hmacHashAlgorithm = algorithm.hash.name;\n        }\n        const pbkdfKey = await this.importKey(\"raw\", parameters.password, \"PBKDF2\", false, [\"deriveKey\"]);\n        const result = await this.deriveKey({\n            name: \"PBKDF2\",\n            hash: {\n                name: hmacHashAlgorithm\n            },\n            salt: saltView,\n            iterations: iterationCount\n        }, pbkdfKey, contentEncryptionAlgorithm, false, [\"decrypt\"]);\n        const dataBuffer = parameters.encryptedContentInfo.getEncryptedContent();\n        return this.decrypt({\n            name: contentEncryptionAlgorithm.name,\n            iv: ivView\n        }, result, dataBuffer);\n    }\n    async stampDataWithPassword(parameters) {\n        if ((parameters instanceof Object) === false)\n            throw new Error(\"Parameters must have type \\\"Object\\\"\");\n        ParameterError.assert(parameters, \"password\", \"hashAlgorithm\", \"iterationCount\", \"salt\", \"contentToStamp\");\n        let length;\n        switch (parameters.hashAlgorithm.toLowerCase()) {\n            case \"sha-1\":\n                length = 160;\n                break;\n            case \"sha-256\":\n                length = 256;\n                break;\n            case \"sha-384\":\n                length = 384;\n                break;\n            case \"sha-512\":\n                length = 512;\n                break;\n            default:\n                throw new Error(`Incorrect \"parameters.hashAlgorithm\" parameter: ${parameters.hashAlgorithm}`);\n        }\n        const hmacAlgorithm = {\n            name: \"HMAC\",\n            length,\n            hash: {\n                name: parameters.hashAlgorithm\n            }\n        };\n        const pkcsKey = await makePKCS12B2Key(parameters.hashAlgorithm, length, parameters.password, parameters.salt, parameters.iterationCount);\n        const hmacKey = await this.importKey(\"raw\", new Uint8Array(pkcsKey), hmacAlgorithm, false, [\"sign\"]);\n        return this.sign(hmacAlgorithm, hmacKey, new Uint8Array(parameters.contentToStamp));\n    }\n    async verifyDataStampedWithPassword(parameters) {\n        ParameterError.assert(parameters, \"password\", \"hashAlgorithm\", \"salt\", \"iterationCount\", \"contentToVerify\", \"signatureToVerify\");\n        let length = 0;\n        switch (parameters.hashAlgorithm.toLowerCase()) {\n            case \"sha-1\":\n                length = 160;\n                break;\n            case \"sha-256\":\n                length = 256;\n                break;\n            case \"sha-384\":\n                length = 384;\n                break;\n            case \"sha-512\":\n                length = 512;\n                break;\n            default:\n                throw new Error(`Incorrect \"parameters.hashAlgorithm\" parameter: ${parameters.hashAlgorithm}`);\n        }\n        const hmacAlgorithm = {\n            name: \"HMAC\",\n            length,\n            hash: {\n                name: parameters.hashAlgorithm\n            }\n        };\n        const pkcsKey = await makePKCS12B2Key(parameters.hashAlgorithm, length, parameters.password, parameters.salt, parameters.iterationCount);\n        const hmacKey = await this.importKey(\"raw\", new Uint8Array(pkcsKey), hmacAlgorithm, false, [\"verify\"]);\n        return this.verify(hmacAlgorithm, hmacKey, new Uint8Array(parameters.signatureToVerify), new Uint8Array(parameters.contentToVerify));\n    }\n    async getSignatureParameters(privateKey, hashAlgorithm = \"SHA-1\") {\n        this.getOIDByAlgorithm({ name: hashAlgorithm }, true, \"hashAlgorithm\");\n        const signatureAlgorithm = new AlgorithmIdentifier();\n        const parameters = this.getAlgorithmParameters(privateKey.algorithm.name, \"sign\");\n        if (!Object.keys(parameters.algorithm).length) {\n            throw new Error(\"Parameter 'algorithm' is empty\");\n        }\n        const algorithm = parameters.algorithm;\n        if (\"hash\" in privateKey.algorithm && privateKey.algorithm.hash && privateKey.algorithm.hash.name) {\n            algorithm.hash.name = privateKey.algorithm.hash.name;\n        }\n        else {\n            algorithm.hash.name = hashAlgorithm;\n        }\n        switch (privateKey.algorithm.name.toUpperCase()) {\n            case \"RSASSA-PKCS1-V1_5\":\n            case \"ECDSA\":\n                signatureAlgorithm.algorithmId = this.getOIDByAlgorithm(algorithm, true);\n                break;\n            case \"RSA-PSS\":\n                {\n                    switch (algorithm.hash.name.toUpperCase()) {\n                        case \"SHA-256\":\n                            algorithm.saltLength = 32;\n                            break;\n                        case \"SHA-384\":\n                            algorithm.saltLength = 48;\n                            break;\n                        case \"SHA-512\":\n                            algorithm.saltLength = 64;\n                            break;\n                    }\n                    const paramsObject = {};\n                    if (algorithm.hash.name.toUpperCase() !== \"SHA-1\") {\n                        const hashAlgorithmOID = this.getOIDByAlgorithm({ name: algorithm.hash.name }, true, \"hashAlgorithm\");\n                        paramsObject.hashAlgorithm = new AlgorithmIdentifier({\n                            algorithmId: hashAlgorithmOID,\n                            algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                        });\n                        paramsObject.maskGenAlgorithm = new AlgorithmIdentifier({\n                            algorithmId: \"1.2.840.113549.1.1.8\",\n                            algorithmParams: paramsObject.hashAlgorithm.toSchema()\n                        });\n                    }\n                    if (algorithm.saltLength !== 20)\n                        paramsObject.saltLength = algorithm.saltLength;\n                    const pssParameters = new RSASSAPSSParams(paramsObject);\n                    signatureAlgorithm.algorithmId = \"1.2.840.113549.1.1.10\";\n                    signatureAlgorithm.algorithmParams = pssParameters.toSchema();\n                }\n                break;\n            default:\n                throw new Error(`Unsupported signature algorithm: ${privateKey.algorithm.name}`);\n        }\n        return {\n            signatureAlgorithm,\n            parameters\n        };\n    }\n    async signWithPrivateKey(data, privateKey, parameters) {\n        const signature = await this.sign(parameters.algorithm, privateKey, data);\n        if (parameters.algorithm.name === \"ECDSA\") {\n            return createCMSECDSASignature(signature);\n        }\n        return signature;\n    }\n    fillPublicKeyParameters(publicKeyInfo, signatureAlgorithm) {\n        const parameters = {};\n        const shaAlgorithm = this.getHashAlgorithm(signatureAlgorithm);\n        if (shaAlgorithm === EMPTY_STRING)\n            throw new Error(`Unsupported signature algorithm: ${signatureAlgorithm.algorithmId}`);\n        let algorithmId;\n        if (signatureAlgorithm.algorithmId === \"1.2.840.113549.1.1.10\")\n            algorithmId = signatureAlgorithm.algorithmId;\n        else\n            algorithmId = publicKeyInfo.algorithm.algorithmId;\n        const algorithmObject = this.getAlgorithmByOID(algorithmId, true);\n        parameters.algorithm = this.getAlgorithmParameters(algorithmObject.name, \"importKey\");\n        if (\"hash\" in parameters.algorithm.algorithm)\n            parameters.algorithm.algorithm.hash.name = shaAlgorithm;\n        if (algorithmObject.name === \"ECDSA\") {\n            const publicKeyAlgorithm = publicKeyInfo.algorithm;\n            if (!publicKeyAlgorithm.algorithmParams) {\n                throw new Error(\"Algorithm parameters for ECDSA public key are missed\");\n            }\n            const publicKeyAlgorithmParams = publicKeyAlgorithm.algorithmParams;\n            if (\"idBlock\" in publicKeyAlgorithm.algorithmParams) {\n                if (!((publicKeyAlgorithmParams.idBlock.tagClass === 1) && (publicKeyAlgorithmParams.idBlock.tagNumber === 6))) {\n                    throw new Error(\"Incorrect type for ECDSA public key parameters\");\n                }\n            }\n            const curveObject = this.getAlgorithmByOID(publicKeyAlgorithmParams.valueBlock.toString(), true);\n            parameters.algorithm.algorithm.namedCurve = curveObject.name;\n        }\n        return parameters;\n    }\n    async getPublicKey(publicKeyInfo, signatureAlgorithm, parameters) {\n        if (!parameters) {\n            parameters = this.fillPublicKeyParameters(publicKeyInfo, signatureAlgorithm);\n        }\n        const publicKeyInfoBuffer = publicKeyInfo.toSchema().toBER(false);\n        return this.importKey(\"spki\", publicKeyInfoBuffer, parameters.algorithm.algorithm, true, parameters.algorithm.usages);\n    }\n    async verifyWithPublicKey(data, signature, publicKeyInfo, signatureAlgorithm, shaAlgorithm) {\n        let publicKey;\n        if (!shaAlgorithm) {\n            shaAlgorithm = this.getHashAlgorithm(signatureAlgorithm);\n            if (!shaAlgorithm)\n                throw new Error(`Unsupported signature algorithm: ${signatureAlgorithm.algorithmId}`);\n            publicKey = await this.getPublicKey(publicKeyInfo, signatureAlgorithm);\n        }\n        else {\n            const parameters = {};\n            let algorithmId;\n            if (signatureAlgorithm.algorithmId === \"1.2.840.113549.1.1.10\")\n                algorithmId = signatureAlgorithm.algorithmId;\n            else\n                algorithmId = publicKeyInfo.algorithm.algorithmId;\n            const algorithmObject = this.getAlgorithmByOID(algorithmId, true);\n            parameters.algorithm = this.getAlgorithmParameters(algorithmObject.name, \"importKey\");\n            if (\"hash\" in parameters.algorithm.algorithm)\n                parameters.algorithm.algorithm.hash.name = shaAlgorithm;\n            if (algorithmObject.name === \"ECDSA\") {\n                let algorithmParamsChecked = false;\n                if ((\"algorithmParams\" in publicKeyInfo.algorithm) === true) {\n                    if (\"idBlock\" in publicKeyInfo.algorithm.algorithmParams) {\n                        if ((publicKeyInfo.algorithm.algorithmParams.idBlock.tagClass === 1) && (publicKeyInfo.algorithm.algorithmParams.idBlock.tagNumber === 6))\n                            algorithmParamsChecked = true;\n                    }\n                }\n                if (algorithmParamsChecked === false) {\n                    throw new Error(\"Incorrect type for ECDSA public key parameters\");\n                }\n                const curveObject = this.getAlgorithmByOID(publicKeyInfo.algorithm.algorithmParams.valueBlock.toString(), true);\n                parameters.algorithm.algorithm.namedCurve = curveObject.name;\n            }\n            publicKey = await this.getPublicKey(publicKeyInfo, null, parameters);\n        }\n        const algorithm = this.getAlgorithmParameters(publicKey.algorithm.name, \"verify\");\n        if (\"hash\" in algorithm.algorithm)\n            algorithm.algorithm.hash.name = shaAlgorithm;\n        let signatureValue = signature.valueBlock.valueHexView;\n        if (publicKey.algorithm.name === \"ECDSA\") {\n            const namedCurve = ECNamedCurves.find(publicKey.algorithm.namedCurve);\n            if (!namedCurve) {\n                throw new Error(\"Unsupported named curve in use\");\n            }\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(signatureValue);\n            AsnError.assert(asn1, \"Signature value\");\n            signatureValue = createECDSASignatureFromCMS(asn1.result, namedCurve.size);\n        }\n        if (publicKey.algorithm.name === \"RSA-PSS\") {\n            const pssParameters = new RSASSAPSSParams({ schema: signatureAlgorithm.algorithmParams });\n            if (\"saltLength\" in pssParameters)\n                algorithm.algorithm.saltLength = pssParameters.saltLength;\n            else\n                algorithm.algorithm.saltLength = 20;\n            let hashAlgo = \"SHA-1\";\n            if (\"hashAlgorithm\" in pssParameters) {\n                const hashAlgorithm = this.getAlgorithmByOID(pssParameters.hashAlgorithm.algorithmId, true);\n                hashAlgo = hashAlgorithm.name;\n            }\n            algorithm.algorithm.hash.name = hashAlgo;\n        }\n        return this.verify(algorithm.algorithm, publicKey, signatureValue, data);\n    }\n}\n\nlet engine = {\n    name: \"none\",\n    crypto: null,\n};\nfunction isCryptoEngine(engine) {\n    return engine\n        && typeof engine === \"object\"\n        && \"crypto\" in engine\n        ? true\n        : false;\n}\nfunction setEngine(name, ...args) {\n    let crypto = null;\n    if (args.length < 2) {\n        if (args.length) {\n            crypto = args[0];\n        }\n        else {\n            crypto = typeof self !== \"undefined\" && self.crypto ? new CryptoEngine({ name: \"browser\", crypto: self.crypto }) : null;\n        }\n    }\n    else {\n        const cryptoArg = args[0];\n        const subtleArg = args[1];\n        if (isCryptoEngine(subtleArg)) {\n            crypto = subtleArg;\n        }\n        else if (isCryptoEngine(cryptoArg)) {\n            crypto = cryptoArg;\n        }\n        else if (\"subtle\" in cryptoArg && \"getRandomValues\" in cryptoArg) {\n            crypto = new CryptoEngine({\n                crypto: cryptoArg,\n            });\n        }\n    }\n    if ((typeof process !== \"undefined\") && (\"pid\" in process) && (typeof global !== \"undefined\") && (typeof window === \"undefined\")) {\n        if (typeof global[process.pid] === \"undefined\") {\n            global[process.pid] = {};\n        }\n        else {\n            if (typeof global[process.pid] !== \"object\") {\n                throw new Error(`Name global.${process.pid} already exists and it is not an object`);\n            }\n        }\n        if (typeof global[process.pid].pkijs === \"undefined\") {\n            global[process.pid].pkijs = {};\n        }\n        else {\n            if (typeof global[process.pid].pkijs !== \"object\") {\n                throw new Error(`Name global.${process.pid}.pkijs already exists and it is not an object`);\n            }\n        }\n        global[process.pid].pkijs.engine = {\n            name: name,\n            crypto,\n        };\n    }\n    else {\n        engine = {\n            name: name,\n            crypto,\n        };\n    }\n}\nfunction getEngine() {\n    if ((typeof process !== \"undefined\") && (\"pid\" in process) && (typeof global !== \"undefined\") && (typeof window === \"undefined\")) {\n        let _engine;\n        try {\n            _engine = global[process.pid].pkijs.engine;\n        }\n        catch (ex) {\n            throw new Error(\"Please call 'setEngine' before call to 'getEngine'\");\n        }\n        return _engine;\n    }\n    return engine;\n}\nfunction getCrypto(safety = false) {\n    const _engine = getEngine();\n    if (!_engine.crypto && safety) {\n        throw new Error(\"Unable to create WebCrypto object\");\n    }\n    return _engine.crypto;\n}\nfunction getRandomValues(view) {\n    return getCrypto(true).getRandomValues(view);\n}\nfunction getOIDByAlgorithm(algorithm, safety, target) {\n    return getCrypto(true).getOIDByAlgorithm(algorithm, safety, target);\n}\nfunction getAlgorithmParameters(algorithmName, operation) {\n    return getCrypto(true).getAlgorithmParameters(algorithmName, operation);\n}\nfunction createCMSECDSASignature(signatureBuffer) {\n    if ((signatureBuffer.byteLength % 2) !== 0)\n        return EMPTY_BUFFER;\n    const length = signatureBuffer.byteLength / 2;\n    const rBuffer = new ArrayBuffer(length);\n    const rView = new Uint8Array(rBuffer);\n    rView.set(new Uint8Array(signatureBuffer, 0, length));\n    const rInteger = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: rBuffer });\n    const sBuffer = new ArrayBuffer(length);\n    const sView = new Uint8Array(sBuffer);\n    sView.set(new Uint8Array(signatureBuffer, length, length));\n    const sInteger = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ valueHex: sBuffer });\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        value: [\n            rInteger.convertToDER(),\n            sInteger.convertToDER()\n        ]\n    })).toBER(false);\n}\nfunction createECDSASignatureFromCMS(cmsSignature, pointSize) {\n    if (!(cmsSignature instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence\n        && cmsSignature.valueBlock.value.length === 2\n        && cmsSignature.valueBlock.value[0] instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer\n        && cmsSignature.valueBlock.value[1] instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer))\n        return EMPTY_BUFFER;\n    const rValueView = cmsSignature.valueBlock.value[0].convertFromDER().valueBlock.valueHexView;\n    const sValueView = cmsSignature.valueBlock.value[1].convertFromDER().valueBlock.valueHexView;\n    const res = new Uint8Array(pointSize * 2);\n    res.set(rValueView, pointSize - rValueView.byteLength);\n    res.set(sValueView, (2 * pointSize) - sValueView.byteLength);\n    return res.buffer;\n}\nfunction getAlgorithmByOID(oid, safety = false, target) {\n    return getCrypto(true).getAlgorithmByOID(oid, safety, target);\n}\nfunction getHashAlgorithm(signatureAlgorithm) {\n    return getCrypto(true).getHashAlgorithm(signatureAlgorithm);\n}\nasync function kdfWithCounter(hashFunction, zBuffer, Counter, SharedInfo, crypto) {\n    switch (hashFunction.toUpperCase()) {\n        case \"SHA-1\":\n        case \"SHA-256\":\n        case \"SHA-384\":\n        case \"SHA-512\":\n            break;\n        default:\n            throw new ArgumentError(`Unknown hash function: ${hashFunction}`);\n    }\n    ArgumentError.assert(zBuffer, \"zBuffer\", \"ArrayBuffer\");\n    if (zBuffer.byteLength === 0)\n        throw new ArgumentError(\"'zBuffer' has zero length, error\");\n    ArgumentError.assert(SharedInfo, \"SharedInfo\", \"ArrayBuffer\");\n    if (Counter > 255)\n        throw new ArgumentError(\"Please set 'Counter' argument to value less or equal to 255\");\n    const counterBuffer = new ArrayBuffer(4);\n    const counterView = new Uint8Array(counterBuffer);\n    counterView[0] = 0x00;\n    counterView[1] = 0x00;\n    counterView[2] = 0x00;\n    counterView[3] = Counter;\n    let combinedBuffer = EMPTY_BUFFER;\n    combinedBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf(combinedBuffer, zBuffer);\n    combinedBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf(combinedBuffer, counterBuffer);\n    combinedBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf(combinedBuffer, SharedInfo);\n    const result = await crypto.digest({ name: hashFunction }, combinedBuffer);\n    return {\n        counter: Counter,\n        result\n    };\n}\nasync function kdf(hashFunction, Zbuffer, keydatalen, SharedInfo, crypto = getCrypto(true)) {\n    let hashLength = 0;\n    let maxCounter = 1;\n    switch (hashFunction.toUpperCase()) {\n        case \"SHA-1\":\n            hashLength = 160;\n            break;\n        case \"SHA-256\":\n            hashLength = 256;\n            break;\n        case \"SHA-384\":\n            hashLength = 384;\n            break;\n        case \"SHA-512\":\n            hashLength = 512;\n            break;\n        default:\n            throw new ArgumentError(`Unknown hash function: ${hashFunction}`);\n    }\n    ArgumentError.assert(Zbuffer, \"Zbuffer\", \"ArrayBuffer\");\n    if (Zbuffer.byteLength === 0)\n        throw new ArgumentError(\"'Zbuffer' has zero length, error\");\n    ArgumentError.assert(SharedInfo, \"SharedInfo\", \"ArrayBuffer\");\n    const quotient = keydatalen / hashLength;\n    if (Math.floor(quotient) > 0) {\n        maxCounter = Math.floor(quotient);\n        if ((quotient - maxCounter) > 0)\n            maxCounter++;\n    }\n    const incomingResult = [];\n    for (let i = 1; i <= maxCounter; i++)\n        incomingResult.push(await kdfWithCounter(hashFunction, Zbuffer, i, SharedInfo, crypto));\n    let combinedBuffer = EMPTY_BUFFER;\n    let currentCounter = 1;\n    let found = true;\n    while (found) {\n        found = false;\n        for (const result of incomingResult) {\n            if (result.counter === currentCounter) {\n                combinedBuffer = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilConcatBuf(combinedBuffer, result.result);\n                found = true;\n                break;\n            }\n        }\n        currentCounter++;\n    }\n    keydatalen >>= 3;\n    if (combinedBuffer.byteLength > keydatalen) {\n        const newBuffer = new ArrayBuffer(keydatalen);\n        const newView = new Uint8Array(newBuffer);\n        const combinedView = new Uint8Array(combinedBuffer);\n        for (let i = 0; i < keydatalen; i++)\n            newView[i] = combinedView[i];\n        return newBuffer;\n    }\n    return combinedBuffer;\n}\n\nconst VERSION$i = \"version\";\nconst LOG_ID = \"logID\";\nconst EXTENSIONS$6 = \"extensions\";\nconst TIMESTAMP = \"timestamp\";\nconst HASH_ALGORITHM$3 = \"hashAlgorithm\";\nconst SIGNATURE_ALGORITHM$8 = \"signatureAlgorithm\";\nconst SIGNATURE$7 = \"signature\";\nconst NONE = \"none\";\nconst MD5 = \"md5\";\nconst SHA1 = \"sha1\";\nconst SHA224 = \"sha224\";\nconst SHA256 = \"sha256\";\nconst SHA384 = \"sha384\";\nconst SHA512 = \"sha512\";\nconst ANONYMOUS = \"anonymous\";\nconst RSA = \"rsa\";\nconst DSA = \"dsa\";\nconst ECDSA = \"ecdsa\";\nclass SignedCertificateTimestamp extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$i, SignedCertificateTimestamp.defaultValues(VERSION$i));\n        this.logID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, LOG_ID, SignedCertificateTimestamp.defaultValues(LOG_ID));\n        this.timestamp = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TIMESTAMP, SignedCertificateTimestamp.defaultValues(TIMESTAMP));\n        this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$6, SignedCertificateTimestamp.defaultValues(EXTENSIONS$6));\n        this.hashAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASH_ALGORITHM$3, SignedCertificateTimestamp.defaultValues(HASH_ALGORITHM$3));\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$8, SignedCertificateTimestamp.defaultValues(SIGNATURE_ALGORITHM$8));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$7, SignedCertificateTimestamp.defaultValues(SIGNATURE$7));\n        if (\"stream\" in parameters && parameters.stream) {\n            this.fromStream(parameters.stream);\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$i:\n                return 0;\n            case LOG_ID:\n            case EXTENSIONS$6:\n                return EMPTY_BUFFER;\n            case TIMESTAMP:\n                return new Date(0);\n            case HASH_ALGORITHM$3:\n            case SIGNATURE_ALGORITHM$8:\n                return EMPTY_STRING;\n            case SIGNATURE$7:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    fromSchema(schema) {\n        if ((schema instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.RawData) === false)\n            throw new Error(\"Object's schema was not verified against input data for SignedCertificateTimestamp\");\n        const seqStream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream({\n            stream: new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.ByteStream({\n                buffer: schema.data\n            })\n        });\n        this.fromStream(seqStream);\n    }\n    fromStream(stream) {\n        const blockLength = stream.getUint16();\n        this.version = (stream.getBlock(1))[0];\n        if (this.version === 0) {\n            this.logID = (new Uint8Array(stream.getBlock(32))).buffer.slice(0);\n            this.timestamp = new Date(pvutils__WEBPACK_IMPORTED_MODULE_2__.utilFromBase(new Uint8Array(stream.getBlock(8)), 8));\n            const extensionsLength = stream.getUint16();\n            this.extensions = (new Uint8Array(stream.getBlock(extensionsLength))).buffer.slice(0);\n            switch ((stream.getBlock(1))[0]) {\n                case 0:\n                    this.hashAlgorithm = NONE;\n                    break;\n                case 1:\n                    this.hashAlgorithm = MD5;\n                    break;\n                case 2:\n                    this.hashAlgorithm = SHA1;\n                    break;\n                case 3:\n                    this.hashAlgorithm = SHA224;\n                    break;\n                case 4:\n                    this.hashAlgorithm = SHA256;\n                    break;\n                case 5:\n                    this.hashAlgorithm = SHA384;\n                    break;\n                case 6:\n                    this.hashAlgorithm = SHA512;\n                    break;\n                default:\n                    throw new Error(\"Object's stream was not correct for SignedCertificateTimestamp\");\n            }\n            switch ((stream.getBlock(1))[0]) {\n                case 0:\n                    this.signatureAlgorithm = ANONYMOUS;\n                    break;\n                case 1:\n                    this.signatureAlgorithm = RSA;\n                    break;\n                case 2:\n                    this.signatureAlgorithm = DSA;\n                    break;\n                case 3:\n                    this.signatureAlgorithm = ECDSA;\n                    break;\n                default:\n                    throw new Error(\"Object's stream was not correct for SignedCertificateTimestamp\");\n            }\n            const signatureLength = stream.getUint16();\n            const signatureData = new Uint8Array(stream.getBlock(signatureLength)).buffer.slice(0);\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(signatureData);\n            AsnError.assert(asn1, \"SignedCertificateTimestamp\");\n            this.signature = asn1.result;\n            if (blockLength !== (47 + extensionsLength + signatureLength)) {\n                throw new Error(\"Object's stream was not correct for SignedCertificateTimestamp\");\n            }\n        }\n    }\n    toSchema() {\n        const stream = this.toStream();\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.RawData({ data: stream.stream.buffer });\n    }\n    toStream() {\n        const stream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream();\n        stream.appendUint16(47 + this.extensions.byteLength + this.signature.valueBeforeDecodeView.byteLength);\n        stream.appendChar(this.version);\n        stream.appendView(new Uint8Array(this.logID));\n        const timeBuffer = new ArrayBuffer(8);\n        const timeView = new Uint8Array(timeBuffer);\n        const baseArray = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilToBase(this.timestamp.valueOf(), 8);\n        timeView.set(new Uint8Array(baseArray), 8 - baseArray.byteLength);\n        stream.appendView(timeView);\n        stream.appendUint16(this.extensions.byteLength);\n        if (this.extensions.byteLength)\n            stream.appendView(new Uint8Array(this.extensions));\n        let _hashAlgorithm;\n        switch (this.hashAlgorithm.toLowerCase()) {\n            case NONE:\n                _hashAlgorithm = 0;\n                break;\n            case MD5:\n                _hashAlgorithm = 1;\n                break;\n            case SHA1:\n                _hashAlgorithm = 2;\n                break;\n            case SHA224:\n                _hashAlgorithm = 3;\n                break;\n            case SHA256:\n                _hashAlgorithm = 4;\n                break;\n            case SHA384:\n                _hashAlgorithm = 5;\n                break;\n            case SHA512:\n                _hashAlgorithm = 6;\n                break;\n            default:\n                throw new Error(`Incorrect data for hashAlgorithm: ${this.hashAlgorithm}`);\n        }\n        stream.appendChar(_hashAlgorithm);\n        let _signatureAlgorithm;\n        switch (this.signatureAlgorithm.toLowerCase()) {\n            case ANONYMOUS:\n                _signatureAlgorithm = 0;\n                break;\n            case RSA:\n                _signatureAlgorithm = 1;\n                break;\n            case DSA:\n                _signatureAlgorithm = 2;\n                break;\n            case ECDSA:\n                _signatureAlgorithm = 3;\n                break;\n            default:\n                throw new Error(`Incorrect data for signatureAlgorithm: ${this.signatureAlgorithm}`);\n        }\n        stream.appendChar(_signatureAlgorithm);\n        const _signature = this.signature.toBER(false);\n        stream.appendUint16(_signature.byteLength);\n        stream.appendView(new Uint8Array(_signature));\n        return stream;\n    }\n    toJSON() {\n        return {\n            version: this.version,\n            logID: pvutils__WEBPACK_IMPORTED_MODULE_2__.bufferToHexCodes(this.logID),\n            timestamp: this.timestamp,\n            extensions: pvutils__WEBPACK_IMPORTED_MODULE_2__.bufferToHexCodes(this.extensions),\n            hashAlgorithm: this.hashAlgorithm,\n            signatureAlgorithm: this.signatureAlgorithm,\n            signature: this.signature.toJSON()\n        };\n    }\n    async verify(logs, data, dataType = 0, crypto = getCrypto(true)) {\n        const logId = pvutils__WEBPACK_IMPORTED_MODULE_2__.toBase64(pvutils__WEBPACK_IMPORTED_MODULE_2__.arrayBufferToString(this.logID));\n        let publicKeyBase64 = null;\n        const stream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream();\n        for (const log of logs) {\n            if (log.log_id === logId) {\n                publicKeyBase64 = log.key;\n                break;\n            }\n        }\n        if (!publicKeyBase64) {\n            throw new Error(`Public key not found for CT with logId: ${logId}`);\n        }\n        const pki = pvutils__WEBPACK_IMPORTED_MODULE_2__.stringToArrayBuffer(pvutils__WEBPACK_IMPORTED_MODULE_2__.fromBase64(publicKeyBase64));\n        const publicKeyInfo = PublicKeyInfo.fromBER(pki);\n        stream.appendChar(0x00);\n        stream.appendChar(0x00);\n        const timeBuffer = new ArrayBuffer(8);\n        const timeView = new Uint8Array(timeBuffer);\n        const baseArray = pvutils__WEBPACK_IMPORTED_MODULE_2__.utilToBase(this.timestamp.valueOf(), 8);\n        timeView.set(new Uint8Array(baseArray), 8 - baseArray.byteLength);\n        stream.appendView(timeView);\n        stream.appendUint16(dataType);\n        if (dataType === 0)\n            stream.appendUint24(data.byteLength);\n        stream.appendView(new Uint8Array(data));\n        stream.appendUint16(this.extensions.byteLength);\n        if (this.extensions.byteLength !== 0)\n            stream.appendView(new Uint8Array(this.extensions));\n        return crypto.verifyWithPublicKey(stream.buffer.slice(0, stream.length), new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: this.signature.toBER(false) }), publicKeyInfo, { algorithmId: EMPTY_STRING }, \"SHA-256\");\n    }\n}\nSignedCertificateTimestamp.CLASS_NAME = \"SignedCertificateTimestamp\";\nasync function verifySCTsForCertificate(certificate, issuerCertificate, logs, index = (-1), crypto = getCrypto(true)) {\n    let parsedValue = null;\n    const stream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream();\n    if (certificate.extensions) {\n        for (let i = certificate.extensions.length - 1; i >= 0; i--) {\n            switch (certificate.extensions[i].extnID) {\n                case id_SignedCertificateTimestampList:\n                    {\n                        parsedValue = certificate.extensions[i].parsedValue;\n                        if (!parsedValue || parsedValue.timestamps.length === 0)\n                            throw new Error(\"Nothing to verify in the certificate\");\n                        certificate.extensions.splice(i, 1);\n                    }\n                    break;\n            }\n        }\n    }\n    if (parsedValue === null)\n        throw new Error(\"No SignedCertificateTimestampList extension in the specified certificate\");\n    const tbs = certificate.encodeTBS().toBER();\n    const issuerId = await crypto.digest({ name: \"SHA-256\" }, new Uint8Array(issuerCertificate.subjectPublicKeyInfo.toSchema().toBER(false)));\n    stream.appendView(new Uint8Array(issuerId));\n    stream.appendUint24(tbs.byteLength);\n    stream.appendView(new Uint8Array(tbs));\n    const preCert = stream.stream.slice(0, stream.length);\n    if (index === (-1)) {\n        const verifyArray = [];\n        for (const timestamp of parsedValue.timestamps) {\n            const verifyResult = await timestamp.verify(logs, preCert.buffer, 1, crypto);\n            verifyArray.push(verifyResult);\n        }\n        return verifyArray;\n    }\n    if (index >= parsedValue.timestamps.length)\n        index = (parsedValue.timestamps.length - 1);\n    return [await parsedValue.timestamps[index].verify(logs, preCert.buffer, 1, crypto)];\n}\n\nconst TIMESTAMPS = \"timestamps\";\nclass SignedCertificateTimestampList extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.timestamps = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TIMESTAMPS, SignedCertificateTimestampList.defaultValues(TIMESTAMPS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TIMESTAMPS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TIMESTAMPS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        var _a;\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        (_a = names.optional) !== null && _a !== void 0 ? _a : (names.optional = false);\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({\n            name: (names.blockName || \"SignedCertificateTimestampList\"),\n            optional: names.optional\n        }));\n    }\n    fromSchema(schema) {\n        if ((schema instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString) === false) {\n            throw new Error(\"Object's schema was not verified against input data for SignedCertificateTimestampList\");\n        }\n        const seqStream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream({\n            stream: new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.ByteStream({\n                buffer: schema.valueBlock.valueHex\n            })\n        });\n        const dataLength = seqStream.getUint16();\n        if (dataLength !== seqStream.length) {\n            throw new Error(\"Object's schema was not verified against input data for SignedCertificateTimestampList\");\n        }\n        while (seqStream.length) {\n            this.timestamps.push(new SignedCertificateTimestamp({ stream: seqStream }));\n        }\n    }\n    toSchema() {\n        const stream = new bytestreamjs__WEBPACK_IMPORTED_MODULE_3__.SeqStream();\n        let overallLength = 0;\n        const timestampsData = [];\n        for (const timestamp of this.timestamps) {\n            const timestampStream = timestamp.toStream();\n            timestampsData.push(timestampStream);\n            overallLength += timestampStream.stream.buffer.byteLength;\n        }\n        stream.appendUint16(overallLength);\n        for (const timestamp of timestampsData) {\n            stream.appendView(timestamp.stream.view);\n        }\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: stream.stream.buffer.slice(0) });\n    }\n    toJSON() {\n        return {\n            timestamps: Array.from(this.timestamps, o => o.toJSON())\n        };\n    }\n}\nSignedCertificateTimestampList.CLASS_NAME = \"SignedCertificateTimestampList\";\n\nconst ATTRIBUTES$4 = \"attributes\";\nconst CLEAR_PROPS$11 = [\n    ATTRIBUTES$4\n];\nclass SubjectDirectoryAttributes extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES$4, SubjectDirectoryAttributes.defaultValues(ATTRIBUTES$4));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ATTRIBUTES$4:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.attributes || EMPTY_STRING),\n                    value: Attribute.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$11);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SubjectDirectoryAttributes.schema({\n            names: {\n                attributes: ATTRIBUTES$4\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.attributes = Array.from(asn1.result.attributes, element => new Attribute({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.attributes, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            attributes: Array.from(this.attributes, o => o.toJSON())\n        };\n    }\n}\nSubjectDirectoryAttributes.CLASS_NAME = \"SubjectDirectoryAttributes\";\n\nclass ExtensionValueFactory {\n    static getItems() {\n        if (!this.types) {\n            this.types = {};\n            ExtensionValueFactory.register(id_SubjectAltName, \"SubjectAltName\", AltName);\n            ExtensionValueFactory.register(id_IssuerAltName, \"IssuerAltName\", AltName);\n            ExtensionValueFactory.register(id_AuthorityKeyIdentifier, \"AuthorityKeyIdentifier\", AuthorityKeyIdentifier);\n            ExtensionValueFactory.register(id_BasicConstraints, \"BasicConstraints\", BasicConstraints);\n            ExtensionValueFactory.register(id_MicrosoftCaVersion, \"MicrosoftCaVersion\", CAVersion);\n            ExtensionValueFactory.register(id_CertificatePolicies, \"CertificatePolicies\", CertificatePolicies);\n            ExtensionValueFactory.register(id_MicrosoftAppPolicies, \"CertificatePoliciesMicrosoft\", CertificatePolicies);\n            ExtensionValueFactory.register(id_MicrosoftCertTemplateV2, \"MicrosoftCertTemplateV2\", CertificateTemplate);\n            ExtensionValueFactory.register(id_CRLDistributionPoints, \"CRLDistributionPoints\", CRLDistributionPoints);\n            ExtensionValueFactory.register(id_FreshestCRL, \"FreshestCRL\", CRLDistributionPoints);\n            ExtensionValueFactory.register(id_ExtKeyUsage, \"ExtKeyUsage\", ExtKeyUsage);\n            ExtensionValueFactory.register(id_CertificateIssuer, \"CertificateIssuer\", GeneralNames);\n            ExtensionValueFactory.register(id_AuthorityInfoAccess, \"AuthorityInfoAccess\", InfoAccess);\n            ExtensionValueFactory.register(id_SubjectInfoAccess, \"SubjectInfoAccess\", InfoAccess);\n            ExtensionValueFactory.register(id_IssuingDistributionPoint, \"IssuingDistributionPoint\", IssuingDistributionPoint);\n            ExtensionValueFactory.register(id_NameConstraints, \"NameConstraints\", NameConstraints);\n            ExtensionValueFactory.register(id_PolicyConstraints, \"PolicyConstraints\", PolicyConstraints);\n            ExtensionValueFactory.register(id_PolicyMappings, \"PolicyMappings\", PolicyMappings);\n            ExtensionValueFactory.register(id_PrivateKeyUsagePeriod, \"PrivateKeyUsagePeriod\", PrivateKeyUsagePeriod);\n            ExtensionValueFactory.register(id_QCStatements, \"QCStatements\", QCStatements);\n            ExtensionValueFactory.register(id_SignedCertificateTimestampList, \"SignedCertificateTimestampList\", SignedCertificateTimestampList);\n            ExtensionValueFactory.register(id_SubjectDirectoryAttributes, \"SubjectDirectoryAttributes\", SubjectDirectoryAttributes);\n        }\n        return this.types;\n    }\n    static fromBER(id, raw) {\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(raw);\n        if (asn1.offset === -1) {\n            return null;\n        }\n        const item = this.find(id);\n        if (item) {\n            try {\n                return new item.type({ schema: asn1.result });\n            }\n            catch (ex) {\n                const res = new item.type();\n                res.parsingError = `Incorrectly formatted value of extension ${item.name} (${id})`;\n                return res;\n            }\n        }\n        return asn1.result;\n    }\n    static find(id) {\n        const types = this.getItems();\n        return types[id] || null;\n    }\n    static register(id, name, type) {\n        this.getItems()[id] = { name, type };\n    }\n}\n\nconst EXTN_ID = \"extnID\";\nconst CRITICAL = \"critical\";\nconst EXTN_VALUE = \"extnValue\";\nconst PARSED_VALUE$5 = \"parsedValue\";\nconst CLEAR_PROPS$10 = [\n    EXTN_ID,\n    CRITICAL,\n    EXTN_VALUE\n];\nclass Extension extends PkiObject {\n    get parsedValue() {\n        if (this._parsedValue === undefined) {\n            const parsedValue = ExtensionValueFactory.fromBER(this.extnID, this.extnValue.valueBlock.valueHexView);\n            this._parsedValue = parsedValue;\n        }\n        return this._parsedValue || undefined;\n    }\n    set parsedValue(value) {\n        this._parsedValue = value;\n    }\n    constructor(parameters = {}) {\n        super();\n        this.extnID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTN_ID, Extension.defaultValues(EXTN_ID));\n        this.critical = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRITICAL, Extension.defaultValues(CRITICAL));\n        if (EXTN_VALUE in parameters) {\n            this.extnValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: parameters.extnValue });\n        }\n        else {\n            this.extnValue = Extension.defaultValues(EXTN_VALUE);\n        }\n        if (PARSED_VALUE$5 in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE$5, Extension.defaultValues(PARSED_VALUE$5));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case EXTN_ID:\n                return EMPTY_STRING;\n            case CRITICAL:\n                return false;\n            case EXTN_VALUE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case PARSED_VALUE$5:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.extnID || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({\n                    name: (names.critical || EMPTY_STRING),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.extnValue || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$10);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Extension.schema({\n            names: {\n                extnID: EXTN_ID,\n                critical: CRITICAL,\n                extnValue: EXTN_VALUE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.extnID = asn1.result.extnID.valueBlock.toString();\n        if (CRITICAL in asn1.result) {\n            this.critical = asn1.result.critical.valueBlock.value;\n        }\n        this.extnValue = asn1.result.extnValue;\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.extnID }));\n        if (this.critical !== Extension.defaultValues(CRITICAL)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({ value: this.critical }));\n        }\n        outputArray.push(this.extnValue);\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const object = {\n            extnID: this.extnID,\n            extnValue: this.extnValue.toJSON(),\n        };\n        if (this.critical !== Extension.defaultValues(CRITICAL)) {\n            object.critical = this.critical;\n        }\n        if (this.parsedValue && this.parsedValue.toJSON) {\n            object.parsedValue = this.parsedValue.toJSON();\n        }\n        return object;\n    }\n}\nExtension.CLASS_NAME = \"Extension\";\n\nconst EXTENSIONS$5 = \"extensions\";\nconst CLEAR_PROPS$$ = [\n    EXTENSIONS$5,\n];\nclass Extensions extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$5, Extensions.defaultValues(EXTENSIONS$5));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case EXTENSIONS$5:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}, optional = false) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            optional,\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.extensions || EMPTY_STRING),\n                    value: Extension.schema(names.extension || {})\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$$);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Extensions.schema({\n            names: {\n                extensions: EXTENSIONS$5\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.extensions = Array.from(asn1.result.extensions, element => new Extension({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.extensions, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            extensions: this.extensions.map(o => o.toJSON())\n        };\n    }\n}\nExtensions.CLASS_NAME = \"Extensions\";\n\nconst ISSUER$5 = \"issuer\";\nconst SERIAL_NUMBER$6 = \"serialNumber\";\nconst ISSUER_UID = \"issuerUID\";\nconst CLEAR_PROPS$_ = [\n    ISSUER$5,\n    SERIAL_NUMBER$6,\n    ISSUER_UID,\n];\nclass IssuerSerial extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER$5, IssuerSerial.defaultValues(ISSUER$5));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$6, IssuerSerial.defaultValues(SERIAL_NUMBER$6));\n        if (ISSUER_UID in parameters) {\n            this.issuerUID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_UID, IssuerSerial.defaultValues(ISSUER_UID));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ISSUER$5:\n                return new GeneralNames();\n            case SERIAL_NUMBER$6:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case ISSUER_UID:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                GeneralNames.schema(names.issuer || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({\n                    optional: true,\n                    name: (names.issuerUID || EMPTY_STRING)\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$_);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, IssuerSerial.schema({\n            names: {\n                issuer: {\n                    names: {\n                        blockName: ISSUER$5\n                    }\n                },\n                serialNumber: SERIAL_NUMBER$6,\n                issuerUID: ISSUER_UID\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.issuer = new GeneralNames({ schema: asn1.result.issuer });\n        this.serialNumber = asn1.result.serialNumber;\n        if (ISSUER_UID in asn1.result)\n            this.issuerUID = asn1.result.issuerUID;\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.issuer.toSchema(),\n                this.serialNumber\n            ]\n        });\n        if (this.issuerUID) {\n            result.valueBlock.value.push(this.issuerUID);\n        }\n        return result;\n    }\n    toJSON() {\n        const result = {\n            issuer: this.issuer.toJSON(),\n            serialNumber: this.serialNumber.toJSON()\n        };\n        if (this.issuerUID) {\n            result.issuerUID = this.issuerUID.toJSON();\n        }\n        return result;\n    }\n}\nIssuerSerial.CLASS_NAME = \"IssuerSerial\";\n\nconst VERSION$h = \"version\";\nconst BASE_CERTIFICATE_ID$2 = \"baseCertificateID\";\nconst SUBJECT_NAME = \"subjectName\";\nconst ISSUER$4 = \"issuer\";\nconst SIGNATURE$6 = \"signature\";\nconst SERIAL_NUMBER$5 = \"serialNumber\";\nconst ATTR_CERT_VALIDITY_PERIOD$1 = \"attrCertValidityPeriod\";\nconst ATTRIBUTES$3 = \"attributes\";\nconst ISSUER_UNIQUE_ID$2 = \"issuerUniqueID\";\nconst EXTENSIONS$4 = \"extensions\";\nconst CLEAR_PROPS$Z = [\n    VERSION$h,\n    BASE_CERTIFICATE_ID$2,\n    SUBJECT_NAME,\n    ISSUER$4,\n    SIGNATURE$6,\n    SERIAL_NUMBER$5,\n    ATTR_CERT_VALIDITY_PERIOD$1,\n    ATTRIBUTES$3,\n    ISSUER_UNIQUE_ID$2,\n    EXTENSIONS$4,\n];\nclass AttributeCertificateInfoV1 extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$h, AttributeCertificateInfoV1.defaultValues(VERSION$h));\n        if (BASE_CERTIFICATE_ID$2 in parameters) {\n            this.baseCertificateID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BASE_CERTIFICATE_ID$2, AttributeCertificateInfoV1.defaultValues(BASE_CERTIFICATE_ID$2));\n        }\n        if (SUBJECT_NAME in parameters) {\n            this.subjectName = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_NAME, AttributeCertificateInfoV1.defaultValues(SUBJECT_NAME));\n        }\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER$4, AttributeCertificateInfoV1.defaultValues(ISSUER$4));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$6, AttributeCertificateInfoV1.defaultValues(SIGNATURE$6));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$5, AttributeCertificateInfoV1.defaultValues(SERIAL_NUMBER$5));\n        this.attrCertValidityPeriod = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTR_CERT_VALIDITY_PERIOD$1, AttributeCertificateInfoV1.defaultValues(ATTR_CERT_VALIDITY_PERIOD$1));\n        this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES$3, AttributeCertificateInfoV1.defaultValues(ATTRIBUTES$3));\n        if (ISSUER_UNIQUE_ID$2 in parameters)\n            this.issuerUniqueID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_UNIQUE_ID$2, AttributeCertificateInfoV1.defaultValues(ISSUER_UNIQUE_ID$2));\n        if (EXTENSIONS$4 in parameters) {\n            this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$4, AttributeCertificateInfoV1.defaultValues(EXTENSIONS$4));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$h:\n                return 0;\n            case BASE_CERTIFICATE_ID$2:\n                return new IssuerSerial();\n            case SUBJECT_NAME:\n                return new GeneralNames();\n            case ISSUER$4:\n                return new GeneralNames();\n            case SIGNATURE$6:\n                return new AlgorithmIdentifier();\n            case SERIAL_NUMBER$5:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case ATTR_CERT_VALIDITY_PERIOD$1:\n                return new AttCertValidityPeriod();\n            case ATTRIBUTES$3:\n                return [];\n            case ISSUER_UNIQUE_ID$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            case EXTENSIONS$4:\n                return new Extensions();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.baseCertificateID || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                            value: IssuerSerial.schema().valueBlock.value\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.subjectName || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 1\n                            },\n                            value: GeneralNames.schema().valueBlock.value\n                        }),\n                    ]\n                }),\n                GeneralNames.schema({\n                    names: {\n                        blockName: (names.issuer || EMPTY_STRING)\n                    }\n                }),\n                AlgorithmIdentifier.schema(names.signature || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || EMPTY_STRING) }),\n                AttCertValidityPeriod.schema(names.attrCertValidityPeriod || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    name: (names.attributes || EMPTY_STRING),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            value: Attribute.schema()\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({\n                    optional: true,\n                    name: (names.issuerUniqueID || EMPTY_STRING)\n                }),\n                Extensions.schema(names.extensions || {}, true)\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$Z);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttributeCertificateInfoV1.schema({\n            names: {\n                version: VERSION$h,\n                baseCertificateID: BASE_CERTIFICATE_ID$2,\n                subjectName: SUBJECT_NAME,\n                issuer: ISSUER$4,\n                signature: {\n                    names: {\n                        blockName: SIGNATURE$6\n                    }\n                },\n                serialNumber: SERIAL_NUMBER$5,\n                attrCertValidityPeriod: {\n                    names: {\n                        blockName: ATTR_CERT_VALIDITY_PERIOD$1\n                    }\n                },\n                attributes: ATTRIBUTES$3,\n                issuerUniqueID: ISSUER_UNIQUE_ID$2,\n                extensions: {\n                    names: {\n                        blockName: EXTENSIONS$4\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        if (BASE_CERTIFICATE_ID$2 in asn1.result) {\n            this.baseCertificateID = new IssuerSerial({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.baseCertificateID.valueBlock.value\n                })\n            });\n        }\n        if (SUBJECT_NAME in asn1.result) {\n            this.subjectName = new GeneralNames({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.subjectName.valueBlock.value\n                })\n            });\n        }\n        this.issuer = asn1.result.issuer;\n        this.signature = new AlgorithmIdentifier({ schema: asn1.result.signature });\n        this.serialNumber = asn1.result.serialNumber;\n        this.attrCertValidityPeriod = new AttCertValidityPeriod({ schema: asn1.result.attrCertValidityPeriod });\n        this.attributes = Array.from(asn1.result.attributes.valueBlock.value, element => new Attribute({ schema: element }));\n        if (ISSUER_UNIQUE_ID$2 in asn1.result) {\n            this.issuerUniqueID = asn1.result.issuerUniqueID;\n        }\n        if (EXTENSIONS$4 in asn1.result) {\n            this.extensions = new Extensions({ schema: asn1.result.extensions });\n        }\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version })]\n        });\n        if (this.baseCertificateID) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.baseCertificateID.toSchema().valueBlock.value\n            }));\n        }\n        if (this.subjectName) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: this.subjectName.toSchema().valueBlock.value\n            }));\n        }\n        result.valueBlock.value.push(this.issuer.toSchema());\n        result.valueBlock.value.push(this.signature.toSchema());\n        result.valueBlock.value.push(this.serialNumber);\n        result.valueBlock.value.push(this.attrCertValidityPeriod.toSchema());\n        result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.attributes, o => o.toSchema())\n        }));\n        if (this.issuerUniqueID) {\n            result.valueBlock.value.push(this.issuerUniqueID);\n        }\n        if (this.extensions) {\n            result.valueBlock.value.push(this.extensions.toSchema());\n        }\n        return result;\n    }\n    toJSON() {\n        const result = {\n            version: this.version\n        };\n        if (this.baseCertificateID) {\n            result.baseCertificateID = this.baseCertificateID.toJSON();\n        }\n        if (this.subjectName) {\n            result.subjectName = this.subjectName.toJSON();\n        }\n        result.issuer = this.issuer.toJSON();\n        result.signature = this.signature.toJSON();\n        result.serialNumber = this.serialNumber.toJSON();\n        result.attrCertValidityPeriod = this.attrCertValidityPeriod.toJSON();\n        result.attributes = Array.from(this.attributes, o => o.toJSON());\n        if (this.issuerUniqueID) {\n            result.issuerUniqueID = this.issuerUniqueID.toJSON();\n        }\n        if (this.extensions) {\n            result.extensions = this.extensions.toJSON();\n        }\n        return result;\n    }\n}\nAttributeCertificateInfoV1.CLASS_NAME = \"AttributeCertificateInfoV1\";\n\nconst ACINFO$1 = \"acinfo\";\nconst SIGNATURE_ALGORITHM$7 = \"signatureAlgorithm\";\nconst SIGNATURE_VALUE$4 = \"signatureValue\";\nconst CLEAR_PROPS$Y = [\n    ACINFO$1,\n    SIGNATURE_VALUE$4,\n    SIGNATURE_ALGORITHM$7\n];\nclass AttributeCertificateV1 extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.acinfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACINFO$1, AttributeCertificateV1.defaultValues(ACINFO$1));\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$7, AttributeCertificateV1.defaultValues(SIGNATURE_ALGORITHM$7));\n        this.signatureValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_VALUE$4, AttributeCertificateV1.defaultValues(SIGNATURE_VALUE$4));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ACINFO$1:\n                return new AttributeCertificateInfoV1();\n            case SIGNATURE_ALGORITHM$7:\n                return new AlgorithmIdentifier();\n            case SIGNATURE_VALUE$4:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AttributeCertificateInfoV1.schema(names.acinfo || {}),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signatureValue || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$Y);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttributeCertificateV1.schema({\n            names: {\n                acinfo: {\n                    names: {\n                        blockName: ACINFO$1\n                    }\n                },\n                signatureAlgorithm: {\n                    names: {\n                        blockName: SIGNATURE_ALGORITHM$7\n                    }\n                },\n                signatureValue: SIGNATURE_VALUE$4\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.acinfo = new AttributeCertificateInfoV1({ schema: asn1.result.acinfo });\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signatureValue = asn1.result.signatureValue;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.acinfo.toSchema(),\n                this.signatureAlgorithm.toSchema(),\n                this.signatureValue\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            acinfo: this.acinfo.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signatureValue: this.signatureValue.toJSON(),\n        };\n    }\n}\nAttributeCertificateV1.CLASS_NAME = \"AttributeCertificateV1\";\n\nconst DIGESTED_OBJECT_TYPE = \"digestedObjectType\";\nconst OTHER_OBJECT_TYPE_ID = \"otherObjectTypeID\";\nconst DIGEST_ALGORITHM$2 = \"digestAlgorithm\";\nconst OBJECT_DIGEST = \"objectDigest\";\nconst CLEAR_PROPS$X = [\n    DIGESTED_OBJECT_TYPE,\n    OTHER_OBJECT_TYPE_ID,\n    DIGEST_ALGORITHM$2,\n    OBJECT_DIGEST,\n];\nclass ObjectDigestInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.digestedObjectType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGESTED_OBJECT_TYPE, ObjectDigestInfo.defaultValues(DIGESTED_OBJECT_TYPE));\n        if (OTHER_OBJECT_TYPE_ID in parameters) {\n            this.otherObjectTypeID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_OBJECT_TYPE_ID, ObjectDigestInfo.defaultValues(OTHER_OBJECT_TYPE_ID));\n        }\n        this.digestAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGEST_ALGORITHM$2, ObjectDigestInfo.defaultValues(DIGEST_ALGORITHM$2));\n        this.objectDigest = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OBJECT_DIGEST, ObjectDigestInfo.defaultValues(OBJECT_DIGEST));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case DIGESTED_OBJECT_TYPE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Enumerated();\n            case OTHER_OBJECT_TYPE_ID:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier();\n            case DIGEST_ALGORITHM$2:\n                return new AlgorithmIdentifier();\n            case OBJECT_DIGEST:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Enumerated({ name: (names.digestedObjectType || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({\n                    optional: true,\n                    name: (names.otherObjectTypeID || EMPTY_STRING)\n                }),\n                AlgorithmIdentifier.schema(names.digestAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.objectDigest || EMPTY_STRING) }),\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$X);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ObjectDigestInfo.schema({\n            names: {\n                digestedObjectType: DIGESTED_OBJECT_TYPE,\n                otherObjectTypeID: OTHER_OBJECT_TYPE_ID,\n                digestAlgorithm: {\n                    names: {\n                        blockName: DIGEST_ALGORITHM$2\n                    }\n                },\n                objectDigest: OBJECT_DIGEST\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.digestedObjectType = asn1.result.digestedObjectType;\n        if (OTHER_OBJECT_TYPE_ID in asn1.result) {\n            this.otherObjectTypeID = asn1.result.otherObjectTypeID;\n        }\n        this.digestAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.digestAlgorithm });\n        this.objectDigest = asn1.result.objectDigest;\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [this.digestedObjectType]\n        });\n        if (this.otherObjectTypeID) {\n            result.valueBlock.value.push(this.otherObjectTypeID);\n        }\n        result.valueBlock.value.push(this.digestAlgorithm.toSchema());\n        result.valueBlock.value.push(this.objectDigest);\n        return result;\n    }\n    toJSON() {\n        const result = {\n            digestedObjectType: this.digestedObjectType.toJSON(),\n            digestAlgorithm: this.digestAlgorithm.toJSON(),\n            objectDigest: this.objectDigest.toJSON(),\n        };\n        if (this.otherObjectTypeID) {\n            result.otherObjectTypeID = this.otherObjectTypeID.toJSON();\n        }\n        return result;\n    }\n}\nObjectDigestInfo.CLASS_NAME = \"ObjectDigestInfo\";\n\nconst ISSUER_NAME = \"issuerName\";\nconst BASE_CERTIFICATE_ID$1 = \"baseCertificateID\";\nconst OBJECT_DIGEST_INFO$1 = \"objectDigestInfo\";\nconst CLEAR_PROPS$W = [\n    ISSUER_NAME,\n    BASE_CERTIFICATE_ID$1,\n    OBJECT_DIGEST_INFO$1\n];\nclass V2Form extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (ISSUER_NAME in parameters) {\n            this.issuerName = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_NAME, V2Form.defaultValues(ISSUER_NAME));\n        }\n        if (BASE_CERTIFICATE_ID$1 in parameters) {\n            this.baseCertificateID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BASE_CERTIFICATE_ID$1, V2Form.defaultValues(BASE_CERTIFICATE_ID$1));\n        }\n        if (OBJECT_DIGEST_INFO$1 in parameters) {\n            this.objectDigestInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OBJECT_DIGEST_INFO$1, V2Form.defaultValues(OBJECT_DIGEST_INFO$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ISSUER_NAME:\n                return new GeneralNames();\n            case BASE_CERTIFICATE_ID$1:\n                return new IssuerSerial();\n            case OBJECT_DIGEST_INFO$1:\n                return new ObjectDigestInfo();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                GeneralNames.schema({\n                    names: {\n                        blockName: names.issuerName\n                    }\n                }, true),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    name: (names.baseCertificateID || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: IssuerSerial.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    name: (names.objectDigestInfo || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: ObjectDigestInfo.schema().valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$W);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, V2Form.schema({\n            names: {\n                issuerName: ISSUER_NAME,\n                baseCertificateID: BASE_CERTIFICATE_ID$1,\n                objectDigestInfo: OBJECT_DIGEST_INFO$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (ISSUER_NAME in asn1.result)\n            this.issuerName = new GeneralNames({ schema: asn1.result.issuerName });\n        if (BASE_CERTIFICATE_ID$1 in asn1.result) {\n            this.baseCertificateID = new IssuerSerial({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.baseCertificateID.valueBlock.value\n                })\n            });\n        }\n        if (OBJECT_DIGEST_INFO$1 in asn1.result) {\n            this.objectDigestInfo = new ObjectDigestInfo({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.objectDigestInfo.valueBlock.value\n                })\n            });\n        }\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence();\n        if (this.issuerName)\n            result.valueBlock.value.push(this.issuerName.toSchema());\n        if (this.baseCertificateID) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.baseCertificateID.toSchema().valueBlock.value\n            }));\n        }\n        if (this.objectDigestInfo) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: this.objectDigestInfo.toSchema().valueBlock.value\n            }));\n        }\n        return result;\n    }\n    toJSON() {\n        const result = {};\n        if (this.issuerName) {\n            result.issuerName = this.issuerName.toJSON();\n        }\n        if (this.baseCertificateID) {\n            result.baseCertificateID = this.baseCertificateID.toJSON();\n        }\n        if (this.objectDigestInfo) {\n            result.objectDigestInfo = this.objectDigestInfo.toJSON();\n        }\n        return result;\n    }\n}\nV2Form.CLASS_NAME = \"V2Form\";\n\nconst BASE_CERTIFICATE_ID = \"baseCertificateID\";\nconst ENTITY_NAME = \"entityName\";\nconst OBJECT_DIGEST_INFO = \"objectDigestInfo\";\nconst CLEAR_PROPS$V = [\n    BASE_CERTIFICATE_ID,\n    ENTITY_NAME,\n    OBJECT_DIGEST_INFO\n];\nclass Holder extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        if (BASE_CERTIFICATE_ID in parameters) {\n            this.baseCertificateID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BASE_CERTIFICATE_ID, Holder.defaultValues(BASE_CERTIFICATE_ID));\n        }\n        if (ENTITY_NAME in parameters) {\n            this.entityName = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENTITY_NAME, Holder.defaultValues(ENTITY_NAME));\n        }\n        if (OBJECT_DIGEST_INFO in parameters) {\n            this.objectDigestInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OBJECT_DIGEST_INFO, Holder.defaultValues(OBJECT_DIGEST_INFO));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case BASE_CERTIFICATE_ID:\n                return new IssuerSerial();\n            case ENTITY_NAME:\n                return new GeneralNames();\n            case OBJECT_DIGEST_INFO:\n                return new ObjectDigestInfo();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    name: (names.baseCertificateID || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: IssuerSerial.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    name: (names.entityName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: GeneralNames.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    name: (names.objectDigestInfo || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: ObjectDigestInfo.schema().valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$V);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Holder.schema({\n            names: {\n                baseCertificateID: BASE_CERTIFICATE_ID,\n                entityName: ENTITY_NAME,\n                objectDigestInfo: OBJECT_DIGEST_INFO\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (BASE_CERTIFICATE_ID in asn1.result) {\n            this.baseCertificateID = new IssuerSerial({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.baseCertificateID.valueBlock.value\n                })\n            });\n        }\n        if (ENTITY_NAME in asn1.result) {\n            this.entityName = new GeneralNames({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.entityName.valueBlock.value\n                })\n            });\n        }\n        if (OBJECT_DIGEST_INFO in asn1.result) {\n            this.objectDigestInfo = new ObjectDigestInfo({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.objectDigestInfo.valueBlock.value\n                })\n            });\n        }\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence();\n        if (this.baseCertificateID) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.baseCertificateID.toSchema().valueBlock.value\n            }));\n        }\n        if (this.entityName) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: this.entityName.toSchema().valueBlock.value\n            }));\n        }\n        if (this.objectDigestInfo) {\n            result.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                value: this.objectDigestInfo.toSchema().valueBlock.value\n            }));\n        }\n        return result;\n    }\n    toJSON() {\n        const result = {};\n        if (this.baseCertificateID) {\n            result.baseCertificateID = this.baseCertificateID.toJSON();\n        }\n        if (this.entityName) {\n            result.entityName = this.entityName.toJSON();\n        }\n        if (this.objectDigestInfo) {\n            result.objectDigestInfo = this.objectDigestInfo.toJSON();\n        }\n        return result;\n    }\n}\nHolder.CLASS_NAME = \"Holder\";\n\nconst VERSION$g = \"version\";\nconst HOLDER = \"holder\";\nconst ISSUER$3 = \"issuer\";\nconst SIGNATURE$5 = \"signature\";\nconst SERIAL_NUMBER$4 = \"serialNumber\";\nconst ATTR_CERT_VALIDITY_PERIOD = \"attrCertValidityPeriod\";\nconst ATTRIBUTES$2 = \"attributes\";\nconst ISSUER_UNIQUE_ID$1 = \"issuerUniqueID\";\nconst EXTENSIONS$3 = \"extensions\";\nconst CLEAR_PROPS$U = [\n    VERSION$g,\n    HOLDER,\n    ISSUER$3,\n    SIGNATURE$5,\n    SERIAL_NUMBER$4,\n    ATTR_CERT_VALIDITY_PERIOD,\n    ATTRIBUTES$2,\n    ISSUER_UNIQUE_ID$1,\n    EXTENSIONS$3\n];\nclass AttributeCertificateInfoV2 extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$g, AttributeCertificateInfoV2.defaultValues(VERSION$g));\n        this.holder = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HOLDER, AttributeCertificateInfoV2.defaultValues(HOLDER));\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER$3, AttributeCertificateInfoV2.defaultValues(ISSUER$3));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$5, AttributeCertificateInfoV2.defaultValues(SIGNATURE$5));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$4, AttributeCertificateInfoV2.defaultValues(SERIAL_NUMBER$4));\n        this.attrCertValidityPeriod = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTR_CERT_VALIDITY_PERIOD, AttributeCertificateInfoV2.defaultValues(ATTR_CERT_VALIDITY_PERIOD));\n        this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES$2, AttributeCertificateInfoV2.defaultValues(ATTRIBUTES$2));\n        if (ISSUER_UNIQUE_ID$1 in parameters) {\n            this.issuerUniqueID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_UNIQUE_ID$1, AttributeCertificateInfoV2.defaultValues(ISSUER_UNIQUE_ID$1));\n        }\n        if (EXTENSIONS$3 in parameters) {\n            this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$3, AttributeCertificateInfoV2.defaultValues(EXTENSIONS$3));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$g:\n                return 1;\n            case HOLDER:\n                return new Holder();\n            case ISSUER$3:\n                return {};\n            case SIGNATURE$5:\n                return new AlgorithmIdentifier();\n            case SERIAL_NUMBER$4:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case ATTR_CERT_VALIDITY_PERIOD:\n                return new AttCertValidityPeriod();\n            case ATTRIBUTES$2:\n                return [];\n            case ISSUER_UNIQUE_ID$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            case EXTENSIONS$3:\n                return new Extensions();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                Holder.schema(names.holder || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        GeneralNames.schema({\n                            names: {\n                                blockName: (names.issuer || EMPTY_STRING)\n                            }\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.issuer || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                            value: V2Form.schema().valueBlock.value\n                        })\n                    ]\n                }),\n                AlgorithmIdentifier.schema(names.signature || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || EMPTY_STRING) }),\n                AttCertValidityPeriod.schema(names.attrCertValidityPeriod || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    name: (names.attributes || EMPTY_STRING),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            value: Attribute.schema()\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({\n                    optional: true,\n                    name: (names.issuerUniqueID || EMPTY_STRING)\n                }),\n                Extensions.schema(names.extensions || {}, true)\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$U);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttributeCertificateInfoV2.schema({\n            names: {\n                version: VERSION$g,\n                holder: {\n                    names: {\n                        blockName: HOLDER\n                    }\n                },\n                issuer: ISSUER$3,\n                signature: {\n                    names: {\n                        blockName: SIGNATURE$5\n                    }\n                },\n                serialNumber: SERIAL_NUMBER$4,\n                attrCertValidityPeriod: {\n                    names: {\n                        blockName: ATTR_CERT_VALIDITY_PERIOD\n                    }\n                },\n                attributes: ATTRIBUTES$2,\n                issuerUniqueID: ISSUER_UNIQUE_ID$1,\n                extensions: {\n                    names: {\n                        blockName: EXTENSIONS$3\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.holder = new Holder({ schema: asn1.result.holder });\n        switch (asn1.result.issuer.idBlock.tagClass) {\n            case 3:\n                this.issuer = new V2Form({\n                    schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: asn1.result.issuer.valueBlock.value\n                    })\n                });\n                break;\n            case 1:\n            default:\n                throw new Error(\"Incorrect value for 'issuer' in AttributeCertificateInfoV2\");\n        }\n        this.signature = new AlgorithmIdentifier({ schema: asn1.result.signature });\n        this.serialNumber = asn1.result.serialNumber;\n        this.attrCertValidityPeriod = new AttCertValidityPeriod({ schema: asn1.result.attrCertValidityPeriod });\n        this.attributes = Array.from(asn1.result.attributes.valueBlock.value, element => new Attribute({ schema: element }));\n        if (ISSUER_UNIQUE_ID$1 in asn1.result) {\n            this.issuerUniqueID = asn1.result.issuerUniqueID;\n        }\n        if (EXTENSIONS$3 in asn1.result) {\n            this.extensions = new Extensions({ schema: asn1.result.extensions });\n        }\n    }\n    toSchema() {\n        const result = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n                this.holder.toSchema(),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: this.issuer.toSchema().valueBlock.value\n                }),\n                this.signature.toSchema(),\n                this.serialNumber,\n                this.attrCertValidityPeriod.toSchema(),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: Array.from(this.attributes, o => o.toSchema())\n                })\n            ]\n        });\n        if (this.issuerUniqueID) {\n            result.valueBlock.value.push(this.issuerUniqueID);\n        }\n        if (this.extensions) {\n            result.valueBlock.value.push(this.extensions.toSchema());\n        }\n        return result;\n    }\n    toJSON() {\n        const result = {\n            version: this.version,\n            holder: this.holder.toJSON(),\n            issuer: this.issuer.toJSON(),\n            signature: this.signature.toJSON(),\n            serialNumber: this.serialNumber.toJSON(),\n            attrCertValidityPeriod: this.attrCertValidityPeriod.toJSON(),\n            attributes: Array.from(this.attributes, o => o.toJSON())\n        };\n        if (this.issuerUniqueID) {\n            result.issuerUniqueID = this.issuerUniqueID.toJSON();\n        }\n        if (this.extensions) {\n            result.extensions = this.extensions.toJSON();\n        }\n        return result;\n    }\n}\nAttributeCertificateInfoV2.CLASS_NAME = \"AttributeCertificateInfoV2\";\n\nconst ACINFO = \"acinfo\";\nconst SIGNATURE_ALGORITHM$6 = \"signatureAlgorithm\";\nconst SIGNATURE_VALUE$3 = \"signatureValue\";\nconst CLEAR_PROPS$T = [\n    ACINFO,\n    SIGNATURE_ALGORITHM$6,\n    SIGNATURE_VALUE$3,\n];\nclass AttributeCertificateV2 extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.acinfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACINFO, AttributeCertificateV2.defaultValues(ACINFO));\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$6, AttributeCertificateV2.defaultValues(SIGNATURE_ALGORITHM$6));\n        this.signatureValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_VALUE$3, AttributeCertificateV2.defaultValues(SIGNATURE_VALUE$3));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ACINFO:\n                return new AttributeCertificateInfoV2();\n            case SIGNATURE_ALGORITHM$6:\n                return new AlgorithmIdentifier();\n            case SIGNATURE_VALUE$3:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AttributeCertificateInfoV2.schema(names.acinfo || {}),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signatureValue || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$T);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AttributeCertificateV2.schema({\n            names: {\n                acinfo: {\n                    names: {\n                        blockName: ACINFO\n                    }\n                },\n                signatureAlgorithm: {\n                    names: {\n                        blockName: SIGNATURE_ALGORITHM$6\n                    }\n                },\n                signatureValue: SIGNATURE_VALUE$3\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.acinfo = new AttributeCertificateInfoV2({ schema: asn1.result.acinfo });\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signatureValue = asn1.result.signatureValue;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.acinfo.toSchema(),\n                this.signatureAlgorithm.toSchema(),\n                this.signatureValue\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            acinfo: this.acinfo.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signatureValue: this.signatureValue.toJSON(),\n        };\n    }\n}\nAttributeCertificateV2.CLASS_NAME = \"AttributeCertificateV2\";\n\nconst CONTENT_TYPE = \"contentType\";\nconst CONTENT = \"content\";\nconst CLEAR_PROPS$S = [CONTENT_TYPE, CONTENT];\nclass ContentInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.contentType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CONTENT_TYPE, ContentInfo.defaultValues(CONTENT_TYPE));\n        this.content = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CONTENT, ContentInfo.defaultValues(CONTENT));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CONTENT_TYPE:\n                return EMPTY_STRING;\n            case CONTENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CONTENT_TYPE:\n                return (typeof memberValue === \"string\" &&\n                    memberValue === this.defaultValues(CONTENT_TYPE));\n            case CONTENT:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        if ((\"optional\" in names) === false) {\n            names.optional = false;\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || \"ContentInfo\"),\n            optional: names.optional,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.contentType || CONTENT_TYPE) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.content || CONTENT) })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$S);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ContentInfo.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.contentType = asn1.result.contentType.valueBlock.toString();\n        this.content = asn1.result.content;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.contentType }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [this.content]\n                })\n            ]\n        }));\n    }\n    toJSON() {\n        const object = {\n            contentType: this.contentType\n        };\n        if (!(this.content instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any)) {\n            object.content = this.content.toJSON();\n        }\n        return object;\n    }\n}\nContentInfo.CLASS_NAME = \"ContentInfo\";\nContentInfo.DATA = id_ContentType_Data;\nContentInfo.SIGNED_DATA = id_ContentType_SignedData;\nContentInfo.ENVELOPED_DATA = id_ContentType_EnvelopedData;\nContentInfo.ENCRYPTED_DATA = id_ContentType_EncryptedData;\n\nconst TYPE$1 = \"type\";\nconst VALUE$4 = \"value\";\nconst UTC_TIME_NAME = \"utcTimeName\";\nconst GENERAL_TIME_NAME = \"generalTimeName\";\nconst CLEAR_PROPS$R = [UTC_TIME_NAME, GENERAL_TIME_NAME];\nvar TimeType;\n(function (TimeType) {\n    TimeType[TimeType[\"UTCTime\"] = 0] = \"UTCTime\";\n    TimeType[TimeType[\"GeneralizedTime\"] = 1] = \"GeneralizedTime\";\n    TimeType[TimeType[\"empty\"] = 2] = \"empty\";\n})(TimeType || (TimeType = {}));\nclass Time extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE$1, Time.defaultValues(TYPE$1));\n        this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$4, Time.defaultValues(VALUE$4));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE$1:\n                return 0;\n            case VALUE$4:\n                return new Date(0, 0, 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}, optional = false) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            optional,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.UTCTime({ name: (names.utcTimeName || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.generalTimeName || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$R);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Time.schema({\n            names: {\n                utcTimeName: UTC_TIME_NAME,\n                generalTimeName: GENERAL_TIME_NAME\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (UTC_TIME_NAME in asn1.result) {\n            this.type = 0;\n            this.value = asn1.result.utcTimeName.toDate();\n        }\n        if (GENERAL_TIME_NAME in asn1.result) {\n            this.type = 1;\n            this.value = asn1.result.generalTimeName.toDate();\n        }\n    }\n    toSchema() {\n        if (this.type === 0) {\n            return new asn1js__WEBPACK_IMPORTED_MODULE_0__.UTCTime({ valueDate: this.value });\n        }\n        else if (this.type === 1) {\n            return new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.value });\n        }\n        return {};\n    }\n    toJSON() {\n        return {\n            type: this.type,\n            value: this.value\n        };\n    }\n}\nTime.CLASS_NAME = \"Time\";\n\nconst TBS$4 = \"tbs\";\nconst VERSION$f = \"version\";\nconst SERIAL_NUMBER$3 = \"serialNumber\";\nconst SIGNATURE$4 = \"signature\";\nconst ISSUER$2 = \"issuer\";\nconst NOT_BEFORE = \"notBefore\";\nconst NOT_AFTER = \"notAfter\";\nconst SUBJECT$1 = \"subject\";\nconst SUBJECT_PUBLIC_KEY_INFO = \"subjectPublicKeyInfo\";\nconst ISSUER_UNIQUE_ID = \"issuerUniqueID\";\nconst SUBJECT_UNIQUE_ID = \"subjectUniqueID\";\nconst EXTENSIONS$2 = \"extensions\";\nconst SIGNATURE_ALGORITHM$5 = \"signatureAlgorithm\";\nconst SIGNATURE_VALUE$2 = \"signatureValue\";\nconst TBS_CERTIFICATE = \"tbsCertificate\";\nconst TBS_CERTIFICATE_VERSION = `${TBS_CERTIFICATE}.${VERSION$f}`;\nconst TBS_CERTIFICATE_SERIAL_NUMBER = `${TBS_CERTIFICATE}.${SERIAL_NUMBER$3}`;\nconst TBS_CERTIFICATE_SIGNATURE = `${TBS_CERTIFICATE}.${SIGNATURE$4}`;\nconst TBS_CERTIFICATE_ISSUER = `${TBS_CERTIFICATE}.${ISSUER$2}`;\nconst TBS_CERTIFICATE_NOT_BEFORE = `${TBS_CERTIFICATE}.${NOT_BEFORE}`;\nconst TBS_CERTIFICATE_NOT_AFTER = `${TBS_CERTIFICATE}.${NOT_AFTER}`;\nconst TBS_CERTIFICATE_SUBJECT = `${TBS_CERTIFICATE}.${SUBJECT$1}`;\nconst TBS_CERTIFICATE_SUBJECT_PUBLIC_KEY = `${TBS_CERTIFICATE}.${SUBJECT_PUBLIC_KEY_INFO}`;\nconst TBS_CERTIFICATE_ISSUER_UNIQUE_ID = `${TBS_CERTIFICATE}.${ISSUER_UNIQUE_ID}`;\nconst TBS_CERTIFICATE_SUBJECT_UNIQUE_ID = `${TBS_CERTIFICATE}.${SUBJECT_UNIQUE_ID}`;\nconst TBS_CERTIFICATE_EXTENSIONS = `${TBS_CERTIFICATE}.${EXTENSIONS$2}`;\nconst CLEAR_PROPS$Q = [\n    TBS_CERTIFICATE,\n    TBS_CERTIFICATE_VERSION,\n    TBS_CERTIFICATE_SERIAL_NUMBER,\n    TBS_CERTIFICATE_SIGNATURE,\n    TBS_CERTIFICATE_ISSUER,\n    TBS_CERTIFICATE_NOT_BEFORE,\n    TBS_CERTIFICATE_NOT_AFTER,\n    TBS_CERTIFICATE_SUBJECT,\n    TBS_CERTIFICATE_SUBJECT_PUBLIC_KEY,\n    TBS_CERTIFICATE_ISSUER_UNIQUE_ID,\n    TBS_CERTIFICATE_SUBJECT_UNIQUE_ID,\n    TBS_CERTIFICATE_EXTENSIONS,\n    SIGNATURE_ALGORITHM$5,\n    SIGNATURE_VALUE$2\n];\nfunction tbsCertificate(parameters = {}) {\n    const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        name: (names.blockName || TBS_CERTIFICATE),\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.tbsCertificateVersion || TBS_CERTIFICATE_VERSION) })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.tbsCertificateSerialNumber || TBS_CERTIFICATE_SERIAL_NUMBER) }),\n            AlgorithmIdentifier.schema(names.signature || {\n                names: {\n                    blockName: TBS_CERTIFICATE_SIGNATURE\n                }\n            }),\n            RelativeDistinguishedNames.schema(names.issuer || {\n                names: {\n                    blockName: TBS_CERTIFICATE_ISSUER\n                }\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                name: (names.tbsCertificateValidity || \"tbsCertificate.validity\"),\n                value: [\n                    Time.schema(names.notBefore || {\n                        names: {\n                            utcTimeName: TBS_CERTIFICATE_NOT_BEFORE,\n                            generalTimeName: TBS_CERTIFICATE_NOT_BEFORE\n                        }\n                    }),\n                    Time.schema(names.notAfter || {\n                        names: {\n                            utcTimeName: TBS_CERTIFICATE_NOT_AFTER,\n                            generalTimeName: TBS_CERTIFICATE_NOT_AFTER\n                        }\n                    })\n                ]\n            }),\n            RelativeDistinguishedNames.schema(names.subject || {\n                names: {\n                    blockName: TBS_CERTIFICATE_SUBJECT\n                }\n            }),\n            PublicKeyInfo.schema(names.subjectPublicKeyInfo || {\n                names: {\n                    blockName: TBS_CERTIFICATE_SUBJECT_PUBLIC_KEY\n                }\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                name: (names.tbsCertificateIssuerUniqueID || TBS_CERTIFICATE_ISSUER_UNIQUE_ID),\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                }\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                name: (names.tbsCertificateSubjectUniqueID || TBS_CERTIFICATE_SUBJECT_UNIQUE_ID),\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                }\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 3\n                },\n                value: [Extensions.schema(names.extensions || {\n                        names: {\n                            blockName: TBS_CERTIFICATE_EXTENSIONS\n                        }\n                    })]\n            })\n        ]\n    }));\n}\nclass Certificate extends PkiObject {\n    get tbs() {\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.tbsView);\n    }\n    set tbs(value) {\n        this.tbsView = new Uint8Array(value);\n    }\n    constructor(parameters = {}) {\n        super();\n        this.tbsView = new Uint8Array(pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS$4, Certificate.defaultValues(TBS$4)));\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$f, Certificate.defaultValues(VERSION$f));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$3, Certificate.defaultValues(SERIAL_NUMBER$3));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$4, Certificate.defaultValues(SIGNATURE$4));\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER$2, Certificate.defaultValues(ISSUER$2));\n        this.notBefore = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_BEFORE, Certificate.defaultValues(NOT_BEFORE));\n        this.notAfter = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NOT_AFTER, Certificate.defaultValues(NOT_AFTER));\n        this.subject = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT$1, Certificate.defaultValues(SUBJECT$1));\n        this.subjectPublicKeyInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_PUBLIC_KEY_INFO, Certificate.defaultValues(SUBJECT_PUBLIC_KEY_INFO));\n        if (ISSUER_UNIQUE_ID in parameters) {\n            this.issuerUniqueID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_UNIQUE_ID, Certificate.defaultValues(ISSUER_UNIQUE_ID));\n        }\n        if (SUBJECT_UNIQUE_ID in parameters) {\n            this.subjectUniqueID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_UNIQUE_ID, Certificate.defaultValues(SUBJECT_UNIQUE_ID));\n        }\n        if (EXTENSIONS$2 in parameters) {\n            this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$2, Certificate.defaultValues(EXTENSIONS$2));\n        }\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$5, Certificate.defaultValues(SIGNATURE_ALGORITHM$5));\n        this.signatureValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_VALUE$2, Certificate.defaultValues(SIGNATURE_VALUE$2));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS$4:\n                return EMPTY_BUFFER;\n            case VERSION$f:\n                return 0;\n            case SERIAL_NUMBER$3:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case SIGNATURE$4:\n                return new AlgorithmIdentifier();\n            case ISSUER$2:\n                return new RelativeDistinguishedNames();\n            case NOT_BEFORE:\n                return new Time();\n            case NOT_AFTER:\n                return new Time();\n            case SUBJECT$1:\n                return new RelativeDistinguishedNames();\n            case SUBJECT_PUBLIC_KEY_INFO:\n                return new PublicKeyInfo();\n            case ISSUER_UNIQUE_ID:\n                return EMPTY_BUFFER;\n            case SUBJECT_UNIQUE_ID:\n                return EMPTY_BUFFER;\n            case EXTENSIONS$2:\n                return [];\n            case SIGNATURE_ALGORITHM$5:\n                return new AlgorithmIdentifier();\n            case SIGNATURE_VALUE$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                tbsCertificate(names.tbsCertificate),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {\n                    names: {\n                        blockName: SIGNATURE_ALGORITHM$5\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signatureValue || SIGNATURE_VALUE$2) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$Q);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Certificate.schema({\n            names: {\n                tbsCertificate: {\n                    names: {\n                        extensions: {\n                            names: {\n                                extensions: TBS_CERTIFICATE_EXTENSIONS\n                            }\n                        }\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsView = asn1.result.tbsCertificate.valueBeforeDecodeView;\n        if (TBS_CERTIFICATE_VERSION in asn1.result)\n            this.version = asn1.result[TBS_CERTIFICATE_VERSION].valueBlock.valueDec;\n        this.serialNumber = asn1.result[TBS_CERTIFICATE_SERIAL_NUMBER];\n        this.signature = new AlgorithmIdentifier({ schema: asn1.result[TBS_CERTIFICATE_SIGNATURE] });\n        this.issuer = new RelativeDistinguishedNames({ schema: asn1.result[TBS_CERTIFICATE_ISSUER] });\n        this.notBefore = new Time({ schema: asn1.result[TBS_CERTIFICATE_NOT_BEFORE] });\n        this.notAfter = new Time({ schema: asn1.result[TBS_CERTIFICATE_NOT_AFTER] });\n        this.subject = new RelativeDistinguishedNames({ schema: asn1.result[TBS_CERTIFICATE_SUBJECT] });\n        this.subjectPublicKeyInfo = new PublicKeyInfo({ schema: asn1.result[TBS_CERTIFICATE_SUBJECT_PUBLIC_KEY] });\n        if (TBS_CERTIFICATE_ISSUER_UNIQUE_ID in asn1.result)\n            this.issuerUniqueID = asn1.result[TBS_CERTIFICATE_ISSUER_UNIQUE_ID].valueBlock.valueHex;\n        if (TBS_CERTIFICATE_SUBJECT_UNIQUE_ID in asn1.result)\n            this.subjectUniqueID = asn1.result[TBS_CERTIFICATE_SUBJECT_UNIQUE_ID].valueBlock.valueHex;\n        if (TBS_CERTIFICATE_EXTENSIONS in asn1.result)\n            this.extensions = Array.from(asn1.result[TBS_CERTIFICATE_EXTENSIONS], element => new Extension({ schema: element }));\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signatureValue = asn1.result.signatureValue;\n    }\n    encodeTBS() {\n        const outputArray = [];\n        if ((VERSION$f in this) && (this.version !== Certificate.defaultValues(VERSION$f))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version })\n                ]\n            }));\n        }\n        outputArray.push(this.serialNumber);\n        outputArray.push(this.signature.toSchema());\n        outputArray.push(this.issuer.toSchema());\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.notBefore.toSchema(),\n                this.notAfter.toSchema()\n            ]\n        }));\n        outputArray.push(this.subject.toSchema());\n        outputArray.push(this.subjectPublicKeyInfo.toSchema());\n        if (this.issuerUniqueID) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                valueHex: this.issuerUniqueID\n            }));\n        }\n        if (this.subjectUniqueID) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                valueHex: this.subjectUniqueID\n            }));\n        }\n        if (this.extensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 3\n                },\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: Array.from(this.extensions, o => o.toSchema())\n                    })]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toSchema(encodeFlag = false) {\n        let tbsSchema;\n        if (encodeFlag === false) {\n            if (!this.tbsView.byteLength) {\n                return Certificate.schema().value[0];\n            }\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.tbsView);\n            AsnError.assert(asn1, \"TBS Certificate\");\n            tbsSchema = asn1.result;\n        }\n        else {\n            tbsSchema = this.encodeTBS();\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                tbsSchema,\n                this.signatureAlgorithm.toSchema(),\n                this.signatureValue\n            ]\n        }));\n    }\n    toJSON() {\n        const res = {\n            tbs: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToHex(this.tbsView),\n            version: this.version,\n            serialNumber: this.serialNumber.toJSON(),\n            signature: this.signature.toJSON(),\n            issuer: this.issuer.toJSON(),\n            notBefore: this.notBefore.toJSON(),\n            notAfter: this.notAfter.toJSON(),\n            subject: this.subject.toJSON(),\n            subjectPublicKeyInfo: this.subjectPublicKeyInfo.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signatureValue: this.signatureValue.toJSON(),\n        };\n        if ((VERSION$f in this) && (this.version !== Certificate.defaultValues(VERSION$f))) {\n            res.version = this.version;\n        }\n        if (this.issuerUniqueID) {\n            res.issuerUniqueID = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToHex(this.issuerUniqueID);\n        }\n        if (this.subjectUniqueID) {\n            res.subjectUniqueID = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToHex(this.subjectUniqueID);\n        }\n        if (this.extensions) {\n            res.extensions = Array.from(this.extensions, o => o.toJSON());\n        }\n        return res;\n    }\n    async getPublicKey(parameters, crypto = getCrypto(true)) {\n        return crypto.getPublicKey(this.subjectPublicKeyInfo, this.signatureAlgorithm, parameters);\n    }\n    async getKeyHash(hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        return crypto.digest({ name: hashAlgorithm }, this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);\n    }\n    async sign(privateKey, hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        if (!privateKey) {\n            throw new Error(\"Need to provide a private key for signing\");\n        }\n        const signatureParameters = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const parameters = signatureParameters.parameters;\n        this.signature = signatureParameters.signatureAlgorithm;\n        this.signatureAlgorithm = signatureParameters.signatureAlgorithm;\n        this.tbsView = new Uint8Array(this.encodeTBS().toBER());\n        const signature = await crypto.signWithPrivateKey(this.tbsView, privateKey, parameters);\n        this.signatureValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: signature });\n    }\n    async verify(issuerCertificate, crypto = getCrypto(true)) {\n        let subjectPublicKeyInfo;\n        if (issuerCertificate) {\n            subjectPublicKeyInfo = issuerCertificate.subjectPublicKeyInfo;\n        }\n        else if (this.issuer.isEqual(this.subject)) {\n            subjectPublicKeyInfo = this.subjectPublicKeyInfo;\n        }\n        if (!(subjectPublicKeyInfo instanceof PublicKeyInfo)) {\n            throw new Error(\"Please provide issuer certificate as a parameter\");\n        }\n        return crypto.verifyWithPublicKey(this.tbsView, this.signatureValue, subjectPublicKeyInfo, this.signatureAlgorithm);\n    }\n}\nCertificate.CLASS_NAME = \"Certificate\";\nfunction checkCA(cert, signerCert = null) {\n    if (signerCert && cert.issuer.isEqual(signerCert.issuer) && cert.serialNumber.isEqual(signerCert.serialNumber)) {\n        return null;\n    }\n    let isCA = false;\n    if (cert.extensions) {\n        for (const extension of cert.extensions) {\n            if (extension.extnID === id_BasicConstraints && extension.parsedValue instanceof BasicConstraints) {\n                if (extension.parsedValue.cA) {\n                    isCA = true;\n                    break;\n                }\n            }\n        }\n    }\n    if (isCA) {\n        return cert;\n    }\n    return null;\n}\n\nconst CERT_ID$1 = \"certId\";\nconst CERT_VALUE = \"certValue\";\nconst PARSED_VALUE$4 = \"parsedValue\";\nconst CLEAR_PROPS$P = [\n    CERT_ID$1,\n    CERT_VALUE\n];\nclass CertBag extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.certId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERT_ID$1, CertBag.defaultValues(CERT_ID$1));\n        this.certValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERT_VALUE, CertBag.defaultValues(CERT_VALUE));\n        if (PARSED_VALUE$4 in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE$4, CertBag.defaultValues(PARSED_VALUE$4));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERT_ID$1:\n                return EMPTY_STRING;\n            case CERT_VALUE:\n                return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any());\n            case PARSED_VALUE$4:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CERT_ID$1:\n                return (memberValue === EMPTY_STRING);\n            case CERT_VALUE:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            case PARSED_VALUE$4:\n                return ((memberValue instanceof Object) && (Object.keys(memberValue).length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.id || \"id\") }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.value || \"value\") })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$P);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertBag.schema({\n            names: {\n                id: CERT_ID$1,\n                value: CERT_VALUE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.certId = asn1.result.certId.valueBlock.toString();\n        this.certValue = asn1.result.certValue;\n        const certValueHex = this.certValue.valueBlock.valueHexView;\n        switch (this.certId) {\n            case id_CertBag_X509Certificate:\n                {\n                    try {\n                        this.parsedValue = Certificate.fromBER(certValueHex);\n                    }\n                    catch (ex) {\n                        AttributeCertificateV2.fromBER(certValueHex);\n                    }\n                }\n                break;\n            case id_CertBag_AttributeCertificate:\n                {\n                    this.parsedValue = AttributeCertificateV2.fromBER(certValueHex);\n                }\n                break;\n            case id_CertBag_SDSICertificate:\n            default:\n                throw new Error(`Incorrect CERT_ID value in CertBag: ${this.certId}`);\n        }\n    }\n    toSchema() {\n        if (PARSED_VALUE$4 in this) {\n            if (\"acinfo\" in this.parsedValue) {\n                this.certId = id_CertBag_AttributeCertificate;\n            }\n            else {\n                this.certId = id_CertBag_X509Certificate;\n            }\n            this.certValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: this.parsedValue.toSchema().toBER(false) });\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.certId }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [((\"toSchema\" in this.certValue) ? this.certValue.toSchema() : this.certValue)]\n                })\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            certId: this.certId,\n            certValue: this.certValue.toJSON()\n        };\n    }\n}\nCertBag.CLASS_NAME = \"CertBag\";\n\nconst USER_CERTIFICATE = \"userCertificate\";\nconst REVOCATION_DATE = \"revocationDate\";\nconst CRL_ENTRY_EXTENSIONS = \"crlEntryExtensions\";\nconst CLEAR_PROPS$O = [\n    USER_CERTIFICATE,\n    REVOCATION_DATE,\n    CRL_ENTRY_EXTENSIONS\n];\nclass RevokedCertificate extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.userCertificate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, USER_CERTIFICATE, RevokedCertificate.defaultValues(USER_CERTIFICATE));\n        this.revocationDate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REVOCATION_DATE, RevokedCertificate.defaultValues(REVOCATION_DATE));\n        if (CRL_ENTRY_EXTENSIONS in parameters) {\n            this.crlEntryExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRL_ENTRY_EXTENSIONS, RevokedCertificate.defaultValues(CRL_ENTRY_EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case USER_CERTIFICATE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case REVOCATION_DATE:\n                return new Time();\n            case CRL_ENTRY_EXTENSIONS:\n                return new Extensions();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.userCertificate || USER_CERTIFICATE) }),\n                Time.schema({\n                    names: {\n                        utcTimeName: (names.revocationDate || REVOCATION_DATE),\n                        generalTimeName: (names.revocationDate || REVOCATION_DATE)\n                    }\n                }),\n                Extensions.schema({\n                    names: {\n                        blockName: (names.crlEntryExtensions || CRL_ENTRY_EXTENSIONS)\n                    }\n                }, true)\n            ]\n        });\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$O);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RevokedCertificate.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.userCertificate = asn1.result.userCertificate;\n        this.revocationDate = new Time({ schema: asn1.result.revocationDate });\n        if (CRL_ENTRY_EXTENSIONS in asn1.result) {\n            this.crlEntryExtensions = new Extensions({ schema: asn1.result.crlEntryExtensions });\n        }\n    }\n    toSchema() {\n        const outputArray = [\n            this.userCertificate,\n            this.revocationDate.toSchema()\n        ];\n        if (this.crlEntryExtensions) {\n            outputArray.push(this.crlEntryExtensions.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            userCertificate: this.userCertificate.toJSON(),\n            revocationDate: this.revocationDate.toJSON(),\n        };\n        if (this.crlEntryExtensions) {\n            res.crlEntryExtensions = this.crlEntryExtensions.toJSON();\n        }\n        return res;\n    }\n}\nRevokedCertificate.CLASS_NAME = \"RevokedCertificate\";\n\nconst TBS$3 = \"tbs\";\nconst VERSION$e = \"version\";\nconst SIGNATURE$3 = \"signature\";\nconst ISSUER$1 = \"issuer\";\nconst THIS_UPDATE$1 = \"thisUpdate\";\nconst NEXT_UPDATE$1 = \"nextUpdate\";\nconst REVOKED_CERTIFICATES = \"revokedCertificates\";\nconst CRL_EXTENSIONS = \"crlExtensions\";\nconst SIGNATURE_ALGORITHM$4 = \"signatureAlgorithm\";\nconst SIGNATURE_VALUE$1 = \"signatureValue\";\nconst TBS_CERT_LIST = \"tbsCertList\";\nconst TBS_CERT_LIST_VERSION = `${TBS_CERT_LIST}.version`;\nconst TBS_CERT_LIST_SIGNATURE = `${TBS_CERT_LIST}.signature`;\nconst TBS_CERT_LIST_ISSUER = `${TBS_CERT_LIST}.issuer`;\nconst TBS_CERT_LIST_THIS_UPDATE = `${TBS_CERT_LIST}.thisUpdate`;\nconst TBS_CERT_LIST_NEXT_UPDATE = `${TBS_CERT_LIST}.nextUpdate`;\nconst TBS_CERT_LIST_REVOKED_CERTIFICATES = `${TBS_CERT_LIST}.revokedCertificates`;\nconst TBS_CERT_LIST_EXTENSIONS = `${TBS_CERT_LIST}.extensions`;\nconst CLEAR_PROPS$N = [\n    TBS_CERT_LIST,\n    TBS_CERT_LIST_VERSION,\n    TBS_CERT_LIST_SIGNATURE,\n    TBS_CERT_LIST_ISSUER,\n    TBS_CERT_LIST_THIS_UPDATE,\n    TBS_CERT_LIST_NEXT_UPDATE,\n    TBS_CERT_LIST_REVOKED_CERTIFICATES,\n    TBS_CERT_LIST_EXTENSIONS,\n    SIGNATURE_ALGORITHM$4,\n    SIGNATURE_VALUE$1\n];\nfunction tbsCertList(parameters = {}) {\n    const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        name: (names.blockName || TBS_CERT_LIST),\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                optional: true,\n                name: (names.tbsCertListVersion || TBS_CERT_LIST_VERSION),\n                value: 2\n            }),\n            AlgorithmIdentifier.schema(names.signature || {\n                names: {\n                    blockName: TBS_CERT_LIST_SIGNATURE\n                }\n            }),\n            RelativeDistinguishedNames.schema(names.issuer || {\n                names: {\n                    blockName: TBS_CERT_LIST_ISSUER\n                }\n            }),\n            Time.schema(names.tbsCertListThisUpdate || {\n                names: {\n                    utcTimeName: TBS_CERT_LIST_THIS_UPDATE,\n                    generalTimeName: TBS_CERT_LIST_THIS_UPDATE\n                }\n            }),\n            Time.schema(names.tbsCertListNextUpdate || {\n                names: {\n                    utcTimeName: TBS_CERT_LIST_NEXT_UPDATE,\n                    generalTimeName: TBS_CERT_LIST_NEXT_UPDATE\n                }\n            }, true),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                optional: true,\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                        name: (names.tbsCertListRevokedCertificates || TBS_CERT_LIST_REVOKED_CERTIFICATES),\n                        value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer(),\n                                Time.schema(),\n                                Extensions.schema({}, true)\n                            ]\n                        })\n                    })\n                ]\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [Extensions.schema(names.crlExtensions || {\n                        names: {\n                            blockName: TBS_CERT_LIST_EXTENSIONS\n                        }\n                    })]\n            })\n        ]\n    }));\n}\nconst WELL_KNOWN_EXTENSIONS = [\n    id_AuthorityKeyIdentifier,\n    id_IssuerAltName,\n    id_CRLNumber,\n    id_BaseCRLNumber,\n    id_IssuingDistributionPoint,\n    id_FreshestCRL,\n    id_AuthorityInfoAccess,\n    id_CRLReason,\n    id_InvalidityDate,\n    id_CertificateIssuer,\n];\nclass CertificateRevocationList extends PkiObject {\n    get tbs() {\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.tbsView);\n    }\n    set tbs(value) {\n        this.tbsView = new Uint8Array(value);\n    }\n    constructor(parameters = {}) {\n        super();\n        this.tbsView = new Uint8Array(pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS$3, CertificateRevocationList.defaultValues(TBS$3)));\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$e, CertificateRevocationList.defaultValues(VERSION$e));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$3, CertificateRevocationList.defaultValues(SIGNATURE$3));\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER$1, CertificateRevocationList.defaultValues(ISSUER$1));\n        this.thisUpdate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, THIS_UPDATE$1, CertificateRevocationList.defaultValues(THIS_UPDATE$1));\n        if (NEXT_UPDATE$1 in parameters) {\n            this.nextUpdate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NEXT_UPDATE$1, CertificateRevocationList.defaultValues(NEXT_UPDATE$1));\n        }\n        if (REVOKED_CERTIFICATES in parameters) {\n            this.revokedCertificates = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REVOKED_CERTIFICATES, CertificateRevocationList.defaultValues(REVOKED_CERTIFICATES));\n        }\n        if (CRL_EXTENSIONS in parameters) {\n            this.crlExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRL_EXTENSIONS, CertificateRevocationList.defaultValues(CRL_EXTENSIONS));\n        }\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$4, CertificateRevocationList.defaultValues(SIGNATURE_ALGORITHM$4));\n        this.signatureValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_VALUE$1, CertificateRevocationList.defaultValues(SIGNATURE_VALUE$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS$3:\n                return EMPTY_BUFFER;\n            case VERSION$e:\n                return 0;\n            case SIGNATURE$3:\n                return new AlgorithmIdentifier();\n            case ISSUER$1:\n                return new RelativeDistinguishedNames();\n            case THIS_UPDATE$1:\n                return new Time();\n            case NEXT_UPDATE$1:\n                return new Time();\n            case REVOKED_CERTIFICATES:\n                return [];\n            case CRL_EXTENSIONS:\n                return new Extensions();\n            case SIGNATURE_ALGORITHM$4:\n                return new AlgorithmIdentifier();\n            case SIGNATURE_VALUE$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || \"CertificateList\"),\n            value: [\n                tbsCertList(parameters),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {\n                    names: {\n                        blockName: SIGNATURE_ALGORITHM$4\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signatureValue || SIGNATURE_VALUE$1) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$N);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertificateRevocationList.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsView = asn1.result.tbsCertList.valueBeforeDecodeView;\n        if (TBS_CERT_LIST_VERSION in asn1.result) {\n            this.version = asn1.result[TBS_CERT_LIST_VERSION].valueBlock.valueDec;\n        }\n        this.signature = new AlgorithmIdentifier({ schema: asn1.result[TBS_CERT_LIST_SIGNATURE] });\n        this.issuer = new RelativeDistinguishedNames({ schema: asn1.result[TBS_CERT_LIST_ISSUER] });\n        this.thisUpdate = new Time({ schema: asn1.result[TBS_CERT_LIST_THIS_UPDATE] });\n        if (TBS_CERT_LIST_NEXT_UPDATE in asn1.result) {\n            this.nextUpdate = new Time({ schema: asn1.result[TBS_CERT_LIST_NEXT_UPDATE] });\n        }\n        if (TBS_CERT_LIST_REVOKED_CERTIFICATES in asn1.result) {\n            this.revokedCertificates = Array.from(asn1.result[TBS_CERT_LIST_REVOKED_CERTIFICATES], element => new RevokedCertificate({ schema: element }));\n        }\n        if (TBS_CERT_LIST_EXTENSIONS in asn1.result) {\n            this.crlExtensions = new Extensions({ schema: asn1.result[TBS_CERT_LIST_EXTENSIONS] });\n        }\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signatureValue = asn1.result.signatureValue;\n    }\n    encodeTBS() {\n        const outputArray = [];\n        if (this.version !== CertificateRevocationList.defaultValues(VERSION$e)) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        }\n        outputArray.push(this.signature.toSchema());\n        outputArray.push(this.issuer.toSchema());\n        outputArray.push(this.thisUpdate.toSchema());\n        if (this.nextUpdate) {\n            outputArray.push(this.nextUpdate.toSchema());\n        }\n        if (this.revokedCertificates) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.revokedCertificates, o => o.toSchema())\n            }));\n        }\n        if (this.crlExtensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    this.crlExtensions.toSchema()\n                ]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toSchema(encodeFlag = false) {\n        let tbsSchema;\n        if (!encodeFlag) {\n            if (!this.tbsView.byteLength) {\n                return CertificateRevocationList.schema();\n            }\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.tbsView);\n            AsnError.assert(asn1, \"TBS Certificate Revocation List\");\n            tbsSchema = asn1.result;\n        }\n        else {\n            tbsSchema = this.encodeTBS();\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                tbsSchema,\n                this.signatureAlgorithm.toSchema(),\n                this.signatureValue\n            ]\n        }));\n    }\n    toJSON() {\n        const res = {\n            tbs: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToHex(this.tbsView),\n            version: this.version,\n            signature: this.signature.toJSON(),\n            issuer: this.issuer.toJSON(),\n            thisUpdate: this.thisUpdate.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signatureValue: this.signatureValue.toJSON()\n        };\n        if (this.version !== CertificateRevocationList.defaultValues(VERSION$e))\n            res.version = this.version;\n        if (this.nextUpdate) {\n            res.nextUpdate = this.nextUpdate.toJSON();\n        }\n        if (this.revokedCertificates) {\n            res.revokedCertificates = Array.from(this.revokedCertificates, o => o.toJSON());\n        }\n        if (this.crlExtensions) {\n            res.crlExtensions = this.crlExtensions.toJSON();\n        }\n        return res;\n    }\n    isCertificateRevoked(certificate) {\n        if (!this.issuer.isEqual(certificate.issuer)) {\n            return false;\n        }\n        if (!this.revokedCertificates) {\n            return false;\n        }\n        for (const revokedCertificate of this.revokedCertificates) {\n            if (revokedCertificate.userCertificate.isEqual(certificate.serialNumber)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    async sign(privateKey, hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        if (!privateKey) {\n            throw new Error(\"Need to provide a private key for signing\");\n        }\n        const signatureParameters = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const { parameters } = signatureParameters;\n        this.signature = signatureParameters.signatureAlgorithm;\n        this.signatureAlgorithm = signatureParameters.signatureAlgorithm;\n        this.tbsView = new Uint8Array(this.encodeTBS().toBER());\n        const signature = await crypto.signWithPrivateKey(this.tbsView, privateKey, parameters);\n        this.signatureValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: signature });\n    }\n    async verify(parameters = {}, crypto = getCrypto(true)) {\n        let subjectPublicKeyInfo;\n        if (parameters.issuerCertificate) {\n            subjectPublicKeyInfo = parameters.issuerCertificate.subjectPublicKeyInfo;\n            if (!this.issuer.isEqual(parameters.issuerCertificate.subject)) {\n                return false;\n            }\n        }\n        if (parameters.publicKeyInfo) {\n            subjectPublicKeyInfo = parameters.publicKeyInfo;\n        }\n        if (!subjectPublicKeyInfo) {\n            throw new Error(\"Issuer's certificate must be provided as an input parameter\");\n        }\n        if (this.crlExtensions) {\n            for (const extension of this.crlExtensions.extensions) {\n                if (extension.critical) {\n                    if (!WELL_KNOWN_EXTENSIONS.includes(extension.extnID))\n                        return false;\n                }\n            }\n        }\n        return crypto.verifyWithPublicKey(this.tbsView, this.signatureValue, subjectPublicKeyInfo, this.signatureAlgorithm);\n    }\n}\nCertificateRevocationList.CLASS_NAME = \"CertificateRevocationList\";\n\nconst CRL_ID = \"crlId\";\nconst CRL_VALUE = \"crlValue\";\nconst PARSED_VALUE$3 = \"parsedValue\";\nconst CLEAR_PROPS$M = [\n    CRL_ID,\n    CRL_VALUE,\n];\nclass CRLBag extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.crlId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRL_ID, CRLBag.defaultValues(CRL_ID));\n        this.crlValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRL_VALUE, CRLBag.defaultValues(CRL_VALUE));\n        if (PARSED_VALUE$3 in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE$3, CRLBag.defaultValues(PARSED_VALUE$3));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CRL_ID:\n                return EMPTY_STRING;\n            case CRL_VALUE:\n                return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any());\n            case PARSED_VALUE$3:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CRL_ID:\n                return (memberValue === EMPTY_STRING);\n            case CRL_VALUE:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            case PARSED_VALUE$3:\n                return ((memberValue instanceof Object) && (Object.keys(memberValue).length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.id || \"id\") }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.value || \"value\") })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$M);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CRLBag.schema({\n            names: {\n                id: CRL_ID,\n                value: CRL_VALUE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.crlId = asn1.result.crlId.valueBlock.toString();\n        this.crlValue = asn1.result.crlValue;\n        switch (this.crlId) {\n            case id_CRLBag_X509CRL:\n                {\n                    this.parsedValue = CertificateRevocationList.fromBER(this.certValue.valueBlock.valueHex);\n                }\n                break;\n            default:\n                throw new Error(`Incorrect CRL_ID value in CRLBag: ${this.crlId}`);\n        }\n    }\n    toSchema() {\n        if (this.parsedValue) {\n            this.crlId = id_CRLBag_X509CRL;\n            this.crlValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: this.parsedValue.toSchema().toBER(false) });\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.crlId }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [this.crlValue.toSchema()]\n                })\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            crlId: this.crlId,\n            crlValue: this.crlValue.toJSON()\n        };\n    }\n}\nCRLBag.CLASS_NAME = \"CRLBag\";\n\nconst VERSION$d = \"version\";\nconst ENCRYPTED_CONTENT_INFO$1 = \"encryptedContentInfo\";\nconst UNPROTECTED_ATTRS$1 = \"unprotectedAttrs\";\nconst CLEAR_PROPS$L = [\n    VERSION$d,\n    ENCRYPTED_CONTENT_INFO$1,\n    UNPROTECTED_ATTRS$1,\n];\nclass EncryptedData extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$d, EncryptedData.defaultValues(VERSION$d));\n        this.encryptedContentInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_CONTENT_INFO$1, EncryptedData.defaultValues(ENCRYPTED_CONTENT_INFO$1));\n        if (UNPROTECTED_ATTRS$1 in parameters) {\n            this.unprotectedAttrs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, UNPROTECTED_ATTRS$1, EncryptedData.defaultValues(UNPROTECTED_ATTRS$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$d:\n                return 0;\n            case ENCRYPTED_CONTENT_INFO$1:\n                return new EncryptedContentInfo();\n            case UNPROTECTED_ATTRS$1:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$d:\n                return (memberValue === 0);\n            case ENCRYPTED_CONTENT_INFO$1:\n                return ((EncryptedContentInfo.compareWithDefault(\"contentType\", memberValue.contentType)) &&\n                    (EncryptedContentInfo.compareWithDefault(\"contentEncryptionAlgorithm\", memberValue.contentEncryptionAlgorithm)) &&\n                    (EncryptedContentInfo.compareWithDefault(\"encryptedContent\", memberValue.encryptedContent)));\n            case UNPROTECTED_ATTRS$1:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                EncryptedContentInfo.schema(names.encryptedContentInfo || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.unprotectedAttrs || EMPTY_STRING),\n                            value: Attribute.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$L);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, EncryptedData.schema({\n            names: {\n                version: VERSION$d,\n                encryptedContentInfo: {\n                    names: {\n                        blockName: ENCRYPTED_CONTENT_INFO$1\n                    }\n                },\n                unprotectedAttrs: UNPROTECTED_ATTRS$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.encryptedContentInfo = new EncryptedContentInfo({ schema: asn1.result.encryptedContentInfo });\n        if (UNPROTECTED_ATTRS$1 in asn1.result)\n            this.unprotectedAttrs = Array.from(asn1.result.unprotectedAttrs, element => new Attribute({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(this.encryptedContentInfo.toSchema());\n        if (this.unprotectedAttrs) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.unprotectedAttrs, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            encryptedContentInfo: this.encryptedContentInfo.toJSON()\n        };\n        if (this.unprotectedAttrs)\n            res.unprotectedAttrs = Array.from(this.unprotectedAttrs, o => o.toJSON());\n        return res;\n    }\n    async encrypt(parameters, crypto = getCrypto(true)) {\n        ArgumentError.assert(parameters, \"parameters\", \"object\");\n        const encryptParams = {\n            ...parameters,\n            contentType: \"1.2.840.113549.1.7.1\",\n        };\n        this.encryptedContentInfo = await crypto.encryptEncryptedContentInfo(encryptParams);\n    }\n    async decrypt(parameters, crypto = getCrypto(true)) {\n        ArgumentError.assert(parameters, \"parameters\", \"object\");\n        const decryptParams = {\n            ...parameters,\n            encryptedContentInfo: this.encryptedContentInfo,\n        };\n        return crypto.decryptEncryptedContentInfo(decryptParams);\n    }\n}\nEncryptedData.CLASS_NAME = \"EncryptedData\";\n\nconst ENCRYPTION_ALGORITHM = \"encryptionAlgorithm\";\nconst ENCRYPTED_DATA = \"encryptedData\";\nconst PARSED_VALUE$2 = \"parsedValue\";\nconst CLEAR_PROPS$K = [\n    ENCRYPTION_ALGORITHM,\n    ENCRYPTED_DATA,\n];\nclass PKCS8ShroudedKeyBag extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.encryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTION_ALGORITHM, PKCS8ShroudedKeyBag.defaultValues(ENCRYPTION_ALGORITHM));\n        this.encryptedData = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_DATA, PKCS8ShroudedKeyBag.defaultValues(ENCRYPTED_DATA));\n        if (PARSED_VALUE$2 in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE$2, PKCS8ShroudedKeyBag.defaultValues(PARSED_VALUE$2));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ENCRYPTION_ALGORITHM:\n                return (new AlgorithmIdentifier());\n            case ENCRYPTED_DATA:\n                return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString());\n            case PARSED_VALUE$2:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ENCRYPTION_ALGORITHM:\n                return ((AlgorithmIdentifier.compareWithDefault(\"algorithmId\", memberValue.algorithmId)) &&\n                    ((\"algorithmParams\" in memberValue) === false));\n            case ENCRYPTED_DATA:\n                return (memberValue.isEqual(PKCS8ShroudedKeyBag.defaultValues(memberName)));\n            case PARSED_VALUE$2:\n                return ((memberValue instanceof Object) && (Object.keys(memberValue).length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.encryptionAlgorithm || {\n                    names: {\n                        blockName: ENCRYPTION_ALGORITHM\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.encryptedData || ENCRYPTED_DATA) }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({\n                            idBlock: {\n                                isConstructed: true\n                            },\n                            name: (names.encryptedData || ENCRYPTED_DATA)\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$K);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PKCS8ShroudedKeyBag.schema({\n            names: {\n                encryptionAlgorithm: {\n                    names: {\n                        blockName: ENCRYPTION_ALGORITHM\n                    }\n                },\n                encryptedData: ENCRYPTED_DATA\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.encryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.encryptionAlgorithm });\n        this.encryptedData = asn1.result.encryptedData;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.encryptionAlgorithm.toSchema(),\n                this.encryptedData\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            encryptionAlgorithm: this.encryptionAlgorithm.toJSON(),\n            encryptedData: this.encryptedData.toJSON(),\n        };\n    }\n    async parseInternalValues(parameters, crypto = getCrypto(true)) {\n        const cmsEncrypted = new EncryptedData({\n            encryptedContentInfo: new EncryptedContentInfo({\n                contentEncryptionAlgorithm: this.encryptionAlgorithm,\n                encryptedContent: this.encryptedData\n            })\n        });\n        const decryptedData = await cmsEncrypted.decrypt(parameters, crypto);\n        this.parsedValue = PrivateKeyInfo.fromBER(decryptedData);\n    }\n    async makeInternalValues(parameters, crypto = getCrypto(true)) {\n        if (!this.parsedValue) {\n            throw new Error(\"Please initialize \\\"parsedValue\\\" first\");\n        }\n        const cmsEncrypted = new EncryptedData();\n        const encryptParams = {\n            ...parameters,\n            contentToEncrypt: this.parsedValue.toSchema().toBER(false),\n        };\n        await cmsEncrypted.encrypt(encryptParams, crypto);\n        if (!cmsEncrypted.encryptedContentInfo.encryptedContent) {\n            throw new Error(\"The filed `encryptedContent` in EncryptedContentInfo is empty\");\n        }\n        this.encryptionAlgorithm = cmsEncrypted.encryptedContentInfo.contentEncryptionAlgorithm;\n        this.encryptedData = cmsEncrypted.encryptedContentInfo.encryptedContent;\n    }\n}\nPKCS8ShroudedKeyBag.CLASS_NAME = \"PKCS8ShroudedKeyBag\";\n\nconst SECRET_TYPE_ID = \"secretTypeId\";\nconst SECRET_VALUE = \"secretValue\";\nconst CLEAR_PROPS$J = [\n    SECRET_TYPE_ID,\n    SECRET_VALUE,\n];\nclass SecretBag extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.secretTypeId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SECRET_TYPE_ID, SecretBag.defaultValues(SECRET_TYPE_ID));\n        this.secretValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SECRET_VALUE, SecretBag.defaultValues(SECRET_VALUE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SECRET_TYPE_ID:\n                return EMPTY_STRING;\n            case SECRET_VALUE:\n                return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any());\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SECRET_TYPE_ID:\n                return (memberValue === EMPTY_STRING);\n            case SECRET_VALUE:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.id || \"id\") }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.value || \"value\") })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$J);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SecretBag.schema({\n            names: {\n                id: SECRET_TYPE_ID,\n                value: SECRET_VALUE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.secretTypeId = asn1.result.secretTypeId.valueBlock.toString();\n        this.secretValue = asn1.result.secretValue;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.secretTypeId }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [this.secretValue.toSchema()]\n                })\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            secretTypeId: this.secretTypeId,\n            secretValue: this.secretValue.toJSON()\n        };\n    }\n}\nSecretBag.CLASS_NAME = \"SecretBag\";\n\nclass SafeBagValueFactory {\n    static getItems() {\n        if (!this.items) {\n            this.items = {};\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.1\", PrivateKeyInfo);\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.2\", PKCS8ShroudedKeyBag);\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.3\", CertBag);\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.4\", CRLBag);\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.5\", SecretBag);\n            SafeBagValueFactory.register(\"1.2.840.113549.1.12.10.1.6\", SafeContents);\n        }\n        return this.items;\n    }\n    static register(id, type) {\n        this.getItems()[id] = type;\n    }\n    static find(id) {\n        return this.getItems()[id] || null;\n    }\n}\n\nconst BAG_ID = \"bagId\";\nconst BAG_VALUE = \"bagValue\";\nconst BAG_ATTRIBUTES = \"bagAttributes\";\nconst CLEAR_PROPS$I = [\n    BAG_ID,\n    BAG_VALUE,\n    BAG_ATTRIBUTES\n];\nclass SafeBag extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.bagId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BAG_ID, SafeBag.defaultValues(BAG_ID));\n        this.bagValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BAG_VALUE, SafeBag.defaultValues(BAG_VALUE));\n        if (BAG_ATTRIBUTES in parameters) {\n            this.bagAttributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, BAG_ATTRIBUTES, SafeBag.defaultValues(BAG_ATTRIBUTES));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case BAG_ID:\n                return EMPTY_STRING;\n            case BAG_VALUE:\n                return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any());\n            case BAG_ATTRIBUTES:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case BAG_ID:\n                return (memberValue === EMPTY_STRING);\n            case BAG_VALUE:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            case BAG_ATTRIBUTES:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.bagId || BAG_ID) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.bagValue || BAG_VALUE) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    optional: true,\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.bagAttributes || BAG_ATTRIBUTES),\n                            value: Attribute.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$I);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SafeBag.schema({\n            names: {\n                bagId: BAG_ID,\n                bagValue: BAG_VALUE,\n                bagAttributes: BAG_ATTRIBUTES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.bagId = asn1.result.bagId.valueBlock.toString();\n        const bagType = SafeBagValueFactory.find(this.bagId);\n        if (!bagType) {\n            throw new Error(`Invalid BAG_ID for SafeBag: ${this.bagId}`);\n        }\n        this.bagValue = new bagType({ schema: asn1.result.bagValue });\n        if (BAG_ATTRIBUTES in asn1.result) {\n            this.bagAttributes = Array.from(asn1.result.bagAttributes, element => new Attribute({ schema: element }));\n        }\n    }\n    toSchema() {\n        const outputArray = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.bagId }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.bagValue.toSchema()]\n            })\n        ];\n        if (this.bagAttributes) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                value: Array.from(this.bagAttributes, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const output = {\n            bagId: this.bagId,\n            bagValue: this.bagValue.toJSON()\n        };\n        if (this.bagAttributes) {\n            output.bagAttributes = Array.from(this.bagAttributes, o => o.toJSON());\n        }\n        return output;\n    }\n}\nSafeBag.CLASS_NAME = \"SafeBag\";\n\nconst SAFE_BUGS = \"safeBags\";\nclass SafeContents extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.safeBags = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SAFE_BUGS, SafeContents.defaultValues(SAFE_BUGS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SAFE_BUGS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SAFE_BUGS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.safeBags || EMPTY_STRING),\n                    value: SafeBag.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            SAFE_BUGS\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SafeContents.schema({\n            names: {\n                safeBags: SAFE_BUGS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.safeBags = Array.from(asn1.result.safeBags, element => new SafeBag({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.safeBags, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            safeBags: Array.from(this.safeBags, o => o.toJSON())\n        };\n    }\n}\nSafeContents.CLASS_NAME = \"SafeContents\";\n\nconst OTHER_CERT_FORMAT = \"otherCertFormat\";\nconst OTHER_CERT = \"otherCert\";\nconst CLEAR_PROPS$H = [\n    OTHER_CERT_FORMAT,\n    OTHER_CERT\n];\nclass OtherCertificateFormat extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.otherCertFormat = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_CERT_FORMAT, OtherCertificateFormat.defaultValues(OTHER_CERT_FORMAT));\n        this.otherCert = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_CERT, OtherCertificateFormat.defaultValues(OTHER_CERT));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case OTHER_CERT_FORMAT:\n                return EMPTY_STRING;\n            case OTHER_CERT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.otherCertFormat || OTHER_CERT_FORMAT) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.otherCert || OTHER_CERT) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$H);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OtherCertificateFormat.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.otherCertFormat = asn1.result.otherCertFormat.valueBlock.toString();\n        this.otherCert = asn1.result.otherCert;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.otherCertFormat }),\n                this.otherCert\n            ]\n        }));\n    }\n    toJSON() {\n        const res = {\n            otherCertFormat: this.otherCertFormat\n        };\n        if (!(this.otherCert instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any)) {\n            res.otherCert = this.otherCert.toJSON();\n        }\n        return res;\n    }\n}\n\nconst CERTIFICATES$1 = \"certificates\";\nconst CLEAR_PROPS$G = [\n    CERTIFICATES$1,\n];\nclass CertificateSet extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.certificates = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTIFICATES$1, CertificateSet.defaultValues(CERTIFICATES$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERTIFICATES$1:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.certificates || CERTIFICATES$1),\n                    value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                        value: [\n                            Certificate.schema(),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: 0\n                                },\n                                value: [\n                                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any()\n                                ]\n                            }),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: 1\n                                },\n                                value: [\n                                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence\n                                ]\n                            }),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: 2\n                                },\n                                value: AttributeCertificateV2.schema().valueBlock.value\n                            }),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: 3\n                                },\n                                value: OtherCertificateFormat.schema().valueBlock.value\n                            })\n                        ]\n                    })\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$G);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertificateSet.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.certificates = Array.from(asn1.result.certificates || [], (element) => {\n            const initialTagNumber = element.idBlock.tagNumber;\n            if (element.idBlock.tagClass === 1)\n                return new Certificate({ schema: element });\n            const elementSequence = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: element.valueBlock.value\n            });\n            switch (initialTagNumber) {\n                case 1:\n                    if (elementSequence.valueBlock.value[0].valueBlock.value[0].valueBlock.valueDec === 1) {\n                        return new AttributeCertificateV2({ schema: elementSequence });\n                    }\n                    else {\n                        return new AttributeCertificateV1({ schema: elementSequence });\n                    }\n                case 2:\n                    return new AttributeCertificateV2({ schema: elementSequence });\n                case 3:\n                    return new OtherCertificateFormat({ schema: elementSequence });\n            }\n            return element;\n        });\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            value: Array.from(this.certificates, element => {\n                switch (true) {\n                    case (element instanceof Certificate):\n                        return element.toSchema();\n                    case (element instanceof AttributeCertificateV1):\n                        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 1\n                            },\n                            value: element.toSchema().valueBlock.value\n                        });\n                    case (element instanceof AttributeCertificateV2):\n                        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 2\n                            },\n                            value: element.toSchema().valueBlock.value\n                        });\n                    case (element instanceof OtherCertificateFormat):\n                        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 3\n                            },\n                            value: element.toSchema().valueBlock.value\n                        });\n                }\n                return element.toSchema();\n            })\n        }));\n    }\n    toJSON() {\n        return {\n            certificates: Array.from(this.certificates, o => o.toJSON())\n        };\n    }\n}\nCertificateSet.CLASS_NAME = \"CertificateSet\";\n\nconst OTHER_REV_INFO_FORMAT = \"otherRevInfoFormat\";\nconst OTHER_REV_INFO = \"otherRevInfo\";\nconst CLEAR_PROPS$F = [\n    OTHER_REV_INFO_FORMAT,\n    OTHER_REV_INFO\n];\nclass OtherRevocationInfoFormat extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.otherRevInfoFormat = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_REV_INFO_FORMAT, OtherRevocationInfoFormat.defaultValues(OTHER_REV_INFO_FORMAT));\n        this.otherRevInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_REV_INFO, OtherRevocationInfoFormat.defaultValues(OTHER_REV_INFO));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case OTHER_REV_INFO_FORMAT:\n                return EMPTY_STRING;\n            case OTHER_REV_INFO:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.otherRevInfoFormat || OTHER_REV_INFO_FORMAT) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.otherRevInfo || OTHER_REV_INFO) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$F);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OtherRevocationInfoFormat.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.otherRevInfoFormat = asn1.result.otherRevInfoFormat.valueBlock.toString();\n        this.otherRevInfo = asn1.result.otherRevInfo;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.otherRevInfoFormat }),\n                this.otherRevInfo\n            ]\n        }));\n    }\n    toJSON() {\n        const res = {\n            otherRevInfoFormat: this.otherRevInfoFormat\n        };\n        if (!(this.otherRevInfo instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any)) {\n            res.otherRevInfo = this.otherRevInfo.toJSON();\n        }\n        return res;\n    }\n}\nOtherRevocationInfoFormat.CLASS_NAME = \"OtherRevocationInfoFormat\";\n\nconst CRLS$3 = \"crls\";\nconst OTHER_REVOCATION_INFOS = \"otherRevocationInfos\";\nconst CLEAR_PROPS$E = [\n    CRLS$3\n];\nclass RevocationInfoChoices extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.crls = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRLS$3, RevocationInfoChoices.defaultValues(CRLS$3));\n        this.otherRevocationInfos = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER_REVOCATION_INFOS, RevocationInfoChoices.defaultValues(OTHER_REVOCATION_INFOS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CRLS$3:\n                return [];\n            case OTHER_REVOCATION_INFOS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.crls || EMPTY_STRING),\n                    value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                        value: [\n                            CertificateRevocationList.schema(),\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: 1\n                                },\n                                value: [\n                                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier(),\n                                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any()\n                                ]\n                            })\n                        ]\n                    })\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$E);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RevocationInfoChoices.schema({\n            names: {\n                crls: CRLS$3\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (asn1.result.crls) {\n            for (const element of asn1.result.crls) {\n                if (element.idBlock.tagClass === 1)\n                    this.crls.push(new CertificateRevocationList({ schema: element }));\n                else\n                    this.otherRevocationInfos.push(new OtherRevocationInfoFormat({ schema: element }));\n            }\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(...Array.from(this.crls, o => o.toSchema()));\n        outputArray.push(...Array.from(this.otherRevocationInfos, element => {\n            const schema = element.toSchema();\n            schema.idBlock.tagClass = 3;\n            schema.idBlock.tagNumber = 1;\n            return schema;\n        }));\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        return {\n            crls: Array.from(this.crls, o => o.toJSON()),\n            otherRevocationInfos: Array.from(this.otherRevocationInfos, o => o.toJSON())\n        };\n    }\n}\nRevocationInfoChoices.CLASS_NAME = \"RevocationInfoChoices\";\n\nconst CERTS$3 = \"certs\";\nconst CRLS$2 = \"crls\";\nconst CLEAR_PROPS$D = [\n    CERTS$3,\n    CRLS$2,\n];\nclass OriginatorInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.crls = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRLS$2, OriginatorInfo.defaultValues(CRLS$2));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERTS$3:\n                return new CertificateSet();\n            case CRLS$2:\n                return new RevocationInfoChoices();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CERTS$3:\n                return (memberValue.certificates.length === 0);\n            case CRLS$2:\n                return ((memberValue.crls.length === 0) && (memberValue.otherRevocationInfos.length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.certs || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: CertificateSet.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.crls || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: RevocationInfoChoices.schema().valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$D);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OriginatorInfo.schema({\n            names: {\n                certs: CERTS$3,\n                crls: CRLS$2\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (CERTS$3 in asn1.result) {\n            this.certs = new CertificateSet({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: asn1.result.certs.valueBlock.value\n                })\n            });\n        }\n        if (CRLS$2 in asn1.result) {\n            this.crls = new RevocationInfoChoices({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: asn1.result.crls.valueBlock.value\n                })\n            });\n        }\n    }\n    toSchema() {\n        const sequenceValue = [];\n        if (this.certs) {\n            sequenceValue.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.certs.toSchema().valueBlock.value\n            }));\n        }\n        if (this.crls) {\n            sequenceValue.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: this.crls.toSchema().valueBlock.value\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: sequenceValue\n        }));\n    }\n    toJSON() {\n        const res = {};\n        if (this.certs) {\n            res.certs = this.certs.toJSON();\n        }\n        if (this.crls) {\n            res.crls = this.crls.toJSON();\n        }\n        return res;\n    }\n}\nOriginatorInfo.CLASS_NAME = \"OriginatorInfo\";\n\nconst ISSUER = \"issuer\";\nconst SERIAL_NUMBER$2 = \"serialNumber\";\nconst CLEAR_PROPS$C = [\n    ISSUER,\n    SERIAL_NUMBER$2,\n];\nclass IssuerAndSerialNumber extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.issuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER, IssuerAndSerialNumber.defaultValues(ISSUER));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$2, IssuerAndSerialNumber.defaultValues(SERIAL_NUMBER$2));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ISSUER:\n                return new RelativeDistinguishedNames();\n            case SERIAL_NUMBER$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                RelativeDistinguishedNames.schema(names.issuer || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$C);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, IssuerAndSerialNumber.schema({\n            names: {\n                issuer: {\n                    names: {\n                        blockName: ISSUER\n                    }\n                },\n                serialNumber: SERIAL_NUMBER$2\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.issuer = new RelativeDistinguishedNames({ schema: asn1.result.issuer });\n        this.serialNumber = asn1.result.serialNumber;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.issuer.toSchema(),\n                this.serialNumber\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            issuer: this.issuer.toJSON(),\n            serialNumber: this.serialNumber.toJSON(),\n        };\n    }\n}\nIssuerAndSerialNumber.CLASS_NAME = \"IssuerAndSerialNumber\";\n\nconst VARIANT$3 = \"variant\";\nconst VALUE$3 = \"value\";\nconst CLEAR_PROPS$B = [\n    \"blockName\"\n];\nclass RecipientIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.variant = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VARIANT$3, RecipientIdentifier.defaultValues(VARIANT$3));\n        if (VALUE$3 in parameters) {\n            this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$3, RecipientIdentifier.defaultValues(VALUE$3));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VARIANT$3:\n                return (-1);\n            case VALUE$3:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VARIANT$3:\n                return (memberValue === (-1));\n            case VALUE$3:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            value: [\n                IssuerAndSerialNumber.schema({\n                    names: {\n                        blockName: (names.blockName || EMPTY_STRING)\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$B);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RecipientIdentifier.schema({\n            names: {\n                blockName: \"blockName\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (asn1.result.blockName.idBlock.tagClass === 1) {\n            this.variant = 1;\n            this.value = new IssuerAndSerialNumber({ schema: asn1.result.blockName });\n        }\n        else {\n            this.variant = 2;\n            this.value = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: asn1.result.blockName.valueBlock.valueHex });\n        }\n    }\n    toSchema() {\n        switch (this.variant) {\n            case 1:\n                if (!(this.value instanceof IssuerAndSerialNumber)) {\n                    throw new Error(\"Incorrect type of RecipientIdentifier.value. It should be IssuerAndSerialNumber.\");\n                }\n                return this.value.toSchema();\n            case 2:\n                if (!(this.value instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString)) {\n                    throw new Error(\"Incorrect type of RecipientIdentifier.value. It should be ASN.1 OctetString.\");\n                }\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    valueHex: this.value.valueBlock.valueHexView\n                });\n            default:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n        }\n    }\n    toJSON() {\n        const res = {\n            variant: this.variant\n        };\n        if ((this.variant === 1 || this.variant === 2) && this.value) {\n            res.value = this.value.toJSON();\n        }\n        return res;\n    }\n}\nRecipientIdentifier.CLASS_NAME = \"RecipientIdentifier\";\n\nconst VERSION$c = \"version\";\nconst RID$1 = \"rid\";\nconst KEY_ENCRYPTION_ALGORITHM$3 = \"keyEncryptionAlgorithm\";\nconst ENCRYPTED_KEY$3 = \"encryptedKey\";\nconst RECIPIENT_CERTIFICATE$1 = \"recipientCertificate\";\nconst CLEAR_PROPS$A = [\n    VERSION$c,\n    RID$1,\n    KEY_ENCRYPTION_ALGORITHM$3,\n    ENCRYPTED_KEY$3,\n];\nclass KeyTransRecipientInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$c, KeyTransRecipientInfo.defaultValues(VERSION$c));\n        this.rid = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RID$1, KeyTransRecipientInfo.defaultValues(RID$1));\n        this.keyEncryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ENCRYPTION_ALGORITHM$3, KeyTransRecipientInfo.defaultValues(KEY_ENCRYPTION_ALGORITHM$3));\n        this.encryptedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_KEY$3, KeyTransRecipientInfo.defaultValues(ENCRYPTED_KEY$3));\n        this.recipientCertificate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RECIPIENT_CERTIFICATE$1, KeyTransRecipientInfo.defaultValues(RECIPIENT_CERTIFICATE$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$c:\n                return (-1);\n            case RID$1:\n                return {};\n            case KEY_ENCRYPTION_ALGORITHM$3:\n                return new AlgorithmIdentifier();\n            case ENCRYPTED_KEY$3:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case RECIPIENT_CERTIFICATE$1:\n                return new Certificate();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$c:\n                return (memberValue === KeyTransRecipientInfo.defaultValues(VERSION$c));\n            case RID$1:\n                return (Object.keys(memberValue).length === 0);\n            case KEY_ENCRYPTION_ALGORITHM$3:\n            case ENCRYPTED_KEY$3:\n                return memberValue.isEqual(KeyTransRecipientInfo.defaultValues(memberName));\n            case RECIPIENT_CERTIFICATE$1:\n                return false;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                RecipientIdentifier.schema(names.rid || {}),\n                AlgorithmIdentifier.schema(names.keyEncryptionAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.encryptedKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$A);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, KeyTransRecipientInfo.schema({\n            names: {\n                version: VERSION$c,\n                rid: {\n                    names: {\n                        blockName: RID$1\n                    }\n                },\n                keyEncryptionAlgorithm: {\n                    names: {\n                        blockName: KEY_ENCRYPTION_ALGORITHM$3\n                    }\n                },\n                encryptedKey: ENCRYPTED_KEY$3\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        if (asn1.result.rid.idBlock.tagClass === 3) {\n            this.rid = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: asn1.result.rid.valueBlock.valueHex });\n        }\n        else {\n            this.rid = new IssuerAndSerialNumber({ schema: asn1.result.rid });\n        }\n        this.keyEncryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.keyEncryptionAlgorithm });\n        this.encryptedKey = asn1.result.encryptedKey;\n    }\n    toSchema() {\n        const outputArray = [];\n        if (this.rid instanceof IssuerAndSerialNumber) {\n            this.version = 0;\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n            outputArray.push(this.rid.toSchema());\n        }\n        else {\n            this.version = 2;\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                valueHex: this.rid.valueBlock.valueHexView\n            }));\n        }\n        outputArray.push(this.keyEncryptionAlgorithm.toSchema());\n        outputArray.push(this.encryptedKey);\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        return {\n            version: this.version,\n            rid: this.rid.toJSON(),\n            keyEncryptionAlgorithm: this.keyEncryptionAlgorithm.toJSON(),\n            encryptedKey: this.encryptedKey.toJSON(),\n        };\n    }\n}\nKeyTransRecipientInfo.CLASS_NAME = \"KeyTransRecipientInfo\";\n\nconst ALGORITHM = \"algorithm\";\nconst PUBLIC_KEY = \"publicKey\";\nconst CLEAR_PROPS$z = [\n    ALGORITHM,\n    PUBLIC_KEY\n];\nclass OriginatorPublicKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.algorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ALGORITHM, OriginatorPublicKey.defaultValues(ALGORITHM));\n        this.publicKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PUBLIC_KEY, OriginatorPublicKey.defaultValues(PUBLIC_KEY));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ALGORITHM:\n                return new AlgorithmIdentifier();\n            case PUBLIC_KEY:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ALGORITHM:\n            case PUBLIC_KEY:\n                return (memberValue.isEqual(OriginatorPublicKey.defaultValues(memberName)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.algorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.publicKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$z);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OriginatorPublicKey.schema({\n            names: {\n                algorithm: {\n                    names: {\n                        blockName: ALGORITHM\n                    }\n                },\n                publicKey: PUBLIC_KEY\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.algorithm = new AlgorithmIdentifier({ schema: asn1.result.algorithm });\n        this.publicKey = asn1.result.publicKey;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.algorithm.toSchema(),\n                this.publicKey\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            algorithm: this.algorithm.toJSON(),\n            publicKey: this.publicKey.toJSON(),\n        };\n    }\n}\nOriginatorPublicKey.CLASS_NAME = \"OriginatorPublicKey\";\n\nconst VARIANT$2 = \"variant\";\nconst VALUE$2 = \"value\";\nconst CLEAR_PROPS$y = [\n    \"blockName\",\n];\nclass OriginatorIdentifierOrKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.variant = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VARIANT$2, OriginatorIdentifierOrKey.defaultValues(VARIANT$2));\n        if (VALUE$2 in parameters) {\n            this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$2, OriginatorIdentifierOrKey.defaultValues(VALUE$2));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VARIANT$2:\n                return (-1);\n            case VALUE$2:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VARIANT$2:\n                return (memberValue === (-1));\n            case VALUE$2:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            value: [\n                IssuerAndSerialNumber.schema({\n                    names: {\n                        blockName: (names.blockName || EMPTY_STRING)\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    name: (names.blockName || EMPTY_STRING)\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    name: (names.blockName || EMPTY_STRING),\n                    value: OriginatorPublicKey.schema().valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$y);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OriginatorIdentifierOrKey.schema({\n            names: {\n                blockName: \"blockName\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (asn1.result.blockName.idBlock.tagClass === 1) {\n            this.variant = 1;\n            this.value = new IssuerAndSerialNumber({ schema: asn1.result.blockName });\n        }\n        else {\n            if (asn1.result.blockName.idBlock.tagNumber === 0) {\n                asn1.result.blockName.idBlock.tagClass = 1;\n                asn1.result.blockName.idBlock.tagNumber = 4;\n                this.variant = 2;\n                this.value = asn1.result.blockName;\n            }\n            else {\n                this.variant = 3;\n                this.value = new OriginatorPublicKey({\n                    schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: asn1.result.blockName.valueBlock.value\n                    })\n                });\n            }\n        }\n    }\n    toSchema() {\n        switch (this.variant) {\n            case 1:\n                return this.value.toSchema();\n            case 2:\n                this.value.idBlock.tagClass = 3;\n                this.value.idBlock.tagNumber = 0;\n                return this.value;\n            case 3:\n                {\n                    const _schema = this.value.toSchema();\n                    _schema.idBlock.tagClass = 3;\n                    _schema.idBlock.tagNumber = 1;\n                    return _schema;\n                }\n            default:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n        }\n    }\n    toJSON() {\n        const res = {\n            variant: this.variant\n        };\n        if ((this.variant === 1) || (this.variant === 2) || (this.variant === 3)) {\n            res.value = this.value.toJSON();\n        }\n        return res;\n    }\n}\nOriginatorIdentifierOrKey.CLASS_NAME = \"OriginatorIdentifierOrKey\";\n\nconst KEY_ATTR_ID = \"keyAttrId\";\nconst KEY_ATTR = \"keyAttr\";\nconst CLEAR_PROPS$x = [\n    KEY_ATTR_ID,\n    KEY_ATTR,\n];\nclass OtherKeyAttribute extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.keyAttrId = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ATTR_ID, OtherKeyAttribute.defaultValues(KEY_ATTR_ID));\n        if (KEY_ATTR in parameters) {\n            this.keyAttr = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ATTR, OtherKeyAttribute.defaultValues(KEY_ATTR));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_ATTR_ID:\n                return EMPTY_STRING;\n            case KEY_ATTR:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case KEY_ATTR_ID:\n                return (typeof memberValue === \"string\" && memberValue === EMPTY_STRING);\n            case KEY_ATTR:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            optional: (names.optional || true),\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.keyAttrId || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({\n                    optional: true,\n                    name: (names.keyAttr || EMPTY_STRING)\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$x);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OtherKeyAttribute.schema({\n            names: {\n                keyAttrId: KEY_ATTR_ID,\n                keyAttr: KEY_ATTR\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.keyAttrId = asn1.result.keyAttrId.valueBlock.toString();\n        if (KEY_ATTR in asn1.result) {\n            this.keyAttr = asn1.result.keyAttr;\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.keyAttrId }));\n        if (KEY_ATTR in this) {\n            outputArray.push(this.keyAttr);\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray,\n        }));\n    }\n    toJSON() {\n        const res = {\n            keyAttrId: this.keyAttrId\n        };\n        if (KEY_ATTR in this) {\n            res.keyAttr = this.keyAttr.toJSON();\n        }\n        return res;\n    }\n}\nOtherKeyAttribute.CLASS_NAME = \"OtherKeyAttribute\";\n\nconst SUBJECT_KEY_IDENTIFIER = \"subjectKeyIdentifier\";\nconst DATE$1 = \"date\";\nconst OTHER$1 = \"other\";\nconst CLEAR_PROPS$w = [\n    SUBJECT_KEY_IDENTIFIER,\n    DATE$1,\n    OTHER$1,\n];\nclass RecipientKeyIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.subjectKeyIdentifier = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT_KEY_IDENTIFIER, RecipientKeyIdentifier.defaultValues(SUBJECT_KEY_IDENTIFIER));\n        if (DATE$1 in parameters) {\n            this.date = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DATE$1, RecipientKeyIdentifier.defaultValues(DATE$1));\n        }\n        if (OTHER$1 in parameters) {\n            this.other = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER$1, RecipientKeyIdentifier.defaultValues(OTHER$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SUBJECT_KEY_IDENTIFIER:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case DATE$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime();\n            case OTHER$1:\n                return new OtherKeyAttribute();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SUBJECT_KEY_IDENTIFIER:\n                return (memberValue.isEqual(RecipientKeyIdentifier.defaultValues(SUBJECT_KEY_IDENTIFIER)));\n            case DATE$1:\n                return ((memberValue.year === 0) &&\n                    (memberValue.month === 0) &&\n                    (memberValue.day === 0) &&\n                    (memberValue.hour === 0) &&\n                    (memberValue.minute === 0) &&\n                    (memberValue.second === 0) &&\n                    (memberValue.millisecond === 0));\n            case OTHER$1:\n                return ((memberValue.keyAttrId === EMPTY_STRING) && ((\"keyAttr\" in memberValue) === false));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.subjectKeyIdentifier || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({\n                    optional: true,\n                    name: (names.date || EMPTY_STRING)\n                }),\n                OtherKeyAttribute.schema(names.other || {})\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$w);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RecipientKeyIdentifier.schema({\n            names: {\n                subjectKeyIdentifier: SUBJECT_KEY_IDENTIFIER,\n                date: DATE$1,\n                other: {\n                    names: {\n                        blockName: OTHER$1\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.subjectKeyIdentifier = asn1.result.subjectKeyIdentifier;\n        if (DATE$1 in asn1.result)\n            this.date = asn1.result.date;\n        if (OTHER$1 in asn1.result)\n            this.other = new OtherKeyAttribute({ schema: asn1.result.other });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.subjectKeyIdentifier);\n        if (this.date) {\n            outputArray.push(this.date);\n        }\n        if (this.other) {\n            outputArray.push(this.other.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            subjectKeyIdentifier: this.subjectKeyIdentifier.toJSON()\n        };\n        if (this.date) {\n            res.date = this.date.toJSON();\n        }\n        if (this.other) {\n            res.other = this.other.toJSON();\n        }\n        return res;\n    }\n}\nRecipientKeyIdentifier.CLASS_NAME = \"RecipientKeyIdentifier\";\n\nconst VARIANT$1 = \"variant\";\nconst VALUE$1 = \"value\";\nconst CLEAR_PROPS$v = [\n    \"blockName\",\n];\nclass KeyAgreeRecipientIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.variant = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VARIANT$1, KeyAgreeRecipientIdentifier.defaultValues(VARIANT$1));\n        this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE$1, KeyAgreeRecipientIdentifier.defaultValues(VALUE$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VARIANT$1:\n                return (-1);\n            case VALUE$1:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VARIANT$1:\n                return (memberValue === (-1));\n            case VALUE$1:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            value: [\n                IssuerAndSerialNumber.schema(names.issuerAndSerialNumber || {\n                    names: {\n                        blockName: (names.blockName || EMPTY_STRING)\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: RecipientKeyIdentifier.schema(names.rKeyId || {\n                        names: {\n                            blockName: (names.blockName || EMPTY_STRING)\n                        }\n                    }).valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$v);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, KeyAgreeRecipientIdentifier.schema({\n            names: {\n                blockName: \"blockName\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (asn1.result.blockName.idBlock.tagClass === 1) {\n            this.variant = 1;\n            this.value = new IssuerAndSerialNumber({ schema: asn1.result.blockName });\n        }\n        else {\n            this.variant = 2;\n            this.value = new RecipientKeyIdentifier({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.blockName.valueBlock.value\n                })\n            });\n        }\n    }\n    toSchema() {\n        switch (this.variant) {\n            case 1:\n                return this.value.toSchema();\n            case 2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: this.value.toSchema().valueBlock.value\n                });\n            default:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n        }\n    }\n    toJSON() {\n        const res = {\n            variant: this.variant,\n        };\n        if ((this.variant === 1) || (this.variant === 2)) {\n            res.value = this.value.toJSON();\n        }\n        return res;\n    }\n}\nKeyAgreeRecipientIdentifier.CLASS_NAME = \"KeyAgreeRecipientIdentifier\";\n\nconst RID = \"rid\";\nconst ENCRYPTED_KEY$2 = \"encryptedKey\";\nconst CLEAR_PROPS$u = [\n    RID,\n    ENCRYPTED_KEY$2,\n];\nclass RecipientEncryptedKey extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.rid = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RID, RecipientEncryptedKey.defaultValues(RID));\n        this.encryptedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_KEY$2, RecipientEncryptedKey.defaultValues(ENCRYPTED_KEY$2));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case RID:\n                return new KeyAgreeRecipientIdentifier();\n            case ENCRYPTED_KEY$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case RID:\n                return ((memberValue.variant === (-1)) && ((\"value\" in memberValue) === false));\n            case ENCRYPTED_KEY$2:\n                return (memberValue.isEqual(RecipientEncryptedKey.defaultValues(ENCRYPTED_KEY$2)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                KeyAgreeRecipientIdentifier.schema(names.rid || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.encryptedKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$u);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RecipientEncryptedKey.schema({\n            names: {\n                rid: {\n                    names: {\n                        blockName: RID\n                    }\n                },\n                encryptedKey: ENCRYPTED_KEY$2\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.rid = new KeyAgreeRecipientIdentifier({ schema: asn1.result.rid });\n        this.encryptedKey = asn1.result.encryptedKey;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.rid.toSchema(),\n                this.encryptedKey\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            rid: this.rid.toJSON(),\n            encryptedKey: this.encryptedKey.toJSON(),\n        };\n    }\n}\nRecipientEncryptedKey.CLASS_NAME = \"RecipientEncryptedKey\";\n\nconst ENCRYPTED_KEYS = \"encryptedKeys\";\nconst RECIPIENT_ENCRYPTED_KEYS = \"RecipientEncryptedKeys\";\nconst CLEAR_PROPS$t = [\n    RECIPIENT_ENCRYPTED_KEYS,\n];\nclass RecipientEncryptedKeys extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.encryptedKeys = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_KEYS, RecipientEncryptedKeys.defaultValues(ENCRYPTED_KEYS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ENCRYPTED_KEYS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ENCRYPTED_KEYS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.RecipientEncryptedKeys || EMPTY_STRING),\n                    value: RecipientEncryptedKey.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$t);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RecipientEncryptedKeys.schema({\n            names: {\n                RecipientEncryptedKeys: RECIPIENT_ENCRYPTED_KEYS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.encryptedKeys = Array.from(asn1.result.RecipientEncryptedKeys, element => new RecipientEncryptedKey({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.encryptedKeys, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            encryptedKeys: Array.from(this.encryptedKeys, o => o.toJSON())\n        };\n    }\n}\nRecipientEncryptedKeys.CLASS_NAME = \"RecipientEncryptedKeys\";\n\nconst VERSION$b = \"version\";\nconst ORIGINATOR = \"originator\";\nconst UKM = \"ukm\";\nconst KEY_ENCRYPTION_ALGORITHM$2 = \"keyEncryptionAlgorithm\";\nconst RECIPIENT_ENCRYPTED_KEY = \"recipientEncryptedKeys\";\nconst RECIPIENT_CERTIFICATE = \"recipientCertificate\";\nconst RECIPIENT_PUBLIC_KEY = \"recipientPublicKey\";\nconst CLEAR_PROPS$s = [\n    VERSION$b,\n    ORIGINATOR,\n    UKM,\n    KEY_ENCRYPTION_ALGORITHM$2,\n    RECIPIENT_ENCRYPTED_KEY,\n];\nclass KeyAgreeRecipientInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$b, KeyAgreeRecipientInfo.defaultValues(VERSION$b));\n        this.originator = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ORIGINATOR, KeyAgreeRecipientInfo.defaultValues(ORIGINATOR));\n        if (UKM in parameters) {\n            this.ukm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, UKM, KeyAgreeRecipientInfo.defaultValues(UKM));\n        }\n        this.keyEncryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ENCRYPTION_ALGORITHM$2, KeyAgreeRecipientInfo.defaultValues(KEY_ENCRYPTION_ALGORITHM$2));\n        this.recipientEncryptedKeys = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RECIPIENT_ENCRYPTED_KEY, KeyAgreeRecipientInfo.defaultValues(RECIPIENT_ENCRYPTED_KEY));\n        this.recipientCertificate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RECIPIENT_CERTIFICATE, KeyAgreeRecipientInfo.defaultValues(RECIPIENT_CERTIFICATE));\n        this.recipientPublicKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RECIPIENT_PUBLIC_KEY, KeyAgreeRecipientInfo.defaultValues(RECIPIENT_PUBLIC_KEY));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$b:\n                return 0;\n            case ORIGINATOR:\n                return new OriginatorIdentifierOrKey();\n            case UKM:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case KEY_ENCRYPTION_ALGORITHM$2:\n                return new AlgorithmIdentifier();\n            case RECIPIENT_ENCRYPTED_KEY:\n                return new RecipientEncryptedKeys();\n            case RECIPIENT_CERTIFICATE:\n                return new Certificate();\n            case RECIPIENT_PUBLIC_KEY:\n                return null;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$b:\n                return (memberValue === 0);\n            case ORIGINATOR:\n                return ((memberValue.variant === (-1)) && ((\"value\" in memberValue) === false));\n            case UKM:\n                return (memberValue.isEqual(KeyAgreeRecipientInfo.defaultValues(UKM)));\n            case KEY_ENCRYPTION_ALGORITHM$2:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case RECIPIENT_ENCRYPTED_KEY:\n                return (memberValue.encryptedKeys.length === 0);\n            case RECIPIENT_CERTIFICATE:\n                return false;\n            case RECIPIENT_PUBLIC_KEY:\n                return false;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: names.blockName || EMPTY_STRING,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: names.version || EMPTY_STRING }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        OriginatorIdentifierOrKey.schema(names.originator || {})\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: names.ukm || EMPTY_STRING })]\n                }),\n                AlgorithmIdentifier.schema(names.keyEncryptionAlgorithm || {}),\n                RecipientEncryptedKeys.schema(names.recipientEncryptedKeys || {})\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$s);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, KeyAgreeRecipientInfo.schema({\n            names: {\n                version: VERSION$b,\n                originator: {\n                    names: {\n                        blockName: ORIGINATOR\n                    }\n                },\n                ukm: UKM,\n                keyEncryptionAlgorithm: {\n                    names: {\n                        blockName: KEY_ENCRYPTION_ALGORITHM$2\n                    }\n                },\n                recipientEncryptedKeys: {\n                    names: {\n                        blockName: RECIPIENT_ENCRYPTED_KEY\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.originator = new OriginatorIdentifierOrKey({ schema: asn1.result.originator });\n        if (UKM in asn1.result)\n            this.ukm = asn1.result.ukm;\n        this.keyEncryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.keyEncryptionAlgorithm });\n        this.recipientEncryptedKeys = new RecipientEncryptedKeys({ schema: asn1.result.recipientEncryptedKeys });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n            idBlock: {\n                tagClass: 3,\n                tagNumber: 0\n            },\n            value: [this.originator.toSchema()]\n        }));\n        if (this.ukm) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [this.ukm]\n            }));\n        }\n        outputArray.push(this.keyEncryptionAlgorithm.toSchema());\n        outputArray.push(this.recipientEncryptedKeys.toSchema());\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            originator: this.originator.toJSON(),\n            keyEncryptionAlgorithm: this.keyEncryptionAlgorithm.toJSON(),\n            recipientEncryptedKeys: this.recipientEncryptedKeys.toJSON(),\n        };\n        if (this.ukm) {\n            res.ukm = this.ukm.toJSON();\n        }\n        return res;\n    }\n}\nKeyAgreeRecipientInfo.CLASS_NAME = \"KeyAgreeRecipientInfo\";\n\nconst KEY_IDENTIFIER = \"keyIdentifier\";\nconst DATE = \"date\";\nconst OTHER = \"other\";\nconst CLEAR_PROPS$r = [\n    KEY_IDENTIFIER,\n    DATE,\n    OTHER,\n];\nclass KEKIdentifier extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.keyIdentifier = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_IDENTIFIER, KEKIdentifier.defaultValues(KEY_IDENTIFIER));\n        if (DATE in parameters) {\n            this.date = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DATE, KEKIdentifier.defaultValues(DATE));\n        }\n        if (OTHER in parameters) {\n            this.other = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OTHER, KEKIdentifier.defaultValues(OTHER));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_IDENTIFIER:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case DATE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime();\n            case OTHER:\n                return new OtherKeyAttribute();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case KEY_IDENTIFIER:\n                return (memberValue.isEqual(KEKIdentifier.defaultValues(KEY_IDENTIFIER)));\n            case DATE:\n                return ((memberValue.year === 0) &&\n                    (memberValue.month === 0) &&\n                    (memberValue.day === 0) &&\n                    (memberValue.hour === 0) &&\n                    (memberValue.minute === 0) &&\n                    (memberValue.second === 0) &&\n                    (memberValue.millisecond === 0));\n            case OTHER:\n                return ((memberValue.compareWithDefault(\"keyAttrId\", memberValue.keyAttrId)) &&\n                    ((\"keyAttr\" in memberValue) === false));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.keyIdentifier || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({\n                    optional: true,\n                    name: (names.date || EMPTY_STRING)\n                }),\n                OtherKeyAttribute.schema(names.other || {})\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$r);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, KEKIdentifier.schema({\n            names: {\n                keyIdentifier: KEY_IDENTIFIER,\n                date: DATE,\n                other: {\n                    names: {\n                        blockName: OTHER\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.keyIdentifier = asn1.result.keyIdentifier;\n        if (DATE in asn1.result)\n            this.date = asn1.result.date;\n        if (OTHER in asn1.result)\n            this.other = new OtherKeyAttribute({ schema: asn1.result.other });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.keyIdentifier);\n        if (this.date) {\n            outputArray.push(this.date);\n        }\n        if (this.other) {\n            outputArray.push(this.other.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            keyIdentifier: this.keyIdentifier.toJSON()\n        };\n        if (this.date) {\n            res.date = this.date;\n        }\n        if (this.other) {\n            res.other = this.other.toJSON();\n        }\n        return res;\n    }\n}\nKEKIdentifier.CLASS_NAME = \"KEKIdentifier\";\n\nconst VERSION$a = \"version\";\nconst KEK_ID = \"kekid\";\nconst KEY_ENCRYPTION_ALGORITHM$1 = \"keyEncryptionAlgorithm\";\nconst ENCRYPTED_KEY$1 = \"encryptedKey\";\nconst PER_DEFINED_KEK = \"preDefinedKEK\";\nconst CLEAR_PROPS$q = [\n    VERSION$a,\n    KEK_ID,\n    KEY_ENCRYPTION_ALGORITHM$1,\n    ENCRYPTED_KEY$1,\n];\nclass KEKRecipientInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$a, KEKRecipientInfo.defaultValues(VERSION$a));\n        this.kekid = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEK_ID, KEKRecipientInfo.defaultValues(KEK_ID));\n        this.keyEncryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ENCRYPTION_ALGORITHM$1, KEKRecipientInfo.defaultValues(KEY_ENCRYPTION_ALGORITHM$1));\n        this.encryptedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_KEY$1, KEKRecipientInfo.defaultValues(ENCRYPTED_KEY$1));\n        this.preDefinedKEK = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PER_DEFINED_KEK, KEKRecipientInfo.defaultValues(PER_DEFINED_KEK));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$a:\n                return 0;\n            case KEK_ID:\n                return new KEKIdentifier();\n            case KEY_ENCRYPTION_ALGORITHM$1:\n                return new AlgorithmIdentifier();\n            case ENCRYPTED_KEY$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case PER_DEFINED_KEK:\n                return EMPTY_BUFFER;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case \"KEKRecipientInfo\":\n                return (memberValue === KEKRecipientInfo.defaultValues(VERSION$a));\n            case KEK_ID:\n                return ((memberValue.compareWithDefault(\"keyIdentifier\", memberValue.keyIdentifier)) &&\n                    ((\"date\" in memberValue) === false) &&\n                    ((\"other\" in memberValue) === false));\n            case KEY_ENCRYPTION_ALGORITHM$1:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case ENCRYPTED_KEY$1:\n                return (memberValue.isEqual(KEKRecipientInfo.defaultValues(ENCRYPTED_KEY$1)));\n            case PER_DEFINED_KEK:\n                return (memberValue.byteLength === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                KEKIdentifier.schema(names.kekid || {}),\n                AlgorithmIdentifier.schema(names.keyEncryptionAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.encryptedKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$q);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, KEKRecipientInfo.schema({\n            names: {\n                version: VERSION$a,\n                kekid: {\n                    names: {\n                        blockName: KEK_ID\n                    }\n                },\n                keyEncryptionAlgorithm: {\n                    names: {\n                        blockName: KEY_ENCRYPTION_ALGORITHM$1\n                    }\n                },\n                encryptedKey: ENCRYPTED_KEY$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.kekid = new KEKIdentifier({ schema: asn1.result.kekid });\n        this.keyEncryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.keyEncryptionAlgorithm });\n        this.encryptedKey = asn1.result.encryptedKey;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n                this.kekid.toSchema(),\n                this.keyEncryptionAlgorithm.toSchema(),\n                this.encryptedKey\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            version: this.version,\n            kekid: this.kekid.toJSON(),\n            keyEncryptionAlgorithm: this.keyEncryptionAlgorithm.toJSON(),\n            encryptedKey: this.encryptedKey.toJSON(),\n        };\n    }\n}\nKEKRecipientInfo.CLASS_NAME = \"KEKRecipientInfo\";\n\nconst VERSION$9 = \"version\";\nconst KEY_DERIVATION_ALGORITHM = \"keyDerivationAlgorithm\";\nconst KEY_ENCRYPTION_ALGORITHM = \"keyEncryptionAlgorithm\";\nconst ENCRYPTED_KEY = \"encryptedKey\";\nconst PASSWORD = \"password\";\nconst CLEAR_PROPS$p = [\n    VERSION$9,\n    KEY_DERIVATION_ALGORITHM,\n    KEY_ENCRYPTION_ALGORITHM,\n    ENCRYPTED_KEY\n];\nclass PasswordRecipientinfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$9, PasswordRecipientinfo.defaultValues(VERSION$9));\n        if (KEY_DERIVATION_ALGORITHM in parameters) {\n            this.keyDerivationAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_DERIVATION_ALGORITHM, PasswordRecipientinfo.defaultValues(KEY_DERIVATION_ALGORITHM));\n        }\n        this.keyEncryptionAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_ENCRYPTION_ALGORITHM, PasswordRecipientinfo.defaultValues(KEY_ENCRYPTION_ALGORITHM));\n        this.encryptedKey = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_KEY, PasswordRecipientinfo.defaultValues(ENCRYPTED_KEY));\n        this.password = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PASSWORD, PasswordRecipientinfo.defaultValues(PASSWORD));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$9:\n                return (-1);\n            case KEY_DERIVATION_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case KEY_ENCRYPTION_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case ENCRYPTED_KEY:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case PASSWORD:\n                return EMPTY_BUFFER;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$9:\n                return (memberValue === (-1));\n            case KEY_DERIVATION_ALGORITHM:\n            case KEY_ENCRYPTION_ALGORITHM:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case ENCRYPTED_KEY:\n                return (memberValue.isEqual(PasswordRecipientinfo.defaultValues(ENCRYPTED_KEY)));\n            case PASSWORD:\n                return (memberValue.byteLength === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.keyDerivationAlgorithm || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: AlgorithmIdentifier.schema().valueBlock.value\n                }),\n                AlgorithmIdentifier.schema(names.keyEncryptionAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.encryptedKey || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$p);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PasswordRecipientinfo.schema({\n            names: {\n                version: VERSION$9,\n                keyDerivationAlgorithm: KEY_DERIVATION_ALGORITHM,\n                keyEncryptionAlgorithm: {\n                    names: {\n                        blockName: KEY_ENCRYPTION_ALGORITHM\n                    }\n                },\n                encryptedKey: ENCRYPTED_KEY\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        if (KEY_DERIVATION_ALGORITHM in asn1.result) {\n            this.keyDerivationAlgorithm = new AlgorithmIdentifier({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.keyDerivationAlgorithm.valueBlock.value\n                })\n            });\n        }\n        this.keyEncryptionAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.keyEncryptionAlgorithm });\n        this.encryptedKey = asn1.result.encryptedKey;\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        if (this.keyDerivationAlgorithm) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.keyDerivationAlgorithm.toSchema().valueBlock.value\n            }));\n        }\n        outputArray.push(this.keyEncryptionAlgorithm.toSchema());\n        outputArray.push(this.encryptedKey);\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            keyEncryptionAlgorithm: this.keyEncryptionAlgorithm.toJSON(),\n            encryptedKey: this.encryptedKey.toJSON(),\n        };\n        if (this.keyDerivationAlgorithm) {\n            res.keyDerivationAlgorithm = this.keyDerivationAlgorithm.toJSON();\n        }\n        return res;\n    }\n}\nPasswordRecipientinfo.CLASS_NAME = \"PasswordRecipientInfo\";\n\nconst ORI_TYPE = \"oriType\";\nconst ORI_VALUE = \"oriValue\";\nconst CLEAR_PROPS$o = [\n    ORI_TYPE,\n    ORI_VALUE\n];\nclass OtherRecipientInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.oriType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ORI_TYPE, OtherRecipientInfo.defaultValues(ORI_TYPE));\n        this.oriValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ORI_VALUE, OtherRecipientInfo.defaultValues(ORI_VALUE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case ORI_TYPE:\n                return EMPTY_STRING;\n            case ORI_VALUE:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case ORI_TYPE:\n                return (memberValue === EMPTY_STRING);\n            case ORI_VALUE:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.oriType || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.oriValue || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$o);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OtherRecipientInfo.schema({\n            names: {\n                oriType: ORI_TYPE,\n                oriValue: ORI_VALUE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.oriType = asn1.result.oriType.valueBlock.toString();\n        this.oriValue = asn1.result.oriValue;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.oriType }),\n                this.oriValue\n            ]\n        }));\n    }\n    toJSON() {\n        const res = {\n            oriType: this.oriType\n        };\n        if (!OtherRecipientInfo.compareWithDefault(ORI_VALUE, this.oriValue)) {\n            res.oriValue = this.oriValue.toJSON();\n        }\n        return res;\n    }\n}\nOtherRecipientInfo.CLASS_NAME = \"OtherRecipientInfo\";\n\nconst VARIANT = \"variant\";\nconst VALUE = \"value\";\nconst CLEAR_PROPS$n = [\n    \"blockName\"\n];\nclass RecipientInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.variant = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VARIANT, RecipientInfo.defaultValues(VARIANT));\n        if (VALUE in parameters) {\n            this.value = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VALUE, RecipientInfo.defaultValues(VALUE));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VARIANT:\n                return (-1);\n            case VALUE:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VARIANT:\n                return (memberValue === RecipientInfo.defaultValues(memberName));\n            case VALUE:\n                return (Object.keys(memberValue).length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n            value: [\n                KeyTransRecipientInfo.schema({\n                    names: {\n                        blockName: (names.blockName || EMPTY_STRING)\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: KeyAgreeRecipientInfo.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: KEKRecipientInfo.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 3\n                    },\n                    value: PasswordRecipientinfo.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.blockName || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 4\n                    },\n                    value: OtherRecipientInfo.schema().valueBlock.value\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$n);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RecipientInfo.schema({\n            names: {\n                blockName: \"blockName\"\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (asn1.result.blockName.idBlock.tagClass === 1) {\n            this.variant = 1;\n            this.value = new KeyTransRecipientInfo({ schema: asn1.result.blockName });\n        }\n        else {\n            const blockSequence = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: asn1.result.blockName.valueBlock.value\n            });\n            switch (asn1.result.blockName.idBlock.tagNumber) {\n                case 1:\n                    this.variant = 2;\n                    this.value = new KeyAgreeRecipientInfo({ schema: blockSequence });\n                    break;\n                case 2:\n                    this.variant = 3;\n                    this.value = new KEKRecipientInfo({ schema: blockSequence });\n                    break;\n                case 3:\n                    this.variant = 4;\n                    this.value = new PasswordRecipientinfo({ schema: blockSequence });\n                    break;\n                case 4:\n                    this.variant = 5;\n                    this.value = new OtherRecipientInfo({ schema: blockSequence });\n                    break;\n                default:\n                    throw new Error(\"Incorrect structure of RecipientInfo block\");\n            }\n        }\n    }\n    toSchema() {\n        ParameterError.assertEmpty(this.value, \"value\", \"RecipientInfo\");\n        const _schema = this.value.toSchema();\n        switch (this.variant) {\n            case 1:\n                return _schema;\n            case 2:\n            case 3:\n            case 4:\n                _schema.idBlock.tagClass = 3;\n                _schema.idBlock.tagNumber = (this.variant - 1);\n                return _schema;\n            default:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n        }\n    }\n    toJSON() {\n        const res = {\n            variant: this.variant\n        };\n        if (this.value && (this.variant >= 1) && (this.variant <= 4)) {\n            res.value = this.value.toJSON();\n        }\n        return res;\n    }\n}\nRecipientInfo.CLASS_NAME = \"RecipientInfo\";\n\nconst HASH_ALGORITHM$2 = \"hashAlgorithm\";\nconst MASK_GEN_ALGORITHM = \"maskGenAlgorithm\";\nconst P_SOURCE_ALGORITHM = \"pSourceAlgorithm\";\nconst CLEAR_PROPS$m = [\n    HASH_ALGORITHM$2,\n    MASK_GEN_ALGORITHM,\n    P_SOURCE_ALGORITHM\n];\nclass RSAESOAEPParams extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.hashAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASH_ALGORITHM$2, RSAESOAEPParams.defaultValues(HASH_ALGORITHM$2));\n        this.maskGenAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MASK_GEN_ALGORITHM, RSAESOAEPParams.defaultValues(MASK_GEN_ALGORITHM));\n        this.pSourceAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, P_SOURCE_ALGORITHM, RSAESOAEPParams.defaultValues(P_SOURCE_ALGORITHM));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case HASH_ALGORITHM$2:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.3.14.3.2.26\",\n                    algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                });\n            case MASK_GEN_ALGORITHM:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.2.840.113549.1.1.8\",\n                    algorithmParams: (new AlgorithmIdentifier({\n                        algorithmId: \"1.3.14.3.2.26\",\n                        algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                    })).toSchema()\n                });\n            case P_SOURCE_ALGORITHM:\n                return new AlgorithmIdentifier({\n                    algorithmId: \"1.2.840.113549.1.1.9\",\n                    algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: (new Uint8Array([0xda, 0x39, 0xa3, 0xee, 0x5e, 0x6b, 0x4b, 0x0d, 0x32, 0x55, 0xbf, 0xef, 0x95, 0x60, 0x18, 0x90, 0xaf, 0xd8, 0x07, 0x09])).buffer })\n                });\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    optional: true,\n                    value: [AlgorithmIdentifier.schema(names.hashAlgorithm || {})]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    optional: true,\n                    value: [AlgorithmIdentifier.schema(names.maskGenAlgorithm || {})]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    optional: true,\n                    value: [AlgorithmIdentifier.schema(names.pSourceAlgorithm || {})]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$m);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, RSAESOAEPParams.schema({\n            names: {\n                hashAlgorithm: {\n                    names: {\n                        blockName: HASH_ALGORITHM$2\n                    }\n                },\n                maskGenAlgorithm: {\n                    names: {\n                        blockName: MASK_GEN_ALGORITHM\n                    }\n                },\n                pSourceAlgorithm: {\n                    names: {\n                        blockName: P_SOURCE_ALGORITHM\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        if (HASH_ALGORITHM$2 in asn1.result)\n            this.hashAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.hashAlgorithm });\n        if (MASK_GEN_ALGORITHM in asn1.result)\n            this.maskGenAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.maskGenAlgorithm });\n        if (P_SOURCE_ALGORITHM in asn1.result)\n            this.pSourceAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.pSourceAlgorithm });\n    }\n    toSchema() {\n        const outputArray = [];\n        if (!this.hashAlgorithm.isEqual(RSAESOAEPParams.defaultValues(HASH_ALGORITHM$2))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.hashAlgorithm.toSchema()]\n            }));\n        }\n        if (!this.maskGenAlgorithm.isEqual(RSAESOAEPParams.defaultValues(MASK_GEN_ALGORITHM))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: [this.maskGenAlgorithm.toSchema()]\n            }));\n        }\n        if (!this.pSourceAlgorithm.isEqual(RSAESOAEPParams.defaultValues(P_SOURCE_ALGORITHM))) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 2\n                },\n                value: [this.pSourceAlgorithm.toSchema()]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {};\n        if (!this.hashAlgorithm.isEqual(RSAESOAEPParams.defaultValues(HASH_ALGORITHM$2))) {\n            res.hashAlgorithm = this.hashAlgorithm.toJSON();\n        }\n        if (!this.maskGenAlgorithm.isEqual(RSAESOAEPParams.defaultValues(MASK_GEN_ALGORITHM))) {\n            res.maskGenAlgorithm = this.maskGenAlgorithm.toJSON();\n        }\n        if (!this.pSourceAlgorithm.isEqual(RSAESOAEPParams.defaultValues(P_SOURCE_ALGORITHM))) {\n            res.pSourceAlgorithm = this.pSourceAlgorithm.toJSON();\n        }\n        return res;\n    }\n}\nRSAESOAEPParams.CLASS_NAME = \"RSAESOAEPParams\";\n\nconst KEY_INFO = \"keyInfo\";\nconst ENTITY_U_INFO = \"entityUInfo\";\nconst SUPP_PUB_INFO = \"suppPubInfo\";\nconst CLEAR_PROPS$l = [\n    KEY_INFO,\n    ENTITY_U_INFO,\n    SUPP_PUB_INFO\n];\nclass ECCCMSSharedInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.keyInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, KEY_INFO, ECCCMSSharedInfo.defaultValues(KEY_INFO));\n        if (ENTITY_U_INFO in parameters) {\n            this.entityUInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENTITY_U_INFO, ECCCMSSharedInfo.defaultValues(ENTITY_U_INFO));\n        }\n        this.suppPubInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUPP_PUB_INFO, ECCCMSSharedInfo.defaultValues(SUPP_PUB_INFO));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case KEY_INFO:\n                return new AlgorithmIdentifier();\n            case ENTITY_U_INFO:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case SUPP_PUB_INFO:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case KEY_INFO:\n            case ENTITY_U_INFO:\n            case SUPP_PUB_INFO:\n                return (memberValue.isEqual(ECCCMSSharedInfo.defaultValues(memberName)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.keyInfo || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.entityUInfo || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    optional: true,\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString()]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.suppPubInfo || EMPTY_STRING),\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString()]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$l);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ECCCMSSharedInfo.schema({\n            names: {\n                keyInfo: {\n                    names: {\n                        blockName: KEY_INFO\n                    }\n                },\n                entityUInfo: ENTITY_U_INFO,\n                suppPubInfo: SUPP_PUB_INFO\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.keyInfo = new AlgorithmIdentifier({ schema: asn1.result.keyInfo });\n        if (ENTITY_U_INFO in asn1.result)\n            this.entityUInfo = asn1.result.entityUInfo.valueBlock.value[0];\n        this.suppPubInfo = asn1.result.suppPubInfo.valueBlock.value[0];\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.keyInfo.toSchema());\n        if (this.entityUInfo) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.entityUInfo]\n            }));\n        }\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n            idBlock: {\n                tagClass: 3,\n                tagNumber: 2\n            },\n            value: [this.suppPubInfo]\n        }));\n        return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        });\n    }\n    toJSON() {\n        const res = {\n            keyInfo: this.keyInfo.toJSON(),\n            suppPubInfo: this.suppPubInfo.toJSON(),\n        };\n        if (this.entityUInfo) {\n            res.entityUInfo = this.entityUInfo.toJSON();\n        }\n        return res;\n    }\n}\nECCCMSSharedInfo.CLASS_NAME = \"ECCCMSSharedInfo\";\n\nconst VERSION$8 = \"version\";\nconst ORIGINATOR_INFO = \"originatorInfo\";\nconst RECIPIENT_INFOS = \"recipientInfos\";\nconst ENCRYPTED_CONTENT_INFO = \"encryptedContentInfo\";\nconst UNPROTECTED_ATTRS = \"unprotectedAttrs\";\nconst CLEAR_PROPS$k = [\n    VERSION$8,\n    ORIGINATOR_INFO,\n    RECIPIENT_INFOS,\n    ENCRYPTED_CONTENT_INFO,\n    UNPROTECTED_ATTRS\n];\nconst defaultEncryptionParams = {\n    kdfAlgorithm: \"SHA-512\",\n    kekEncryptionLength: 256\n};\nconst curveLengthByName = {\n    \"P-256\": 256,\n    \"P-384\": 384,\n    \"P-521\": 528\n};\nclass EnvelopedData extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$8, EnvelopedData.defaultValues(VERSION$8));\n        if (ORIGINATOR_INFO in parameters) {\n            this.originatorInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ORIGINATOR_INFO, EnvelopedData.defaultValues(ORIGINATOR_INFO));\n        }\n        this.recipientInfos = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RECIPIENT_INFOS, EnvelopedData.defaultValues(RECIPIENT_INFOS));\n        this.encryptedContentInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCRYPTED_CONTENT_INFO, EnvelopedData.defaultValues(ENCRYPTED_CONTENT_INFO));\n        if (UNPROTECTED_ATTRS in parameters) {\n            this.unprotectedAttrs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, UNPROTECTED_ATTRS, EnvelopedData.defaultValues(UNPROTECTED_ATTRS));\n        }\n        this.policy = {\n            disableSplit: !!parameters.disableSplit,\n        };\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$8:\n                return 0;\n            case ORIGINATOR_INFO:\n                return new OriginatorInfo();\n            case RECIPIENT_INFOS:\n                return [];\n            case ENCRYPTED_CONTENT_INFO:\n                return new EncryptedContentInfo();\n            case UNPROTECTED_ATTRS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$8:\n                return (memberValue === EnvelopedData.defaultValues(memberName));\n            case ORIGINATOR_INFO:\n                return ((memberValue.certs.certificates.length === 0) && (memberValue.crls.crls.length === 0));\n            case RECIPIENT_INFOS:\n            case UNPROTECTED_ATTRS:\n                return (memberValue.length === 0);\n            case ENCRYPTED_CONTENT_INFO:\n                return ((EncryptedContentInfo.compareWithDefault(\"contentType\", memberValue.contentType)) &&\n                    (EncryptedContentInfo.compareWithDefault(\"contentEncryptionAlgorithm\", memberValue.contentEncryptionAlgorithm) &&\n                        (EncryptedContentInfo.compareWithDefault(\"encryptedContent\", memberValue.encryptedContent))));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.originatorInfo || EMPTY_STRING),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: OriginatorInfo.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.recipientInfos || EMPTY_STRING),\n                            value: RecipientInfo.schema()\n                        })\n                    ]\n                }),\n                EncryptedContentInfo.schema(names.encryptedContentInfo || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.unprotectedAttrs || EMPTY_STRING),\n                            value: Attribute.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$k);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, EnvelopedData.schema({\n            names: {\n                version: VERSION$8,\n                originatorInfo: ORIGINATOR_INFO,\n                recipientInfos: RECIPIENT_INFOS,\n                encryptedContentInfo: {\n                    names: {\n                        blockName: ENCRYPTED_CONTENT_INFO\n                    }\n                },\n                unprotectedAttrs: UNPROTECTED_ATTRS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        if (ORIGINATOR_INFO in asn1.result) {\n            this.originatorInfo = new OriginatorInfo({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: asn1.result.originatorInfo.valueBlock.value\n                })\n            });\n        }\n        this.recipientInfos = Array.from(asn1.result.recipientInfos, o => new RecipientInfo({ schema: o }));\n        this.encryptedContentInfo = new EncryptedContentInfo({ schema: asn1.result.encryptedContentInfo });\n        if (UNPROTECTED_ATTRS in asn1.result)\n            this.unprotectedAttrs = Array.from(asn1.result.unprotectedAttrs, o => new Attribute({ schema: o }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        if (this.originatorInfo) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: this.originatorInfo.toSchema().valueBlock.value\n            }));\n        }\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            value: Array.from(this.recipientInfos, o => o.toSchema())\n        }));\n        outputArray.push(this.encryptedContentInfo.toSchema());\n        if (this.unprotectedAttrs) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.unprotectedAttrs, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            recipientInfos: Array.from(this.recipientInfos, o => o.toJSON()),\n            encryptedContentInfo: this.encryptedContentInfo.toJSON(),\n        };\n        if (this.originatorInfo)\n            res.originatorInfo = this.originatorInfo.toJSON();\n        if (this.unprotectedAttrs)\n            res.unprotectedAttrs = Array.from(this.unprotectedAttrs, o => o.toJSON());\n        return res;\n    }\n    addRecipientByCertificate(certificate, parameters, variant, crypto = getCrypto(true)) {\n        const encryptionParameters = Object.assign({ useOAEP: true, oaepHashAlgorithm: \"SHA-512\" }, defaultEncryptionParams, parameters || {});\n        if (certificate.subjectPublicKeyInfo.algorithm.algorithmId.indexOf(\"1.2.840.113549\") !== (-1))\n            variant = 1;\n        else {\n            if (certificate.subjectPublicKeyInfo.algorithm.algorithmId.indexOf(\"1.2.840.10045\") !== (-1))\n                variant = 2;\n            else\n                throw new Error(`Unknown type of certificate's public key: ${certificate.subjectPublicKeyInfo.algorithm.algorithmId}`);\n        }\n        switch (variant) {\n            case 1:\n                {\n                    let algorithmId;\n                    let algorithmParams;\n                    if (encryptionParameters.useOAEP === true) {\n                        algorithmId = crypto.getOIDByAlgorithm({\n                            name: \"RSA-OAEP\"\n                        }, true, \"keyEncryptionAlgorithm\");\n                        const hashOID = crypto.getOIDByAlgorithm({\n                            name: encryptionParameters.oaepHashAlgorithm\n                        }, true, \"RSAES-OAEP-params\");\n                        const hashAlgorithm = new AlgorithmIdentifier({\n                            algorithmId: hashOID,\n                            algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                        });\n                        const rsaOAEPParams = new RSAESOAEPParams({\n                            hashAlgorithm,\n                            maskGenAlgorithm: new AlgorithmIdentifier({\n                                algorithmId: \"1.2.840.113549.1.1.8\",\n                                algorithmParams: hashAlgorithm.toSchema()\n                            })\n                        });\n                        algorithmParams = rsaOAEPParams.toSchema();\n                    }\n                    else {\n                        algorithmId = crypto.getOIDByAlgorithm({\n                            name: \"RSAES-PKCS1-v1_5\"\n                        });\n                        if (algorithmId === EMPTY_STRING)\n                            throw new Error(\"Can not find OID for RSAES-PKCS1-v1_5\");\n                        algorithmParams = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null();\n                    }\n                    const keyInfo = new KeyTransRecipientInfo({\n                        version: 0,\n                        rid: new IssuerAndSerialNumber({\n                            issuer: certificate.issuer,\n                            serialNumber: certificate.serialNumber\n                        }),\n                        keyEncryptionAlgorithm: new AlgorithmIdentifier({\n                            algorithmId,\n                            algorithmParams\n                        }),\n                        recipientCertificate: certificate,\n                    });\n                    this.recipientInfos.push(new RecipientInfo({\n                        variant: 1,\n                        value: keyInfo\n                    }));\n                }\n                break;\n            case 2:\n                {\n                    const recipientIdentifier = new KeyAgreeRecipientIdentifier({\n                        variant: 1,\n                        value: new IssuerAndSerialNumber({\n                            issuer: certificate.issuer,\n                            serialNumber: certificate.serialNumber\n                        })\n                    });\n                    this._addKeyAgreeRecipientInfo(recipientIdentifier, encryptionParameters, { recipientCertificate: certificate }, crypto);\n                }\n                break;\n            default:\n                throw new Error(`Unknown \"variant\" value: ${variant}`);\n        }\n        return true;\n    }\n    addRecipientByPreDefinedData(preDefinedData, parameters = {}, variant, crypto = getCrypto(true)) {\n        ArgumentError.assert(preDefinedData, \"preDefinedData\", \"ArrayBuffer\");\n        if (!preDefinedData.byteLength) {\n            throw new Error(\"Pre-defined data could have zero length\");\n        }\n        if (!parameters.keyIdentifier) {\n            const keyIdentifierBuffer = new ArrayBuffer(16);\n            const keyIdentifierView = new Uint8Array(keyIdentifierBuffer);\n            crypto.getRandomValues(keyIdentifierView);\n            parameters.keyIdentifier = keyIdentifierBuffer;\n        }\n        if (!parameters.hmacHashAlgorithm)\n            parameters.hmacHashAlgorithm = \"SHA-512\";\n        if (parameters.iterationCount === undefined) {\n            parameters.iterationCount = 2048;\n        }\n        if (!parameters.keyEncryptionAlgorithm) {\n            parameters.keyEncryptionAlgorithm = {\n                name: \"AES-KW\",\n                length: 256\n            };\n        }\n        if (!parameters.keyEncryptionAlgorithmParams)\n            parameters.keyEncryptionAlgorithmParams = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null();\n        switch (variant) {\n            case 1:\n                {\n                    const kekOID = crypto.getOIDByAlgorithm(parameters.keyEncryptionAlgorithm, true, \"keyEncryptionAlgorithm\");\n                    const keyInfo = new KEKRecipientInfo({\n                        version: 4,\n                        kekid: new KEKIdentifier({\n                            keyIdentifier: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: parameters.keyIdentifier })\n                        }),\n                        keyEncryptionAlgorithm: new AlgorithmIdentifier({\n                            algorithmId: kekOID,\n                            algorithmParams: parameters.keyEncryptionAlgorithmParams\n                        }),\n                        preDefinedKEK: preDefinedData\n                    });\n                    this.recipientInfos.push(new RecipientInfo({\n                        variant: 3,\n                        value: keyInfo\n                    }));\n                }\n                break;\n            case 2:\n                {\n                    const pbkdf2OID = crypto.getOIDByAlgorithm({ name: \"PBKDF2\" }, true, \"keyDerivationAlgorithm\");\n                    const saltBuffer = new ArrayBuffer(64);\n                    const saltView = new Uint8Array(saltBuffer);\n                    crypto.getRandomValues(saltView);\n                    const hmacOID = crypto.getOIDByAlgorithm({\n                        name: \"HMAC\",\n                        hash: {\n                            name: parameters.hmacHashAlgorithm\n                        }\n                    }, true, \"hmacHashAlgorithm\");\n                    const pbkdf2Params = new PBKDF2Params({\n                        salt: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: saltBuffer }),\n                        iterationCount: parameters.iterationCount,\n                        prf: new AlgorithmIdentifier({\n                            algorithmId: hmacOID,\n                            algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n                        })\n                    });\n                    const kekOID = crypto.getOIDByAlgorithm(parameters.keyEncryptionAlgorithm, true, \"keyEncryptionAlgorithm\");\n                    const keyInfo = new PasswordRecipientinfo({\n                        version: 0,\n                        keyDerivationAlgorithm: new AlgorithmIdentifier({\n                            algorithmId: pbkdf2OID,\n                            algorithmParams: pbkdf2Params.toSchema()\n                        }),\n                        keyEncryptionAlgorithm: new AlgorithmIdentifier({\n                            algorithmId: kekOID,\n                            algorithmParams: parameters.keyEncryptionAlgorithmParams\n                        }),\n                        password: preDefinedData\n                    });\n                    this.recipientInfos.push(new RecipientInfo({\n                        variant: 4,\n                        value: keyInfo\n                    }));\n                }\n                break;\n            default:\n                throw new Error(`Unknown value for \"variant\": ${variant}`);\n        }\n    }\n    addRecipientByKeyIdentifier(key, keyId, parameters, crypto = getCrypto(true)) {\n        const encryptionParameters = Object.assign({}, defaultEncryptionParams, parameters || {});\n        const recipientIdentifier = new KeyAgreeRecipientIdentifier({\n            variant: 2,\n            value: new RecipientKeyIdentifier({\n                subjectKeyIdentifier: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: keyId }),\n            })\n        });\n        this._addKeyAgreeRecipientInfo(recipientIdentifier, encryptionParameters, { recipientPublicKey: key }, crypto);\n    }\n    _addKeyAgreeRecipientInfo(recipientIdentifier, encryptionParameters, extraRecipientInfoParams, crypto = getCrypto(true)) {\n        const encryptedKey = new RecipientEncryptedKey({\n            rid: recipientIdentifier\n        });\n        const aesKWoid = crypto.getOIDByAlgorithm({\n            name: \"AES-KW\",\n            length: encryptionParameters.kekEncryptionLength\n        }, true, \"keyEncryptionAlgorithm\");\n        const aesKW = new AlgorithmIdentifier({\n            algorithmId: aesKWoid,\n        });\n        const ecdhOID = crypto.getOIDByAlgorithm({\n            name: \"ECDH\",\n            kdf: encryptionParameters.kdfAlgorithm\n        }, true, \"KeyAgreeRecipientInfo\");\n        const ukmBuffer = new ArrayBuffer(64);\n        const ukmView = new Uint8Array(ukmBuffer);\n        crypto.getRandomValues(ukmView);\n        const recipientInfoParams = {\n            version: 3,\n            ukm: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: ukmBuffer }),\n            keyEncryptionAlgorithm: new AlgorithmIdentifier({\n                algorithmId: ecdhOID,\n                algorithmParams: aesKW.toSchema()\n            }),\n            recipientEncryptedKeys: new RecipientEncryptedKeys({\n                encryptedKeys: [encryptedKey]\n            })\n        };\n        const keyInfo = new KeyAgreeRecipientInfo(Object.assign(recipientInfoParams, extraRecipientInfoParams));\n        this.recipientInfos.push(new RecipientInfo({\n            variant: 2,\n            value: keyInfo\n        }));\n    }\n    async encrypt(contentEncryptionAlgorithm, contentToEncrypt, crypto = getCrypto(true)) {\n        const ivBuffer = new ArrayBuffer(16);\n        const ivView = new Uint8Array(ivBuffer);\n        crypto.getRandomValues(ivView);\n        const contentView = new Uint8Array(contentToEncrypt);\n        const contentEncryptionOID = crypto.getOIDByAlgorithm(contentEncryptionAlgorithm, true, \"contentEncryptionAlgorithm\");\n        const sessionKey = await crypto.generateKey(contentEncryptionAlgorithm, true, [\"encrypt\"]);\n        const encryptedContent = await crypto.encrypt({\n            name: contentEncryptionAlgorithm.name,\n            iv: ivView\n        }, sessionKey, contentView);\n        const exportedSessionKey = await crypto.exportKey(\"raw\", sessionKey);\n        this.version = 2;\n        this.encryptedContentInfo = new EncryptedContentInfo({\n            disableSplit: this.policy.disableSplit,\n            contentType: \"1.2.840.113549.1.7.1\",\n            contentEncryptionAlgorithm: new AlgorithmIdentifier({\n                algorithmId: contentEncryptionOID,\n                algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: ivBuffer })\n            }),\n            encryptedContent: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: encryptedContent })\n        });\n        const SubKeyAgreeRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            let recipientCurve;\n            let recipientPublicKey;\n            if (recipientInfo.recipientPublicKey) {\n                recipientCurve = recipientInfo.recipientPublicKey.algorithm.namedCurve;\n                recipientPublicKey = recipientInfo.recipientPublicKey;\n            }\n            else if (recipientInfo.recipientCertificate) {\n                const curveObject = recipientInfo.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;\n                if (curveObject.constructor.blockName() !== asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier.blockName())\n                    throw new Error(`Incorrect \"recipientCertificate\" for index ${index}`);\n                const curveOID = curveObject.valueBlock.toString();\n                switch (curveOID) {\n                    case \"1.2.840.10045.3.1.7\":\n                        recipientCurve = \"P-256\";\n                        break;\n                    case \"1.3.132.0.34\":\n                        recipientCurve = \"P-384\";\n                        break;\n                    case \"1.3.132.0.35\":\n                        recipientCurve = \"P-521\";\n                        break;\n                    default:\n                        throw new Error(`Incorrect curve OID for index ${index}`);\n                }\n                recipientPublicKey = await recipientInfo.recipientCertificate.getPublicKey({\n                    algorithm: {\n                        algorithm: {\n                            name: \"ECDH\",\n                            namedCurve: recipientCurve\n                        },\n                        usages: []\n                    }\n                }, crypto);\n            }\n            else {\n                throw new Error(\"Unsupported RecipientInfo\");\n            }\n            const recipientCurveLength = curveLengthByName[recipientCurve];\n            const ecdhKeys = await crypto.generateKey({ name: \"ECDH\", namedCurve: recipientCurve }, true, [\"deriveBits\"]);\n            const exportedECDHPublicKey = await crypto.exportKey(\"spki\", ecdhKeys.publicKey);\n            const derivedBits = await crypto.deriveBits({\n                name: \"ECDH\",\n                public: recipientPublicKey\n            }, ecdhKeys.privateKey, recipientCurveLength);\n            const aesKWAlgorithm = new AlgorithmIdentifier({ schema: recipientInfo.keyEncryptionAlgorithm.algorithmParams });\n            const kwAlgorithm = crypto.getAlgorithmByOID(aesKWAlgorithm.algorithmId, true, \"aesKWAlgorithm\");\n            let kwLength = kwAlgorithm.length;\n            const kwLengthBuffer = new ArrayBuffer(4);\n            const kwLengthView = new Uint8Array(kwLengthBuffer);\n            for (let j = 3; j >= 0; j--) {\n                kwLengthView[j] = kwLength;\n                kwLength >>= 8;\n            }\n            const eccInfo = new ECCCMSSharedInfo({\n                keyInfo: new AlgorithmIdentifier({\n                    algorithmId: aesKWAlgorithm.algorithmId\n                }),\n                entityUInfo: recipientInfo.ukm,\n                suppPubInfo: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: kwLengthBuffer })\n            });\n            const encodedInfo = eccInfo.toSchema().toBER(false);\n            const ecdhAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"ecdhAlgorithm\");\n            const derivedKeyRaw = await kdf(ecdhAlgorithm.kdf, derivedBits, kwAlgorithm.length, encodedInfo, crypto);\n            const awsKW = await crypto.importKey(\"raw\", derivedKeyRaw, { name: \"AES-KW\" }, true, [\"wrapKey\"]);\n            const wrappedKey = await crypto.wrapKey(\"raw\", sessionKey, awsKW, { name: \"AES-KW\" });\n            const originator = new OriginatorIdentifierOrKey();\n            originator.variant = 3;\n            originator.value = OriginatorPublicKey.fromBER(exportedECDHPublicKey);\n            recipientInfo.originator = originator;\n            recipientInfo.recipientEncryptedKeys.encryptedKeys[0].encryptedKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: wrappedKey });\n            return { ecdhPrivateKey: ecdhKeys.privateKey };\n        };\n        const SubKeyTransRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            const algorithmParameters = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"keyEncryptionAlgorithm\");\n            if (algorithmParameters.name === \"RSA-OAEP\") {\n                const schema = recipientInfo.keyEncryptionAlgorithm.algorithmParams;\n                const rsaOAEPParams = new RSAESOAEPParams({ schema });\n                algorithmParameters.hash = crypto.getAlgorithmByOID(rsaOAEPParams.hashAlgorithm.algorithmId);\n                if ((\"name\" in algorithmParameters.hash) === false)\n                    throw new Error(`Incorrect OID for hash algorithm: ${rsaOAEPParams.hashAlgorithm.algorithmId}`);\n            }\n            try {\n                const publicKey = await recipientInfo.recipientCertificate.getPublicKey({\n                    algorithm: {\n                        algorithm: algorithmParameters,\n                        usages: [\"encrypt\", \"wrapKey\"]\n                    }\n                }, crypto);\n                const encryptedKey = await crypto.encrypt(publicKey.algorithm, publicKey, exportedSessionKey);\n                recipientInfo.encryptedKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: encryptedKey });\n            }\n            catch {\n            }\n        };\n        const SubKEKRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            const kekAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"kekAlgorithm\");\n            const kekKey = await crypto.importKey(\"raw\", new Uint8Array(recipientInfo.preDefinedKEK), kekAlgorithm, true, [\"wrapKey\"]);\n            const wrappedKey = await crypto.wrapKey(\"raw\", sessionKey, kekKey, kekAlgorithm);\n            recipientInfo.encryptedKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: wrappedKey });\n        };\n        const SubPasswordRecipientinfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            let pbkdf2Params;\n            if (!recipientInfo.keyDerivationAlgorithm)\n                throw new Error(\"Please append encoded \\\"keyDerivationAlgorithm\\\"\");\n            if (!recipientInfo.keyDerivationAlgorithm.algorithmParams)\n                throw new Error(\"Incorrectly encoded \\\"keyDerivationAlgorithm\\\"\");\n            try {\n                pbkdf2Params = new PBKDF2Params({ schema: recipientInfo.keyDerivationAlgorithm.algorithmParams });\n            }\n            catch (ex) {\n                throw new Error(\"Incorrectly encoded \\\"keyDerivationAlgorithm\\\"\");\n            }\n            const passwordView = new Uint8Array(recipientInfo.password);\n            const derivationKey = await crypto.importKey(\"raw\", passwordView, \"PBKDF2\", false, [\"deriveKey\"]);\n            const kekAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"kekAlgorithm\");\n            let hmacHashAlgorithm = \"SHA-1\";\n            if (pbkdf2Params.prf) {\n                const prfAlgorithm = crypto.getAlgorithmByOID(pbkdf2Params.prf.algorithmId, true, \"prfAlgorithm\");\n                hmacHashAlgorithm = prfAlgorithm.hash.name;\n            }\n            const saltView = new Uint8Array(pbkdf2Params.salt.valueBlock.valueHex);\n            const iterations = pbkdf2Params.iterationCount;\n            const derivedKey = await crypto.deriveKey({\n                name: \"PBKDF2\",\n                hash: {\n                    name: hmacHashAlgorithm\n                },\n                salt: saltView,\n                iterations\n            }, derivationKey, kekAlgorithm, true, [\"wrapKey\"]);\n            const wrappedKey = await crypto.wrapKey(\"raw\", sessionKey, derivedKey, kekAlgorithm);\n            recipientInfo.encryptedKey = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: wrappedKey });\n        };\n        const res = [];\n        for (let i = 0; i < this.recipientInfos.length; i++) {\n            switch (this.recipientInfos[i].variant) {\n                case 1:\n                    res.push(await SubKeyTransRecipientInfo(i));\n                    break;\n                case 2:\n                    res.push(await SubKeyAgreeRecipientInfo(i));\n                    break;\n                case 3:\n                    res.push(await SubKEKRecipientInfo(i));\n                    break;\n                case 4:\n                    res.push(await SubPasswordRecipientinfo(i));\n                    break;\n                default:\n                    throw new Error(`Unknown recipient type in array with index ${i}`);\n            }\n        }\n        return res;\n    }\n    async decrypt(recipientIndex, parameters, crypto = getCrypto(true)) {\n        const decryptionParameters = parameters || {};\n        if ((recipientIndex + 1) > this.recipientInfos.length) {\n            throw new Error(`Maximum value for \"index\" is: ${this.recipientInfos.length - 1}`);\n        }\n        const SubKeyAgreeRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            let curveOID;\n            let recipientCurve;\n            let recipientCurveLength;\n            const originator = recipientInfo.originator;\n            if (decryptionParameters.recipientCertificate) {\n                const curveObject = decryptionParameters.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;\n                if (curveObject.constructor.blockName() !== asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier.blockName()) {\n                    throw new Error(`Incorrect \"recipientCertificate\" for index ${index}`);\n                }\n                curveOID = curveObject.valueBlock.toString();\n            }\n            else if (originator.value.algorithm.algorithmParams) {\n                const curveObject = originator.value.algorithm.algorithmParams;\n                if (curveObject.constructor.blockName() !== asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier.blockName()) {\n                    throw new Error(`Incorrect originator for index ${index}`);\n                }\n                curveOID = curveObject.valueBlock.toString();\n            }\n            else {\n                throw new Error(\"Parameter \\\"recipientCertificate\\\" is mandatory for \\\"KeyAgreeRecipientInfo\\\" if algorithm params are missing from originator\");\n            }\n            if (!decryptionParameters.recipientPrivateKey)\n                throw new Error(\"Parameter \\\"recipientPrivateKey\\\" is mandatory for \\\"KeyAgreeRecipientInfo\\\"\");\n            switch (curveOID) {\n                case \"1.2.840.10045.3.1.7\":\n                    recipientCurve = \"P-256\";\n                    recipientCurveLength = 256;\n                    break;\n                case \"1.3.132.0.34\":\n                    recipientCurve = \"P-384\";\n                    recipientCurveLength = 384;\n                    break;\n                case \"1.3.132.0.35\":\n                    recipientCurve = \"P-521\";\n                    recipientCurveLength = 528;\n                    break;\n                default:\n                    throw new Error(`Incorrect curve OID for index ${index}`);\n            }\n            let ecdhPrivateKey;\n            let keyCrypto = crypto;\n            if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isBufferSource(decryptionParameters.recipientPrivateKey)) {\n                ecdhPrivateKey = await crypto.importKey(\"pkcs8\", decryptionParameters.recipientPrivateKey, {\n                    name: \"ECDH\",\n                    namedCurve: recipientCurve\n                }, true, [\"deriveBits\"]);\n            }\n            else {\n                ecdhPrivateKey = decryptionParameters.recipientPrivateKey;\n                if (\"crypto\" in decryptionParameters && decryptionParameters.crypto) {\n                    keyCrypto = decryptionParameters.crypto.subtle;\n                }\n            }\n            if ((\"algorithmParams\" in originator.value.algorithm) === false)\n                originator.value.algorithm.algorithmParams = new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: curveOID });\n            const buffer = originator.value.toSchema().toBER(false);\n            const ecdhPublicKey = await crypto.importKey(\"spki\", buffer, {\n                name: \"ECDH\",\n                namedCurve: recipientCurve\n            }, true, []);\n            const sharedSecret = await keyCrypto.deriveBits({\n                name: \"ECDH\",\n                public: ecdhPublicKey\n            }, ecdhPrivateKey, recipientCurveLength);\n            async function applyKDF(includeAlgorithmParams) {\n                includeAlgorithmParams = includeAlgorithmParams || false;\n                const aesKWAlgorithm = new AlgorithmIdentifier({ schema: recipientInfo.keyEncryptionAlgorithm.algorithmParams });\n                const kwAlgorithm = crypto.getAlgorithmByOID(aesKWAlgorithm.algorithmId, true, \"kwAlgorithm\");\n                let kwLength = kwAlgorithm.length;\n                const kwLengthBuffer = new ArrayBuffer(4);\n                const kwLengthView = new Uint8Array(kwLengthBuffer);\n                for (let j = 3; j >= 0; j--) {\n                    kwLengthView[j] = kwLength;\n                    kwLength >>= 8;\n                }\n                const keyInfoAlgorithm = {\n                    algorithmId: aesKWAlgorithm.algorithmId\n                };\n                if (includeAlgorithmParams) {\n                    keyInfoAlgorithm.algorithmParams = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null();\n                }\n                const eccInfo = new ECCCMSSharedInfo({\n                    keyInfo: new AlgorithmIdentifier(keyInfoAlgorithm),\n                    entityUInfo: recipientInfo.ukm,\n                    suppPubInfo: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: kwLengthBuffer })\n                });\n                const encodedInfo = eccInfo.toSchema().toBER(false);\n                const ecdhAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"ecdhAlgorithm\");\n                if (!ecdhAlgorithm.name) {\n                    throw new Error(`Incorrect OID for key encryption algorithm: ${recipientInfo.keyEncryptionAlgorithm.algorithmId}`);\n                }\n                return kdf(ecdhAlgorithm.kdf, sharedSecret, kwAlgorithm.length, encodedInfo, crypto);\n            }\n            const kdfResult = await applyKDF();\n            const importAesKwKey = async (kdfResult) => {\n                return crypto.importKey(\"raw\", kdfResult, { name: \"AES-KW\" }, true, [\"unwrapKey\"]);\n            };\n            const aesKwKey = await importAesKwKey(kdfResult);\n            const unwrapSessionKey = async (aesKwKey) => {\n                const algorithmId = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId;\n                const contentEncryptionAlgorithm = crypto.getAlgorithmByOID(algorithmId, true, \"contentEncryptionAlgorithm\");\n                return crypto.unwrapKey(\"raw\", recipientInfo.recipientEncryptedKeys.encryptedKeys[0].encryptedKey.valueBlock.valueHexView, aesKwKey, { name: \"AES-KW\" }, contentEncryptionAlgorithm, true, [\"decrypt\"]);\n            };\n            try {\n                return await unwrapSessionKey(aesKwKey);\n            }\n            catch {\n                const kdfResult = await applyKDF(true);\n                const aesKwKey = await importAesKwKey(kdfResult);\n                return unwrapSessionKey(aesKwKey);\n            }\n        };\n        const SubKeyTransRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            if (!decryptionParameters.recipientPrivateKey) {\n                throw new Error(\"Parameter \\\"recipientPrivateKey\\\" is mandatory for \\\"KeyTransRecipientInfo\\\"\");\n            }\n            const algorithmParameters = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"keyEncryptionAlgorithm\");\n            if (algorithmParameters.name === \"RSA-OAEP\") {\n                const schema = recipientInfo.keyEncryptionAlgorithm.algorithmParams;\n                const rsaOAEPParams = new RSAESOAEPParams({ schema });\n                algorithmParameters.hash = crypto.getAlgorithmByOID(rsaOAEPParams.hashAlgorithm.algorithmId);\n                if ((\"name\" in algorithmParameters.hash) === false)\n                    throw new Error(`Incorrect OID for hash algorithm: ${rsaOAEPParams.hashAlgorithm.algorithmId}`);\n            }\n            let privateKey;\n            let keyCrypto = crypto;\n            if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isBufferSource(decryptionParameters.recipientPrivateKey)) {\n                privateKey = await crypto.importKey(\"pkcs8\", decryptionParameters.recipientPrivateKey, algorithmParameters, true, [\"decrypt\"]);\n            }\n            else {\n                privateKey = decryptionParameters.recipientPrivateKey;\n                if (\"crypto\" in decryptionParameters && decryptionParameters.crypto) {\n                    keyCrypto = decryptionParameters.crypto.subtle;\n                }\n            }\n            const sessionKey = await keyCrypto.decrypt(privateKey.algorithm, privateKey, recipientInfo.encryptedKey.valueBlock.valueHexView);\n            const algorithmId = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId;\n            const contentEncryptionAlgorithm = crypto.getAlgorithmByOID(algorithmId, true, \"contentEncryptionAlgorithm\");\n            if ((\"name\" in contentEncryptionAlgorithm) === false)\n                throw new Error(`Incorrect \"contentEncryptionAlgorithm\": ${algorithmId}`);\n            return crypto.importKey(\"raw\", sessionKey, contentEncryptionAlgorithm, true, [\"decrypt\"]);\n        };\n        const SubKEKRecipientInfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            if (!decryptionParameters.preDefinedData)\n                throw new Error(\"Parameter \\\"preDefinedData\\\" is mandatory for \\\"KEKRecipientInfo\\\"\");\n            const kekAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"kekAlgorithm\");\n            const importedKey = await crypto.importKey(\"raw\", decryptionParameters.preDefinedData, kekAlgorithm, true, [\"unwrapKey\"]);\n            const algorithmId = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId;\n            const contentEncryptionAlgorithm = crypto.getAlgorithmByOID(algorithmId, true, \"contentEncryptionAlgorithm\");\n            if (!contentEncryptionAlgorithm.name) {\n                throw new Error(`Incorrect \"contentEncryptionAlgorithm\": ${algorithmId}`);\n            }\n            return crypto.unwrapKey(\"raw\", recipientInfo.encryptedKey.valueBlock.valueHexView, importedKey, kekAlgorithm, contentEncryptionAlgorithm, true, [\"decrypt\"]);\n        };\n        const SubPasswordRecipientinfo = async (index) => {\n            const recipientInfo = this.recipientInfos[index].value;\n            let pbkdf2Params;\n            if (!decryptionParameters.preDefinedData) {\n                throw new Error(\"Parameter \\\"preDefinedData\\\" is mandatory for \\\"KEKRecipientInfo\\\"\");\n            }\n            if (!recipientInfo.keyDerivationAlgorithm) {\n                throw new Error(\"Please append encoded \\\"keyDerivationAlgorithm\\\"\");\n            }\n            if (!recipientInfo.keyDerivationAlgorithm.algorithmParams) {\n                throw new Error(\"Incorrectly encoded \\\"keyDerivationAlgorithm\\\"\");\n            }\n            try {\n                pbkdf2Params = new PBKDF2Params({ schema: recipientInfo.keyDerivationAlgorithm.algorithmParams });\n            }\n            catch (ex) {\n                throw new Error(\"Incorrectly encoded \\\"keyDerivationAlgorithm\\\"\");\n            }\n            const pbkdf2Key = await crypto.importKey(\"raw\", decryptionParameters.preDefinedData, \"PBKDF2\", false, [\"deriveKey\"]);\n            const kekAlgorithm = crypto.getAlgorithmByOID(recipientInfo.keyEncryptionAlgorithm.algorithmId, true, \"keyEncryptionAlgorithm\");\n            const hmacHashAlgorithm = pbkdf2Params.prf\n                ? crypto.getAlgorithmByOID(pbkdf2Params.prf.algorithmId, true, \"prfAlgorithm\").hash.name\n                : \"SHA-1\";\n            const saltView = new Uint8Array(pbkdf2Params.salt.valueBlock.valueHex);\n            const iterations = pbkdf2Params.iterationCount;\n            const kekKey = await crypto.deriveKey({\n                name: \"PBKDF2\",\n                hash: {\n                    name: hmacHashAlgorithm\n                },\n                salt: saltView,\n                iterations\n            }, pbkdf2Key, kekAlgorithm, true, [\"unwrapKey\"]);\n            const algorithmId = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId;\n            const contentEncryptionAlgorithm = crypto.getAlgorithmByOID(algorithmId, true, \"contentEncryptionAlgorithm\");\n            return crypto.unwrapKey(\"raw\", recipientInfo.encryptedKey.valueBlock.valueHexView, kekKey, kekAlgorithm, contentEncryptionAlgorithm, true, [\"decrypt\"]);\n        };\n        let unwrappedKey;\n        switch (this.recipientInfos[recipientIndex].variant) {\n            case 1:\n                unwrappedKey = await SubKeyTransRecipientInfo(recipientIndex);\n                break;\n            case 2:\n                unwrappedKey = await SubKeyAgreeRecipientInfo(recipientIndex);\n                break;\n            case 3:\n                unwrappedKey = await SubKEKRecipientInfo(recipientIndex);\n                break;\n            case 4:\n                unwrappedKey = await SubPasswordRecipientinfo(recipientIndex);\n                break;\n            default:\n                throw new Error(`Unknown recipient type in array with index ${recipientIndex}`);\n        }\n        const algorithmId = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId;\n        const contentEncryptionAlgorithm = crypto.getAlgorithmByOID(algorithmId, true, \"contentEncryptionAlgorithm\");\n        const ivBuffer = this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams.valueBlock.valueHex;\n        const ivView = new Uint8Array(ivBuffer);\n        if (!this.encryptedContentInfo.encryptedContent) {\n            throw new Error(\"Required property `encryptedContent` is empty\");\n        }\n        const dataBuffer = this.encryptedContentInfo.getEncryptedContent();\n        return crypto.decrypt({\n            name: contentEncryptionAlgorithm.name,\n            iv: ivView\n        }, unwrappedKey, dataBuffer);\n    }\n}\nEnvelopedData.CLASS_NAME = \"EnvelopedData\";\n\nconst SAFE_CONTENTS = \"safeContents\";\nconst PARSED_VALUE$1 = \"parsedValue\";\nconst CONTENT_INFOS = \"contentInfos\";\nclass AuthenticatedSafe extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.safeContents = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SAFE_CONTENTS, AuthenticatedSafe.defaultValues(SAFE_CONTENTS));\n        if (PARSED_VALUE$1 in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE$1, AuthenticatedSafe.defaultValues(PARSED_VALUE$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SAFE_CONTENTS:\n                return [];\n            case PARSED_VALUE$1:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SAFE_CONTENTS:\n                return (memberValue.length === 0);\n            case PARSED_VALUE$1:\n                return ((memberValue instanceof Object) && (Object.keys(memberValue).length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.contentInfos || EMPTY_STRING),\n                    value: ContentInfo.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            CONTENT_INFOS\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, AuthenticatedSafe.schema({\n            names: {\n                contentInfos: CONTENT_INFOS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.safeContents = Array.from(asn1.result.contentInfos, element => new ContentInfo({ schema: element }));\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: Array.from(this.safeContents, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        return {\n            safeContents: Array.from(this.safeContents, o => o.toJSON())\n        };\n    }\n    async parseInternalValues(parameters, crypto = getCrypto(true)) {\n        ParameterError.assert(parameters, SAFE_CONTENTS);\n        ArgumentError.assert(parameters.safeContents, SAFE_CONTENTS, \"Array\");\n        if (parameters.safeContents.length !== this.safeContents.length) {\n            throw new ArgumentError(\"Length of \\\"parameters.safeContents\\\" must be equal to \\\"this.safeContents.length\\\"\");\n        }\n        this.parsedValue = {\n            safeContents: [],\n        };\n        for (const [index, content] of this.safeContents.entries()) {\n            const safeContent = parameters.safeContents[index];\n            const errorTarget = `parameters.safeContents[${index}]`;\n            switch (content.contentType) {\n                case id_ContentType_Data:\n                    {\n                        ArgumentError.assert(content.content, \"this.safeContents[j].content\", asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString);\n                        const authSafeContent = content.content.getValue();\n                        this.parsedValue.safeContents.push({\n                            privacyMode: 0,\n                            value: SafeContents.fromBER(authSafeContent)\n                        });\n                    }\n                    break;\n                case id_ContentType_EnvelopedData:\n                    {\n                        const cmsEnveloped = new EnvelopedData({ schema: content.content });\n                        ParameterError.assert(errorTarget, safeContent, \"recipientCertificate\", \"recipientKey\");\n                        const envelopedData = safeContent;\n                        const recipientCertificate = envelopedData.recipientCertificate;\n                        const recipientKey = envelopedData.recipientKey;\n                        const decrypted = await cmsEnveloped.decrypt(0, {\n                            recipientCertificate,\n                            recipientPrivateKey: recipientKey\n                        }, crypto);\n                        this.parsedValue.safeContents.push({\n                            privacyMode: 2,\n                            value: SafeContents.fromBER(decrypted),\n                        });\n                    }\n                    break;\n                case id_ContentType_EncryptedData:\n                    {\n                        const cmsEncrypted = new EncryptedData({ schema: content.content });\n                        ParameterError.assert(errorTarget, safeContent, \"password\");\n                        const password = safeContent.password;\n                        const decrypted = await cmsEncrypted.decrypt({\n                            password\n                        }, crypto);\n                        this.parsedValue.safeContents.push({\n                            privacyMode: 1,\n                            value: SafeContents.fromBER(decrypted),\n                        });\n                    }\n                    break;\n                default:\n                    throw new Error(`Unknown \"contentType\" for AuthenticatedSafe: \" ${content.contentType}`);\n            }\n        }\n    }\n    async makeInternalValues(parameters, crypto = getCrypto(true)) {\n        if (!(this.parsedValue)) {\n            throw new Error(\"Please run \\\"parseValues\\\" first or add \\\"parsedValue\\\" manually\");\n        }\n        ArgumentError.assert(this.parsedValue, \"this.parsedValue\", \"object\");\n        ArgumentError.assert(this.parsedValue.safeContents, \"this.parsedValue.safeContents\", \"Array\");\n        ArgumentError.assert(parameters, \"parameters\", \"object\");\n        ParameterError.assert(parameters, \"safeContents\");\n        ArgumentError.assert(parameters.safeContents, \"parameters.safeContents\", \"Array\");\n        if (parameters.safeContents.length !== this.parsedValue.safeContents.length) {\n            throw new ArgumentError(\"Length of \\\"parameters.safeContents\\\" must be equal to \\\"this.parsedValue.safeContents\\\"\");\n        }\n        this.safeContents = [];\n        for (const [index, content] of this.parsedValue.safeContents.entries()) {\n            ParameterError.assert(\"content\", content, \"privacyMode\", \"value\");\n            ArgumentError.assert(content.value, \"content.value\", SafeContents);\n            switch (content.privacyMode) {\n                case 0:\n                    {\n                        const contentBuffer = content.value.toSchema().toBER(false);\n                        this.safeContents.push(new ContentInfo({\n                            contentType: \"1.2.840.113549.1.7.1\",\n                            content: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: contentBuffer })\n                        }));\n                    }\n                    break;\n                case 1:\n                    {\n                        const cmsEncrypted = new EncryptedData();\n                        const currentParameters = parameters.safeContents[index];\n                        currentParameters.contentToEncrypt = content.value.toSchema().toBER(false);\n                        await cmsEncrypted.encrypt(currentParameters, crypto);\n                        this.safeContents.push(new ContentInfo({\n                            contentType: \"1.2.840.113549.1.7.6\",\n                            content: cmsEncrypted.toSchema()\n                        }));\n                    }\n                    break;\n                case 2:\n                    {\n                        const cmsEnveloped = new EnvelopedData();\n                        const contentToEncrypt = content.value.toSchema().toBER(false);\n                        const safeContent = parameters.safeContents[index];\n                        ParameterError.assert(`parameters.safeContents[${index}]`, safeContent, \"encryptingCertificate\", \"encryptionAlgorithm\");\n                        switch (true) {\n                            case (safeContent.encryptionAlgorithm.name.toLowerCase() === \"aes-cbc\"):\n                            case (safeContent.encryptionAlgorithm.name.toLowerCase() === \"aes-gcm\"):\n                                break;\n                            default:\n                                throw new Error(`Incorrect parameter \"encryptionAlgorithm\" in \"parameters.safeContents[i]\": ${safeContent.encryptionAlgorithm}`);\n                        }\n                        switch (true) {\n                            case (safeContent.encryptionAlgorithm.length === 128):\n                            case (safeContent.encryptionAlgorithm.length === 192):\n                            case (safeContent.encryptionAlgorithm.length === 256):\n                                break;\n                            default:\n                                throw new Error(`Incorrect parameter \"encryptionAlgorithm.length\" in \"parameters.safeContents[i]\": ${safeContent.encryptionAlgorithm.length}`);\n                        }\n                        const encryptionAlgorithm = safeContent.encryptionAlgorithm;\n                        cmsEnveloped.addRecipientByCertificate(safeContent.encryptingCertificate, {}, undefined, crypto);\n                        await cmsEnveloped.encrypt(encryptionAlgorithm, contentToEncrypt, crypto);\n                        this.safeContents.push(new ContentInfo({\n                            contentType: \"1.2.840.113549.1.7.3\",\n                            content: cmsEnveloped.toSchema()\n                        }));\n                    }\n                    break;\n                default:\n                    throw new Error(`Incorrect value for \"content.privacyMode\": ${content.privacyMode}`);\n            }\n        }\n        return this;\n    }\n}\nAuthenticatedSafe.CLASS_NAME = \"AuthenticatedSafe\";\n\nconst HASH_ALGORITHM$1 = \"hashAlgorithm\";\nconst ISSUER_NAME_HASH = \"issuerNameHash\";\nconst ISSUER_KEY_HASH = \"issuerKeyHash\";\nconst SERIAL_NUMBER$1 = \"serialNumber\";\nconst CLEAR_PROPS$j = [\n    HASH_ALGORITHM$1,\n    ISSUER_NAME_HASH,\n    ISSUER_KEY_HASH,\n    SERIAL_NUMBER$1,\n];\nclass CertID extends PkiObject {\n    static async create(certificate, parameters, crypto = getCrypto(true)) {\n        const certID = new CertID();\n        await certID.createForCertificate(certificate, parameters, crypto);\n        return certID;\n    }\n    constructor(parameters = {}) {\n        super();\n        this.hashAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASH_ALGORITHM$1, CertID.defaultValues(HASH_ALGORITHM$1));\n        this.issuerNameHash = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_NAME_HASH, CertID.defaultValues(ISSUER_NAME_HASH));\n        this.issuerKeyHash = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ISSUER_KEY_HASH, CertID.defaultValues(ISSUER_KEY_HASH));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER$1, CertID.defaultValues(SERIAL_NUMBER$1));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case HASH_ALGORITHM$1:\n                return new AlgorithmIdentifier();\n            case ISSUER_NAME_HASH:\n            case ISSUER_KEY_HASH:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case SERIAL_NUMBER$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case HASH_ALGORITHM$1:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case ISSUER_NAME_HASH:\n            case ISSUER_KEY_HASH:\n            case SERIAL_NUMBER$1:\n                return (memberValue.isEqual(CertID.defaultValues(SERIAL_NUMBER$1)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.hashAlgorithmObject || {\n                    names: {\n                        blockName: (names.hashAlgorithm || EMPTY_STRING)\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.issuerNameHash || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.issuerKeyHash || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$j);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertID.schema({\n            names: {\n                hashAlgorithm: HASH_ALGORITHM$1,\n                issuerNameHash: ISSUER_NAME_HASH,\n                issuerKeyHash: ISSUER_KEY_HASH,\n                serialNumber: SERIAL_NUMBER$1\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.hashAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.hashAlgorithm });\n        this.issuerNameHash = asn1.result.issuerNameHash;\n        this.issuerKeyHash = asn1.result.issuerKeyHash;\n        this.serialNumber = asn1.result.serialNumber;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.hashAlgorithm.toSchema(),\n                this.issuerNameHash,\n                this.issuerKeyHash,\n                this.serialNumber\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            hashAlgorithm: this.hashAlgorithm.toJSON(),\n            issuerNameHash: this.issuerNameHash.toJSON(),\n            issuerKeyHash: this.issuerKeyHash.toJSON(),\n            serialNumber: this.serialNumber.toJSON(),\n        };\n    }\n    isEqual(certificateID) {\n        if (this.hashAlgorithm.algorithmId !== certificateID.hashAlgorithm.algorithmId) {\n            return false;\n        }\n        if (!pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(this.issuerNameHash.valueBlock.valueHexView, certificateID.issuerNameHash.valueBlock.valueHexView)) {\n            return false;\n        }\n        if (!pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(this.issuerKeyHash.valueBlock.valueHexView, certificateID.issuerKeyHash.valueBlock.valueHexView)) {\n            return false;\n        }\n        if (!this.serialNumber.isEqual(certificateID.serialNumber)) {\n            return false;\n        }\n        return true;\n    }\n    async createForCertificate(certificate, parameters, crypto = getCrypto(true)) {\n        ParameterError.assert(parameters, HASH_ALGORITHM$1, \"issuerCertificate\");\n        const hashOID = crypto.getOIDByAlgorithm({ name: parameters.hashAlgorithm }, true, \"hashAlgorithm\");\n        this.hashAlgorithm = new AlgorithmIdentifier({\n            algorithmId: hashOID,\n            algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n        });\n        const issuerCertificate = parameters.issuerCertificate;\n        this.serialNumber = certificate.serialNumber;\n        const hashIssuerName = await crypto.digest({ name: parameters.hashAlgorithm }, issuerCertificate.subject.toSchema().toBER(false));\n        this.issuerNameHash = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: hashIssuerName });\n        const issuerKeyBuffer = issuerCertificate.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView;\n        const hashIssuerKey = await crypto.digest({ name: parameters.hashAlgorithm }, issuerKeyBuffer);\n        this.issuerKeyHash = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: hashIssuerKey });\n    }\n}\nCertID.CLASS_NAME = \"CertID\";\n\nconst CERT_ID = \"certID\";\nconst CERT_STATUS = \"certStatus\";\nconst THIS_UPDATE = \"thisUpdate\";\nconst NEXT_UPDATE = \"nextUpdate\";\nconst SINGLE_EXTENSIONS = \"singleExtensions\";\nconst CLEAR_PROPS$i = [\n    CERT_ID,\n    CERT_STATUS,\n    THIS_UPDATE,\n    NEXT_UPDATE,\n    SINGLE_EXTENSIONS,\n];\nclass SingleResponse extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.certID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERT_ID, SingleResponse.defaultValues(CERT_ID));\n        this.certStatus = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERT_STATUS, SingleResponse.defaultValues(CERT_STATUS));\n        this.thisUpdate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, THIS_UPDATE, SingleResponse.defaultValues(THIS_UPDATE));\n        if (NEXT_UPDATE in parameters) {\n            this.nextUpdate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NEXT_UPDATE, SingleResponse.defaultValues(NEXT_UPDATE));\n        }\n        if (SINGLE_EXTENSIONS in parameters) {\n            this.singleExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SINGLE_EXTENSIONS, SingleResponse.defaultValues(SINGLE_EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case CERT_ID:\n                return new CertID();\n            case CERT_STATUS:\n                return {};\n            case THIS_UPDATE:\n            case NEXT_UPDATE:\n                return new Date(0, 0, 0);\n            case SINGLE_EXTENSIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case CERT_ID:\n                return ((CertID.compareWithDefault(\"hashAlgorithm\", memberValue.hashAlgorithm)) &&\n                    (CertID.compareWithDefault(\"issuerNameHash\", memberValue.issuerNameHash)) &&\n                    (CertID.compareWithDefault(\"issuerKeyHash\", memberValue.issuerKeyHash)) &&\n                    (CertID.compareWithDefault(\"serialNumber\", memberValue.serialNumber)));\n            case CERT_STATUS:\n                return (Object.keys(memberValue).length === 0);\n            case THIS_UPDATE:\n            case NEXT_UPDATE:\n                return (memberValue === SingleResponse.defaultValues(memberName));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                CertID.schema(names.certID || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                            name: (names.certStatus || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 0\n                            },\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.certStatus || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 1\n                            },\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime(),\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    optional: true,\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 0\n                                    },\n                                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Enumerated()]\n                                })\n                            ]\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                            name: (names.certStatus || EMPTY_STRING),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 2\n                            },\n                            lenBlock: { length: 1 }\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.thisUpdate || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.nextUpdate || EMPTY_STRING) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [Extensions.schema(names.singleExtensions || {})]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$i);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SingleResponse.schema({\n            names: {\n                certID: {\n                    names: {\n                        blockName: CERT_ID\n                    }\n                },\n                certStatus: CERT_STATUS,\n                thisUpdate: THIS_UPDATE,\n                nextUpdate: NEXT_UPDATE,\n                singleExtensions: {\n                    names: {\n                        blockName: SINGLE_EXTENSIONS\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.certID = new CertID({ schema: asn1.result.certID });\n        this.certStatus = asn1.result.certStatus;\n        this.thisUpdate = asn1.result.thisUpdate.toDate();\n        if (NEXT_UPDATE in asn1.result)\n            this.nextUpdate = asn1.result.nextUpdate.toDate();\n        if (SINGLE_EXTENSIONS in asn1.result)\n            this.singleExtensions = Array.from(asn1.result.singleExtensions.valueBlock.value, element => new Extension({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.certID.toSchema());\n        outputArray.push(this.certStatus);\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.thisUpdate }));\n        if (this.nextUpdate) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.nextUpdate })]\n            }));\n        }\n        if (this.singleExtensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.singleExtensions, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            certID: this.certID.toJSON(),\n            certStatus: this.certStatus.toJSON(),\n            thisUpdate: this.thisUpdate\n        };\n        if (this.nextUpdate) {\n            res.nextUpdate = this.nextUpdate;\n        }\n        if (this.singleExtensions) {\n            res.singleExtensions = Array.from(this.singleExtensions, o => o.toJSON());\n        }\n        return res;\n    }\n}\nSingleResponse.CLASS_NAME = \"SingleResponse\";\n\nconst TBS$2 = \"tbs\";\nconst VERSION$7 = \"version\";\nconst RESPONDER_ID = \"responderID\";\nconst PRODUCED_AT = \"producedAt\";\nconst RESPONSES = \"responses\";\nconst RESPONSE_EXTENSIONS = \"responseExtensions\";\nconst RESPONSE_DATA = \"ResponseData\";\nconst RESPONSE_DATA_VERSION = `${RESPONSE_DATA}.${VERSION$7}`;\nconst RESPONSE_DATA_RESPONDER_ID = `${RESPONSE_DATA}.${RESPONDER_ID}`;\nconst RESPONSE_DATA_PRODUCED_AT = `${RESPONSE_DATA}.${PRODUCED_AT}`;\nconst RESPONSE_DATA_RESPONSES = `${RESPONSE_DATA}.${RESPONSES}`;\nconst RESPONSE_DATA_RESPONSE_EXTENSIONS = `${RESPONSE_DATA}.${RESPONSE_EXTENSIONS}`;\nconst CLEAR_PROPS$h = [\n    RESPONSE_DATA,\n    RESPONSE_DATA_VERSION,\n    RESPONSE_DATA_RESPONDER_ID,\n    RESPONSE_DATA_PRODUCED_AT,\n    RESPONSE_DATA_RESPONSES,\n    RESPONSE_DATA_RESPONSE_EXTENSIONS\n];\nclass ResponseData extends PkiObject {\n    get tbs() {\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.tbsView);\n    }\n    set tbs(value) {\n        this.tbsView = new Uint8Array(value);\n    }\n    constructor(parameters = {}) {\n        super();\n        this.tbsView = new Uint8Array(pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS$2, ResponseData.defaultValues(TBS$2)));\n        if (VERSION$7 in parameters) {\n            this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$7, ResponseData.defaultValues(VERSION$7));\n        }\n        this.responderID = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONDER_ID, ResponseData.defaultValues(RESPONDER_ID));\n        this.producedAt = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PRODUCED_AT, ResponseData.defaultValues(PRODUCED_AT));\n        this.responses = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSES, ResponseData.defaultValues(RESPONSES));\n        if (RESPONSE_EXTENSIONS in parameters) {\n            this.responseExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSE_EXTENSIONS, ResponseData.defaultValues(RESPONSE_EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$7:\n                return 0;\n            case TBS$2:\n                return EMPTY_BUFFER;\n            case RESPONDER_ID:\n                return {};\n            case PRODUCED_AT:\n                return new Date(0, 0, 0);\n            case RESPONSES:\n            case RESPONSE_EXTENSIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TBS$2:\n                return (memberValue.byteLength === 0);\n            case RESPONDER_ID:\n                return (Object.keys(memberValue).length === 0);\n            case PRODUCED_AT:\n                return (memberValue === ResponseData.defaultValues(memberName));\n            case RESPONSES:\n            case RESPONSE_EXTENSIONS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || RESPONSE_DATA),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || RESPONSE_DATA_VERSION) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.responderID || RESPONSE_DATA_RESPONDER_ID),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 1\n                            },\n                            value: [RelativeDistinguishedNames.schema(names.ResponseDataByName || {\n                                    names: {\n                                        blockName: \"ResponseData.byName\"\n                                    }\n                                })]\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                            name: (names.responderID || RESPONSE_DATA_RESPONDER_ID),\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: 2\n                            },\n                            value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.ResponseDataByKey || \"ResponseData.byKey\") })]\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.producedAt || RESPONSE_DATA_PRODUCED_AT) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: RESPONSE_DATA_RESPONSES,\n                            value: SingleResponse.schema(names.response || {})\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [Extensions.schema(names.extensions || {\n                            names: {\n                                blockName: RESPONSE_DATA_RESPONSE_EXTENSIONS\n                            }\n                        })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$h);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ResponseData.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsView = asn1.result.ResponseData.valueBeforeDecodeView;\n        if (RESPONSE_DATA_VERSION in asn1.result)\n            this.version = asn1.result[RESPONSE_DATA_VERSION].valueBlock.valueDec;\n        if (asn1.result[RESPONSE_DATA_RESPONDER_ID].idBlock.tagNumber === 1)\n            this.responderID = new RelativeDistinguishedNames({ schema: asn1.result[RESPONSE_DATA_RESPONDER_ID].valueBlock.value[0] });\n        else\n            this.responderID = asn1.result[RESPONSE_DATA_RESPONDER_ID].valueBlock.value[0];\n        this.producedAt = asn1.result[RESPONSE_DATA_PRODUCED_AT].toDate();\n        this.responses = Array.from(asn1.result[RESPONSE_DATA_RESPONSES], element => new SingleResponse({ schema: element }));\n        if (RESPONSE_DATA_RESPONSE_EXTENSIONS in asn1.result)\n            this.responseExtensions = Array.from(asn1.result[RESPONSE_DATA_RESPONSE_EXTENSIONS].valueBlock.value, element => new Extension({ schema: element }));\n    }\n    toSchema(encodeFlag = false) {\n        let tbsSchema;\n        if (encodeFlag === false) {\n            if (!this.tbsView.byteLength) {\n                return ResponseData.schema();\n            }\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.tbsView);\n            AsnError.assert(asn1, \"TBS Response Data\");\n            tbsSchema = asn1.result;\n        }\n        else {\n            const outputArray = [];\n            if (VERSION$7 in this) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version })]\n                }));\n            }\n            if (this.responderID instanceof RelativeDistinguishedNames) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [this.responderID.toSchema()]\n                }));\n            }\n            else {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: [this.responderID]\n                }));\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.producedAt }));\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.responses, o => o.toSchema())\n            }));\n            if (this.responseExtensions) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                            value: Array.from(this.responseExtensions, o => o.toSchema())\n                        })]\n                }));\n            }\n            tbsSchema = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: outputArray\n            });\n        }\n        return tbsSchema;\n    }\n    toJSON() {\n        const res = {};\n        if (VERSION$7 in this) {\n            res.version = this.version;\n        }\n        if (this.responderID) {\n            res.responderID = this.responderID;\n        }\n        if (this.producedAt) {\n            res.producedAt = this.producedAt;\n        }\n        if (this.responses) {\n            res.responses = Array.from(this.responses, o => o.toJSON());\n        }\n        if (this.responseExtensions) {\n            res.responseExtensions = Array.from(this.responseExtensions, o => o.toJSON());\n        }\n        return res;\n    }\n}\nResponseData.CLASS_NAME = \"ResponseData\";\n\nconst TRUSTED_CERTS = \"trustedCerts\";\nconst CERTS$2 = \"certs\";\nconst CRLS$1 = \"crls\";\nconst OCSPS$1 = \"ocsps\";\nconst CHECK_DATE = \"checkDate\";\nconst FIND_ORIGIN = \"findOrigin\";\nconst FIND_ISSUER = \"findIssuer\";\nvar ChainValidationCode;\n(function (ChainValidationCode) {\n    ChainValidationCode[ChainValidationCode[\"unknown\"] = -1] = \"unknown\";\n    ChainValidationCode[ChainValidationCode[\"success\"] = 0] = \"success\";\n    ChainValidationCode[ChainValidationCode[\"noRevocation\"] = 11] = \"noRevocation\";\n    ChainValidationCode[ChainValidationCode[\"noPath\"] = 60] = \"noPath\";\n    ChainValidationCode[ChainValidationCode[\"noValidPath\"] = 97] = \"noValidPath\";\n})(ChainValidationCode || (ChainValidationCode = {}));\nclass ChainValidationError extends Error {\n    constructor(code, message) {\n        super(message);\n        this.name = ChainValidationError.NAME;\n        this.code = code;\n        this.message = message;\n    }\n}\nChainValidationError.NAME = \"ChainValidationError\";\nfunction isTrusted(cert, trustedList) {\n    for (let i = 0; i < trustedList.length; i++) {\n        if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(cert.tbsView, trustedList[i].tbsView)) {\n            return true;\n        }\n    }\n    return false;\n}\nclass CertificateChainValidationEngine {\n    constructor(parameters = {}) {\n        this.trustedCerts = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TRUSTED_CERTS, this.defaultValues(TRUSTED_CERTS));\n        this.certs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTS$2, this.defaultValues(CERTS$2));\n        this.crls = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRLS$1, this.defaultValues(CRLS$1));\n        this.ocsps = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OCSPS$1, this.defaultValues(OCSPS$1));\n        this.checkDate = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CHECK_DATE, this.defaultValues(CHECK_DATE));\n        this.findOrigin = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, FIND_ORIGIN, this.defaultValues(FIND_ORIGIN));\n        this.findIssuer = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, FIND_ISSUER, this.defaultValues(FIND_ISSUER));\n    }\n    static defaultFindOrigin(certificate, validationEngine) {\n        if (certificate.tbsView.byteLength === 0) {\n            certificate.tbsView = new Uint8Array(certificate.encodeTBS().toBER());\n        }\n        for (const localCert of validationEngine.certs) {\n            if (localCert.tbsView.byteLength === 0) {\n                localCert.tbsView = new Uint8Array(localCert.encodeTBS().toBER());\n            }\n            if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(certificate.tbsView, localCert.tbsView))\n                return \"Intermediate Certificates\";\n        }\n        for (const trustedCert of validationEngine.trustedCerts) {\n            if (trustedCert.tbsView.byteLength === 0)\n                trustedCert.tbsView = new Uint8Array(trustedCert.encodeTBS().toBER());\n            if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(certificate.tbsView, trustedCert.tbsView))\n                return \"Trusted Certificates\";\n        }\n        return \"Unknown\";\n    }\n    async defaultFindIssuer(certificate, validationEngine, crypto = getCrypto(true)) {\n        const result = [];\n        let keyIdentifier = null;\n        let authorityCertIssuer = null;\n        let authorityCertSerialNumber = null;\n        if (certificate.subject.isEqual(certificate.issuer)) {\n            try {\n                const verificationResult = await certificate.verify(undefined, crypto);\n                if (verificationResult) {\n                    return [certificate];\n                }\n            }\n            catch (ex) {\n            }\n        }\n        if (certificate.extensions) {\n            for (const extension of certificate.extensions) {\n                if (extension.extnID === id_AuthorityKeyIdentifier && extension.parsedValue instanceof AuthorityKeyIdentifier) {\n                    if (extension.parsedValue.keyIdentifier) {\n                        keyIdentifier = extension.parsedValue.keyIdentifier;\n                    }\n                    else {\n                        if (extension.parsedValue.authorityCertIssuer) {\n                            authorityCertIssuer = extension.parsedValue.authorityCertIssuer;\n                        }\n                        if (extension.parsedValue.authorityCertSerialNumber) {\n                            authorityCertSerialNumber = extension.parsedValue.authorityCertSerialNumber;\n                        }\n                    }\n                    break;\n                }\n            }\n        }\n        function checkCertificate(possibleIssuer) {\n            if (keyIdentifier !== null) {\n                if (possibleIssuer.extensions) {\n                    let extensionFound = false;\n                    for (const extension of possibleIssuer.extensions) {\n                        if (extension.extnID === id_SubjectKeyIdentifier && extension.parsedValue) {\n                            extensionFound = true;\n                            if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(extension.parsedValue.valueBlock.valueHex, keyIdentifier.valueBlock.valueHexView)) {\n                                result.push(possibleIssuer);\n                            }\n                            break;\n                        }\n                    }\n                    if (extensionFound) {\n                        return;\n                    }\n                }\n            }\n            let authorityCertSerialNumberEqual = false;\n            if (authorityCertSerialNumber !== null)\n                authorityCertSerialNumberEqual = possibleIssuer.serialNumber.isEqual(authorityCertSerialNumber);\n            if (authorityCertIssuer !== null) {\n                if (possibleIssuer.subject.isEqual(authorityCertIssuer)) {\n                    if (authorityCertSerialNumberEqual)\n                        result.push(possibleIssuer);\n                }\n            }\n            else {\n                if (certificate.issuer.isEqual(possibleIssuer.subject))\n                    result.push(possibleIssuer);\n            }\n        }\n        for (const trustedCert of validationEngine.trustedCerts) {\n            checkCertificate(trustedCert);\n        }\n        for (const intermediateCert of validationEngine.certs) {\n            checkCertificate(intermediateCert);\n        }\n        for (let i = result.length - 1; i >= 0; i--) {\n            try {\n                const verificationResult = await certificate.verify(result[i], crypto);\n                if (verificationResult === false)\n                    result.splice(i, 1);\n            }\n            catch (ex) {\n                result.splice(i, 1);\n            }\n        }\n        return result;\n    }\n    defaultValues(memberName) {\n        switch (memberName) {\n            case TRUSTED_CERTS:\n                return [];\n            case CERTS$2:\n                return [];\n            case CRLS$1:\n                return [];\n            case OCSPS$1:\n                return [];\n            case CHECK_DATE:\n                return new Date();\n            case FIND_ORIGIN:\n                return CertificateChainValidationEngine.defaultFindOrigin;\n            case FIND_ISSUER:\n                return this.defaultFindIssuer;\n            default:\n                throw new Error(`Invalid member name for CertificateChainValidationEngine class: ${memberName}`);\n        }\n    }\n    async sort(passedWhenNotRevValues = false, crypto = getCrypto(true)) {\n        const localCerts = [];\n        const buildPath = async (certificate, crypto) => {\n            const result = [];\n            function checkUnique(array) {\n                let unique = true;\n                for (let i = 0; i < array.length; i++) {\n                    for (let j = 0; j < array.length; j++) {\n                        if (j === i)\n                            continue;\n                        if (array[i] === array[j]) {\n                            unique = false;\n                            break;\n                        }\n                    }\n                    if (!unique)\n                        break;\n                }\n                return unique;\n            }\n            if (isTrusted(certificate, this.trustedCerts)) {\n                return [[certificate]];\n            }\n            const findIssuerResult = await this.findIssuer(certificate, this, crypto);\n            if (findIssuerResult.length === 0) {\n                throw new Error(\"No valid certificate paths found\");\n            }\n            for (let i = 0; i < findIssuerResult.length; i++) {\n                if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(findIssuerResult[i].tbsView, certificate.tbsView)) {\n                    result.push([findIssuerResult[i]]);\n                    continue;\n                }\n                const buildPathResult = await buildPath(findIssuerResult[i], crypto);\n                for (let j = 0; j < buildPathResult.length; j++) {\n                    const copy = buildPathResult[j].slice();\n                    copy.splice(0, 0, findIssuerResult[i]);\n                    if (checkUnique(copy))\n                        result.push(copy);\n                    else\n                        result.push(buildPathResult[j]);\n                }\n            }\n            return result;\n        };\n        const findCRL = async (certificate) => {\n            const issuerCertificates = [];\n            const crls = [];\n            const crlsAndCertificates = [];\n            issuerCertificates.push(...localCerts.filter(element => certificate.issuer.isEqual(element.subject)));\n            if (issuerCertificates.length === 0) {\n                return {\n                    status: 1,\n                    statusMessage: \"No certificate's issuers\"\n                };\n            }\n            crls.push(...this.crls.filter(o => o.issuer.isEqual(certificate.issuer)));\n            if (crls.length === 0) {\n                return {\n                    status: 2,\n                    statusMessage: \"No CRLs for specific certificate issuer\"\n                };\n            }\n            for (let i = 0; i < crls.length; i++) {\n                const crl = crls[i];\n                if (crl.nextUpdate && crl.nextUpdate.value < this.checkDate) {\n                    continue;\n                }\n                for (let j = 0; j < issuerCertificates.length; j++) {\n                    try {\n                        const result = await crls[i].verify({ issuerCertificate: issuerCertificates[j] }, crypto);\n                        if (result) {\n                            crlsAndCertificates.push({\n                                crl: crls[i],\n                                certificate: issuerCertificates[j]\n                            });\n                            break;\n                        }\n                    }\n                    catch (ex) {\n                    }\n                }\n            }\n            if (crlsAndCertificates.length) {\n                return {\n                    status: 0,\n                    statusMessage: EMPTY_STRING,\n                    result: crlsAndCertificates\n                };\n            }\n            return {\n                status: 3,\n                statusMessage: \"No valid CRLs found\"\n            };\n        };\n        const findOCSP = async (certificate, issuerCertificate) => {\n            const hashAlgorithm = crypto.getAlgorithmByOID(certificate.signatureAlgorithm.algorithmId);\n            if (!hashAlgorithm.name) {\n                return 1;\n            }\n            if (!hashAlgorithm.hash) {\n                return 1;\n            }\n            for (let i = 0; i < this.ocsps.length; i++) {\n                const ocsp = this.ocsps[i];\n                const result = await ocsp.getCertificateStatus(certificate, issuerCertificate, crypto);\n                if (result.isForCertificate) {\n                    if (result.status === 0)\n                        return 0;\n                    return 1;\n                }\n            }\n            return 2;\n        };\n        async function checkForCA(certificate, needToCheckCRL = false) {\n            let isCA = false;\n            let mustBeCA = false;\n            let keyUsagePresent = false;\n            let cRLSign = false;\n            if (certificate.extensions) {\n                for (let j = 0; j < certificate.extensions.length; j++) {\n                    const extension = certificate.extensions[j];\n                    if (extension.critical && !extension.parsedValue) {\n                        return {\n                            result: false,\n                            resultCode: 6,\n                            resultMessage: `Unable to parse critical certificate extension: ${extension.extnID}`\n                        };\n                    }\n                    if (extension.extnID === id_KeyUsage) {\n                        keyUsagePresent = true;\n                        const view = new Uint8Array(extension.parsedValue.valueBlock.valueHex);\n                        if ((view[0] & 0x04) === 0x04)\n                            mustBeCA = true;\n                        if ((view[0] & 0x02) === 0x02)\n                            cRLSign = true;\n                    }\n                    if (extension.extnID === id_BasicConstraints) {\n                        if (\"cA\" in extension.parsedValue) {\n                            if (extension.parsedValue.cA === true)\n                                isCA = true;\n                        }\n                    }\n                }\n                if ((mustBeCA === true) && (isCA === false)) {\n                    return {\n                        result: false,\n                        resultCode: 3,\n                        resultMessage: \"Unable to build certificate chain - using \\\"keyCertSign\\\" flag set without BasicConstraints\"\n                    };\n                }\n                if ((keyUsagePresent === true) && (isCA === true) && (mustBeCA === false)) {\n                    return {\n                        result: false,\n                        resultCode: 4,\n                        resultMessage: \"Unable to build certificate chain - \\\"keyCertSign\\\" flag was not set\"\n                    };\n                }\n                if ((isCA === true) && (keyUsagePresent === true) && ((needToCheckCRL) && (cRLSign === false))) {\n                    return {\n                        result: false,\n                        resultCode: 5,\n                        resultMessage: \"Unable to build certificate chain - intermediate certificate must have \\\"cRLSign\\\" key usage flag\"\n                    };\n                }\n            }\n            if (isCA === false) {\n                return {\n                    result: false,\n                    resultCode: 7,\n                    resultMessage: \"Unable to build certificate chain - more than one possible end-user certificate\"\n                };\n            }\n            return {\n                result: true,\n                resultCode: 0,\n                resultMessage: EMPTY_STRING\n            };\n        }\n        const basicCheck = async (path, checkDate) => {\n            for (let i = 0; i < path.length; i++) {\n                if ((path[i].notBefore.value > checkDate) ||\n                    (path[i].notAfter.value < checkDate)) {\n                    return {\n                        result: false,\n                        resultCode: 8,\n                        resultMessage: \"The certificate is either not yet valid or expired\"\n                    };\n                }\n            }\n            if (path.length < 2) {\n                return {\n                    result: false,\n                    resultCode: 9,\n                    resultMessage: \"Too short certificate path\"\n                };\n            }\n            for (let i = (path.length - 2); i >= 0; i--) {\n                if (path[i].issuer.isEqual(path[i].subject) === false) {\n                    if (path[i].issuer.isEqual(path[i + 1].subject) === false) {\n                        return {\n                            result: false,\n                            resultCode: 10,\n                            resultMessage: \"Incorrect name chaining\"\n                        };\n                    }\n                }\n            }\n            if ((this.crls.length !== 0) || (this.ocsps.length !== 0)) {\n                for (let i = 0; i < (path.length - 1); i++) {\n                    let ocspResult = 2;\n                    let crlResult = {\n                        status: 0,\n                        statusMessage: EMPTY_STRING\n                    };\n                    if (this.ocsps.length !== 0) {\n                        ocspResult = await findOCSP(path[i], path[i + 1]);\n                        switch (ocspResult) {\n                            case 0:\n                                continue;\n                            case 1:\n                                return {\n                                    result: false,\n                                    resultCode: 12,\n                                    resultMessage: \"One of certificates was revoked via OCSP response\"\n                                };\n                        }\n                    }\n                    if (this.crls.length !== 0) {\n                        crlResult = await findCRL(path[i]);\n                        if (crlResult.status === 0 && crlResult.result) {\n                            for (let j = 0; j < crlResult.result.length; j++) {\n                                const isCertificateRevoked = crlResult.result[j].crl.isCertificateRevoked(path[i]);\n                                if (isCertificateRevoked) {\n                                    return {\n                                        result: false,\n                                        resultCode: 12,\n                                        resultMessage: \"One of certificates had been revoked\"\n                                    };\n                                }\n                                const isCertificateCA = await checkForCA(crlResult.result[j].certificate, true);\n                                if (isCertificateCA.result === false) {\n                                    return {\n                                        result: false,\n                                        resultCode: 13,\n                                        resultMessage: \"CRL issuer certificate is not a CA certificate or does not have crlSign flag\"\n                                    };\n                                }\n                            }\n                        }\n                        else {\n                            if (passedWhenNotRevValues === false) {\n                                throw new ChainValidationError(ChainValidationCode.noRevocation, `No revocation values found for one of certificates: ${crlResult.statusMessage}`);\n                            }\n                        }\n                    }\n                    else {\n                        if (ocspResult === 2) {\n                            return {\n                                result: false,\n                                resultCode: 11,\n                                resultMessage: \"No revocation values found for one of certificates\"\n                            };\n                        }\n                    }\n                    if ((ocspResult === 2) && (crlResult.status === 2) && passedWhenNotRevValues) {\n                        const issuerCertificate = path[i + 1];\n                        let extensionFound = false;\n                        if (issuerCertificate.extensions) {\n                            for (const extension of issuerCertificate.extensions) {\n                                switch (extension.extnID) {\n                                    case id_CRLDistributionPoints:\n                                    case id_FreshestCRL:\n                                    case id_AuthorityInfoAccess:\n                                        extensionFound = true;\n                                        break;\n                                }\n                            }\n                        }\n                        if (extensionFound) {\n                            throw new ChainValidationError(ChainValidationCode.noRevocation, `No revocation values found for one of certificates: ${crlResult.statusMessage}`);\n                        }\n                    }\n                }\n            }\n            for (const [i, cert] of path.entries()) {\n                if (!i) {\n                    continue;\n                }\n                const result = await checkForCA(cert);\n                if (!result.result) {\n                    return {\n                        result: false,\n                        resultCode: 14,\n                        resultMessage: \"One of intermediate certificates is not a CA certificate\"\n                    };\n                }\n            }\n            return {\n                result: true\n            };\n        };\n        localCerts.push(...this.trustedCerts);\n        localCerts.push(...this.certs);\n        for (let i = 0; i < localCerts.length; i++) {\n            for (let j = 0; j < localCerts.length; j++) {\n                if (i === j)\n                    continue;\n                if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(localCerts[i].tbsView, localCerts[j].tbsView)) {\n                    localCerts.splice(j, 1);\n                    i = 0;\n                    break;\n                }\n            }\n        }\n        const leafCert = localCerts[localCerts.length - 1];\n        let result;\n        const certificatePath = [leafCert];\n        result = await buildPath(leafCert, crypto);\n        if (result.length === 0) {\n            throw new ChainValidationError(ChainValidationCode.noPath, \"Unable to find certificate path\");\n        }\n        for (let i = result.length - 1; i >= 0; i--) {\n            let found = false;\n            for (let j = 0; j < (result[i]).length; j++) {\n                const certificate = (result[i])[j];\n                for (let k = 0; k < this.trustedCerts.length; k++) {\n                    if (pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(certificate.tbsView, this.trustedCerts[k].tbsView)) {\n                        found = true;\n                        break;\n                    }\n                }\n                if (found)\n                    break;\n            }\n            if (!found) {\n                result.splice(i, 1);\n            }\n        }\n        if (result.length === 0) {\n            throw new ChainValidationError(ChainValidationCode.noValidPath, \"No valid certificate paths found\");\n        }\n        let shortestLength = result[0].length;\n        let shortestIndex = 0;\n        for (let i = 0; i < result.length; i++) {\n            if (result[i].length < shortestLength) {\n                shortestLength = result[i].length;\n                shortestIndex = i;\n            }\n        }\n        for (let i = 0; i < result[shortestIndex].length; i++)\n            certificatePath.push((result[shortestIndex])[i]);\n        result = await basicCheck(certificatePath, this.checkDate);\n        if (result.result === false)\n            throw result;\n        return certificatePath;\n    }\n    async verify(parameters = {}, crypto = getCrypto(true)) {\n        function compareDNSName(name, constraint) {\n            const namePrepared = stringPrep(name);\n            const constraintPrepared = stringPrep(constraint);\n            const nameSplitted = namePrepared.split(\".\");\n            const constraintSplitted = constraintPrepared.split(\".\");\n            const nameLen = nameSplitted.length;\n            const constrLen = constraintSplitted.length;\n            if ((nameLen === 0) || (constrLen === 0) || (nameLen < constrLen)) {\n                return false;\n            }\n            for (let i = 0; i < nameLen; i++) {\n                if (nameSplitted[i].length === 0) {\n                    return false;\n                }\n            }\n            for (let i = 0; i < constrLen; i++) {\n                if (constraintSplitted[i].length === 0) {\n                    if (i === 0) {\n                        if (constrLen === 1) {\n                            return false;\n                        }\n                        continue;\n                    }\n                    return false;\n                }\n            }\n            for (let i = 0; i < constrLen; i++) {\n                if (constraintSplitted[constrLen - 1 - i].length === 0) {\n                    continue;\n                }\n                if (nameSplitted[nameLen - 1 - i].localeCompare(constraintSplitted[constrLen - 1 - i]) !== 0) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        function compareRFC822Name(name, constraint) {\n            const namePrepared = stringPrep(name);\n            const constraintPrepared = stringPrep(constraint);\n            const nameSplitted = namePrepared.split(\"@\");\n            const constraintSplitted = constraintPrepared.split(\"@\");\n            if ((nameSplitted.length === 0) || (constraintSplitted.length === 0) || (nameSplitted.length < constraintSplitted.length))\n                return false;\n            if (constraintSplitted.length === 1) {\n                const result = compareDNSName(nameSplitted[1], constraintSplitted[0]);\n                if (result) {\n                    const ns = nameSplitted[1].split(\".\");\n                    const cs = constraintSplitted[0].split(\".\");\n                    if (cs[0].length === 0)\n                        return true;\n                    return ns.length === cs.length;\n                }\n                return false;\n            }\n            return (namePrepared.localeCompare(constraintPrepared) === 0);\n        }\n        function compareUniformResourceIdentifier(name, constraint) {\n            let namePrepared = stringPrep(name);\n            const constraintPrepared = stringPrep(constraint);\n            const ns = namePrepared.split(\"/\");\n            const cs = constraintPrepared.split(\"/\");\n            if (cs.length > 1)\n                return false;\n            if (ns.length > 1) {\n                for (let i = 0; i < ns.length; i++) {\n                    if ((ns[i].length > 0) && (ns[i].charAt(ns[i].length - 1) !== \":\")) {\n                        const nsPort = ns[i].split(\":\");\n                        namePrepared = nsPort[0];\n                        break;\n                    }\n                }\n            }\n            const result = compareDNSName(namePrepared, constraintPrepared);\n            if (result) {\n                const nameSplitted = namePrepared.split(\".\");\n                const constraintSplitted = constraintPrepared.split(\".\");\n                if (constraintSplitted[0].length === 0)\n                    return true;\n                return nameSplitted.length === constraintSplitted.length;\n            }\n            return false;\n        }\n        function compareIPAddress(name, constraint) {\n            const nameView = name.valueBlock.valueHexView;\n            const constraintView = constraint.valueBlock.valueHexView;\n            if ((nameView.length === 4) && (constraintView.length === 8)) {\n                for (let i = 0; i < 4; i++) {\n                    if ((nameView[i] ^ constraintView[i]) & constraintView[i + 4])\n                        return false;\n                }\n                return true;\n            }\n            if ((nameView.length === 16) && (constraintView.length === 32)) {\n                for (let i = 0; i < 16; i++) {\n                    if ((nameView[i] ^ constraintView[i]) & constraintView[i + 16])\n                        return false;\n                }\n                return true;\n            }\n            return false;\n        }\n        function compareDirectoryName(name, constraint) {\n            if ((name.typesAndValues.length === 0) || (constraint.typesAndValues.length === 0))\n                return true;\n            if (name.typesAndValues.length < constraint.typesAndValues.length)\n                return false;\n            let result = true;\n            let nameStart = 0;\n            for (let i = 0; i < constraint.typesAndValues.length; i++) {\n                let localResult = false;\n                for (let j = nameStart; j < name.typesAndValues.length; j++) {\n                    localResult = name.typesAndValues[j].isEqual(constraint.typesAndValues[i]);\n                    if (name.typesAndValues[j].type === constraint.typesAndValues[i].type)\n                        result = result && localResult;\n                    if (localResult === true) {\n                        if ((nameStart === 0) || (nameStart === j)) {\n                            nameStart = j + 1;\n                            break;\n                        }\n                        else\n                            return false;\n                    }\n                }\n                if (localResult === false)\n                    return false;\n            }\n            return (nameStart === 0) ? false : result;\n        }\n        try {\n            if (this.certs.length === 0)\n                throw new Error(\"Empty certificate array\");\n            const passedWhenNotRevValues = parameters.passedWhenNotRevValues || false;\n            const initialPolicySet = parameters.initialPolicySet || [id_AnyPolicy];\n            const initialExplicitPolicy = parameters.initialExplicitPolicy || false;\n            const initialPolicyMappingInhibit = parameters.initialPolicyMappingInhibit || false;\n            const initialInhibitPolicy = parameters.initialInhibitPolicy || false;\n            const initialPermittedSubtreesSet = parameters.initialPermittedSubtreesSet || [];\n            const initialExcludedSubtreesSet = parameters.initialExcludedSubtreesSet || [];\n            const initialRequiredNameForms = parameters.initialRequiredNameForms || [];\n            let explicitPolicyIndicator = initialExplicitPolicy;\n            let policyMappingInhibitIndicator = initialPolicyMappingInhibit;\n            let inhibitAnyPolicyIndicator = initialInhibitPolicy;\n            const pendingConstraints = [\n                false,\n                false,\n                false,\n            ];\n            let explicitPolicyPending = 0;\n            let policyMappingInhibitPending = 0;\n            let inhibitAnyPolicyPending = 0;\n            let permittedSubtrees = initialPermittedSubtreesSet;\n            let excludedSubtrees = initialExcludedSubtreesSet;\n            const requiredNameForms = initialRequiredNameForms;\n            let pathDepth = 1;\n            this.certs = await this.sort(passedWhenNotRevValues, crypto);\n            const allPolicies = [];\n            allPolicies.push(id_AnyPolicy);\n            const policiesAndCerts = [];\n            const anyPolicyArray = new Array(this.certs.length - 1);\n            for (let ii = 0; ii < (this.certs.length - 1); ii++)\n                anyPolicyArray[ii] = true;\n            policiesAndCerts.push(anyPolicyArray);\n            const policyMappings = new Array(this.certs.length - 1);\n            const certPolicies = new Array(this.certs.length - 1);\n            let explicitPolicyStart = (explicitPolicyIndicator) ? (this.certs.length - 1) : (-1);\n            for (let i = (this.certs.length - 2); i >= 0; i--, pathDepth++) {\n                const cert = this.certs[i];\n                if (cert.extensions) {\n                    for (let j = 0; j < cert.extensions.length; j++) {\n                        const extension = cert.extensions[j];\n                        if (extension.extnID === id_CertificatePolicies) {\n                            certPolicies[i] = extension.parsedValue;\n                            for (let s = 0; s < allPolicies.length; s++) {\n                                if (allPolicies[s] === id_AnyPolicy) {\n                                    delete (policiesAndCerts[s])[i];\n                                    break;\n                                }\n                            }\n                            for (let k = 0; k < extension.parsedValue.certificatePolicies.length; k++) {\n                                let policyIndex = (-1);\n                                const policyId = extension.parsedValue.certificatePolicies[k].policyIdentifier;\n                                for (let s = 0; s < allPolicies.length; s++) {\n                                    if (policyId === allPolicies[s]) {\n                                        policyIndex = s;\n                                        break;\n                                    }\n                                }\n                                if (policyIndex === (-1)) {\n                                    allPolicies.push(policyId);\n                                    const certArray = new Array(this.certs.length - 1);\n                                    certArray[i] = true;\n                                    policiesAndCerts.push(certArray);\n                                }\n                                else\n                                    (policiesAndCerts[policyIndex])[i] = true;\n                            }\n                        }\n                        if (extension.extnID === id_PolicyMappings) {\n                            if (policyMappingInhibitIndicator) {\n                                return {\n                                    result: false,\n                                    resultCode: 98,\n                                    resultMessage: \"Policy mapping prohibited\"\n                                };\n                            }\n                            policyMappings[i] = extension.parsedValue;\n                        }\n                        if (extension.extnID === id_PolicyConstraints) {\n                            if (explicitPolicyIndicator === false) {\n                                if (extension.parsedValue.requireExplicitPolicy === 0) {\n                                    explicitPolicyIndicator = true;\n                                    explicitPolicyStart = i;\n                                }\n                                else {\n                                    if (pendingConstraints[0] === false) {\n                                        pendingConstraints[0] = true;\n                                        explicitPolicyPending = extension.parsedValue.requireExplicitPolicy;\n                                    }\n                                    else\n                                        explicitPolicyPending = (explicitPolicyPending > extension.parsedValue.requireExplicitPolicy) ? extension.parsedValue.requireExplicitPolicy : explicitPolicyPending;\n                                }\n                                if (extension.parsedValue.inhibitPolicyMapping === 0)\n                                    policyMappingInhibitIndicator = true;\n                                else {\n                                    if (pendingConstraints[1] === false) {\n                                        pendingConstraints[1] = true;\n                                        policyMappingInhibitPending = extension.parsedValue.inhibitPolicyMapping + 1;\n                                    }\n                                    else\n                                        policyMappingInhibitPending = (policyMappingInhibitPending > (extension.parsedValue.inhibitPolicyMapping + 1)) ? (extension.parsedValue.inhibitPolicyMapping + 1) : policyMappingInhibitPending;\n                                }\n                            }\n                        }\n                        if (extension.extnID === id_InhibitAnyPolicy) {\n                            if (inhibitAnyPolicyIndicator === false) {\n                                if (extension.parsedValue.valueBlock.valueDec === 0)\n                                    inhibitAnyPolicyIndicator = true;\n                                else {\n                                    if (pendingConstraints[2] === false) {\n                                        pendingConstraints[2] = true;\n                                        inhibitAnyPolicyPending = extension.parsedValue.valueBlock.valueDec;\n                                    }\n                                    else\n                                        inhibitAnyPolicyPending = (inhibitAnyPolicyPending > extension.parsedValue.valueBlock.valueDec) ? extension.parsedValue.valueBlock.valueDec : inhibitAnyPolicyPending;\n                                }\n                            }\n                        }\n                    }\n                    if (inhibitAnyPolicyIndicator === true) {\n                        let policyIndex = (-1);\n                        for (let searchAnyPolicy = 0; searchAnyPolicy < allPolicies.length; searchAnyPolicy++) {\n                            if (allPolicies[searchAnyPolicy] === id_AnyPolicy) {\n                                policyIndex = searchAnyPolicy;\n                                break;\n                            }\n                        }\n                        if (policyIndex !== (-1))\n                            delete (policiesAndCerts[0])[i];\n                    }\n                    if (explicitPolicyIndicator === false) {\n                        if (pendingConstraints[0] === true) {\n                            explicitPolicyPending--;\n                            if (explicitPolicyPending === 0) {\n                                explicitPolicyIndicator = true;\n                                explicitPolicyStart = i;\n                                pendingConstraints[0] = false;\n                            }\n                        }\n                    }\n                    if (policyMappingInhibitIndicator === false) {\n                        if (pendingConstraints[1] === true) {\n                            policyMappingInhibitPending--;\n                            if (policyMappingInhibitPending === 0) {\n                                policyMappingInhibitIndicator = true;\n                                pendingConstraints[1] = false;\n                            }\n                        }\n                    }\n                    if (inhibitAnyPolicyIndicator === false) {\n                        if (pendingConstraints[2] === true) {\n                            inhibitAnyPolicyPending--;\n                            if (inhibitAnyPolicyPending === 0) {\n                                inhibitAnyPolicyIndicator = true;\n                                pendingConstraints[2] = false;\n                            }\n                        }\n                    }\n                }\n            }\n            for (let i = 0; i < (this.certs.length - 1); i++) {\n                if ((i < (this.certs.length - 2)) && (typeof policyMappings[i + 1] !== \"undefined\")) {\n                    for (let k = 0; k < policyMappings[i + 1].mappings.length; k++) {\n                        if ((policyMappings[i + 1].mappings[k].issuerDomainPolicy === id_AnyPolicy) || (policyMappings[i + 1].mappings[k].subjectDomainPolicy === id_AnyPolicy)) {\n                            return {\n                                result: false,\n                                resultCode: 99,\n                                resultMessage: \"The \\\"anyPolicy\\\" should not be a part of policy mapping scheme\"\n                            };\n                        }\n                        let issuerDomainPolicyIndex = (-1);\n                        let subjectDomainPolicyIndex = (-1);\n                        for (let n = 0; n < allPolicies.length; n++) {\n                            if (allPolicies[n] === policyMappings[i + 1].mappings[k].issuerDomainPolicy)\n                                issuerDomainPolicyIndex = n;\n                            if (allPolicies[n] === policyMappings[i + 1].mappings[k].subjectDomainPolicy)\n                                subjectDomainPolicyIndex = n;\n                        }\n                        if (typeof (policiesAndCerts[issuerDomainPolicyIndex])[i] !== \"undefined\")\n                            delete (policiesAndCerts[issuerDomainPolicyIndex])[i];\n                        for (let j = 0; j < certPolicies[i].certificatePolicies.length; j++) {\n                            if (policyMappings[i + 1].mappings[k].subjectDomainPolicy === certPolicies[i].certificatePolicies[j].policyIdentifier) {\n                                if ((issuerDomainPolicyIndex !== (-1)) && (subjectDomainPolicyIndex !== (-1))) {\n                                    for (let m = 0; m <= i; m++) {\n                                        if (typeof (policiesAndCerts[subjectDomainPolicyIndex])[m] !== \"undefined\") {\n                                            (policiesAndCerts[issuerDomainPolicyIndex])[m] = true;\n                                            delete (policiesAndCerts[subjectDomainPolicyIndex])[m];\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            for (let i = 0; i < allPolicies.length; i++) {\n                if (allPolicies[i] === id_AnyPolicy) {\n                    for (let j = 0; j < explicitPolicyStart; j++)\n                        delete (policiesAndCerts[i])[j];\n                }\n            }\n            const authConstrPolicies = [];\n            for (let i = 0; i < policiesAndCerts.length; i++) {\n                let found = true;\n                for (let j = 0; j < (this.certs.length - 1); j++) {\n                    let anyPolicyFound = false;\n                    if ((j < explicitPolicyStart) && (allPolicies[i] === id_AnyPolicy) && (allPolicies.length > 1)) {\n                        found = false;\n                        break;\n                    }\n                    if (typeof (policiesAndCerts[i])[j] === \"undefined\") {\n                        if (j >= explicitPolicyStart) {\n                            for (let k = 0; k < allPolicies.length; k++) {\n                                if (allPolicies[k] === id_AnyPolicy) {\n                                    if ((policiesAndCerts[k])[j] === true)\n                                        anyPolicyFound = true;\n                                    break;\n                                }\n                            }\n                        }\n                        if (!anyPolicyFound) {\n                            found = false;\n                            break;\n                        }\n                    }\n                }\n                if (found === true)\n                    authConstrPolicies.push(allPolicies[i]);\n            }\n            let userConstrPolicies = [];\n            if ((initialPolicySet.length === 1) && (initialPolicySet[0] === id_AnyPolicy) && (explicitPolicyIndicator === false))\n                userConstrPolicies = initialPolicySet;\n            else {\n                if ((authConstrPolicies.length === 1) && (authConstrPolicies[0] === id_AnyPolicy))\n                    userConstrPolicies = initialPolicySet;\n                else {\n                    for (let i = 0; i < authConstrPolicies.length; i++) {\n                        for (let j = 0; j < initialPolicySet.length; j++) {\n                            if ((initialPolicySet[j] === authConstrPolicies[i]) || (initialPolicySet[j] === id_AnyPolicy)) {\n                                userConstrPolicies.push(authConstrPolicies[i]);\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            const policyResult = {\n                result: (userConstrPolicies.length > 0),\n                resultCode: 0,\n                resultMessage: (userConstrPolicies.length > 0) ? EMPTY_STRING : \"Zero \\\"userConstrPolicies\\\" array, no intersections with \\\"authConstrPolicies\\\"\",\n                authConstrPolicies,\n                userConstrPolicies,\n                explicitPolicyIndicator,\n                policyMappings,\n                certificatePath: this.certs\n            };\n            if (userConstrPolicies.length === 0)\n                return policyResult;\n            if (policyResult.result === false)\n                return policyResult;\n            pathDepth = 1;\n            for (let i = (this.certs.length - 2); i >= 0; i--, pathDepth++) {\n                const cert = this.certs[i];\n                let subjectAltNames = [];\n                let certPermittedSubtrees = [];\n                let certExcludedSubtrees = [];\n                if (cert.extensions) {\n                    for (let j = 0; j < cert.extensions.length; j++) {\n                        const extension = cert.extensions[j];\n                        if (extension.extnID === id_NameConstraints) {\n                            if (\"permittedSubtrees\" in extension.parsedValue)\n                                certPermittedSubtrees = certPermittedSubtrees.concat(extension.parsedValue.permittedSubtrees);\n                            if (\"excludedSubtrees\" in extension.parsedValue)\n                                certExcludedSubtrees = certExcludedSubtrees.concat(extension.parsedValue.excludedSubtrees);\n                        }\n                        if (extension.extnID === id_SubjectAltName)\n                            subjectAltNames = subjectAltNames.concat(extension.parsedValue.altNames);\n                    }\n                }\n                let formFound = (requiredNameForms.length <= 0);\n                for (let j = 0; j < requiredNameForms.length; j++) {\n                    switch (requiredNameForms[j].base.type) {\n                        case 4:\n                            {\n                                if (requiredNameForms[j].base.value.typesAndValues.length !== cert.subject.typesAndValues.length)\n                                    continue;\n                                formFound = true;\n                                for (let k = 0; k < cert.subject.typesAndValues.length; k++) {\n                                    if (cert.subject.typesAndValues[k].type !== requiredNameForms[j].base.value.typesAndValues[k].type) {\n                                        formFound = false;\n                                        break;\n                                    }\n                                }\n                                if (formFound === true)\n                                    break;\n                            }\n                            break;\n                        default:\n                    }\n                }\n                if (formFound === false) {\n                    policyResult.result = false;\n                    policyResult.resultCode = 21;\n                    policyResult.resultMessage = \"No necessary name form found\";\n                    throw policyResult;\n                }\n                const constrGroups = [\n                    [],\n                    [],\n                    [],\n                    [],\n                    [],\n                ];\n                for (let j = 0; j < permittedSubtrees.length; j++) {\n                    switch (permittedSubtrees[j].base.type) {\n                        case 1:\n                            constrGroups[0].push(permittedSubtrees[j]);\n                            break;\n                        case 2:\n                            constrGroups[1].push(permittedSubtrees[j]);\n                            break;\n                        case 4:\n                            constrGroups[2].push(permittedSubtrees[j]);\n                            break;\n                        case 6:\n                            constrGroups[3].push(permittedSubtrees[j]);\n                            break;\n                        case 7:\n                            constrGroups[4].push(permittedSubtrees[j]);\n                            break;\n                        default:\n                    }\n                }\n                for (let p = 0; p < 5; p++) {\n                    let groupPermitted = false;\n                    let valueExists = false;\n                    const group = constrGroups[p];\n                    for (let j = 0; j < group.length; j++) {\n                        switch (p) {\n                            case 0:\n                                if (subjectAltNames.length > 0) {\n                                    for (let k = 0; k < subjectAltNames.length; k++) {\n                                        if (subjectAltNames[k].type === 1) {\n                                            valueExists = true;\n                                            groupPermitted = groupPermitted || compareRFC822Name(subjectAltNames[k].value, group[j].base.value);\n                                        }\n                                    }\n                                }\n                                else {\n                                    for (let k = 0; k < cert.subject.typesAndValues.length; k++) {\n                                        if ((cert.subject.typesAndValues[k].type === \"1.2.840.113549.1.9.1\") ||\n                                            (cert.subject.typesAndValues[k].type === \"0.9.2342.19200300.100.1.3\")) {\n                                            valueExists = true;\n                                            groupPermitted = groupPermitted || compareRFC822Name(cert.subject.typesAndValues[k].value.valueBlock.value, group[j].base.value);\n                                        }\n                                    }\n                                }\n                                break;\n                            case 1:\n                                if (subjectAltNames.length > 0) {\n                                    for (let k = 0; k < subjectAltNames.length; k++) {\n                                        if (subjectAltNames[k].type === 2) {\n                                            valueExists = true;\n                                            groupPermitted = groupPermitted || compareDNSName(subjectAltNames[k].value, group[j].base.value);\n                                        }\n                                    }\n                                }\n                                break;\n                            case 2:\n                                valueExists = true;\n                                groupPermitted = compareDirectoryName(cert.subject, group[j].base.value);\n                                break;\n                            case 3:\n                                if (subjectAltNames.length > 0) {\n                                    for (let k = 0; k < subjectAltNames.length; k++) {\n                                        if (subjectAltNames[k].type === 6) {\n                                            valueExists = true;\n                                            groupPermitted = groupPermitted || compareUniformResourceIdentifier(subjectAltNames[k].value, group[j].base.value);\n                                        }\n                                    }\n                                }\n                                break;\n                            case 4:\n                                if (subjectAltNames.length > 0) {\n                                    for (let k = 0; k < subjectAltNames.length; k++) {\n                                        if (subjectAltNames[k].type === 7) {\n                                            valueExists = true;\n                                            groupPermitted = groupPermitted || compareIPAddress(subjectAltNames[k].value, group[j].base.value);\n                                        }\n                                    }\n                                }\n                                break;\n                            default:\n                        }\n                        if (groupPermitted)\n                            break;\n                    }\n                    if ((groupPermitted === false) && (group.length > 0) && valueExists) {\n                        policyResult.result = false;\n                        policyResult.resultCode = 41;\n                        policyResult.resultMessage = \"Failed to meet \\\"permitted sub-trees\\\" name constraint\";\n                        throw policyResult;\n                    }\n                }\n                let excluded = false;\n                for (let j = 0; j < excludedSubtrees.length; j++) {\n                    switch (excludedSubtrees[j].base.type) {\n                        case 1:\n                            if (subjectAltNames.length >= 0) {\n                                for (let k = 0; k < subjectAltNames.length; k++) {\n                                    if (subjectAltNames[k].type === 1)\n                                        excluded = excluded || compareRFC822Name(subjectAltNames[k].value, excludedSubtrees[j].base.value);\n                                }\n                            }\n                            else {\n                                for (let k = 0; k < cert.subject.typesAndValues.length; k++) {\n                                    if ((cert.subject.typesAndValues[k].type === \"1.2.840.113549.1.9.1\") ||\n                                        (cert.subject.typesAndValues[k].type === \"0.9.2342.19200300.100.1.3\"))\n                                        excluded = excluded || compareRFC822Name(cert.subject.typesAndValues[k].value.valueBlock.value, excludedSubtrees[j].base.value);\n                                }\n                            }\n                            break;\n                        case 2:\n                            if (subjectAltNames.length > 0) {\n                                for (let k = 0; k < subjectAltNames.length; k++) {\n                                    if (subjectAltNames[k].type === 2)\n                                        excluded = excluded || compareDNSName(subjectAltNames[k].value, excludedSubtrees[j].base.value);\n                                }\n                            }\n                            break;\n                        case 4:\n                            excluded = excluded || compareDirectoryName(cert.subject, excludedSubtrees[j].base.value);\n                            break;\n                        case 6:\n                            if (subjectAltNames.length > 0) {\n                                for (let k = 0; k < subjectAltNames.length; k++) {\n                                    if (subjectAltNames[k].type === 6)\n                                        excluded = excluded || compareUniformResourceIdentifier(subjectAltNames[k].value, excludedSubtrees[j].base.value);\n                                }\n                            }\n                            break;\n                        case 7:\n                            if (subjectAltNames.length > 0) {\n                                for (let k = 0; k < subjectAltNames.length; k++) {\n                                    if (subjectAltNames[k].type === 7)\n                                        excluded = excluded || compareIPAddress(subjectAltNames[k].value, excludedSubtrees[j].base.value);\n                                }\n                            }\n                            break;\n                        default:\n                    }\n                    if (excluded)\n                        break;\n                }\n                if (excluded === true) {\n                    policyResult.result = false;\n                    policyResult.resultCode = 42;\n                    policyResult.resultMessage = \"Failed to meet \\\"excluded sub-trees\\\" name constraint\";\n                    throw policyResult;\n                }\n                permittedSubtrees = permittedSubtrees.concat(certPermittedSubtrees);\n                excludedSubtrees = excludedSubtrees.concat(certExcludedSubtrees);\n            }\n            return policyResult;\n        }\n        catch (error) {\n            if (error instanceof Error) {\n                if (error instanceof ChainValidationError) {\n                    return {\n                        result: false,\n                        resultCode: error.code,\n                        resultMessage: error.message,\n                        error: error,\n                    };\n                }\n                return {\n                    result: false,\n                    resultCode: ChainValidationCode.unknown,\n                    resultMessage: error.message,\n                    error: error,\n                };\n            }\n            if (error && typeof error === \"object\" && \"resultMessage\" in error) {\n                return error;\n            }\n            return {\n                result: false,\n                resultCode: -1,\n                resultMessage: `${error}`,\n            };\n        }\n    }\n}\n\nconst TBS_RESPONSE_DATA = \"tbsResponseData\";\nconst SIGNATURE_ALGORITHM$3 = \"signatureAlgorithm\";\nconst SIGNATURE$2 = \"signature\";\nconst CERTS$1 = \"certs\";\nconst BASIC_OCSP_RESPONSE = \"BasicOCSPResponse\";\nconst BASIC_OCSP_RESPONSE_TBS_RESPONSE_DATA = `${BASIC_OCSP_RESPONSE}.${TBS_RESPONSE_DATA}`;\nconst BASIC_OCSP_RESPONSE_SIGNATURE_ALGORITHM = `${BASIC_OCSP_RESPONSE}.${SIGNATURE_ALGORITHM$3}`;\nconst BASIC_OCSP_RESPONSE_SIGNATURE = `${BASIC_OCSP_RESPONSE}.${SIGNATURE$2}`;\nconst BASIC_OCSP_RESPONSE_CERTS = `${BASIC_OCSP_RESPONSE}.${CERTS$1}`;\nconst CLEAR_PROPS$g = [\n    BASIC_OCSP_RESPONSE_TBS_RESPONSE_DATA,\n    BASIC_OCSP_RESPONSE_SIGNATURE_ALGORITHM,\n    BASIC_OCSP_RESPONSE_SIGNATURE,\n    BASIC_OCSP_RESPONSE_CERTS\n];\nclass BasicOCSPResponse extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.tbsResponseData = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS_RESPONSE_DATA, BasicOCSPResponse.defaultValues(TBS_RESPONSE_DATA));\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$3, BasicOCSPResponse.defaultValues(SIGNATURE_ALGORITHM$3));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$2, BasicOCSPResponse.defaultValues(SIGNATURE$2));\n        if (CERTS$1 in parameters) {\n            this.certs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTS$1, BasicOCSPResponse.defaultValues(CERTS$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS_RESPONSE_DATA:\n                return new ResponseData();\n            case SIGNATURE_ALGORITHM$3:\n                return new AlgorithmIdentifier();\n            case SIGNATURE$2:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            case CERTS$1:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case \"type\":\n                {\n                    let comparisonResult = ((ResponseData.compareWithDefault(\"tbs\", memberValue.tbs)) &&\n                        (ResponseData.compareWithDefault(\"responderID\", memberValue.responderID)) &&\n                        (ResponseData.compareWithDefault(\"producedAt\", memberValue.producedAt)) &&\n                        (ResponseData.compareWithDefault(\"responses\", memberValue.responses)));\n                    if (\"responseExtensions\" in memberValue)\n                        comparisonResult = comparisonResult && (ResponseData.compareWithDefault(\"responseExtensions\", memberValue.responseExtensions));\n                    return comparisonResult;\n                }\n            case SIGNATURE_ALGORITHM$3:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case SIGNATURE$2:\n                return (memberValue.isEqual(BasicOCSPResponse.defaultValues(memberName)));\n            case CERTS$1:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || BASIC_OCSP_RESPONSE),\n            value: [\n                ResponseData.schema(names.tbsResponseData || {\n                    names: {\n                        blockName: BASIC_OCSP_RESPONSE_TBS_RESPONSE_DATA\n                    }\n                }),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {\n                    names: {\n                        blockName: BASIC_OCSP_RESPONSE_SIGNATURE_ALGORITHM\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signature || BASIC_OCSP_RESPONSE_SIGNATURE) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                            value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                    name: BASIC_OCSP_RESPONSE_CERTS,\n                                    value: Certificate.schema(names.certs || {})\n                                })]\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$g);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, BasicOCSPResponse.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsResponseData = new ResponseData({ schema: asn1.result[BASIC_OCSP_RESPONSE_TBS_RESPONSE_DATA] });\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result[BASIC_OCSP_RESPONSE_SIGNATURE_ALGORITHM] });\n        this.signature = asn1.result[BASIC_OCSP_RESPONSE_SIGNATURE];\n        if (BASIC_OCSP_RESPONSE_CERTS in asn1.result) {\n            this.certs = Array.from(asn1.result[BASIC_OCSP_RESPONSE_CERTS], element => new Certificate({ schema: element }));\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.tbsResponseData.toSchema());\n        outputArray.push(this.signatureAlgorithm.toSchema());\n        outputArray.push(this.signature);\n        if (this.certs) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: Array.from(this.certs, o => o.toSchema())\n                    })\n                ]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            tbsResponseData: this.tbsResponseData.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signature: this.signature.toJSON(),\n        };\n        if (this.certs) {\n            res.certs = Array.from(this.certs, o => o.toJSON());\n        }\n        return res;\n    }\n    async getCertificateStatus(certificate, issuerCertificate, crypto = getCrypto(true)) {\n        const result = {\n            isForCertificate: false,\n            status: 2\n        };\n        const hashesObject = {};\n        const certIDs = [];\n        for (const response of this.tbsResponseData.responses) {\n            const hashAlgorithm = crypto.getAlgorithmByOID(response.certID.hashAlgorithm.algorithmId, true, \"CertID.hashAlgorithm\");\n            if (!hashesObject[hashAlgorithm.name]) {\n                hashesObject[hashAlgorithm.name] = 1;\n                const certID = new CertID();\n                certIDs.push(certID);\n                await certID.createForCertificate(certificate, {\n                    hashAlgorithm: hashAlgorithm.name,\n                    issuerCertificate\n                }, crypto);\n            }\n        }\n        for (const response of this.tbsResponseData.responses) {\n            for (const id of certIDs) {\n                if (response.certID.isEqual(id)) {\n                    result.isForCertificate = true;\n                    try {\n                        switch (response.certStatus.idBlock.isConstructed) {\n                            case true:\n                                if (response.certStatus.idBlock.tagNumber === 1)\n                                    result.status = 1;\n                                break;\n                            case false:\n                                switch (response.certStatus.idBlock.tagNumber) {\n                                    case 0:\n                                        result.status = 0;\n                                        break;\n                                    case 2:\n                                        result.status = 2;\n                                        break;\n                                    default:\n                                }\n                                break;\n                            default:\n                        }\n                    }\n                    catch (ex) {\n                    }\n                    return result;\n                }\n            }\n        }\n        return result;\n    }\n    async sign(privateKey, hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        if (!privateKey) {\n            throw new Error(\"Need to provide a private key for signing\");\n        }\n        const signatureParams = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const algorithm = signatureParams.parameters.algorithm;\n        if (!(\"name\" in algorithm)) {\n            throw new Error(\"Empty algorithm\");\n        }\n        this.signatureAlgorithm = signatureParams.signatureAlgorithm;\n        this.tbsResponseData.tbsView = new Uint8Array(this.tbsResponseData.toSchema(true).toBER());\n        const signature = await crypto.signWithPrivateKey(this.tbsResponseData.tbsView, privateKey, { algorithm });\n        this.signature = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: signature });\n    }\n    async verify(params = {}, crypto = getCrypto(true)) {\n        let signerCert = null;\n        let certIndex = -1;\n        const trustedCerts = params.trustedCerts || [];\n        if (!this.certs) {\n            throw new Error(\"No certificates attached to the BasicOCSPResponse\");\n        }\n        switch (true) {\n            case (this.tbsResponseData.responderID instanceof RelativeDistinguishedNames):\n                for (const [index, certificate] of this.certs.entries()) {\n                    if (certificate.subject.isEqual(this.tbsResponseData.responderID)) {\n                        certIndex = index;\n                        break;\n                    }\n                }\n                break;\n            case (this.tbsResponseData.responderID instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString):\n                for (const [index, cert] of this.certs.entries()) {\n                    const hash = await crypto.digest({ name: \"sha-1\" }, cert.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);\n                    if (pvutils__WEBPACK_IMPORTED_MODULE_2__.isEqualBuffer(hash, this.tbsResponseData.responderID.valueBlock.valueHex)) {\n                        certIndex = index;\n                        break;\n                    }\n                }\n                break;\n            default:\n                throw new Error(\"Wrong value for responderID\");\n        }\n        if (certIndex === (-1))\n            throw new Error(\"Correct certificate was not found in OCSP response\");\n        signerCert = this.certs[certIndex];\n        const additionalCerts = [signerCert];\n        for (const cert of this.certs) {\n            const caCert = await checkCA(cert, signerCert);\n            if (caCert) {\n                additionalCerts.push(caCert);\n            }\n        }\n        const certChain = new CertificateChainValidationEngine({\n            certs: additionalCerts,\n            trustedCerts,\n        });\n        const verificationResult = await certChain.verify({}, crypto);\n        if (!verificationResult.result) {\n            throw new Error(\"Validation of signer's certificate failed\");\n        }\n        return crypto.verifyWithPublicKey(this.tbsResponseData.tbsView, this.signature, this.certs[certIndex].subjectPublicKeyInfo, this.signatureAlgorithm);\n    }\n}\nBasicOCSPResponse.CLASS_NAME = \"BasicOCSPResponse\";\n\nconst TBS$1 = \"tbs\";\nconst VERSION$6 = \"version\";\nconst SUBJECT = \"subject\";\nconst SPKI = \"subjectPublicKeyInfo\";\nconst ATTRIBUTES$1 = \"attributes\";\nconst SIGNATURE_ALGORITHM$2 = \"signatureAlgorithm\";\nconst SIGNATURE_VALUE = \"signatureValue\";\nconst CSR_INFO = \"CertificationRequestInfo\";\nconst CSR_INFO_VERSION = `${CSR_INFO}.version`;\nconst CSR_INFO_SUBJECT = `${CSR_INFO}.subject`;\nconst CSR_INFO_SPKI = `${CSR_INFO}.subjectPublicKeyInfo`;\nconst CSR_INFO_ATTRS = `${CSR_INFO}.attributes`;\nconst CLEAR_PROPS$f = [\n    CSR_INFO,\n    CSR_INFO_VERSION,\n    CSR_INFO_SUBJECT,\n    CSR_INFO_SPKI,\n    CSR_INFO_ATTRS,\n    SIGNATURE_ALGORITHM$2,\n    SIGNATURE_VALUE\n];\nfunction CertificationRequestInfo(parameters = {}) {\n    const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n    return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n        name: (names.CertificationRequestInfo || CSR_INFO),\n        value: [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.CertificationRequestInfoVersion || CSR_INFO_VERSION) }),\n            RelativeDistinguishedNames.schema(names.subject || {\n                names: {\n                    blockName: CSR_INFO_SUBJECT\n                }\n            }),\n            PublicKeyInfo.schema({\n                names: {\n                    blockName: CSR_INFO_SPKI\n                }\n            }),\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                        optional: true,\n                        name: (names.CertificationRequestInfoAttributes || CSR_INFO_ATTRS),\n                        value: Attribute.schema(names.attributes || {})\n                    })\n                ]\n            })\n        ]\n    }));\n}\nclass CertificationRequest extends PkiObject {\n    get tbs() {\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.tbsView);\n    }\n    set tbs(value) {\n        this.tbsView = new Uint8Array(value);\n    }\n    constructor(parameters = {}) {\n        super();\n        this.tbsView = new Uint8Array(pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS$1, CertificationRequest.defaultValues(TBS$1)));\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$6, CertificationRequest.defaultValues(VERSION$6));\n        this.subject = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SUBJECT, CertificationRequest.defaultValues(SUBJECT));\n        this.subjectPublicKeyInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SPKI, CertificationRequest.defaultValues(SPKI));\n        if (ATTRIBUTES$1 in parameters) {\n            this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES$1, CertificationRequest.defaultValues(ATTRIBUTES$1));\n        }\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$2, CertificationRequest.defaultValues(SIGNATURE_ALGORITHM$2));\n        this.signatureValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_VALUE, CertificationRequest.defaultValues(SIGNATURE_VALUE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS$1:\n                return EMPTY_BUFFER;\n            case VERSION$6:\n                return 0;\n            case SUBJECT:\n                return new RelativeDistinguishedNames();\n            case SPKI:\n                return new PublicKeyInfo();\n            case ATTRIBUTES$1:\n                return [];\n            case SIGNATURE_ALGORITHM$2:\n                return new AlgorithmIdentifier();\n            case SIGNATURE_VALUE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                CertificationRequestInfo(names.certificationRequestInfo || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    name: (names.signatureAlgorithm || SIGNATURE_ALGORITHM$2),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier(),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ optional: true })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signatureValue || SIGNATURE_VALUE) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$f);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, CertificationRequest.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsView = asn1.result.CertificationRequestInfo.valueBeforeDecodeView;\n        this.version = asn1.result[CSR_INFO_VERSION].valueBlock.valueDec;\n        this.subject = new RelativeDistinguishedNames({ schema: asn1.result[CSR_INFO_SUBJECT] });\n        this.subjectPublicKeyInfo = new PublicKeyInfo({ schema: asn1.result[CSR_INFO_SPKI] });\n        if (CSR_INFO_ATTRS in asn1.result) {\n            this.attributes = Array.from(asn1.result[CSR_INFO_ATTRS], element => new Attribute({ schema: element }));\n        }\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signatureValue = asn1.result.signatureValue;\n    }\n    encodeTBS() {\n        const outputArray = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n            this.subject.toSchema(),\n            this.subjectPublicKeyInfo.toSchema()\n        ];\n        if (ATTRIBUTES$1 in this) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: Array.from(this.attributes || [], o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toSchema(encodeFlag = false) {\n        let tbsSchema;\n        if (encodeFlag === false) {\n            if (this.tbsView.byteLength === 0) {\n                return CertificationRequest.schema();\n            }\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.tbsView);\n            AsnError.assert(asn1, \"PKCS#10 Certificate Request\");\n            tbsSchema = asn1.result;\n        }\n        else {\n            tbsSchema = this.encodeTBS();\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                tbsSchema,\n                this.signatureAlgorithm.toSchema(),\n                this.signatureValue\n            ]\n        }));\n    }\n    toJSON() {\n        const object = {\n            tbs: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.Convert.ToHex(this.tbsView),\n            version: this.version,\n            subject: this.subject.toJSON(),\n            subjectPublicKeyInfo: this.subjectPublicKeyInfo.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signatureValue: this.signatureValue.toJSON(),\n        };\n        if (ATTRIBUTES$1 in this) {\n            object.attributes = Array.from(this.attributes || [], o => o.toJSON());\n        }\n        return object;\n    }\n    async sign(privateKey, hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        if (!privateKey) {\n            throw new Error(\"Need to provide a private key for signing\");\n        }\n        const signatureParams = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const parameters = signatureParams.parameters;\n        this.signatureAlgorithm = signatureParams.signatureAlgorithm;\n        this.tbsView = new Uint8Array(this.encodeTBS().toBER());\n        const signature = await crypto.signWithPrivateKey(this.tbsView, privateKey, parameters);\n        this.signatureValue = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: signature });\n    }\n    async verify(crypto = getCrypto(true)) {\n        return crypto.verifyWithPublicKey(this.tbsView, this.signatureValue, this.subjectPublicKeyInfo, this.signatureAlgorithm);\n    }\n    async getPublicKey(parameters, crypto = getCrypto(true)) {\n        return crypto.getPublicKey(this.subjectPublicKeyInfo, this.signatureAlgorithm, parameters);\n    }\n}\nCertificationRequest.CLASS_NAME = \"CertificationRequest\";\n\nconst DIGEST_ALGORITHM$1 = \"digestAlgorithm\";\nconst DIGEST = \"digest\";\nconst CLEAR_PROPS$e = [\n    DIGEST_ALGORITHM$1,\n    DIGEST\n];\nclass DigestInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.digestAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGEST_ALGORITHM$1, DigestInfo.defaultValues(DIGEST_ALGORITHM$1));\n        this.digest = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGEST, DigestInfo.defaultValues(DIGEST));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case DIGEST_ALGORITHM$1:\n                return new AlgorithmIdentifier();\n            case DIGEST:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case DIGEST_ALGORITHM$1:\n                return ((AlgorithmIdentifier.compareWithDefault(\"algorithmId\", memberValue.algorithmId)) &&\n                    ((\"algorithmParams\" in memberValue) === false));\n            case DIGEST:\n                return (memberValue.isEqual(DigestInfo.defaultValues(memberName)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.digestAlgorithm || {\n                    names: {\n                        blockName: DIGEST_ALGORITHM$1\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.digest || DIGEST) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$e);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, DigestInfo.schema({\n            names: {\n                digestAlgorithm: {\n                    names: {\n                        blockName: DIGEST_ALGORITHM$1\n                    }\n                },\n                digest: DIGEST\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.digestAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.digestAlgorithm });\n        this.digest = asn1.result.digest;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.digestAlgorithm.toSchema(),\n                this.digest\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            digestAlgorithm: this.digestAlgorithm.toJSON(),\n            digest: this.digest.toJSON(),\n        };\n    }\n}\nDigestInfo.CLASS_NAME = \"DigestInfo\";\n\nconst E_CONTENT_TYPE = \"eContentType\";\nconst E_CONTENT = \"eContent\";\nconst CLEAR_PROPS$d = [\n    E_CONTENT_TYPE,\n    E_CONTENT,\n];\nclass EncapsulatedContentInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.eContentType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, E_CONTENT_TYPE, EncapsulatedContentInfo.defaultValues(E_CONTENT_TYPE));\n        if (E_CONTENT in parameters) {\n            this.eContent = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, E_CONTENT, EncapsulatedContentInfo.defaultValues(E_CONTENT));\n            if ((this.eContent.idBlock.tagClass === 1) &&\n                (this.eContent.idBlock.tagNumber === 4)) {\n                if (this.eContent.idBlock.isConstructed === false) {\n                    const constrString = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({\n                        idBlock: { isConstructed: true },\n                        isConstructed: true\n                    });\n                    let offset = 0;\n                    const viewHex = this.eContent.valueBlock.valueHexView.slice().buffer;\n                    let length = viewHex.byteLength;\n                    while (length > 0) {\n                        const pieceView = new Uint8Array(viewHex, offset, ((offset + 65536) > viewHex.byteLength) ? (viewHex.byteLength - offset) : 65536);\n                        const _array = new ArrayBuffer(pieceView.length);\n                        const _view = new Uint8Array(_array);\n                        for (let i = 0; i < _view.length; i++) {\n                            _view[i] = pieceView[i];\n                        }\n                        constrString.valueBlock.value.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: _array }));\n                        length -= pieceView.length;\n                        offset += pieceView.length;\n                    }\n                    this.eContent = constrString;\n                }\n            }\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case E_CONTENT_TYPE:\n                return EMPTY_STRING;\n            case E_CONTENT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case E_CONTENT_TYPE:\n                return (memberValue === EMPTY_STRING);\n            case E_CONTENT:\n                {\n                    if ((memberValue.idBlock.tagClass === 1) && (memberValue.idBlock.tagNumber === 4))\n                        return (memberValue.isEqual(EncapsulatedContentInfo.defaultValues(E_CONTENT)));\n                    return false;\n                }\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.eContentType || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any({ name: (names.eContent || EMPTY_STRING) })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$d);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, EncapsulatedContentInfo.schema({\n            names: {\n                eContentType: E_CONTENT_TYPE,\n                eContent: E_CONTENT\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.eContentType = asn1.result.eContentType.valueBlock.toString();\n        if (E_CONTENT in asn1.result)\n            this.eContent = asn1.result.eContent;\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.eContentType }));\n        if (this.eContent) {\n            if (EncapsulatedContentInfo.compareWithDefault(E_CONTENT, this.eContent) === false) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [this.eContent]\n                }));\n            }\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            eContentType: this.eContentType\n        };\n        if (this.eContent && EncapsulatedContentInfo.compareWithDefault(E_CONTENT, this.eContent) === false) {\n            res.eContent = this.eContent.toJSON();\n        }\n        return res;\n    }\n}\nEncapsulatedContentInfo.CLASS_NAME = \"EncapsulatedContentInfo\";\n\nclass KeyBag extends PrivateKeyInfo {\n    constructor(parameters = {}) {\n        super(parameters);\n    }\n}\n\nconst MAC = \"mac\";\nconst MAC_SALT = \"macSalt\";\nconst ITERATIONS = \"iterations\";\nconst CLEAR_PROPS$c = [\n    MAC,\n    MAC_SALT,\n    ITERATIONS\n];\nclass MacData extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.mac = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MAC, MacData.defaultValues(MAC));\n        this.macSalt = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MAC_SALT, MacData.defaultValues(MAC_SALT));\n        if (ITERATIONS in parameters) {\n            this.iterations = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ITERATIONS, MacData.defaultValues(ITERATIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case MAC:\n                return new DigestInfo();\n            case MAC_SALT:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case ITERATIONS:\n                return 1;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case MAC:\n                return ((DigestInfo.compareWithDefault(\"digestAlgorithm\", memberValue.digestAlgorithm)) &&\n                    (DigestInfo.compareWithDefault(\"digest\", memberValue.digest)));\n            case MAC_SALT:\n                return (memberValue.isEqual(MacData.defaultValues(memberName)));\n            case ITERATIONS:\n                return (memberValue === MacData.defaultValues(memberName));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            optional: (names.optional || true),\n            value: [\n                DigestInfo.schema(names.mac || {\n                    names: {\n                        blockName: MAC\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.macSalt || MAC_SALT) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    optional: true,\n                    name: (names.iterations || ITERATIONS)\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$c);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, MacData.schema({\n            names: {\n                mac: {\n                    names: {\n                        blockName: MAC\n                    }\n                },\n                macSalt: MAC_SALT,\n                iterations: ITERATIONS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.mac = new DigestInfo({ schema: asn1.result.mac });\n        this.macSalt = asn1.result.macSalt;\n        if (ITERATIONS in asn1.result)\n            this.iterations = asn1.result.iterations.valueBlock.valueDec;\n    }\n    toSchema() {\n        const outputArray = [\n            this.mac.toSchema(),\n            this.macSalt\n        ];\n        if (this.iterations !== undefined) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.iterations }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            mac: this.mac.toJSON(),\n            macSalt: this.macSalt.toJSON(),\n        };\n        if (this.iterations !== undefined) {\n            res.iterations = this.iterations;\n        }\n        return res;\n    }\n}\nMacData.CLASS_NAME = \"MacData\";\n\nconst HASH_ALGORITHM = \"hashAlgorithm\";\nconst HASHED_MESSAGE = \"hashedMessage\";\nconst CLEAR_PROPS$b = [\n    HASH_ALGORITHM,\n    HASHED_MESSAGE,\n];\nclass MessageImprint extends PkiObject {\n    static async create(hashAlgorithm, message, crypto = getCrypto(true)) {\n        const hashAlgorithmOID = crypto.getOIDByAlgorithm({ name: hashAlgorithm }, true, \"hashAlgorithm\");\n        const hashedMessage = await crypto.digest(hashAlgorithm, message);\n        const res = new MessageImprint({\n            hashAlgorithm: new AlgorithmIdentifier({\n                algorithmId: hashAlgorithmOID,\n                algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null(),\n            }),\n            hashedMessage: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: hashedMessage })\n        });\n        return res;\n    }\n    constructor(parameters = {}) {\n        super();\n        this.hashAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASH_ALGORITHM, MessageImprint.defaultValues(HASH_ALGORITHM));\n        this.hashedMessage = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, HASHED_MESSAGE, MessageImprint.defaultValues(HASHED_MESSAGE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case HASH_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case HASHED_MESSAGE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case HASH_ALGORITHM:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case HASHED_MESSAGE:\n                return (memberValue.isEqual(MessageImprint.defaultValues(memberName)) === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.hashAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.hashedMessage || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$b);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, MessageImprint.schema({\n            names: {\n                hashAlgorithm: {\n                    names: {\n                        blockName: HASH_ALGORITHM\n                    }\n                },\n                hashedMessage: HASHED_MESSAGE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.hashAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.hashAlgorithm });\n        this.hashedMessage = asn1.result.hashedMessage;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                this.hashAlgorithm.toSchema(),\n                this.hashedMessage\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            hashAlgorithm: this.hashAlgorithm.toJSON(),\n            hashedMessage: this.hashedMessage.toJSON(),\n        };\n    }\n}\nMessageImprint.CLASS_NAME = \"MessageImprint\";\n\nconst REQ_CERT = \"reqCert\";\nconst SINGLE_REQUEST_EXTENSIONS = \"singleRequestExtensions\";\nconst CLEAR_PROPS$a = [\n    REQ_CERT,\n    SINGLE_REQUEST_EXTENSIONS,\n];\nclass Request extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.reqCert = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQ_CERT, Request.defaultValues(REQ_CERT));\n        if (SINGLE_REQUEST_EXTENSIONS in parameters) {\n            this.singleRequestExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SINGLE_REQUEST_EXTENSIONS, Request.defaultValues(SINGLE_REQUEST_EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case REQ_CERT:\n                return new CertID();\n            case SINGLE_REQUEST_EXTENSIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case REQ_CERT:\n                return (memberValue.isEqual(Request.defaultValues(memberName)));\n            case SINGLE_REQUEST_EXTENSIONS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                CertID.schema(names.reqCert || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [Extension.schema(names.extensions || {\n                            names: {\n                                blockName: (names.singleRequestExtensions || EMPTY_STRING)\n                            }\n                        })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$a);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Request.schema({\n            names: {\n                reqCert: {\n                    names: {\n                        blockName: REQ_CERT\n                    }\n                },\n                extensions: {\n                    names: {\n                        blockName: SINGLE_REQUEST_EXTENSIONS\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.reqCert = new CertID({ schema: asn1.result.reqCert });\n        if (SINGLE_REQUEST_EXTENSIONS in asn1.result) {\n            this.singleRequestExtensions = Array.from(asn1.result.singleRequestExtensions.valueBlock.value, element => new Extension({ schema: element }));\n        }\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.reqCert.toSchema());\n        if (this.singleRequestExtensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: Array.from(this.singleRequestExtensions, o => o.toSchema())\n                    })\n                ]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            reqCert: this.reqCert.toJSON()\n        };\n        if (this.singleRequestExtensions) {\n            res.singleRequestExtensions = Array.from(this.singleRequestExtensions, o => o.toJSON());\n        }\n        return res;\n    }\n}\nRequest.CLASS_NAME = \"Request\";\n\nconst TBS = \"tbs\";\nconst VERSION$5 = \"version\";\nconst REQUESTOR_NAME = \"requestorName\";\nconst REQUEST_LIST = \"requestList\";\nconst REQUEST_EXTENSIONS = \"requestExtensions\";\nconst TBS_REQUEST$1 = \"TBSRequest\";\nconst TBS_REQUEST_VERSION = `${TBS_REQUEST$1}.${VERSION$5}`;\nconst TBS_REQUEST_REQUESTOR_NAME = `${TBS_REQUEST$1}.${REQUESTOR_NAME}`;\nconst TBS_REQUEST_REQUESTS = `${TBS_REQUEST$1}.requests`;\nconst TBS_REQUEST_REQUEST_EXTENSIONS = `${TBS_REQUEST$1}.${REQUEST_EXTENSIONS}`;\nconst CLEAR_PROPS$9 = [\n    TBS_REQUEST$1,\n    TBS_REQUEST_VERSION,\n    TBS_REQUEST_REQUESTOR_NAME,\n    TBS_REQUEST_REQUESTS,\n    TBS_REQUEST_REQUEST_EXTENSIONS\n];\nclass TBSRequest extends PkiObject {\n    get tbs() {\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.tbsView);\n    }\n    set tbs(value) {\n        this.tbsView = new Uint8Array(value);\n    }\n    constructor(parameters = {}) {\n        super();\n        this.tbsView = new Uint8Array(pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS, TBSRequest.defaultValues(TBS)));\n        if (VERSION$5 in parameters) {\n            this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$5, TBSRequest.defaultValues(VERSION$5));\n        }\n        if (REQUESTOR_NAME in parameters) {\n            this.requestorName = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQUESTOR_NAME, TBSRequest.defaultValues(REQUESTOR_NAME));\n        }\n        this.requestList = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQUEST_LIST, TBSRequest.defaultValues(REQUEST_LIST));\n        if (REQUEST_EXTENSIONS in parameters) {\n            this.requestExtensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQUEST_EXTENSIONS, TBSRequest.defaultValues(REQUEST_EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS:\n                return EMPTY_BUFFER;\n            case VERSION$5:\n                return 0;\n            case REQUESTOR_NAME:\n                return new GeneralName();\n            case REQUEST_LIST:\n            case REQUEST_EXTENSIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TBS:\n                return (memberValue.byteLength === 0);\n            case VERSION$5:\n                return (memberValue === TBSRequest.defaultValues(memberName));\n            case REQUESTOR_NAME:\n                return ((memberValue.type === GeneralName.defaultValues(\"type\")) && (Object.keys(memberValue.value).length === 0));\n            case REQUEST_LIST:\n            case REQUEST_EXTENSIONS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || TBS_REQUEST$1),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.TBSRequestVersion || TBS_REQUEST_VERSION) })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [GeneralName.schema(names.requestorName || {\n                            names: {\n                                blockName: TBS_REQUEST_REQUESTOR_NAME\n                            }\n                        })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    name: (names.requestList || \"TBSRequest.requestList\"),\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.requests || TBS_REQUEST_REQUESTS),\n                            value: Request.schema(names.requestNames || {})\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: [Extensions.schema(names.extensions || {\n                            names: {\n                                blockName: (names.requestExtensions || TBS_REQUEST_REQUEST_EXTENSIONS)\n                            }\n                        })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$9);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, TBSRequest.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsView = asn1.result.TBSRequest.valueBeforeDecodeView;\n        if (TBS_REQUEST_VERSION in asn1.result)\n            this.version = asn1.result[TBS_REQUEST_VERSION].valueBlock.valueDec;\n        if (TBS_REQUEST_REQUESTOR_NAME in asn1.result)\n            this.requestorName = new GeneralName({ schema: asn1.result[TBS_REQUEST_REQUESTOR_NAME] });\n        this.requestList = Array.from(asn1.result[TBS_REQUEST_REQUESTS], element => new Request({ schema: element }));\n        if (TBS_REQUEST_REQUEST_EXTENSIONS in asn1.result)\n            this.requestExtensions = Array.from(asn1.result[TBS_REQUEST_REQUEST_EXTENSIONS].valueBlock.value, element => new Extension({ schema: element }));\n    }\n    toSchema(encodeFlag = false) {\n        let tbsSchema;\n        if (encodeFlag === false) {\n            if (this.tbsView.byteLength === 0)\n                return TBSRequest.schema();\n            const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.tbsView);\n            AsnError.assert(asn1, \"TBS Request\");\n            if (!(asn1.result instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence)) {\n                throw new Error(\"ASN.1 result should be SEQUENCE\");\n            }\n            tbsSchema = asn1.result;\n        }\n        else {\n            const outputArray = [];\n            if (this.version !== undefined) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version })]\n                }));\n            }\n            if (this.requestorName) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [this.requestorName.toSchema()]\n                }));\n            }\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: Array.from(this.requestList, o => o.toSchema())\n            }));\n            if (this.requestExtensions) {\n                outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 2\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                            value: Array.from(this.requestExtensions, o => o.toSchema())\n                        })\n                    ]\n                }));\n            }\n            tbsSchema = new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                value: outputArray\n            });\n        }\n        return tbsSchema;\n    }\n    toJSON() {\n        const res = {};\n        if (this.version != undefined)\n            res.version = this.version;\n        if (this.requestorName) {\n            res.requestorName = this.requestorName.toJSON();\n        }\n        res.requestList = Array.from(this.requestList, o => o.toJSON());\n        if (this.requestExtensions) {\n            res.requestExtensions = Array.from(this.requestExtensions, o => o.toJSON());\n        }\n        return res;\n    }\n}\nTBSRequest.CLASS_NAME = \"TBSRequest\";\n\nconst SIGNATURE_ALGORITHM$1 = \"signatureAlgorithm\";\nconst SIGNATURE$1 = \"signature\";\nconst CERTS = \"certs\";\nclass Signature extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM$1, Signature.defaultValues(SIGNATURE_ALGORITHM$1));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE$1, Signature.defaultValues(SIGNATURE$1));\n        if (CERTS in parameters) {\n            this.certs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTS, Signature.defaultValues(CERTS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case SIGNATURE_ALGORITHM$1:\n                return new AlgorithmIdentifier();\n            case SIGNATURE$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            case CERTS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case SIGNATURE_ALGORITHM$1:\n                return ((memberValue.algorithmId === EMPTY_STRING) && ((\"algorithmParams\" in memberValue) === false));\n            case SIGNATURE$1:\n                return (memberValue.isEqual(Signature.defaultValues(memberName)));\n            case CERTS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {}),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ name: (names.signature || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                            value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                                    name: (names.certs || EMPTY_STRING),\n                                    value: Certificate.schema({})\n                                })]\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            SIGNATURE_ALGORITHM$1,\n            SIGNATURE$1,\n            CERTS\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, Signature.schema({\n            names: {\n                signatureAlgorithm: {\n                    names: {\n                        blockName: SIGNATURE_ALGORITHM$1\n                    }\n                },\n                signature: SIGNATURE$1,\n                certs: CERTS\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result.signatureAlgorithm });\n        this.signature = asn1.result.signature;\n        if (CERTS in asn1.result)\n            this.certs = Array.from(asn1.result.certs, element => new Certificate({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.signatureAlgorithm.toSchema());\n        outputArray.push(this.signature);\n        if (this.certs) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                        value: Array.from(this.certs, o => o.toSchema())\n                    })\n                ]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signature: this.signature.toJSON(),\n        };\n        if (this.certs) {\n            res.certs = Array.from(this.certs, o => o.toJSON());\n        }\n        return res;\n    }\n}\nSignature.CLASS_NAME = \"Signature\";\n\nconst TBS_REQUEST = \"tbsRequest\";\nconst OPTIONAL_SIGNATURE = \"optionalSignature\";\nconst CLEAR_PROPS$8 = [\n    TBS_REQUEST,\n    OPTIONAL_SIGNATURE\n];\nclass OCSPRequest extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.tbsRequest = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TBS_REQUEST, OCSPRequest.defaultValues(TBS_REQUEST));\n        if (OPTIONAL_SIGNATURE in parameters) {\n            this.optionalSignature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OPTIONAL_SIGNATURE, OCSPRequest.defaultValues(OPTIONAL_SIGNATURE));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TBS_REQUEST:\n                return new TBSRequest();\n            case OPTIONAL_SIGNATURE:\n                return new Signature();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TBS_REQUEST:\n                return ((TBSRequest.compareWithDefault(\"tbs\", memberValue.tbs)) &&\n                    (TBSRequest.compareWithDefault(\"version\", memberValue.version)) &&\n                    (TBSRequest.compareWithDefault(\"requestorName\", memberValue.requestorName)) &&\n                    (TBSRequest.compareWithDefault(\"requestList\", memberValue.requestList)) &&\n                    (TBSRequest.compareWithDefault(\"requestExtensions\", memberValue.requestExtensions)));\n            case OPTIONAL_SIGNATURE:\n                return ((Signature.compareWithDefault(\"signatureAlgorithm\", memberValue.signatureAlgorithm)) &&\n                    (Signature.compareWithDefault(\"signature\", memberValue.signature)) &&\n                    (Signature.compareWithDefault(\"certs\", memberValue.certs)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: names.blockName || \"OCSPRequest\",\n            value: [\n                TBSRequest.schema(names.tbsRequest || {\n                    names: {\n                        blockName: TBS_REQUEST\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        Signature.schema(names.optionalSignature || {\n                            names: {\n                                blockName: OPTIONAL_SIGNATURE\n                            }\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$8);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OCSPRequest.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.tbsRequest = new TBSRequest({ schema: asn1.result.tbsRequest });\n        if (OPTIONAL_SIGNATURE in asn1.result)\n            this.optionalSignature = new Signature({ schema: asn1.result.optionalSignature });\n    }\n    toSchema(encodeFlag = false) {\n        const outputArray = [];\n        outputArray.push(this.tbsRequest.toSchema(encodeFlag));\n        if (this.optionalSignature)\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [\n                    this.optionalSignature.toSchema()\n                ]\n            }));\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            tbsRequest: this.tbsRequest.toJSON()\n        };\n        if (this.optionalSignature) {\n            res.optionalSignature = this.optionalSignature.toJSON();\n        }\n        return res;\n    }\n    async createForCertificate(certificate, parameters, crypto = getCrypto(true)) {\n        const certID = new CertID();\n        await certID.createForCertificate(certificate, parameters, crypto);\n        this.tbsRequest.requestList.push(new Request({\n            reqCert: certID,\n        }));\n    }\n    async sign(privateKey, hashAlgorithm = \"SHA-1\", crypto = getCrypto(true)) {\n        ParameterError.assertEmpty(privateKey, \"privateKey\", \"OCSPRequest.sign method\");\n        if (!this.optionalSignature) {\n            throw new Error(\"Need to create \\\"optionalSignature\\\" field before signing\");\n        }\n        const signatureParams = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const parameters = signatureParams.parameters;\n        this.optionalSignature.signatureAlgorithm = signatureParams.signatureAlgorithm;\n        const tbs = this.tbsRequest.toSchema(true).toBER(false);\n        const signature = await crypto.signWithPrivateKey(tbs, privateKey, parameters);\n        this.optionalSignature.signature = new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({ valueHex: signature });\n    }\n    verify() {\n    }\n}\nOCSPRequest.CLASS_NAME = \"OCSPRequest\";\n\nconst RESPONSE_TYPE = \"responseType\";\nconst RESPONSE = \"response\";\nconst CLEAR_PROPS$7 = [\n    RESPONSE_TYPE,\n    RESPONSE\n];\nclass ResponseBytes extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.responseType = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSE_TYPE, ResponseBytes.defaultValues(RESPONSE_TYPE));\n        this.response = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSE, ResponseBytes.defaultValues(RESPONSE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case RESPONSE_TYPE:\n                return EMPTY_STRING;\n            case RESPONSE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case RESPONSE_TYPE:\n                return (memberValue === EMPTY_STRING);\n            case RESPONSE:\n                return (memberValue.isEqual(ResponseBytes.defaultValues(memberName)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.responseType || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.response || EMPTY_STRING) })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$7);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, ResponseBytes.schema({\n            names: {\n                responseType: RESPONSE_TYPE,\n                response: RESPONSE\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.responseType = asn1.result.responseType.valueBlock.toString();\n        this.response = asn1.result.response;\n    }\n    toSchema() {\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.responseType }),\n                this.response\n            ]\n        }));\n    }\n    toJSON() {\n        return {\n            responseType: this.responseType,\n            response: this.response.toJSON(),\n        };\n    }\n}\nResponseBytes.CLASS_NAME = \"ResponseBytes\";\n\nconst RESPONSE_STATUS = \"responseStatus\";\nconst RESPONSE_BYTES = \"responseBytes\";\nclass OCSPResponse extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.responseStatus = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSE_STATUS, OCSPResponse.defaultValues(RESPONSE_STATUS));\n        if (RESPONSE_BYTES in parameters) {\n            this.responseBytes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, RESPONSE_BYTES, OCSPResponse.defaultValues(RESPONSE_BYTES));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case RESPONSE_STATUS:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Enumerated();\n            case RESPONSE_BYTES:\n                return new ResponseBytes();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case RESPONSE_STATUS:\n                return (memberValue.isEqual(OCSPResponse.defaultValues(memberName)));\n            case RESPONSE_BYTES:\n                return ((ResponseBytes.compareWithDefault(\"responseType\", memberValue.responseType)) &&\n                    (ResponseBytes.compareWithDefault(\"response\", memberValue.response)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || \"OCSPResponse\"),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Enumerated({ name: (names.responseStatus || RESPONSE_STATUS) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [\n                        ResponseBytes.schema(names.responseBytes || {\n                            names: {\n                                blockName: RESPONSE_BYTES\n                            }\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, [\n            RESPONSE_STATUS,\n            RESPONSE_BYTES\n        ]);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, OCSPResponse.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.responseStatus = asn1.result.responseStatus;\n        if (RESPONSE_BYTES in asn1.result)\n            this.responseBytes = new ResponseBytes({ schema: asn1.result.responseBytes });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.responseStatus);\n        if (this.responseBytes) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.responseBytes.toSchema()]\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            responseStatus: this.responseStatus.toJSON()\n        };\n        if (this.responseBytes) {\n            res.responseBytes = this.responseBytes.toJSON();\n        }\n        return res;\n    }\n    async getCertificateStatus(certificate, issuerCertificate, crypto = getCrypto(true)) {\n        let basicResponse;\n        const result = {\n            isForCertificate: false,\n            status: 2\n        };\n        if (!this.responseBytes)\n            return result;\n        if (this.responseBytes.responseType !== id_PKIX_OCSP_Basic)\n            return result;\n        try {\n            const asn1Basic = asn1js__WEBPACK_IMPORTED_MODULE_0__.fromBER(this.responseBytes.response.valueBlock.valueHexView);\n            AsnError.assert(asn1Basic, \"Basic OCSP response\");\n            basicResponse = new BasicOCSPResponse({ schema: asn1Basic.result });\n        }\n        catch (ex) {\n            return result;\n        }\n        return basicResponse.getCertificateStatus(certificate, issuerCertificate, crypto);\n    }\n    async sign(privateKey, hashAlgorithm, crypto = getCrypto(true)) {\n        var _a;\n        if (this.responseBytes && this.responseBytes.responseType === id_PKIX_OCSP_Basic) {\n            const basicResponse = BasicOCSPResponse.fromBER(this.responseBytes.response.valueBlock.valueHexView);\n            return basicResponse.sign(privateKey, hashAlgorithm, crypto);\n        }\n        throw new Error(`Unknown ResponseBytes type: ${((_a = this.responseBytes) === null || _a === void 0 ? void 0 : _a.responseType) || \"Unknown\"}`);\n    }\n    async verify(issuerCertificate = null, crypto = getCrypto(true)) {\n        var _a;\n        if ((RESPONSE_BYTES in this) === false)\n            throw new Error(\"Empty ResponseBytes field\");\n        if (this.responseBytes && this.responseBytes.responseType === id_PKIX_OCSP_Basic) {\n            const basicResponse = BasicOCSPResponse.fromBER(this.responseBytes.response.valueBlock.valueHexView);\n            if (issuerCertificate !== null) {\n                if (!basicResponse.certs) {\n                    basicResponse.certs = [];\n                }\n                basicResponse.certs.push(issuerCertificate);\n            }\n            return basicResponse.verify({}, crypto);\n        }\n        throw new Error(`Unknown ResponseBytes type: ${((_a = this.responseBytes) === null || _a === void 0 ? void 0 : _a.responseType) || \"Unknown\"}`);\n    }\n}\nOCSPResponse.CLASS_NAME = \"OCSPResponse\";\n\nconst TYPE = \"type\";\nconst ATTRIBUTES = \"attributes\";\nconst ENCODED_VALUE = \"encodedValue\";\nconst CLEAR_PROPS$6 = [\n    ATTRIBUTES\n];\nclass SignedAndUnsignedAttributes extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.type = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TYPE, SignedAndUnsignedAttributes.defaultValues(TYPE));\n        this.attributes = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ATTRIBUTES, SignedAndUnsignedAttributes.defaultValues(ATTRIBUTES));\n        this.encodedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCODED_VALUE, SignedAndUnsignedAttributes.defaultValues(ENCODED_VALUE));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case TYPE:\n                return (-1);\n            case ATTRIBUTES:\n                return [];\n            case ENCODED_VALUE:\n                return EMPTY_BUFFER;\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case TYPE:\n                return (memberValue === SignedAndUnsignedAttributes.defaultValues(TYPE));\n            case ATTRIBUTES:\n                return (memberValue.length === 0);\n            case ENCODED_VALUE:\n                return (memberValue.byteLength === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n            name: (names.blockName || EMPTY_STRING),\n            optional: true,\n            idBlock: {\n                tagClass: 3,\n                tagNumber: names.tagNumber || 0\n            },\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                    name: (names.attributes || EMPTY_STRING),\n                    value: Attribute.schema()\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$6);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SignedAndUnsignedAttributes.schema({\n            names: {\n                tagNumber: this.type,\n                attributes: ATTRIBUTES\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.type = asn1.result.idBlock.tagNumber;\n        this.encodedValue = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(asn1.result.valueBeforeDecodeView);\n        const encodedView = new Uint8Array(this.encodedValue);\n        encodedView[0] = 0x31;\n        if ((ATTRIBUTES in asn1.result) === false) {\n            if (this.type === 0)\n                throw new Error(\"Wrong structure of SignedUnsignedAttributes\");\n            else\n                return;\n        }\n        this.attributes = Array.from(asn1.result.attributes, element => new Attribute({ schema: element }));\n    }\n    toSchema() {\n        if (SignedAndUnsignedAttributes.compareWithDefault(TYPE, this.type) || SignedAndUnsignedAttributes.compareWithDefault(ATTRIBUTES, this.attributes))\n            throw new Error(\"Incorrectly initialized \\\"SignedAndUnsignedAttributes\\\" class\");\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n            optional: true,\n            idBlock: {\n                tagClass: 3,\n                tagNumber: this.type\n            },\n            value: Array.from(this.attributes, o => o.toSchema())\n        }));\n    }\n    toJSON() {\n        if (SignedAndUnsignedAttributes.compareWithDefault(TYPE, this.type) || SignedAndUnsignedAttributes.compareWithDefault(ATTRIBUTES, this.attributes))\n            throw new Error(\"Incorrectly initialized \\\"SignedAndUnsignedAttributes\\\" class\");\n        return {\n            type: this.type,\n            attributes: Array.from(this.attributes, o => o.toJSON())\n        };\n    }\n}\nSignedAndUnsignedAttributes.CLASS_NAME = \"SignedAndUnsignedAttributes\";\n\nconst VERSION$4 = \"version\";\nconst SID = \"sid\";\nconst DIGEST_ALGORITHM = \"digestAlgorithm\";\nconst SIGNED_ATTRS = \"signedAttrs\";\nconst SIGNATURE_ALGORITHM = \"signatureAlgorithm\";\nconst SIGNATURE = \"signature\";\nconst UNSIGNED_ATTRS = \"unsignedAttrs\";\nconst SIGNER_INFO = \"SignerInfo\";\nconst SIGNER_INFO_VERSION = `${SIGNER_INFO}.${VERSION$4}`;\nconst SIGNER_INFO_SID = `${SIGNER_INFO}.${SID}`;\nconst SIGNER_INFO_DIGEST_ALGORITHM = `${SIGNER_INFO}.${DIGEST_ALGORITHM}`;\nconst SIGNER_INFO_SIGNED_ATTRS = `${SIGNER_INFO}.${SIGNED_ATTRS}`;\nconst SIGNER_INFO_SIGNATURE_ALGORITHM = `${SIGNER_INFO}.${SIGNATURE_ALGORITHM}`;\nconst SIGNER_INFO_SIGNATURE = `${SIGNER_INFO}.${SIGNATURE}`;\nconst SIGNER_INFO_UNSIGNED_ATTRS = `${SIGNER_INFO}.${UNSIGNED_ATTRS}`;\nconst CLEAR_PROPS$5 = [\n    SIGNER_INFO_VERSION,\n    SIGNER_INFO_SID,\n    SIGNER_INFO_DIGEST_ALGORITHM,\n    SIGNER_INFO_SIGNED_ATTRS,\n    SIGNER_INFO_SIGNATURE_ALGORITHM,\n    SIGNER_INFO_SIGNATURE,\n    SIGNER_INFO_UNSIGNED_ATTRS\n];\nclass SignerInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$4, SignerInfo.defaultValues(VERSION$4));\n        this.sid = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SID, SignerInfo.defaultValues(SID));\n        this.digestAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGEST_ALGORITHM, SignerInfo.defaultValues(DIGEST_ALGORITHM));\n        if (SIGNED_ATTRS in parameters) {\n            this.signedAttrs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNED_ATTRS, SignerInfo.defaultValues(SIGNED_ATTRS));\n        }\n        this.signatureAlgorithm = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE_ALGORITHM, SignerInfo.defaultValues(SIGNATURE_ALGORITHM));\n        this.signature = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNATURE, SignerInfo.defaultValues(SIGNATURE));\n        if (UNSIGNED_ATTRS in parameters) {\n            this.unsignedAttrs = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, UNSIGNED_ATTRS, SignerInfo.defaultValues(UNSIGNED_ATTRS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$4:\n                return 0;\n            case SID:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Any();\n            case DIGEST_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case SIGNED_ATTRS:\n                return new SignedAndUnsignedAttributes({ type: 0 });\n            case SIGNATURE_ALGORITHM:\n                return new AlgorithmIdentifier();\n            case SIGNATURE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString();\n            case UNSIGNED_ATTRS:\n                return new SignedAndUnsignedAttributes({ type: 1 });\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$4:\n                return (SignerInfo.defaultValues(VERSION$4) === memberValue);\n            case SID:\n                return (memberValue instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any);\n            case DIGEST_ALGORITHM:\n                if ((memberValue instanceof AlgorithmIdentifier) === false)\n                    return false;\n                return memberValue.isEqual(SignerInfo.defaultValues(DIGEST_ALGORITHM));\n            case SIGNED_ATTRS:\n                return ((SignedAndUnsignedAttributes.compareWithDefault(\"type\", memberValue.type))\n                    && (SignedAndUnsignedAttributes.compareWithDefault(\"attributes\", memberValue.attributes))\n                    && (SignedAndUnsignedAttributes.compareWithDefault(\"encodedValue\", memberValue.encodedValue)));\n            case SIGNATURE_ALGORITHM:\n                if ((memberValue instanceof AlgorithmIdentifier) === false)\n                    return false;\n                return memberValue.isEqual(SignerInfo.defaultValues(SIGNATURE_ALGORITHM));\n            case SIGNATURE:\n            case UNSIGNED_ATTRS:\n                return ((SignedAndUnsignedAttributes.compareWithDefault(\"type\", memberValue.type))\n                    && (SignedAndUnsignedAttributes.compareWithDefault(\"attributes\", memberValue.attributes))\n                    && (SignedAndUnsignedAttributes.compareWithDefault(\"encodedValue\", memberValue.encodedValue)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: SIGNER_INFO,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || SIGNER_INFO_VERSION) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                    value: [\n                        IssuerAndSerialNumber.schema(names.sidSchema || {\n                            names: {\n                                blockName: SIGNER_INFO_SID\n                            }\n                        }),\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Choice({\n                            value: [\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                                    optional: true,\n                                    name: (names.sid || SIGNER_INFO_SID),\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 0\n                                    },\n                                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString()]\n                                }),\n                                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Primitive({\n                                    optional: true,\n                                    name: (names.sid || SIGNER_INFO_SID),\n                                    idBlock: {\n                                        tagClass: 3,\n                                        tagNumber: 0\n                                    }\n                                }),\n                            ]\n                        }),\n                    ]\n                }),\n                AlgorithmIdentifier.schema(names.digestAlgorithm || {\n                    names: {\n                        blockName: SIGNER_INFO_DIGEST_ALGORITHM\n                    }\n                }),\n                SignedAndUnsignedAttributes.schema(names.signedAttrs || {\n                    names: {\n                        blockName: SIGNER_INFO_SIGNED_ATTRS,\n                        tagNumber: 0\n                    }\n                }),\n                AlgorithmIdentifier.schema(names.signatureAlgorithm || {\n                    names: {\n                        blockName: SIGNER_INFO_SIGNATURE_ALGORITHM\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ name: (names.signature || SIGNER_INFO_SIGNATURE) }),\n                SignedAndUnsignedAttributes.schema(names.unsignedAttrs || {\n                    names: {\n                        blockName: SIGNER_INFO_UNSIGNED_ATTRS,\n                        tagNumber: 1\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$5);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SignerInfo.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result[SIGNER_INFO_VERSION].valueBlock.valueDec;\n        const currentSid = asn1.result[SIGNER_INFO_SID];\n        if (currentSid.idBlock.tagClass === 1)\n            this.sid = new IssuerAndSerialNumber({ schema: currentSid });\n        else\n            this.sid = currentSid;\n        this.digestAlgorithm = new AlgorithmIdentifier({ schema: asn1.result[SIGNER_INFO_DIGEST_ALGORITHM] });\n        if (SIGNER_INFO_SIGNED_ATTRS in asn1.result)\n            this.signedAttrs = new SignedAndUnsignedAttributes({ type: 0, schema: asn1.result[SIGNER_INFO_SIGNED_ATTRS] });\n        this.signatureAlgorithm = new AlgorithmIdentifier({ schema: asn1.result[SIGNER_INFO_SIGNATURE_ALGORITHM] });\n        this.signature = asn1.result[SIGNER_INFO_SIGNATURE];\n        if (SIGNER_INFO_UNSIGNED_ATTRS in asn1.result)\n            this.unsignedAttrs = new SignedAndUnsignedAttributes({ type: 1, schema: asn1.result[SIGNER_INFO_UNSIGNED_ATTRS] });\n    }\n    toSchema() {\n        if (SignerInfo.compareWithDefault(SID, this.sid))\n            throw new Error(\"Incorrectly initialized \\\"SignerInfo\\\" class\");\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        if (this.sid instanceof IssuerAndSerialNumber)\n            outputArray.push(this.sid.toSchema());\n        else\n            outputArray.push(this.sid);\n        outputArray.push(this.digestAlgorithm.toSchema());\n        if (this.signedAttrs) {\n            if (SignerInfo.compareWithDefault(SIGNED_ATTRS, this.signedAttrs) === false)\n                outputArray.push(this.signedAttrs.toSchema());\n        }\n        outputArray.push(this.signatureAlgorithm.toSchema());\n        outputArray.push(this.signature);\n        if (this.unsignedAttrs) {\n            if (SignerInfo.compareWithDefault(UNSIGNED_ATTRS, this.unsignedAttrs) === false)\n                outputArray.push(this.unsignedAttrs.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        if (SignerInfo.compareWithDefault(SID, this.sid)) {\n            throw new Error(\"Incorrectly initialized \\\"SignerInfo\\\" class\");\n        }\n        const res = {\n            version: this.version,\n            digestAlgorithm: this.digestAlgorithm.toJSON(),\n            signatureAlgorithm: this.signatureAlgorithm.toJSON(),\n            signature: this.signature.toJSON(),\n        };\n        if (!(this.sid instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any))\n            res.sid = this.sid.toJSON();\n        if (this.signedAttrs && SignerInfo.compareWithDefault(SIGNED_ATTRS, this.signedAttrs) === false) {\n            res.signedAttrs = this.signedAttrs.toJSON();\n        }\n        if (this.unsignedAttrs && SignerInfo.compareWithDefault(UNSIGNED_ATTRS, this.unsignedAttrs) === false) {\n            res.unsignedAttrs = this.unsignedAttrs.toJSON();\n        }\n        return res;\n    }\n}\nSignerInfo.CLASS_NAME = \"SignerInfo\";\n\nconst VERSION$3 = \"version\";\nconst POLICY = \"policy\";\nconst MESSAGE_IMPRINT$1 = \"messageImprint\";\nconst SERIAL_NUMBER = \"serialNumber\";\nconst GEN_TIME = \"genTime\";\nconst ORDERING = \"ordering\";\nconst NONCE$1 = \"nonce\";\nconst ACCURACY = \"accuracy\";\nconst TSA = \"tsa\";\nconst EXTENSIONS$1 = \"extensions\";\nconst TST_INFO = \"TSTInfo\";\nconst TST_INFO_VERSION = `${TST_INFO}.${VERSION$3}`;\nconst TST_INFO_POLICY = `${TST_INFO}.${POLICY}`;\nconst TST_INFO_MESSAGE_IMPRINT = `${TST_INFO}.${MESSAGE_IMPRINT$1}`;\nconst TST_INFO_SERIAL_NUMBER = `${TST_INFO}.${SERIAL_NUMBER}`;\nconst TST_INFO_GEN_TIME = `${TST_INFO}.${GEN_TIME}`;\nconst TST_INFO_ACCURACY = `${TST_INFO}.${ACCURACY}`;\nconst TST_INFO_ORDERING = `${TST_INFO}.${ORDERING}`;\nconst TST_INFO_NONCE = `${TST_INFO}.${NONCE$1}`;\nconst TST_INFO_TSA = `${TST_INFO}.${TSA}`;\nconst TST_INFO_EXTENSIONS = `${TST_INFO}.${EXTENSIONS$1}`;\nconst CLEAR_PROPS$4 = [\n    TST_INFO_VERSION,\n    TST_INFO_POLICY,\n    TST_INFO_MESSAGE_IMPRINT,\n    TST_INFO_SERIAL_NUMBER,\n    TST_INFO_GEN_TIME,\n    TST_INFO_ACCURACY,\n    TST_INFO_ORDERING,\n    TST_INFO_NONCE,\n    TST_INFO_TSA,\n    TST_INFO_EXTENSIONS\n];\nclass TSTInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$3, TSTInfo.defaultValues(VERSION$3));\n        this.policy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, POLICY, TSTInfo.defaultValues(POLICY));\n        this.messageImprint = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MESSAGE_IMPRINT$1, TSTInfo.defaultValues(MESSAGE_IMPRINT$1));\n        this.serialNumber = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SERIAL_NUMBER, TSTInfo.defaultValues(SERIAL_NUMBER));\n        this.genTime = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, GEN_TIME, TSTInfo.defaultValues(GEN_TIME));\n        if (ACCURACY in parameters) {\n            this.accuracy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ACCURACY, TSTInfo.defaultValues(ACCURACY));\n        }\n        if (ORDERING in parameters) {\n            this.ordering = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ORDERING, TSTInfo.defaultValues(ORDERING));\n        }\n        if (NONCE$1 in parameters) {\n            this.nonce = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NONCE$1, TSTInfo.defaultValues(NONCE$1));\n        }\n        if (TSA in parameters) {\n            this.tsa = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TSA, TSTInfo.defaultValues(TSA));\n        }\n        if (EXTENSIONS$1 in parameters) {\n            this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS$1, TSTInfo.defaultValues(EXTENSIONS$1));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$3:\n                return 0;\n            case POLICY:\n                return EMPTY_STRING;\n            case MESSAGE_IMPRINT$1:\n                return new MessageImprint();\n            case SERIAL_NUMBER:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case GEN_TIME:\n                return new Date(0, 0, 0);\n            case ACCURACY:\n                return new Accuracy();\n            case ORDERING:\n                return false;\n            case NONCE$1:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case TSA:\n                return new GeneralName();\n            case EXTENSIONS$1:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$3:\n            case POLICY:\n            case GEN_TIME:\n            case ORDERING:\n                return (memberValue === TSTInfo.defaultValues(ORDERING));\n            case MESSAGE_IMPRINT$1:\n                return ((MessageImprint.compareWithDefault(HASH_ALGORITHM, memberValue.hashAlgorithm)) &&\n                    (MessageImprint.compareWithDefault(HASHED_MESSAGE, memberValue.hashedMessage)));\n            case SERIAL_NUMBER:\n            case NONCE$1:\n                return (memberValue.isEqual(TSTInfo.defaultValues(NONCE$1)));\n            case ACCURACY:\n                return ((Accuracy.compareWithDefault(SECONDS, memberValue.seconds)) &&\n                    (Accuracy.compareWithDefault(MILLIS, memberValue.millis)) &&\n                    (Accuracy.compareWithDefault(MICROS, memberValue.micros)));\n            case TSA:\n                return ((GeneralName.compareWithDefault(TYPE$4, memberValue.type)) &&\n                    (GeneralName.compareWithDefault(VALUE$5, memberValue.value)));\n            case EXTENSIONS$1:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || TST_INFO),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || TST_INFO_VERSION) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ name: (names.policy || TST_INFO_POLICY) }),\n                MessageImprint.schema(names.messageImprint || {\n                    names: {\n                        blockName: TST_INFO_MESSAGE_IMPRINT\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.serialNumber || TST_INFO_SERIAL_NUMBER) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ name: (names.genTime || TST_INFO_GEN_TIME) }),\n                Accuracy.schema(names.accuracy || {\n                    names: {\n                        blockName: TST_INFO_ACCURACY\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({\n                    name: (names.ordering || TST_INFO_ORDERING),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    name: (names.nonce || TST_INFO_NONCE),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [GeneralName.schema(names.tsa || {\n                            names: {\n                                blockName: TST_INFO_TSA\n                            }\n                        })]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.extensions || TST_INFO_EXTENSIONS),\n                            value: Extension.schema(names.extension || {})\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$4);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, TSTInfo.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result[TST_INFO_VERSION].valueBlock.valueDec;\n        this.policy = asn1.result[TST_INFO_POLICY].valueBlock.toString();\n        this.messageImprint = new MessageImprint({ schema: asn1.result[TST_INFO_MESSAGE_IMPRINT] });\n        this.serialNumber = asn1.result[TST_INFO_SERIAL_NUMBER];\n        this.genTime = asn1.result[TST_INFO_GEN_TIME].toDate();\n        if (TST_INFO_ACCURACY in asn1.result)\n            this.accuracy = new Accuracy({ schema: asn1.result[TST_INFO_ACCURACY] });\n        if (TST_INFO_ORDERING in asn1.result)\n            this.ordering = asn1.result[TST_INFO_ORDERING].valueBlock.value;\n        if (TST_INFO_NONCE in asn1.result)\n            this.nonce = asn1.result[TST_INFO_NONCE];\n        if (TST_INFO_TSA in asn1.result)\n            this.tsa = new GeneralName({ schema: asn1.result[TST_INFO_TSA] });\n        if (TST_INFO_EXTENSIONS in asn1.result)\n            this.extensions = Array.from(asn1.result[TST_INFO_EXTENSIONS], element => new Extension({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.policy }));\n        outputArray.push(this.messageImprint.toSchema());\n        outputArray.push(this.serialNumber);\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.GeneralizedTime({ valueDate: this.genTime }));\n        if (this.accuracy)\n            outputArray.push(this.accuracy.toSchema());\n        if (this.ordering !== undefined)\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({ value: this.ordering }));\n        if (this.nonce)\n            outputArray.push(this.nonce);\n        if (this.tsa) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: [this.tsa.toSchema()]\n            }));\n        }\n        if (this.extensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                optional: true,\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.extensions, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            policy: this.policy,\n            messageImprint: this.messageImprint.toJSON(),\n            serialNumber: this.serialNumber.toJSON(),\n            genTime: this.genTime\n        };\n        if (this.accuracy)\n            res.accuracy = this.accuracy.toJSON();\n        if (this.ordering !== undefined)\n            res.ordering = this.ordering;\n        if (this.nonce)\n            res.nonce = this.nonce.toJSON();\n        if (this.tsa)\n            res.tsa = this.tsa.toJSON();\n        if (this.extensions)\n            res.extensions = Array.from(this.extensions, o => o.toJSON());\n        return res;\n    }\n    async verify(params, crypto = getCrypto(true)) {\n        if (!params.data) {\n            throw new Error(\"\\\"data\\\" is a mandatory attribute for TST_INFO verification\");\n        }\n        const data = params.data;\n        if (params.notBefore) {\n            if (this.genTime < params.notBefore)\n                throw new Error(\"Generation time for TSTInfo object is less than notBefore value\");\n        }\n        if (params.notAfter) {\n            if (this.genTime > params.notAfter)\n                throw new Error(\"Generation time for TSTInfo object is more than notAfter value\");\n        }\n        const shaAlgorithm = crypto.getAlgorithmByOID(this.messageImprint.hashAlgorithm.algorithmId, true, \"MessageImprint.hashAlgorithm\");\n        const hash = await crypto.digest(shaAlgorithm.name, new Uint8Array(data));\n        return pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.isEqual(hash, this.messageImprint.hashedMessage.valueBlock.valueHexView);\n    }\n}\nTSTInfo.CLASS_NAME = \"TSTInfo\";\n\nconst VERSION$2 = \"version\";\nconst DIGEST_ALGORITHMS = \"digestAlgorithms\";\nconst ENCAP_CONTENT_INFO = \"encapContentInfo\";\nconst CERTIFICATES = \"certificates\";\nconst CRLS = \"crls\";\nconst SIGNER_INFOS = \"signerInfos\";\nconst OCSPS = \"ocsps\";\nconst SIGNED_DATA = \"SignedData\";\nconst SIGNED_DATA_VERSION = `${SIGNED_DATA}.${VERSION$2}`;\nconst SIGNED_DATA_DIGEST_ALGORITHMS = `${SIGNED_DATA}.${DIGEST_ALGORITHMS}`;\nconst SIGNED_DATA_ENCAP_CONTENT_INFO = `${SIGNED_DATA}.${ENCAP_CONTENT_INFO}`;\nconst SIGNED_DATA_CERTIFICATES = `${SIGNED_DATA}.${CERTIFICATES}`;\nconst SIGNED_DATA_CRLS = `${SIGNED_DATA}.${CRLS}`;\nconst SIGNED_DATA_SIGNER_INFOS = `${SIGNED_DATA}.${SIGNER_INFOS}`;\nconst CLEAR_PROPS$3 = [\n    SIGNED_DATA_VERSION,\n    SIGNED_DATA_DIGEST_ALGORITHMS,\n    SIGNED_DATA_ENCAP_CONTENT_INFO,\n    SIGNED_DATA_CERTIFICATES,\n    SIGNED_DATA_CRLS,\n    SIGNED_DATA_SIGNER_INFOS\n];\nclass SignedDataVerifyError extends Error {\n    constructor({ message, code = 0, date = new Date(), signatureVerified = null, signerCertificate = null, signerCertificateVerified = null, timestampSerial = null, certificatePath = [], }) {\n        super(message);\n        this.name = \"SignedDataVerifyError\";\n        this.date = date;\n        this.code = code;\n        this.timestampSerial = timestampSerial;\n        this.signatureVerified = signatureVerified;\n        this.signerCertificate = signerCertificate;\n        this.signerCertificateVerified = signerCertificateVerified;\n        this.certificatePath = certificatePath;\n    }\n}\nclass SignedData extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$2, SignedData.defaultValues(VERSION$2));\n        this.digestAlgorithms = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, DIGEST_ALGORITHMS, SignedData.defaultValues(DIGEST_ALGORITHMS));\n        this.encapContentInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, ENCAP_CONTENT_INFO, SignedData.defaultValues(ENCAP_CONTENT_INFO));\n        if (CERTIFICATES in parameters) {\n            this.certificates = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERTIFICATES, SignedData.defaultValues(CERTIFICATES));\n        }\n        if (CRLS in parameters) {\n            this.crls = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CRLS, SignedData.defaultValues(CRLS));\n        }\n        if (OCSPS in parameters) {\n            this.ocsps = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, OCSPS, SignedData.defaultValues(OCSPS));\n        }\n        this.signerInfos = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, SIGNER_INFOS, SignedData.defaultValues(SIGNER_INFOS));\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$2:\n                return 0;\n            case DIGEST_ALGORITHMS:\n                return [];\n            case ENCAP_CONTENT_INFO:\n                return new EncapsulatedContentInfo();\n            case CERTIFICATES:\n                return [];\n            case CRLS:\n                return [];\n            case OCSPS:\n                return [];\n            case SIGNER_INFOS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$2:\n                return (memberValue === SignedData.defaultValues(VERSION$2));\n            case ENCAP_CONTENT_INFO:\n                return EncapsulatedContentInfo.compareWithDefault(\"eContentType\", memberValue.eContentType) &&\n                    EncapsulatedContentInfo.compareWithDefault(\"eContent\", memberValue.eContent);\n            case DIGEST_ALGORITHMS:\n            case CERTIFICATES:\n            case CRLS:\n            case OCSPS:\n            case SIGNER_INFOS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        if (names.optional === undefined) {\n            names.optional = false;\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || SIGNED_DATA),\n            optional: names.optional,\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || SIGNED_DATA_VERSION) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.digestAlgorithms || SIGNED_DATA_DIGEST_ALGORITHMS),\n                            value: AlgorithmIdentifier.schema()\n                        })\n                    ]\n                }),\n                EncapsulatedContentInfo.schema(names.encapContentInfo || {\n                    names: {\n                        blockName: SIGNED_DATA_ENCAP_CONTENT_INFO\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    name: (names.certificates || SIGNED_DATA_CERTIFICATES),\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: CertificateSet.schema().valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 1\n                    },\n                    value: RevocationInfoChoices.schema(names.crls || {\n                        names: {\n                            crls: SIGNED_DATA_CRLS\n                        }\n                    }).valueBlock.value\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.signerInfos || SIGNED_DATA_SIGNER_INFOS),\n                            value: SignerInfo.schema()\n                        })\n                    ]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$3);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, SignedData.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result[SIGNED_DATA_VERSION].valueBlock.valueDec;\n        if (SIGNED_DATA_DIGEST_ALGORITHMS in asn1.result)\n            this.digestAlgorithms = Array.from(asn1.result[SIGNED_DATA_DIGEST_ALGORITHMS], algorithm => new AlgorithmIdentifier({ schema: algorithm }));\n        this.encapContentInfo = new EncapsulatedContentInfo({ schema: asn1.result[SIGNED_DATA_ENCAP_CONTENT_INFO] });\n        if (SIGNED_DATA_CERTIFICATES in asn1.result) {\n            const certificateSet = new CertificateSet({\n                schema: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n                    value: asn1.result[SIGNED_DATA_CERTIFICATES].valueBlock.value\n                })\n            });\n            this.certificates = certificateSet.certificates.slice(0);\n        }\n        if (SIGNED_DATA_CRLS in asn1.result) {\n            this.crls = Array.from(asn1.result[SIGNED_DATA_CRLS], (crl) => {\n                if (crl.idBlock.tagClass === 1)\n                    return new CertificateRevocationList({ schema: crl });\n                crl.idBlock.tagClass = 1;\n                crl.idBlock.tagNumber = 16;\n                return new OtherRevocationInfoFormat({ schema: crl });\n            });\n        }\n        if (SIGNED_DATA_SIGNER_INFOS in asn1.result)\n            this.signerInfos = Array.from(asn1.result[SIGNED_DATA_SIGNER_INFOS], signerInfoSchema => new SignerInfo({ schema: signerInfoSchema }));\n    }\n    toSchema(encodeFlag = false) {\n        const outputArray = [];\n        if ((this.certificates && this.certificates.length && this.certificates.some(o => o instanceof OtherCertificateFormat))\n            || (this.crls && this.crls.length && this.crls.some(o => o instanceof OtherRevocationInfoFormat))) {\n            this.version = 5;\n        }\n        else if (this.certificates && this.certificates.length && this.certificates.some(o => o instanceof AttributeCertificateV2)) {\n            this.version = 4;\n        }\n        else if ((this.certificates && this.certificates.length && this.certificates.some(o => o instanceof AttributeCertificateV1))\n            || this.signerInfos.some(o => o.version === 3)\n            || this.encapContentInfo.eContentType !== SignedData.ID_DATA) {\n            this.version = 3;\n        }\n        else {\n            this.version = 1;\n        }\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            value: Array.from(this.digestAlgorithms, algorithm => algorithm.toSchema())\n        }));\n        outputArray.push(this.encapContentInfo.toSchema());\n        if (this.certificates) {\n            const certificateSet = new CertificateSet({ certificates: this.certificates });\n            const certificateSetSchema = certificateSet.toSchema();\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: certificateSetSchema.valueBlock.value\n            }));\n        }\n        if (this.crls) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 1\n                },\n                value: Array.from(this.crls, crl => {\n                    if (crl instanceof OtherRevocationInfoFormat) {\n                        const crlSchema = crl.toSchema();\n                        crlSchema.idBlock.tagClass = 3;\n                        crlSchema.idBlock.tagNumber = 1;\n                        return crlSchema;\n                    }\n                    return crl.toSchema(encodeFlag);\n                })\n            }));\n        }\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Set({\n            value: Array.from(this.signerInfos, signerInfo => signerInfo.toSchema())\n        }));\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            digestAlgorithms: Array.from(this.digestAlgorithms, algorithm => algorithm.toJSON()),\n            encapContentInfo: this.encapContentInfo.toJSON(),\n            signerInfos: Array.from(this.signerInfos, signerInfo => signerInfo.toJSON()),\n        };\n        if (this.certificates) {\n            res.certificates = Array.from(this.certificates, certificate => certificate.toJSON());\n        }\n        if (this.crls) {\n            res.crls = Array.from(this.crls, crl => crl.toJSON());\n        }\n        return res;\n    }\n    async verify({ signer = (-1), data = (EMPTY_BUFFER), trustedCerts = [], checkDate = (new Date()), checkChain = false, passedWhenNotRevValues = false, extendedMode = false, findOrigin = null, findIssuer = null } = {}, crypto = getCrypto(true)) {\n        let signerCert = null;\n        let timestampSerial = null;\n        try {\n            let messageDigestValue = EMPTY_BUFFER;\n            let shaAlgorithm = EMPTY_STRING;\n            let certificatePath = [];\n            const signerInfo = this.signerInfos[signer];\n            if (!signerInfo) {\n                throw new SignedDataVerifyError({\n                    date: checkDate,\n                    code: 1,\n                    message: \"Unable to get signer by supplied index\",\n                });\n            }\n            if (!this.certificates) {\n                throw new SignedDataVerifyError({\n                    date: checkDate,\n                    code: 2,\n                    message: \"No certificates attached to this signed data\",\n                });\n            }\n            if (signerInfo.sid instanceof IssuerAndSerialNumber) {\n                for (const certificate of this.certificates) {\n                    if (!(certificate instanceof Certificate))\n                        continue;\n                    if ((certificate.issuer.isEqual(signerInfo.sid.issuer)) &&\n                        (certificate.serialNumber.isEqual(signerInfo.sid.serialNumber))) {\n                        signerCert = certificate;\n                        break;\n                    }\n                }\n            }\n            else {\n                const sid = signerInfo.sid;\n                const keyId = sid.idBlock.isConstructed\n                    ? sid.valueBlock.value[0].valueBlock.valueHex\n                    : sid.valueBlock.valueHex;\n                for (const certificate of this.certificates) {\n                    if (!(certificate instanceof Certificate)) {\n                        continue;\n                    }\n                    const digest = await crypto.digest({ name: \"sha-1\" }, certificate.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);\n                    if (pvutils__WEBPACK_IMPORTED_MODULE_2__.isEqualBuffer(digest, keyId)) {\n                        signerCert = certificate;\n                        break;\n                    }\n                }\n            }\n            if (!signerCert) {\n                throw new SignedDataVerifyError({\n                    date: checkDate,\n                    code: 3,\n                    message: \"Unable to find signer certificate\",\n                });\n            }\n            if (this.encapContentInfo.eContentType === id_eContentType_TSTInfo) {\n                if (!this.encapContentInfo.eContent) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 15,\n                        message: \"Error during verification: TSTInfo eContent is empty\",\n                        signatureVerified: null,\n                        signerCertificate: signerCert,\n                        timestampSerial,\n                        signerCertificateVerified: true\n                    });\n                }\n                let tstInfo;\n                try {\n                    tstInfo = TSTInfo.fromBER(this.encapContentInfo.eContent.valueBlock.valueHexView);\n                }\n                catch (ex) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 15,\n                        message: \"Error during verification: TSTInfo wrong ASN.1 schema \",\n                        signatureVerified: null,\n                        signerCertificate: signerCert,\n                        timestampSerial,\n                        signerCertificateVerified: true\n                    });\n                }\n                checkDate = tstInfo.genTime;\n                timestampSerial = tstInfo.serialNumber.valueBlock.valueHexView.slice();\n                if (data.byteLength === 0) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 4,\n                        message: \"Missed detached data input array\",\n                    });\n                }\n                if (!(await tstInfo.verify({ data }, crypto))) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 15,\n                        message: \"Error during verification: TSTInfo verification is failed\",\n                        signatureVerified: false,\n                        signerCertificate: signerCert,\n                        timestampSerial,\n                        signerCertificateVerified: true\n                    });\n                }\n            }\n            if (checkChain) {\n                const certs = this.certificates.filter(certificate => (certificate instanceof Certificate && !!checkCA(certificate, signerCert)));\n                const chainParams = {\n                    checkDate,\n                    certs,\n                    trustedCerts,\n                };\n                if (findIssuer) {\n                    chainParams.findIssuer = findIssuer;\n                }\n                if (findOrigin) {\n                    chainParams.findOrigin = findOrigin;\n                }\n                const chainEngine = new CertificateChainValidationEngine(chainParams);\n                chainEngine.certs.push(signerCert);\n                if (this.crls) {\n                    for (const crl of this.crls) {\n                        if (\"thisUpdate\" in crl)\n                            chainEngine.crls.push(crl);\n                        else {\n                            if (crl.otherRevInfoFormat === id_PKIX_OCSP_Basic)\n                                chainEngine.ocsps.push(new BasicOCSPResponse({ schema: crl.otherRevInfo }));\n                        }\n                    }\n                }\n                if (this.ocsps) {\n                    chainEngine.ocsps.push(...(this.ocsps));\n                }\n                const verificationResult = await chainEngine.verify({ passedWhenNotRevValues }, crypto)\n                    .catch(e => {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 5,\n                        message: `Validation of signer's certificate failed with error: ${((e instanceof Object) ? e.resultMessage : e)}`,\n                        signerCertificate: signerCert,\n                        signerCertificateVerified: false\n                    });\n                });\n                if (verificationResult.certificatePath) {\n                    certificatePath = verificationResult.certificatePath;\n                }\n                if (!verificationResult.result)\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 5,\n                        message: `Validation of signer's certificate failed: ${verificationResult.resultMessage}`,\n                        signerCertificate: signerCert,\n                        signerCertificateVerified: false\n                    });\n            }\n            const signerInfoHashAlgorithm = crypto.getAlgorithmByOID(signerInfo.digestAlgorithm.algorithmId);\n            if (!(\"name\" in signerInfoHashAlgorithm)) {\n                throw new SignedDataVerifyError({\n                    date: checkDate,\n                    code: 7,\n                    message: `Unsupported signature algorithm: ${signerInfo.digestAlgorithm.algorithmId}`,\n                    signerCertificate: signerCert,\n                    signerCertificateVerified: true\n                });\n            }\n            shaAlgorithm = signerInfoHashAlgorithm.name;\n            const eContent = this.encapContentInfo.eContent;\n            if (eContent) {\n                if ((eContent.idBlock.tagClass === 1) &&\n                    (eContent.idBlock.tagNumber === 4)) {\n                    data = eContent.getValue();\n                }\n                else\n                    data = eContent.valueBlock.valueBeforeDecodeView;\n            }\n            else {\n                if (data.byteLength === 0) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 8,\n                        message: \"Missed detached data input array\",\n                        signerCertificate: signerCert,\n                        signerCertificateVerified: true\n                    });\n                }\n            }\n            if (signerInfo.signedAttrs) {\n                let foundContentType = false;\n                let foundMessageDigest = false;\n                for (const attribute of signerInfo.signedAttrs.attributes) {\n                    if (attribute.type === \"1.2.840.113549.1.9.3\")\n                        foundContentType = true;\n                    if (attribute.type === \"1.2.840.113549.1.9.4\") {\n                        foundMessageDigest = true;\n                        messageDigestValue = attribute.values[0].valueBlock.valueHex;\n                    }\n                    if (foundContentType && foundMessageDigest)\n                        break;\n                }\n                if (foundContentType === false) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 9,\n                        message: \"Attribute \\\"content-type\\\" is a mandatory attribute for \\\"signed attributes\\\"\",\n                        signerCertificate: signerCert,\n                        signerCertificateVerified: true\n                    });\n                }\n                if (foundMessageDigest === false) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 10,\n                        message: \"Attribute \\\"message-digest\\\" is a mandatory attribute for \\\"signed attributes\\\"\",\n                        signatureVerified: null,\n                        signerCertificate: signerCert,\n                        signerCertificateVerified: true\n                    });\n                }\n            }\n            if (signerInfo.signedAttrs) {\n                const messageDigest = await crypto.digest(shaAlgorithm, new Uint8Array(data));\n                if (!pvutils__WEBPACK_IMPORTED_MODULE_2__.isEqualBuffer(messageDigest, messageDigestValue)) {\n                    throw new SignedDataVerifyError({\n                        date: checkDate,\n                        code: 15,\n                        message: \"Error during verification: Message digest doesn't match\",\n                        signatureVerified: null,\n                        signerCertificate: signerCert,\n                        timestampSerial,\n                        signerCertificateVerified: true\n                    });\n                }\n                data = signerInfo.signedAttrs.encodedValue;\n            }\n            const verifyResult = signerInfo.signatureAlgorithm.algorithmId === \"1.2.840.113549.1.1.1\"\n                ? await crypto.verifyWithPublicKey(data, signerInfo.signature, signerCert.subjectPublicKeyInfo, signerInfo.signatureAlgorithm, shaAlgorithm)\n                : await crypto.verifyWithPublicKey(data, signerInfo.signature, signerCert.subjectPublicKeyInfo, signerInfo.signatureAlgorithm);\n            if (extendedMode) {\n                return {\n                    date: checkDate,\n                    code: 14,\n                    message: EMPTY_STRING,\n                    signatureVerified: verifyResult,\n                    signerCertificate: signerCert,\n                    timestampSerial,\n                    signerCertificateVerified: true,\n                    certificatePath\n                };\n            }\n            else {\n                return verifyResult;\n            }\n        }\n        catch (e) {\n            if (e instanceof SignedDataVerifyError) {\n                throw e;\n            }\n            throw new SignedDataVerifyError({\n                date: checkDate,\n                code: 15,\n                message: `Error during verification: ${e instanceof Error ? e.message : e}`,\n                signatureVerified: null,\n                signerCertificate: signerCert,\n                timestampSerial,\n                signerCertificateVerified: true\n            });\n        }\n    }\n    async sign(privateKey, signerIndex, hashAlgorithm = \"SHA-1\", data = (EMPTY_BUFFER), crypto = getCrypto(true)) {\n        var _a;\n        if (!privateKey)\n            throw new Error(\"Need to provide a private key for signing\");\n        const signerInfo = this.signerInfos[signerIndex];\n        if (!signerInfo) {\n            throw new RangeError(\"SignerInfo index is out of range\");\n        }\n        if (!((_a = signerInfo.signedAttrs) === null || _a === void 0 ? void 0 : _a.attributes.length) && \"hash\" in privateKey.algorithm && \"hash\" in privateKey.algorithm && privateKey.algorithm.hash) {\n            hashAlgorithm = privateKey.algorithm.hash.name;\n        }\n        const hashAlgorithmOID = crypto.getOIDByAlgorithm({ name: hashAlgorithm }, true, \"hashAlgorithm\");\n        if ((this.digestAlgorithms.filter(algorithm => algorithm.algorithmId === hashAlgorithmOID)).length === 0) {\n            this.digestAlgorithms.push(new AlgorithmIdentifier({\n                algorithmId: hashAlgorithmOID,\n                algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n            }));\n        }\n        signerInfo.digestAlgorithm = new AlgorithmIdentifier({\n            algorithmId: hashAlgorithmOID,\n            algorithmParams: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Null()\n        });\n        const signatureParams = await crypto.getSignatureParameters(privateKey, hashAlgorithm);\n        const parameters = signatureParams.parameters;\n        signerInfo.signatureAlgorithm = signatureParams.signatureAlgorithm;\n        if (signerInfo.signedAttrs) {\n            if (signerInfo.signedAttrs.encodedValue.byteLength !== 0)\n                data = signerInfo.signedAttrs.encodedValue;\n            else {\n                data = signerInfo.signedAttrs.toSchema().toBER();\n                const view = pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toUint8Array(data);\n                view[0] = 0x31;\n            }\n        }\n        else {\n            const eContent = this.encapContentInfo.eContent;\n            if (eContent) {\n                if ((eContent.idBlock.tagClass === 1) &&\n                    (eContent.idBlock.tagNumber === 4)) {\n                    data = eContent.getValue();\n                }\n                else\n                    data = eContent.valueBlock.valueBeforeDecodeView;\n            }\n            else {\n                if (data.byteLength === 0)\n                    throw new Error(\"Missed detached data input array\");\n            }\n        }\n        const signature = await crypto.signWithPrivateKey(data, privateKey, parameters);\n        signerInfo.signature = new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: signature });\n    }\n}\nSignedData.CLASS_NAME = \"SignedData\";\nSignedData.ID_DATA = id_ContentType_Data;\n\nconst VERSION$1 = \"version\";\nconst AUTH_SAFE = \"authSafe\";\nconst MAC_DATA = \"macData\";\nconst PARSED_VALUE = \"parsedValue\";\nconst CLERA_PROPS = [\n    VERSION$1,\n    AUTH_SAFE,\n    MAC_DATA\n];\nclass PFX extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION$1, PFX.defaultValues(VERSION$1));\n        this.authSafe = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, AUTH_SAFE, PFX.defaultValues(AUTH_SAFE));\n        if (MAC_DATA in parameters) {\n            this.macData = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MAC_DATA, PFX.defaultValues(MAC_DATA));\n        }\n        if (PARSED_VALUE in parameters) {\n            this.parsedValue = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, PARSED_VALUE, PFX.defaultValues(PARSED_VALUE));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION$1:\n                return 3;\n            case AUTH_SAFE:\n                return (new ContentInfo());\n            case MAC_DATA:\n                return (new MacData());\n            case PARSED_VALUE:\n                return {};\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION$1:\n                return (memberValue === PFX.defaultValues(memberName));\n            case AUTH_SAFE:\n                return ((ContentInfo.compareWithDefault(\"contentType\", memberValue.contentType)) &&\n                    (ContentInfo.compareWithDefault(\"content\", memberValue.content)));\n            case MAC_DATA:\n                return ((MacData.compareWithDefault(\"mac\", memberValue.mac)) &&\n                    (MacData.compareWithDefault(\"macSalt\", memberValue.macSalt)) &&\n                    (MacData.compareWithDefault(\"iterations\", memberValue.iterations)));\n            case PARSED_VALUE:\n                return ((memberValue instanceof Object) && (Object.keys(memberValue).length === 0));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || VERSION$1) }),\n                ContentInfo.schema(names.authSafe || {\n                    names: {\n                        blockName: AUTH_SAFE\n                    }\n                }),\n                MacData.schema(names.macData || {\n                    names: {\n                        blockName: MAC_DATA,\n                        optional: true\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLERA_PROPS);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PFX.schema({\n            names: {\n                version: VERSION$1,\n                authSafe: {\n                    names: {\n                        blockName: AUTH_SAFE\n                    }\n                },\n                macData: {\n                    names: {\n                        blockName: MAC_DATA\n                    }\n                }\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result.version.valueBlock.valueDec;\n        this.authSafe = new ContentInfo({ schema: asn1.result.authSafe });\n        if (MAC_DATA in asn1.result)\n            this.macData = new MacData({ schema: asn1.result.macData });\n    }\n    toSchema() {\n        const outputArray = [\n            new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }),\n            this.authSafe.toSchema()\n        ];\n        if (this.macData) {\n            outputArray.push(this.macData.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const output = {\n            version: this.version,\n            authSafe: this.authSafe.toJSON()\n        };\n        if (this.macData) {\n            output.macData = this.macData.toJSON();\n        }\n        return output;\n    }\n    async makeInternalValues(parameters = {}, crypto = getCrypto(true)) {\n        ArgumentError.assert(parameters, \"parameters\", \"object\");\n        if (!this.parsedValue) {\n            throw new Error(\"Please call \\\"parseValues\\\" function first in order to make \\\"parsedValue\\\" data\");\n        }\n        ParameterError.assertEmpty(this.parsedValue.integrityMode, \"integrityMode\", \"parsedValue\");\n        ParameterError.assertEmpty(this.parsedValue.authenticatedSafe, \"authenticatedSafe\", \"parsedValue\");\n        switch (this.parsedValue.integrityMode) {\n            case 0:\n                {\n                    if (!(\"iterations\" in parameters))\n                        throw new ParameterError(\"iterations\");\n                    ParameterError.assertEmpty(parameters.pbkdf2HashAlgorithm, \"pbkdf2HashAlgorithm\");\n                    ParameterError.assertEmpty(parameters.hmacHashAlgorithm, \"hmacHashAlgorithm\");\n                    ParameterError.assertEmpty(parameters.password, \"password\");\n                    const saltBuffer = new ArrayBuffer(64);\n                    const saltView = new Uint8Array(saltBuffer);\n                    crypto.getRandomValues(saltView);\n                    const data = this.parsedValue.authenticatedSafe.toSchema().toBER(false);\n                    this.authSafe = new ContentInfo({\n                        contentType: ContentInfo.DATA,\n                        content: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: data })\n                    });\n                    const result = await crypto.stampDataWithPassword({\n                        password: parameters.password,\n                        hashAlgorithm: parameters.hmacHashAlgorithm,\n                        salt: saltBuffer,\n                        iterationCount: parameters.iterations,\n                        contentToStamp: data\n                    });\n                    this.macData = new MacData({\n                        mac: new DigestInfo({\n                            digestAlgorithm: new AlgorithmIdentifier({\n                                algorithmId: crypto.getOIDByAlgorithm({ name: parameters.hmacHashAlgorithm }, true, \"hmacHashAlgorithm\"),\n                            }),\n                            digest: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: result })\n                        }),\n                        macSalt: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: saltBuffer }),\n                        iterations: parameters.iterations\n                    });\n                }\n                break;\n            case 1:\n                {\n                    if (!(\"signingCertificate\" in parameters)) {\n                        throw new ParameterError(\"signingCertificate\");\n                    }\n                    ParameterError.assertEmpty(parameters.privateKey, \"privateKey\");\n                    ParameterError.assertEmpty(parameters.hashAlgorithm, \"hashAlgorithm\");\n                    const toBeSigned = this.parsedValue.authenticatedSafe.toSchema().toBER(false);\n                    const cmsSigned = new SignedData({\n                        version: 1,\n                        encapContentInfo: new EncapsulatedContentInfo({\n                            eContentType: \"1.2.840.113549.1.7.1\",\n                            eContent: new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: toBeSigned })\n                        }),\n                        certificates: [parameters.signingCertificate]\n                    });\n                    const result = await crypto.digest({ name: parameters.hashAlgorithm }, new Uint8Array(toBeSigned));\n                    const signedAttr = [];\n                    signedAttr.push(new Attribute({\n                        type: \"1.2.840.113549.1.9.3\",\n                        values: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: \"1.2.840.113549.1.7.1\" })\n                        ]\n                    }));\n                    signedAttr.push(new Attribute({\n                        type: \"1.2.840.113549.1.9.5\",\n                        values: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.UTCTime({ valueDate: new Date() })\n                        ]\n                    }));\n                    signedAttr.push(new Attribute({\n                        type: \"1.2.840.113549.1.9.4\",\n                        values: [\n                            new asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString({ valueHex: result })\n                        ]\n                    }));\n                    cmsSigned.signerInfos.push(new SignerInfo({\n                        version: 1,\n                        sid: new IssuerAndSerialNumber({\n                            issuer: parameters.signingCertificate.issuer,\n                            serialNumber: parameters.signingCertificate.serialNumber\n                        }),\n                        signedAttrs: new SignedAndUnsignedAttributes({\n                            type: 0,\n                            attributes: signedAttr\n                        })\n                    }));\n                    await cmsSigned.sign(parameters.privateKey, 0, parameters.hashAlgorithm, undefined, crypto);\n                    this.authSafe = new ContentInfo({\n                        contentType: \"1.2.840.113549.1.7.2\",\n                        content: cmsSigned.toSchema(true)\n                    });\n                }\n                break;\n            default:\n                throw new Error(`Parameter \"integrityMode\" has unknown value: ${this.parsedValue.integrityMode}`);\n        }\n    }\n    async parseInternalValues(parameters, crypto = getCrypto(true)) {\n        ArgumentError.assert(parameters, \"parameters\", \"object\");\n        if (parameters.checkIntegrity === undefined) {\n            parameters.checkIntegrity = true;\n        }\n        this.parsedValue = {};\n        switch (this.authSafe.contentType) {\n            case ContentInfo.DATA:\n                {\n                    ParameterError.assertEmpty(parameters.password, \"password\");\n                    this.parsedValue.integrityMode = 0;\n                    ArgumentError.assert(this.authSafe.content, \"authSafe.content\", asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString);\n                    const authSafeContent = this.authSafe.content.getValue();\n                    this.parsedValue.authenticatedSafe = AuthenticatedSafe.fromBER(authSafeContent);\n                    if (parameters.checkIntegrity) {\n                        if (!this.macData) {\n                            throw new Error(\"Absent \\\"macData\\\" value, can not check PKCS#12 data integrity\");\n                        }\n                        const hashAlgorithm = crypto.getAlgorithmByOID(this.macData.mac.digestAlgorithm.algorithmId, true, \"digestAlgorithm\");\n                        const result = await crypto.verifyDataStampedWithPassword({\n                            password: parameters.password,\n                            hashAlgorithm: hashAlgorithm.name,\n                            salt: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.macData.macSalt.valueBlock.valueHexView),\n                            iterationCount: this.macData.iterations || 1,\n                            contentToVerify: authSafeContent,\n                            signatureToVerify: pvtsutils__WEBPACK_IMPORTED_MODULE_1__.BufferSourceConverter.toArrayBuffer(this.macData.mac.digest.valueBlock.valueHexView),\n                        });\n                        if (!result) {\n                            throw new Error(\"Integrity for the PKCS#12 data is broken!\");\n                        }\n                    }\n                }\n                break;\n            case ContentInfo.SIGNED_DATA:\n                {\n                    this.parsedValue.integrityMode = 1;\n                    const cmsSigned = new SignedData({ schema: this.authSafe.content });\n                    const eContent = cmsSigned.encapContentInfo.eContent;\n                    ParameterError.assert(eContent, \"eContent\", \"cmsSigned.encapContentInfo\");\n                    ArgumentError.assert(eContent, \"eContent\", asn1js__WEBPACK_IMPORTED_MODULE_0__.OctetString);\n                    const data = eContent.getValue();\n                    this.parsedValue.authenticatedSafe = AuthenticatedSafe.fromBER(data);\n                    const ok = await cmsSigned.verify({ signer: 0, checkChain: false }, crypto);\n                    if (!ok) {\n                        throw new Error(\"Integrity for the PKCS#12 data is broken!\");\n                    }\n                }\n                break;\n            default:\n                throw new Error(`Incorrect value for \"this.authSafe.contentType\": ${this.authSafe.contentType}`);\n        }\n    }\n}\nPFX.CLASS_NAME = \"PFX\";\n\nconst STATUS$1 = \"status\";\nconst STATUS_STRINGS = \"statusStrings\";\nconst FAIL_INFO = \"failInfo\";\nconst CLEAR_PROPS$2 = [\n    STATUS$1,\n    STATUS_STRINGS,\n    FAIL_INFO\n];\nvar PKIStatus;\n(function (PKIStatus) {\n    PKIStatus[PKIStatus[\"granted\"] = 0] = \"granted\";\n    PKIStatus[PKIStatus[\"grantedWithMods\"] = 1] = \"grantedWithMods\";\n    PKIStatus[PKIStatus[\"rejection\"] = 2] = \"rejection\";\n    PKIStatus[PKIStatus[\"waiting\"] = 3] = \"waiting\";\n    PKIStatus[PKIStatus[\"revocationWarning\"] = 4] = \"revocationWarning\";\n    PKIStatus[PKIStatus[\"revocationNotification\"] = 5] = \"revocationNotification\";\n})(PKIStatus || (PKIStatus = {}));\nclass PKIStatusInfo extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.status = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, STATUS$1, PKIStatusInfo.defaultValues(STATUS$1));\n        if (STATUS_STRINGS in parameters) {\n            this.statusStrings = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, STATUS_STRINGS, PKIStatusInfo.defaultValues(STATUS_STRINGS));\n        }\n        if (FAIL_INFO in parameters) {\n            this.failInfo = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, FAIL_INFO, PKIStatusInfo.defaultValues(FAIL_INFO));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case STATUS$1:\n                return 2;\n            case STATUS_STRINGS:\n                return [];\n            case FAIL_INFO:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case STATUS$1:\n                return (memberValue === PKIStatusInfo.defaultValues(memberName));\n            case STATUS_STRINGS:\n                return (memberValue.length === 0);\n            case FAIL_INFO:\n                return (memberValue.isEqual(PKIStatusInfo.defaultValues(memberName)));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || EMPTY_STRING),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.status || EMPTY_STRING) }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                    optional: true,\n                    value: [\n                        new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.statusStrings || EMPTY_STRING),\n                            value: new asn1js__WEBPACK_IMPORTED_MODULE_0__.Utf8String()\n                        })\n                    ]\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.BitString({\n                    name: (names.failInfo || EMPTY_STRING),\n                    optional: true\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$2);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, PKIStatusInfo.schema({\n            names: {\n                status: STATUS$1,\n                statusStrings: STATUS_STRINGS,\n                failInfo: FAIL_INFO\n            }\n        }));\n        AsnError.assertSchema(asn1, this.className);\n        const _status = asn1.result.status;\n        if ((_status.valueBlock.isHexOnly === true) ||\n            (_status.valueBlock.valueDec < 0) ||\n            (_status.valueBlock.valueDec > 5))\n            throw new Error(\"PKIStatusInfo \\\"status\\\" has invalid value\");\n        this.status = _status.valueBlock.valueDec;\n        if (STATUS_STRINGS in asn1.result)\n            this.statusStrings = asn1.result.statusStrings;\n        if (FAIL_INFO in asn1.result)\n            this.failInfo = asn1.result.failInfo;\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.status }));\n        if (this.statusStrings) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n                optional: true,\n                value: this.statusStrings\n            }));\n        }\n        if (this.failInfo) {\n            outputArray.push(this.failInfo);\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            status: this.status\n        };\n        if (this.statusStrings) {\n            res.statusStrings = Array.from(this.statusStrings, o => o.toJSON());\n        }\n        if (this.failInfo) {\n            res.failInfo = this.failInfo.toJSON();\n        }\n        return res;\n    }\n}\nPKIStatusInfo.CLASS_NAME = \"PKIStatusInfo\";\n\nconst VERSION = \"version\";\nconst MESSAGE_IMPRINT = \"messageImprint\";\nconst REQ_POLICY = \"reqPolicy\";\nconst NONCE = \"nonce\";\nconst CERT_REQ = \"certReq\";\nconst EXTENSIONS = \"extensions\";\nconst TIME_STAMP_REQ = \"TimeStampReq\";\nconst TIME_STAMP_REQ_VERSION = `${TIME_STAMP_REQ}.${VERSION}`;\nconst TIME_STAMP_REQ_MESSAGE_IMPRINT = `${TIME_STAMP_REQ}.${MESSAGE_IMPRINT}`;\nconst TIME_STAMP_REQ_POLICY = `${TIME_STAMP_REQ}.${REQ_POLICY}`;\nconst TIME_STAMP_REQ_NONCE = `${TIME_STAMP_REQ}.${NONCE}`;\nconst TIME_STAMP_REQ_CERT_REQ = `${TIME_STAMP_REQ}.${CERT_REQ}`;\nconst TIME_STAMP_REQ_EXTENSIONS = `${TIME_STAMP_REQ}.${EXTENSIONS}`;\nconst CLEAR_PROPS$1 = [\n    TIME_STAMP_REQ_VERSION,\n    TIME_STAMP_REQ_MESSAGE_IMPRINT,\n    TIME_STAMP_REQ_POLICY,\n    TIME_STAMP_REQ_NONCE,\n    TIME_STAMP_REQ_CERT_REQ,\n    TIME_STAMP_REQ_EXTENSIONS,\n];\nclass TimeStampReq extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.version = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, VERSION, TimeStampReq.defaultValues(VERSION));\n        this.messageImprint = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, MESSAGE_IMPRINT, TimeStampReq.defaultValues(MESSAGE_IMPRINT));\n        if (REQ_POLICY in parameters) {\n            this.reqPolicy = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, REQ_POLICY, TimeStampReq.defaultValues(REQ_POLICY));\n        }\n        if (NONCE in parameters) {\n            this.nonce = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, NONCE, TimeStampReq.defaultValues(NONCE));\n        }\n        if (CERT_REQ in parameters) {\n            this.certReq = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, CERT_REQ, TimeStampReq.defaultValues(CERT_REQ));\n        }\n        if (EXTENSIONS in parameters) {\n            this.extensions = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, EXTENSIONS, TimeStampReq.defaultValues(EXTENSIONS));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case VERSION:\n                return 0;\n            case MESSAGE_IMPRINT:\n                return new MessageImprint();\n            case REQ_POLICY:\n                return EMPTY_STRING;\n            case NONCE:\n                return new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer();\n            case CERT_REQ:\n                return false;\n            case EXTENSIONS:\n                return [];\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case VERSION:\n            case REQ_POLICY:\n            case CERT_REQ:\n                return (memberValue === TimeStampReq.defaultValues(memberName));\n            case MESSAGE_IMPRINT:\n                return ((MessageImprint.compareWithDefault(\"hashAlgorithm\", memberValue.hashAlgorithm)) &&\n                    (MessageImprint.compareWithDefault(\"hashedMessage\", memberValue.hashedMessage)));\n            case NONCE:\n                return (memberValue.isEqual(TimeStampReq.defaultValues(memberName)));\n            case EXTENSIONS:\n                return (memberValue.length === 0);\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || TIME_STAMP_REQ),\n            value: [\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ name: (names.version || TIME_STAMP_REQ_VERSION) }),\n                MessageImprint.schema(names.messageImprint || {\n                    names: {\n                        blockName: TIME_STAMP_REQ_MESSAGE_IMPRINT\n                    }\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({\n                    name: (names.reqPolicy || TIME_STAMP_REQ_POLICY),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({\n                    name: (names.nonce || TIME_STAMP_REQ_NONCE),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({\n                    name: (names.certReq || TIME_STAMP_REQ_CERT_REQ),\n                    optional: true\n                }),\n                new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                    optional: true,\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: 0\n                    },\n                    value: [new asn1js__WEBPACK_IMPORTED_MODULE_0__.Repeated({\n                            name: (names.extensions || TIME_STAMP_REQ_EXTENSIONS),\n                            value: Extension.schema()\n                        })]\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS$1);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, TimeStampReq.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.version = asn1.result[TIME_STAMP_REQ_VERSION].valueBlock.valueDec;\n        this.messageImprint = new MessageImprint({ schema: asn1.result[TIME_STAMP_REQ_MESSAGE_IMPRINT] });\n        if (TIME_STAMP_REQ_POLICY in asn1.result)\n            this.reqPolicy = asn1.result[TIME_STAMP_REQ_POLICY].valueBlock.toString();\n        if (TIME_STAMP_REQ_NONCE in asn1.result)\n            this.nonce = asn1.result[TIME_STAMP_REQ_NONCE];\n        if (TIME_STAMP_REQ_CERT_REQ in asn1.result)\n            this.certReq = asn1.result[TIME_STAMP_REQ_CERT_REQ].valueBlock.value;\n        if (TIME_STAMP_REQ_EXTENSIONS in asn1.result)\n            this.extensions = Array.from(asn1.result[TIME_STAMP_REQ_EXTENSIONS], element => new Extension({ schema: element }));\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Integer({ value: this.version }));\n        outputArray.push(this.messageImprint.toSchema());\n        if (this.reqPolicy)\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.ObjectIdentifier({ value: this.reqPolicy }));\n        if (this.nonce)\n            outputArray.push(this.nonce);\n        if ((CERT_REQ in this) && (TimeStampReq.compareWithDefault(CERT_REQ, this.certReq) === false))\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Boolean({ value: this.certReq }));\n        if (this.extensions) {\n            outputArray.push(new asn1js__WEBPACK_IMPORTED_MODULE_0__.Constructed({\n                idBlock: {\n                    tagClass: 3,\n                    tagNumber: 0\n                },\n                value: Array.from(this.extensions, o => o.toSchema())\n            }));\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            version: this.version,\n            messageImprint: this.messageImprint.toJSON()\n        };\n        if (this.reqPolicy !== undefined)\n            res.reqPolicy = this.reqPolicy;\n        if (this.nonce !== undefined)\n            res.nonce = this.nonce.toJSON();\n        if ((this.certReq !== undefined) && (TimeStampReq.compareWithDefault(CERT_REQ, this.certReq) === false))\n            res.certReq = this.certReq;\n        if (this.extensions) {\n            res.extensions = Array.from(this.extensions, o => o.toJSON());\n        }\n        return res;\n    }\n}\nTimeStampReq.CLASS_NAME = \"TimeStampReq\";\n\nconst STATUS = \"status\";\nconst TIME_STAMP_TOKEN = \"timeStampToken\";\nconst TIME_STAMP_RESP = \"TimeStampResp\";\nconst TIME_STAMP_RESP_STATUS = `${TIME_STAMP_RESP}.${STATUS}`;\nconst TIME_STAMP_RESP_TOKEN = `${TIME_STAMP_RESP}.${TIME_STAMP_TOKEN}`;\nconst CLEAR_PROPS = [\n    TIME_STAMP_RESP_STATUS,\n    TIME_STAMP_RESP_TOKEN\n];\nclass TimeStampResp extends PkiObject {\n    constructor(parameters = {}) {\n        super();\n        this.status = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, STATUS, TimeStampResp.defaultValues(STATUS));\n        if (TIME_STAMP_TOKEN in parameters) {\n            this.timeStampToken = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, TIME_STAMP_TOKEN, TimeStampResp.defaultValues(TIME_STAMP_TOKEN));\n        }\n        if (parameters.schema) {\n            this.fromSchema(parameters.schema);\n        }\n    }\n    static defaultValues(memberName) {\n        switch (memberName) {\n            case STATUS:\n                return new PKIStatusInfo();\n            case TIME_STAMP_TOKEN:\n                return new ContentInfo();\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static compareWithDefault(memberName, memberValue) {\n        switch (memberName) {\n            case STATUS:\n                return ((PKIStatusInfo.compareWithDefault(STATUS, memberValue.status)) &&\n                    ((\"statusStrings\" in memberValue) === false) &&\n                    ((\"failInfo\" in memberValue) === false));\n            case TIME_STAMP_TOKEN:\n                return ((memberValue.contentType === EMPTY_STRING) &&\n                    (memberValue.content instanceof asn1js__WEBPACK_IMPORTED_MODULE_0__.Any));\n            default:\n                return super.defaultValues(memberName);\n        }\n    }\n    static schema(parameters = {}) {\n        const names = pvutils__WEBPACK_IMPORTED_MODULE_2__.getParametersValue(parameters, \"names\", {});\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            name: (names.blockName || TIME_STAMP_RESP),\n            value: [\n                PKIStatusInfo.schema(names.status || {\n                    names: {\n                        blockName: TIME_STAMP_RESP_STATUS\n                    }\n                }),\n                ContentInfo.schema(names.timeStampToken || {\n                    names: {\n                        blockName: TIME_STAMP_RESP_TOKEN,\n                        optional: true\n                    }\n                })\n            ]\n        }));\n    }\n    fromSchema(schema) {\n        pvutils__WEBPACK_IMPORTED_MODULE_2__.clearProps(schema, CLEAR_PROPS);\n        const asn1 = asn1js__WEBPACK_IMPORTED_MODULE_0__.compareSchema(schema, schema, TimeStampResp.schema());\n        AsnError.assertSchema(asn1, this.className);\n        this.status = new PKIStatusInfo({ schema: asn1.result[TIME_STAMP_RESP_STATUS] });\n        if (TIME_STAMP_RESP_TOKEN in asn1.result)\n            this.timeStampToken = new ContentInfo({ schema: asn1.result[TIME_STAMP_RESP_TOKEN] });\n    }\n    toSchema() {\n        const outputArray = [];\n        outputArray.push(this.status.toSchema());\n        if (this.timeStampToken) {\n            outputArray.push(this.timeStampToken.toSchema());\n        }\n        return (new asn1js__WEBPACK_IMPORTED_MODULE_0__.Sequence({\n            value: outputArray\n        }));\n    }\n    toJSON() {\n        const res = {\n            status: this.status.toJSON()\n        };\n        if (this.timeStampToken) {\n            res.timeStampToken = this.timeStampToken.toJSON();\n        }\n        return res;\n    }\n    async sign(privateKey, hashAlgorithm, crypto = getCrypto(true)) {\n        this.assertContentType();\n        const signed = new SignedData({ schema: this.timeStampToken.content });\n        return signed.sign(privateKey, 0, hashAlgorithm, undefined, crypto);\n    }\n    async verify(verificationParameters = { signer: 0, trustedCerts: [], data: EMPTY_BUFFER }, crypto = getCrypto(true)) {\n        this.assertContentType();\n        const signed = new SignedData({ schema: this.timeStampToken.content });\n        return signed.verify(verificationParameters, crypto);\n    }\n    assertContentType() {\n        if (!this.timeStampToken) {\n            throw new Error(\"timeStampToken is absent in TSP response\");\n        }\n        if (this.timeStampToken.contentType !== id_ContentType_SignedData) {\n            throw new Error(`Wrong format of timeStampToken: ${this.timeStampToken.contentType}`);\n        }\n    }\n}\nTimeStampResp.CLASS_NAME = \"TimeStampResp\";\n\nfunction initCryptoEngine() {\n    if (typeof self !== \"undefined\") {\n        if (\"crypto\" in self) {\n            let engineName = \"webcrypto\";\n            if (\"webkitSubtle\" in self.crypto) {\n                engineName = \"safari\";\n            }\n            setEngine(engineName, new CryptoEngine({ name: engineName, crypto: crypto }));\n        }\n    }\n    else if (typeof crypto !== \"undefined\" && \"webcrypto\" in crypto) {\n        const name = \"NodeJS ^15\";\n        const nodeCrypto = crypto.webcrypto;\n        setEngine(name, new CryptoEngine({ name, crypto: nodeCrypto }));\n    }\n}\n\ninitCryptoEngine();\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcGtpanMvYnVpbGQvaW5kZXguZXMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsY0FBYztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFaUM7QUFDTTtBQUNXO0FBQ2Y7QUFDQTtBQUNPO0FBQ0k7QUFDUTs7QUFFdEQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRGQUE0RixFQUFFO0FBQzlGLDhDQUE4QyxLQUFLLG1CQUFtQiwyQkFBMkIsdUJBQXVCLGtCQUFrQjtBQUMxSTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsZ0JBQWdCLFFBQVEsaUJBQWlCLElBQUksSUFBSTtBQUNqSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsZ0JBQWdCLFFBQVEsaUJBQWlCLElBQUksZUFBZTtBQUNqSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsaUJBQWlCO0FBQ3pEO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCw0Q0FBNEM7QUFDekc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNB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L25vZGVfbW9kdWxlcy9wa2lqcy9idWlsZC9pbmRleC5lcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIENvcHlyaWdodCAoYykgMjAxNCwgR2xvYmFsU2lnblxuICogQ29weXJpZ2h0IChjKSAyMDE1LTIwMTksIFBlY3VsaWFyIFZlbnR1cmVzXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogXG4gKiBBdXRob3IgMjAxNC0yMDE5LCBZdXJ5IFN0cm96aGV2c2t5XG4gKiBcbiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dCBtb2RpZmljYXRpb24sXG4gKiBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zIGFyZSBtZXQ6XG4gKiBcbiAqICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLCB0aGlzXG4gKiAgIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLlxuICogXG4gKiAqIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSwgdGhpc1xuICogICBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3JcbiAqICAgb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cbiAqIFxuICogKiBOZWl0aGVyIHRoZSBuYW1lIG9mIHRoZSB7b3JnYW5pemF0aW9ufSBub3IgdGhlIG5hbWVzIG9mIGl0c1xuICogICBjb250cmlidXRvcnMgbWF5IGJlIHVzZWQgdG8gZW5kb3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzIGRlcml2ZWQgZnJvbVxuICogICB0aGlzIHNvZnR3YXJlIHdpdGhvdXQgc3BlY2lmaWMgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLlxuICogXG4gKiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIiBBTkRcbiAqIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEXG4gKiBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQVJFXG4gKiBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUIEhPTERFUiBPUiBDT05UUklCVVRPUlMgQkUgTElBQkxFIEZPUlxuICogQU5ZIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTXG4gKiAoSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFBST0NVUkVNRU5UIE9GIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7XG4gKiBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQgT05cbiAqIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUXG4gKiAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0YgVEhJU1xuICogU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4gKiBcbiAqL1xuXG5pbXBvcnQgKiBhcyBhc24xanMgZnJvbSAnYXNuMWpzJztcbmltcG9ydCAqIGFzIHB2dHN1dGlscyBmcm9tICdwdnRzdXRpbHMnO1xuaW1wb3J0IHsgQnVmZmVyU291cmNlQ29udmVydGVyIH0gZnJvbSAncHZ0c3V0aWxzJztcbmltcG9ydCAqIGFzIHB2dXRpbHMgZnJvbSAncHZ1dGlscyc7XG5pbXBvcnQgKiBhcyBicyBmcm9tICdieXRlc3RyZWFtanMnO1xuaW1wb3J0IHsgc2hhMSB9IGZyb20gJ0Bub2JsZS9oYXNoZXMvc2hhMSc7XG5pbXBvcnQgeyBzaGEyNTYgfSBmcm9tICdAbm9ibGUvaGFzaGVzL3NoYTI1Nic7XG5pbXBvcnQgeyBzaGE1MTIsIHNoYTM4NCB9IGZyb20gJ0Bub2JsZS9oYXNoZXMvc2hhNTEyJztcblxuY29uc3QgRU1QVFlfQlVGRkVSID0gbmV3IEFycmF5QnVmZmVyKDApO1xuY29uc3QgRU1QVFlfU1RSSU5HID0gXCJcIjtcblxuY2xhc3MgQXJndW1lbnRFcnJvciBleHRlbmRzIFR5cGVFcnJvciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMubmFtZSA9IEFyZ3VtZW50RXJyb3IuTkFNRTtcbiAgICB9XG4gICAgc3RhdGljIGlzVHlwZSh2YWx1ZSwgdHlwZSkge1xuICAgICAgICBpZiAodHlwZW9mIHR5cGUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGlmICh0eXBlID09PSBcIkFycmF5XCIgJiYgQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT09IFwiQXJyYXlCdWZmZXJcIiAmJiB2YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlID09PSBcIkFycmF5QnVmZmVyVmlld1wiICYmIEFycmF5QnVmZmVyLmlzVmlldyh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gdHlwZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgdHlwZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBzdGF0aWMgYXNzZXJ0KHZhbHVlLCBuYW1lLCAuLi50eXBlcykge1xuICAgICAgICBmb3IgKGNvbnN0IHR5cGUgb2YgdHlwZXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVHlwZSh2YWx1ZSwgdHlwZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdHlwZU5hbWVzID0gdHlwZXMubWFwKG8gPT4gbyBpbnN0YW5jZW9mIEZ1bmN0aW9uICYmIFwibmFtZVwiIGluIG8gPyBvLm5hbWUgOiBgJHtvfWApO1xuICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFcnJvcihgUGFyYW1ldGVyICcke25hbWV9JyBpcyBub3Qgb2YgdHlwZSAke3R5cGVOYW1lcy5sZW5ndGggPiAxID8gYCgke3R5cGVOYW1lcy5qb2luKFwiIG9yIFwiKX0pYCA6IHR5cGVOYW1lc1swXX1gKTtcbiAgICB9XG59XG5Bcmd1bWVudEVycm9yLk5BTUUgPSBcIkFyZ3VtZW50RXJyb3JcIjtcblxuY2xhc3MgUGFyYW1ldGVyRXJyb3IgZXh0ZW5kcyBUeXBlRXJyb3Ige1xuICAgIHN0YXRpYyBhc3NlcnQoLi4uYXJncykge1xuICAgICAgICBsZXQgdGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgbGV0IHBhcmFtcztcbiAgICAgICAgbGV0IGZpZWxkcztcbiAgICAgICAgaWYgKHR5cGVvZiBhcmdzWzBdID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0YXJnZXQgPSBhcmdzWzBdO1xuICAgICAgICAgICAgcGFyYW1zID0gYXJnc1sxXTtcbiAgICAgICAgICAgIGZpZWxkcyA9IGFyZ3Muc2xpY2UoMik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwYXJhbXMgPSBhcmdzWzBdO1xuICAgICAgICAgICAgZmllbGRzID0gYXJncy5zbGljZSgxKTtcbiAgICAgICAgfVxuICAgICAgICBBcmd1bWVudEVycm9yLmFzc2VydChwYXJhbXMsIFwicGFyYW1ldGVyc1wiLCBcIm9iamVjdFwiKTtcbiAgICAgICAgZm9yIChjb25zdCBmaWVsZCBvZiBmaWVsZHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gcGFyYW1zW2ZpZWxkXTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFBhcmFtZXRlckVycm9yKGZpZWxkLCB0YXJnZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBhc3NlcnRFbXB0eSh2YWx1ZSwgbmFtZSwgdGFyZ2V0KSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUGFyYW1ldGVyRXJyb3IobmFtZSwgdGFyZ2V0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihmaWVsZCwgdGFyZ2V0ID0gbnVsbCwgbWVzc2FnZSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm5hbWUgPSBQYXJhbWV0ZXJFcnJvci5OQU1FO1xuICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7XG4gICAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gYEFic2VudCBtYW5kYXRvcnkgcGFyYW1ldGVyICcke2ZpZWxkfScgJHt0YXJnZXQgPyBgIGluICcke3RhcmdldH0nYCA6IEVNUFRZX1NUUklOR31gO1xuICAgICAgICB9XG4gICAgfVxufVxuUGFyYW1ldGVyRXJyb3IuTkFNRSA9IFwiUGFyYW1ldGVyRXJyb3JcIjtcblxuY2xhc3MgQXNuRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgc3RhdGljIGFzc2VydFNjaGVtYShhc24xLCB0YXJnZXQpIHtcbiAgICAgICAgaWYgKCFhc24xLnZlcmlmaWVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE9iamVjdCdzIHNjaGVtYSB3YXMgbm90IHZlcmlmaWVkIGFnYWluc3QgaW5wdXQgZGF0YSBmb3IgJHt0YXJnZXR9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGFzc2VydChhc24sIHRhcmdldCkge1xuICAgICAgICBpZiAoYXNuLm9mZnNldCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBc25FcnJvcihgRXJyb3IgZHVyaW5nIHBhcnNpbmcgb2YgQVNOLjEgZGF0YS4gRGF0YSBpcyBub3QgY29ycmVjdCBmb3IgJyR7dGFyZ2V0fScuYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSkge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5uYW1lID0gXCJBc25FcnJvclwiO1xuICAgIH1cbn1cblxuY2xhc3MgUGtpT2JqZWN0IHtcbiAgICBzdGF0aWMgYmxvY2tOYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5DTEFTU19OQU1FO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUJFUihyYXcpIHtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5mcm9tQkVSKHJhdyk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydChhc24xLCB0aGlzLm5hbWUpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyB0aGlzKHsgc2NoZW1hOiBhc24xLnJlc3VsdCB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFzbkVycm9yKGBDYW5ub3QgY3JlYXRlICcke3RoaXMuQ0xBU1NfTkFNRX0nIGZyb20gQVNOLjEgb2JqZWN0YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgbWVtYmVyIG5hbWUgZm9yICR7dGhpcy5DTEFTU19OQU1FfSBjbGFzczogJHttZW1iZXJOYW1lfWApO1xuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1ldGhvZCAnJHt0aGlzLkNMQVNTX05BTUV9LnNjaGVtYScgc2hvdWxkIGJlIG92ZXJyaWRkZW5gKTtcbiAgICB9XG4gICAgZ2V0IGNsYXNzTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IuQ0xBU1NfTkFNRTtcbiAgICB9XG4gICAgdG9TdHJpbmcoZW5jb2RpbmcgPSBcImhleFwiKSB7XG4gICAgICAgIGxldCBzY2hlbWE7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBzY2hlbWEgPSB0aGlzLnRvU2NoZW1hKCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgc2NoZW1hID0gdGhpcy50b1NjaGVtYSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHZ0c3V0aWxzLkNvbnZlcnQuVG9TdHJpbmcoc2NoZW1hLnRvQkVSKCksIGVuY29kaW5nKTtcbiAgICB9XG59XG5Qa2lPYmplY3QuQ0xBU1NfTkFNRSA9IFwiUGtpT2JqZWN0XCI7XG5cbmZ1bmN0aW9uIHN0cmluZ1ByZXAoaW5wdXRTdHJpbmcpIHtcbiAgICBsZXQgaXNTcGFjZSA9IGZhbHNlO1xuICAgIGxldCBjdXRSZXN1bHQgPSBFTVBUWV9TVFJJTkc7XG4gICAgY29uc3QgcmVzdWx0ID0gaW5wdXRTdHJpbmcudHJpbSgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChyZXN1bHQuY2hhckNvZGVBdChpKSA9PT0gMzIpIHtcbiAgICAgICAgICAgIGlmIChpc1NwYWNlID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICBpc1NwYWNlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpc1NwYWNlKSB7XG4gICAgICAgICAgICAgICAgY3V0UmVzdWx0ICs9IFwiIFwiO1xuICAgICAgICAgICAgICAgIGlzU3BhY2UgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1dFJlc3VsdCArPSByZXN1bHRbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGN1dFJlc3VsdC50b0xvd2VyQ2FzZSgpO1xufVxuXG5jb25zdCBUWVBFJDUgPSBcInR5cGVcIjtcbmNvbnN0IFZBTFVFJDYgPSBcInZhbHVlXCI7XG5jbGFzcyBBdHRyaWJ1dGVUeXBlQW5kVmFsdWUgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnR5cGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBUWVBFJDUsIEF0dHJpYnV0ZVR5cGVBbmRWYWx1ZS5kZWZhdWx0VmFsdWVzKFRZUEUkNSkpO1xuICAgICAgICB0aGlzLnZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkFMVUUkNiwgQXR0cmlidXRlVHlwZUFuZFZhbHVlLmRlZmF1bHRWYWx1ZXMoVkFMVUUkNikpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVFlQRSQ1OlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIFZBTFVFJDY6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMudHlwZSB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQW55KHsgbmFtZTogKG5hbWVzLnZhbHVlIHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBbXG4gICAgICAgICAgICBUWVBFJDUsXG4gICAgICAgICAgICBcInR5cGVWYWx1ZVwiXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEF0dHJpYnV0ZVR5cGVBbmRWYWx1ZS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBUWVBFJDUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IFwidHlwZVZhbHVlXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnR5cGUgPSBhc24xLnJlc3VsdC50eXBlLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IGFzbjEucmVzdWx0LnR5cGVWYWx1ZTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLnR5cGUgfSksXG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgX29iamVjdCA9IHtcbiAgICAgICAgICAgIHR5cGU6IHRoaXMudHlwZVxuICAgICAgICB9O1xuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy52YWx1ZSkubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICBfb2JqZWN0LnZhbHVlID0gKHRoaXMudmFsdWUpLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgX29iamVjdC52YWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9vYmplY3Q7XG4gICAgfVxuICAgIGlzRXF1YWwoY29tcGFyZVRvKSB7XG4gICAgICAgIGNvbnN0IHN0cmluZ0Jsb2NrTmFtZXMgPSBbXG4gICAgICAgICAgICBhc24xanMuVXRmOFN0cmluZy5ibG9ja05hbWUoKSxcbiAgICAgICAgICAgIGFzbjFqcy5CbXBTdHJpbmcuYmxvY2tOYW1lKCksXG4gICAgICAgICAgICBhc24xanMuVW5pdmVyc2FsU3RyaW5nLmJsb2NrTmFtZSgpLFxuICAgICAgICAgICAgYXNuMWpzLk51bWVyaWNTdHJpbmcuYmxvY2tOYW1lKCksXG4gICAgICAgICAgICBhc24xanMuUHJpbnRhYmxlU3RyaW5nLmJsb2NrTmFtZSgpLFxuICAgICAgICAgICAgYXNuMWpzLlRlbGV0ZXhTdHJpbmcuYmxvY2tOYW1lKCksXG4gICAgICAgICAgICBhc24xanMuVmlkZW90ZXhTdHJpbmcuYmxvY2tOYW1lKCksXG4gICAgICAgICAgICBhc24xanMuSUE1U3RyaW5nLmJsb2NrTmFtZSgpLFxuICAgICAgICAgICAgYXNuMWpzLkdyYXBoaWNTdHJpbmcuYmxvY2tOYW1lKCksXG4gICAgICAgICAgICBhc24xanMuVmlzaWJsZVN0cmluZy5ibG9ja05hbWUoKSxcbiAgICAgICAgICAgIGFzbjFqcy5HZW5lcmFsU3RyaW5nLmJsb2NrTmFtZSgpLFxuICAgICAgICAgICAgYXNuMWpzLkNoYXJhY3RlclN0cmluZy5ibG9ja05hbWUoKVxuICAgICAgICBdO1xuICAgICAgICBpZiAoY29tcGFyZVRvIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLmlzRXF1YWwodGhpcy52YWx1ZS52YWx1ZUJlZm9yZURlY29kZVZpZXcsIGNvbXBhcmVUbyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbXBhcmVUby5jb25zdHJ1Y3Rvci5ibG9ja05hbWUoKSA9PT0gQXR0cmlidXRlVHlwZUFuZFZhbHVlLmJsb2NrTmFtZSgpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy50eXBlICE9PSBjb21wYXJlVG8udHlwZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBpc1N0cmluZ1BhaXIgPSBbZmFsc2UsIGZhbHNlXTtcbiAgICAgICAgICAgIGNvbnN0IHRoaXNOYW1lID0gdGhpcy52YWx1ZS5jb25zdHJ1Y3Rvci5ibG9ja05hbWUoKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbmFtZSBvZiBzdHJpbmdCbG9ja05hbWVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXNOYW1lID09PSBuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzU3RyaW5nUGFpclswXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjb21wYXJlVG8udmFsdWUuY29uc3RydWN0b3IuYmxvY2tOYW1lKCkgPT09IG5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNTdHJpbmdQYWlyWzFdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNTdHJpbmdQYWlyWzBdICE9PSBpc1N0cmluZ1BhaXJbMV0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBpc1N0cmluZyA9IChpc1N0cmluZ1BhaXJbMF0gJiYgaXNTdHJpbmdQYWlyWzFdKTtcbiAgICAgICAgICAgIGlmIChpc1N0cmluZykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlMSA9IHN0cmluZ1ByZXAodGhpcy52YWx1ZS52YWx1ZUJsb2NrLnZhbHVlKTtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZTIgPSBzdHJpbmdQcmVwKGNvbXBhcmVUby52YWx1ZS52YWx1ZUJsb2NrLnZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUxLmxvY2FsZUNvbXBhcmUodmFsdWUyKSAhPT0gMClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCFwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLmlzRXF1YWwodGhpcy52YWx1ZS52YWx1ZUJlZm9yZURlY29kZVZpZXcsIGNvbXBhcmVUby52YWx1ZS52YWx1ZUJlZm9yZURlY29kZVZpZXcpKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuQXR0cmlidXRlVHlwZUFuZFZhbHVlLkNMQVNTX05BTUUgPSBcIkF0dHJpYnV0ZVR5cGVBbmRWYWx1ZVwiO1xuXG5jb25zdCBUWVBFX0FORF9WQUxVRVMgPSBcInR5cGVzQW5kVmFsdWVzXCI7XG5jb25zdCBWQUxVRV9CRUZPUkVfREVDT0RFID0gXCJ2YWx1ZUJlZm9yZURlY29kZVwiO1xuY29uc3QgUkROID0gXCJSRE5cIjtcbmNsYXNzIFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50eXBlc0FuZFZhbHVlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRZUEVfQU5EX1ZBTFVFUywgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMuZGVmYXVsdFZhbHVlcyhUWVBFX0FORF9WQUxVRVMpKTtcbiAgICAgICAgdGhpcy52YWx1ZUJlZm9yZURlY29kZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZBTFVFX0JFRk9SRV9ERUNPREUsIFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzLmRlZmF1bHRWYWx1ZXMoVkFMVUVfQkVGT1JFX0RFQ09ERSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVFlQRV9BTkRfVkFMVUVTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgVkFMVUVfQkVGT1JFX0RFQ09ERTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfQlVGRkVSO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUWVBFX0FORF9WQUxVRVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBWQUxVRV9CRUZPUkVfREVDT0RFOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuYnl0ZUxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMucmVwZWF0ZWRTZXF1ZW5jZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnJlcGVhdGVkU2V0IHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBdHRyaWJ1dGVUeXBlQW5kVmFsdWUuc2NoZW1hKG5hbWVzLnR5cGVBbmRWYWx1ZSB8fCB7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgW1xuICAgICAgICAgICAgUkROLFxuICAgICAgICAgICAgVFlQRV9BTkRfVkFMVUVTXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogUkROLFxuICAgICAgICAgICAgICAgIHJlcGVhdGVkU2V0OiBUWVBFX0FORF9WQUxVRVNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoVFlQRV9BTkRfVkFMVUVTIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLnR5cGVzQW5kVmFsdWVzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC50eXBlc0FuZFZhbHVlcywgZWxlbWVudCA9PiBuZXcgQXR0cmlidXRlVHlwZUFuZFZhbHVlKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZhbHVlQmVmb3JlRGVjb2RlID0gYXNuMS5yZXN1bHQuUkROLnZhbHVlQmVmb3JlRGVjb2RlVmlldy5zbGljZSgpLmJ1ZmZlcjtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGlmICh0aGlzLnZhbHVlQmVmb3JlRGVjb2RlLmJ5dGVMZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLlNldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLnR5cGVzQW5kVmFsdWVzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgICAgICAgICAgfSldXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5mcm9tQkVSKHRoaXMudmFsdWVCZWZvcmVEZWNvZGUpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnQoYXNuMSwgXCJSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lc1wiKTtcbiAgICAgICAgaWYgKCEoYXNuMS5yZXN1bHQgaW5zdGFuY2VvZiBhc24xanMuU2VxdWVuY2UpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBU04uMSByZXN1bHQgc2hvdWxkIGJlIFNFUVVFTkNFXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhc24xLnJlc3VsdDtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZXNBbmRWYWx1ZXM6IEFycmF5LmZyb20odGhpcy50eXBlc0FuZFZhbHVlcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbiAgICBpc0VxdWFsKGNvbXBhcmVUbykge1xuICAgICAgICBpZiAoY29tcGFyZVRvIGluc3RhbmNlb2YgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnR5cGVzQW5kVmFsdWVzLmxlbmd0aCAhPT0gY29tcGFyZVRvLnR5cGVzQW5kVmFsdWVzLmxlbmd0aClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtpbmRleCwgdHlwZUFuZFZhbHVlXSBvZiB0aGlzLnR5cGVzQW5kVmFsdWVzLmVudHJpZXMoKSkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlQW5kVmFsdWUuaXNFcXVhbChjb21wYXJlVG8udHlwZXNBbmRWYWx1ZXNbaW5kZXhdKSA9PT0gZmFsc2UpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb21wYXJlVG8gaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgICAgICAgICAgcmV0dXJuIHB2dXRpbHMuaXNFcXVhbEJ1ZmZlcih0aGlzLnZhbHVlQmVmb3JlRGVjb2RlLCBjb21wYXJlVG8pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG5SZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcy5DTEFTU19OQU1FID0gXCJSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lc1wiO1xuXG5jb25zdCBUWVBFJDQgPSBcInR5cGVcIjtcbmNvbnN0IFZBTFVFJDUgPSBcInZhbHVlXCI7XG5mdW5jdGlvbiBidWlsdEluU3RhbmRhcmRBdHRyaWJ1dGVzKHBhcmFtZXRlcnMgPSB7fSwgb3B0aW9uYWwgPSBmYWxzZSkge1xuICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAyLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5jb3VudHJ5X25hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuTnVtZXJpY1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbnRhYmxlU3RyaW5nKClcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDIsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmFkbWluaXN0cmF0aW9uX2RvbWFpbl9uYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk51bWVyaWNTdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW50YWJsZVN0cmluZygpXG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMubmV0d29ya19hZGRyZXNzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgaXNIZXhPbmx5OiB0cnVlXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy50ZXJtaW5hbF9pZGVudGlmaWVyIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgaXNIZXhPbmx5OiB0cnVlXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnByaXZhdGVfZG9tYWluX25hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuTnVtZXJpY1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbnRhYmxlU3RyaW5nKClcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDNcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vcmdhbml6YXRpb25fbmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgIGlzSGV4T25seTogdHJ1ZVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm51bWVyaWNfdXNlcl9pZGVudGlmaWVyIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiA0XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBpc0hleE9ubHk6IHRydWVcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnBlcnNvbmFsX25hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDVcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0hleE9ubHk6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzSGV4T25seTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNIZXhPbmx5OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0hleE9ubHk6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vcmdhbml6YXRpb25hbF91bml0X25hbWVzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiA2XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuZXcgYXNuMWpzLlByaW50YWJsZVN0cmluZygpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSlcbiAgICAgICAgXVxuICAgIH0pKTtcbn1cbmZ1bmN0aW9uIGJ1aWx0SW5Eb21haW5EZWZpbmVkQXR0cmlidXRlcyhvcHRpb25hbCA9IGZhbHNlKSB7XG4gICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICBuZXcgYXNuMWpzLlByaW50YWJsZVN0cmluZygpLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmludGFibGVTdHJpbmcoKVxuICAgICAgICBdXG4gICAgfSkpO1xufVxuZnVuY3Rpb24gZXh0ZW5zaW9uQXR0cmlidXRlcyhvcHRpb25hbCA9IGZhbHNlKSB7XG4gICAgcmV0dXJuIChuZXcgYXNuMWpzLlNldCh7XG4gICAgICAgIG9wdGlvbmFsLFxuICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaXNIZXhPbmx5OiB0cnVlXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkFueSgpXVxuICAgICAgICAgICAgfSlcbiAgICAgICAgXVxuICAgIH0pKTtcbn1cbmNsYXNzIEdlbmVyYWxOYW1lIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50eXBlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVFlQRSQ0LCBHZW5lcmFsTmFtZS5kZWZhdWx0VmFsdWVzKFRZUEUkNCkpO1xuICAgICAgICB0aGlzLnZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkFMVUUkNSwgR2VuZXJhbE5hbWUuZGVmYXVsdFZhbHVlcyhWQUxVRSQ1KSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUWVBFJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDk7XG4gICAgICAgICAgICBjYXNlIFZBTFVFJDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUWVBFJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gR2VuZXJhbE5hbWUuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSk7XG4gICAgICAgICAgICBjYXNlIFZBTFVFJDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChPYmplY3Qua2V5cyhtZW1iZXJWYWx1ZSkubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkFueSgpXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDNcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgYnVpbHRJblN0YW5kYXJkQXR0cmlidXRlcygobmFtZXMuYnVpbHRJblN0YW5kYXJkQXR0cmlidXRlcyB8fCB7fSksIGZhbHNlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWx0SW5Eb21haW5EZWZpbmVkQXR0cmlidXRlcyh0cnVlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvbkF0dHJpYnV0ZXModHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogNFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMuc2NoZW1hKG5hbWVzLmRpcmVjdG9yeU5hbWUgfHwge30pXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogNVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5UZWxldGV4U3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmludGFibGVTdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlVuaXZlcnNhbFN0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuVXRmOFN0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQm1wU3RyaW5nKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlRlbGV0ZXhTdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW50YWJsZVN0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuVW5pdmVyc2FsU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5VdGY4U3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5CbXBTdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDZcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogN1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiA4XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIFtcbiAgICAgICAgICAgIFwiYmxvY2tOYW1lXCIsXG4gICAgICAgICAgICBcIm90aGVyTmFtZVwiLFxuICAgICAgICAgICAgXCJyZmM4MjJOYW1lXCIsXG4gICAgICAgICAgICBcImROU05hbWVcIixcbiAgICAgICAgICAgIFwieDQwMEFkZHJlc3NcIixcbiAgICAgICAgICAgIFwiZGlyZWN0b3J5TmFtZVwiLFxuICAgICAgICAgICAgXCJlZGlQYXJ0eU5hbWVcIixcbiAgICAgICAgICAgIFwidW5pZm9ybVJlc291cmNlSWRlbnRpZmllclwiLFxuICAgICAgICAgICAgXCJpUEFkZHJlc3NcIixcbiAgICAgICAgICAgIFwicmVnaXN0ZXJlZElEXCJcbiAgICAgICAgXSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgR2VuZXJhbE5hbWUuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBcImJsb2NrTmFtZVwiLFxuICAgICAgICAgICAgICAgIG90aGVyTmFtZTogXCJvdGhlck5hbWVcIixcbiAgICAgICAgICAgICAgICByZmM4MjJOYW1lOiBcInJmYzgyMk5hbWVcIixcbiAgICAgICAgICAgICAgICBkTlNOYW1lOiBcImROU05hbWVcIixcbiAgICAgICAgICAgICAgICB4NDAwQWRkcmVzczogXCJ4NDAwQWRkcmVzc1wiLFxuICAgICAgICAgICAgICAgIGRpcmVjdG9yeU5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogXCJkaXJlY3RvcnlOYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZWRpUGFydHlOYW1lOiBcImVkaVBhcnR5TmFtZVwiLFxuICAgICAgICAgICAgICAgIHVuaWZvcm1SZXNvdXJjZUlkZW50aWZpZXI6IFwidW5pZm9ybVJlc291cmNlSWRlbnRpZmllclwiLFxuICAgICAgICAgICAgICAgIGlQQWRkcmVzczogXCJpUEFkZHJlc3NcIixcbiAgICAgICAgICAgICAgICByZWdpc3RlcmVkSUQ6IFwicmVnaXN0ZXJlZElEXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnR5cGUgPSBhc24xLnJlc3VsdC5ibG9ja05hbWUuaWRCbG9jay50YWdOdW1iZXI7XG4gICAgICAgIHN3aXRjaCAodGhpcy50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFzbjEucmVzdWx0LmJsb2NrTmFtZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXNuMS5yZXN1bHQuYmxvY2tOYW1lO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZS5pZEJsb2NrLnRhZ0NsYXNzID0gMTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUuaWRCbG9jay50YWdOdW1iZXIgPSAyMjtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVCRVIgPSB2YWx1ZS50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFzblZhbHVlID0gYXNuMWpzLmZyb21CRVIodmFsdWVCRVIpO1xuICAgICAgICAgICAgICAgICAgICBBc25FcnJvci5hc3NlcnQoYXNuVmFsdWUsIFwiR2VuZXJhbE5hbWUgdmFsdWVcIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBhc25WYWx1ZS5yZXN1bHQudmFsdWVCbG9jay52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFzbjEucmVzdWx0LmJsb2NrTmFtZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gbmV3IFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5kaXJlY3RvcnlOYW1lIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBhc24xLnJlc3VsdC5lZGlQYXJ0eU5hbWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogYXNuMS5yZXN1bHQuYmxvY2tOYW1lLnZhbHVlQmxvY2sudmFsdWVIZXggfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGFzbjEucmVzdWx0LmJsb2NrTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUuaWRCbG9jay50YWdDbGFzcyA9IDE7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLmlkQmxvY2sudGFnTnVtYmVyID0gNjtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVCRVIgPSB2YWx1ZS50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFzblZhbHVlID0gYXNuMWpzLmZyb21CRVIodmFsdWVCRVIpO1xuICAgICAgICAgICAgICAgICAgICBBc25FcnJvci5hc3NlcnQoYXNuVmFsdWUsIFwiR2VuZXJhbE5hbWUgcmVnaXN0ZXJlZElEXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gYXNuVmFsdWUucmVzdWx0LnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogdGhpcy50eXBlXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gbmV3IGFzbjFqcy5JQTVTdHJpbmcoeyB2YWx1ZTogdGhpcy52YWx1ZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUuaWRCbG9jay50YWdDbGFzcyA9IDM7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLmlkQmxvY2sudGFnTnVtYmVyID0gdGhpcy50eXBlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDRcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFt0aGlzLnZhbHVlLnRvU2NoZW1hKCldXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLmlkQmxvY2sudGFnQ2xhc3MgPSAzO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZS5pZEJsb2NrLnRhZ051bWJlciA9IHRoaXMudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMudmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLmlkQmxvY2sudGFnQ2xhc3MgPSAzO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZS5pZEJsb2NrLnRhZ051bWJlciA9IHRoaXMudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEdlbmVyYWxOYW1lLnNjaGVtYSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgX29iamVjdCA9IHtcbiAgICAgICAgICAgIHR5cGU6IHRoaXMudHlwZSxcbiAgICAgICAgICAgIHZhbHVlOiBFTVBUWV9TVFJJTkdcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCh0eXBlb2YgdGhpcy52YWx1ZSkgPT09IFwic3RyaW5nXCIpXG4gICAgICAgICAgICBfb2JqZWN0LnZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIF9vYmplY3QudmFsdWUgPSB0aGlzLnZhbHVlLnRvSlNPTigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9vYmplY3Q7XG4gICAgfVxufVxuR2VuZXJhbE5hbWUuQ0xBU1NfTkFNRSA9IFwiR2VuZXJhbE5hbWVcIjtcblxuY29uc3QgQUNDRVNTX01FVEhPRCA9IFwiYWNjZXNzTWV0aG9kXCI7XG5jb25zdCBBQ0NFU1NfTE9DQVRJT04gPSBcImFjY2Vzc0xvY2F0aW9uXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxdiA9IFtcbiAgICBBQ0NFU1NfTUVUSE9ELFxuICAgIEFDQ0VTU19MT0NBVElPTixcbl07XG5jbGFzcyBBY2Nlc3NEZXNjcmlwdGlvbiBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuYWNjZXNzTWV0aG9kID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQUNDRVNTX01FVEhPRCwgQWNjZXNzRGVzY3JpcHRpb24uZGVmYXVsdFZhbHVlcyhBQ0NFU1NfTUVUSE9EKSk7XG4gICAgICAgIHRoaXMuYWNjZXNzTG9jYXRpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBQ0NFU1NfTE9DQVRJT04sIEFjY2Vzc0Rlc2NyaXB0aW9uLmRlZmF1bHRWYWx1ZXMoQUNDRVNTX0xPQ0FUSU9OKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBBQ0NFU1NfTUVUSE9EOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIEFDQ0VTU19MT0NBVElPTjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyYWxOYW1lKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5hY2Nlc3NNZXRob2QgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBHZW5lcmFsTmFtZS5zY2hlbWEobmFtZXMuYWNjZXNzTG9jYXRpb24gfHwge30pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMXYpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEFjY2Vzc0Rlc2NyaXB0aW9uLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGFjY2Vzc01ldGhvZDogQUNDRVNTX01FVEhPRCxcbiAgICAgICAgICAgICAgICBhY2Nlc3NMb2NhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBBQ0NFU1NfTE9DQVRJT05cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmFjY2Vzc01ldGhvZCA9IGFzbjEucmVzdWx0LmFjY2Vzc01ldGhvZC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMuYWNjZXNzTG9jYXRpb24gPSBuZXcgR2VuZXJhbE5hbWUoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmFjY2Vzc0xvY2F0aW9uIH0pO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMuYWNjZXNzTWV0aG9kIH0pLFxuICAgICAgICAgICAgICAgIHRoaXMuYWNjZXNzTG9jYXRpb24udG9TY2hlbWEoKVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFjY2Vzc01ldGhvZDogdGhpcy5hY2Nlc3NNZXRob2QsXG4gICAgICAgICAgICBhY2Nlc3NMb2NhdGlvbjogdGhpcy5hY2Nlc3NMb2NhdGlvbi50b0pTT04oKVxuICAgICAgICB9O1xuICAgIH1cbn1cbkFjY2Vzc0Rlc2NyaXB0aW9uLkNMQVNTX05BTUUgPSBcIkFjY2Vzc0Rlc2NyaXB0aW9uXCI7XG5cbmNvbnN0IFNFQ09ORFMgPSBcInNlY29uZHNcIjtcbmNvbnN0IE1JTExJUyA9IFwibWlsbGlzXCI7XG5jb25zdCBNSUNST1MgPSBcIm1pY3Jvc1wiO1xuY2xhc3MgQWNjdXJhY3kgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBpZiAoU0VDT05EUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnNlY29uZHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTRUNPTkRTLCBBY2N1cmFjeS5kZWZhdWx0VmFsdWVzKFNFQ09ORFMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTUlMTElTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMubWlsbGlzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTUlMTElTLCBBY2N1cmFjeS5kZWZhdWx0VmFsdWVzKE1JTExJUykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChNSUNST1MgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5taWNyb3MgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBNSUNST1MsIEFjY3VyYWN5LmRlZmF1bHRWYWx1ZXMoTUlDUk9TKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFNFQ09ORFM6XG4gICAgICAgICAgICBjYXNlIE1JTExJUzpcbiAgICAgICAgICAgIGNhc2UgTUlDUk9TOlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBTRUNPTkRTOlxuICAgICAgICAgICAgY2FzZSBNSUxMSVM6XG4gICAgICAgICAgICBjYXNlIE1JQ1JPUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBBY2N1cmFjeS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnNlY29uZHMgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm1pbGxpcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm1pY3JvcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgW1xuICAgICAgICAgICAgU0VDT05EUyxcbiAgICAgICAgICAgIE1JTExJUyxcbiAgICAgICAgICAgIE1JQ1JPUyxcbiAgICAgICAgXSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQWNjdXJhY3kuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgc2Vjb25kczogU0VDT05EUyxcbiAgICAgICAgICAgICAgICBtaWxsaXM6IE1JTExJUyxcbiAgICAgICAgICAgICAgICBtaWNyb3M6IE1JQ1JPUyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoXCJzZWNvbmRzXCIgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuc2Vjb25kcyA9IGFzbjEucmVzdWx0LnNlY29uZHMudmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJtaWxsaXNcIiBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgaW50TWlsbGlzID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IGFzbjEucmVzdWx0Lm1pbGxpcy52YWx1ZUJsb2NrLnZhbHVlSGV4IH0pO1xuICAgICAgICAgICAgdGhpcy5taWxsaXMgPSBpbnRNaWxsaXMudmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJtaWNyb3NcIiBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgaW50TWljcm9zID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IGFzbjEucmVzdWx0Lm1pY3Jvcy52YWx1ZUJsb2NrLnZhbHVlSGV4IH0pO1xuICAgICAgICAgICAgdGhpcy5taWNyb3MgPSBpbnRNaWNyb3MudmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMuc2Vjb25kcyAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy5zZWNvbmRzIH0pKTtcbiAgICAgICAgaWYgKHRoaXMubWlsbGlzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGludE1pbGxpcyA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLm1pbGxpcyB9KTtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IGludE1pbGxpcy52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlld1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1pY3JvcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBpbnRNaWNyb3MgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy5taWNyb3MgfSk7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlSGV4OiBpbnRNaWNyb3MudmFsdWVCbG9jay52YWx1ZUhleFZpZXdcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBfb2JqZWN0ID0ge307XG4gICAgICAgIGlmICh0aGlzLnNlY29uZHMgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIF9vYmplY3Quc2Vjb25kcyA9IHRoaXMuc2Vjb25kcztcbiAgICAgICAgaWYgKHRoaXMubWlsbGlzICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBfb2JqZWN0Lm1pbGxpcyA9IHRoaXMubWlsbGlzO1xuICAgICAgICBpZiAodGhpcy5taWNyb3MgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIF9vYmplY3QubWljcm9zID0gdGhpcy5taWNyb3M7XG4gICAgICAgIHJldHVybiBfb2JqZWN0O1xuICAgIH1cbn1cbkFjY3VyYWN5LkNMQVNTX05BTUUgPSBcIkFjY3VyYWN5XCI7XG5cbmNvbnN0IEFMR09SSVRITV9JRCA9IFwiYWxnb3JpdGhtSWRcIjtcbmNvbnN0IEFMR09SSVRITV9QQVJBTVMgPSBcImFsZ29yaXRobVBhcmFtc1wiO1xuY29uc3QgQUxHT1JJVEhNJDIgPSBcImFsZ29yaXRobVwiO1xuY29uc3QgUEFSQU1TID0gXCJwYXJhbXNcIjtcbmNvbnN0IENMRUFSX1BST1BTJDF1ID0gW1xuICAgIEFMR09SSVRITSQyLFxuICAgIFBBUkFNU1xuXTtcbmNsYXNzIEFsZ29yaXRobUlkZW50aWZpZXIgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmFsZ29yaXRobUlkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQUxHT1JJVEhNX0lELCBBbGdvcml0aG1JZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoQUxHT1JJVEhNX0lEKSk7XG4gICAgICAgIGlmIChBTEdPUklUSE1fUEFSQU1TIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuYWxnb3JpdGhtUGFyYW1zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQUxHT1JJVEhNX1BBUkFNUywgQWxnb3JpdGhtSWRlbnRpZmllci5kZWZhdWx0VmFsdWVzKEFMR09SSVRITV9QQVJBTVMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQUxHT1JJVEhNX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIEFMR09SSVRITV9QQVJBTVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuQW55KCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEFMR09SSVRITV9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBFTVBUWV9TVFJJTkcpO1xuICAgICAgICAgICAgY2FzZSBBTEdPUklUSE1fUEFSQU1TOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBhc24xanMuQW55KTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIG9wdGlvbmFsOiAobmFtZXMub3B0aW9uYWwgfHwgZmFsc2UpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMuYWxnb3JpdGhtSWRlbnRpZmllciB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQW55KHsgbmFtZTogKG5hbWVzLmFsZ29yaXRobVBhcmFtcyB8fCBFTVBUWV9TVFJJTkcpLCBvcHRpb25hbDogdHJ1ZSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDF1KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkZW50aWZpZXI6IEFMR09SSVRITSQyLFxuICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogUEFSQU1TXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5hbGdvcml0aG1JZCA9IGFzbjEucmVzdWx0LmFsZ29yaXRobS52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmIChQQVJBTVMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuYWxnb3JpdGhtUGFyYW1zID0gYXNuMS5yZXN1bHQucGFyYW1zO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLmFsZ29yaXRobUlkIH0pKTtcbiAgICAgICAgaWYgKHRoaXMuYWxnb3JpdGhtUGFyYW1zICYmICEodGhpcy5hbGdvcml0aG1QYXJhbXMgaW5zdGFuY2VvZiBhc24xanMuQW55KSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmFsZ29yaXRobVBhcmFtcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0ge1xuICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IHRoaXMuYWxnb3JpdGhtSWRcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuYWxnb3JpdGhtUGFyYW1zICYmICEodGhpcy5hbGdvcml0aG1QYXJhbXMgaW5zdGFuY2VvZiBhc24xanMuQW55KSkge1xuICAgICAgICAgICAgb2JqZWN0LmFsZ29yaXRobVBhcmFtcyA9IHRoaXMuYWxnb3JpdGhtUGFyYW1zLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgfVxuICAgIGlzRXF1YWwoYWxnb3JpdGhtSWRlbnRpZmllcikge1xuICAgICAgICBpZiAoIShhbGdvcml0aG1JZGVudGlmaWVyIGluc3RhbmNlb2YgQWxnb3JpdGhtSWRlbnRpZmllcikpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hbGdvcml0aG1JZCAhPT0gYWxnb3JpdGhtSWRlbnRpZmllci5hbGdvcml0aG1JZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFsZ29yaXRobVBhcmFtcykge1xuICAgICAgICAgICAgaWYgKGFsZ29yaXRobUlkZW50aWZpZXIuYWxnb3JpdGhtUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMuYWxnb3JpdGhtUGFyYW1zKSA9PT0gSlNPTi5zdHJpbmdpZnkoYWxnb3JpdGhtSWRlbnRpZmllci5hbGdvcml0aG1QYXJhbXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbGdvcml0aG1JZGVudGlmaWVyLmFsZ29yaXRobVBhcmFtcykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn1cbkFsZ29yaXRobUlkZW50aWZpZXIuQ0xBU1NfTkFNRSA9IFwiQWxnb3JpdGhtSWRlbnRpZmllclwiO1xuXG5jb25zdCBBTFRfTkFNRVMgPSBcImFsdE5hbWVzXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxdCA9IFtcbiAgICBBTFRfTkFNRVNcbl07XG5jbGFzcyBBbHROYW1lIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5hbHROYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFMVF9OQU1FUywgQWx0TmFtZS5kZWZhdWx0VmFsdWVzKEFMVF9OQU1FUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQUxUX05BTUVTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5hbHROYW1lcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogR2VuZXJhbE5hbWUuc2NoZW1hKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDF0KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBBbHROYW1lLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGFsdE5hbWVzOiBBTFRfTkFNRVNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoQUxUX05BTUVTIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmFsdE5hbWVzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5hbHROYW1lcywgZWxlbWVudCA9PiBuZXcgR2VuZXJhbE5hbWUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5hbHROYW1lcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWx0TmFtZXM6IEFycmF5LmZyb20odGhpcy5hbHROYW1lcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cbkFsdE5hbWUuQ0xBU1NfTkFNRSA9IFwiQWx0TmFtZVwiO1xuXG5jb25zdCBUWVBFJDMgPSBcInR5cGVcIjtcbmNvbnN0IFZBTFVFUyQxID0gXCJ2YWx1ZXNcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFzID0gW1xuICAgIFRZUEUkMyxcbiAgICBWQUxVRVMkMVxuXTtcbmNsYXNzIEF0dHJpYnV0ZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudHlwZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRZUEUkMywgQXR0cmlidXRlLmRlZmF1bHRWYWx1ZXMoVFlQRSQzKSk7XG4gICAgICAgIHRoaXMudmFsdWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkFMVUVTJDEsIEF0dHJpYnV0ZS5kZWZhdWx0VmFsdWVzKFZBTFVFUyQxKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUWVBFJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgVkFMVUVTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUWVBFJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgVkFMVUVTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMudHlwZSB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnNldE5hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy52YWx1ZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbmV3IGFzbjFqcy5BbnkoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMXMpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEF0dHJpYnV0ZS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBUWVBFJDMsXG4gICAgICAgICAgICAgICAgdmFsdWVzOiBWQUxVRVMkMVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudHlwZSA9IGFzbjEucmVzdWx0LnR5cGUudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnZhbHVlcyA9IGFzbjEucmVzdWx0LnZhbHVlcztcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLnR5cGUgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZXNcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IHRoaXMudHlwZSxcbiAgICAgICAgICAgIHZhbHVlczogQXJyYXkuZnJvbSh0aGlzLnZhbHVlcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cbkF0dHJpYnV0ZS5DTEFTU19OQU1FID0gXCJBdHRyaWJ1dGVcIjtcblxuY29uc3QgTk9UX0JFRk9SRV9USU1FID0gXCJub3RCZWZvcmVUaW1lXCI7XG5jb25zdCBOT1RfQUZURVJfVElNRSA9IFwibm90QWZ0ZXJUaW1lXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxciA9IFtcbiAgICBOT1RfQkVGT1JFX1RJTUUsXG4gICAgTk9UX0FGVEVSX1RJTUUsXG5dO1xuY2xhc3MgQXR0Q2VydFZhbGlkaXR5UGVyaW9kIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5ub3RCZWZvcmVUaW1lID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTk9UX0JFRk9SRV9USU1FLCBBdHRDZXJ0VmFsaWRpdHlQZXJpb2QuZGVmYXVsdFZhbHVlcyhOT1RfQkVGT1JFX1RJTUUpKTtcbiAgICAgICAgdGhpcy5ub3RBZnRlclRpbWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBOT1RfQUZURVJfVElNRSwgQXR0Q2VydFZhbGlkaXR5UGVyaW9kLmRlZmF1bHRWYWx1ZXMoTk9UX0FGVEVSX1RJTUUpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIE5PVF9CRUZPUkVfVElNRTpcbiAgICAgICAgICAgIGNhc2UgTk9UX0FGVEVSX1RJTUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKDAsIDAsIDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IG5hbWU6IChuYW1lcy5ub3RCZWZvcmVUaW1lIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoeyBuYW1lOiAobmFtZXMubm90QWZ0ZXJUaW1lIHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxcik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQXR0Q2VydFZhbGlkaXR5UGVyaW9kLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIG5vdEJlZm9yZVRpbWU6IE5PVF9CRUZPUkVfVElNRSxcbiAgICAgICAgICAgICAgICBub3RBZnRlclRpbWU6IE5PVF9BRlRFUl9USU1FXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5ub3RCZWZvcmVUaW1lID0gYXNuMS5yZXN1bHQubm90QmVmb3JlVGltZS50b0RhdGUoKTtcbiAgICAgICAgdGhpcy5ub3RBZnRlclRpbWUgPSBhc24xLnJlc3VsdC5ub3RBZnRlclRpbWUudG9EYXRlKCk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IHZhbHVlRGF0ZTogdGhpcy5ub3RCZWZvcmVUaW1lIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKHsgdmFsdWVEYXRlOiB0aGlzLm5vdEFmdGVyVGltZSB9KSxcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBub3RCZWZvcmVUaW1lOiB0aGlzLm5vdEJlZm9yZVRpbWUsXG4gICAgICAgICAgICBub3RBZnRlclRpbWU6IHRoaXMubm90QWZ0ZXJUaW1lXG4gICAgICAgIH07XG4gICAgfVxufVxuQXR0Q2VydFZhbGlkaXR5UGVyaW9kLkNMQVNTX05BTUUgPSBcIkF0dENlcnRWYWxpZGl0eVBlcmlvZFwiO1xuXG5jb25zdCBOQU1FUyA9IFwibmFtZXNcIjtcbmNvbnN0IEdFTkVSQUxfTkFNRVMgPSBcImdlbmVyYWxOYW1lc1wiO1xuY2xhc3MgR2VuZXJhbE5hbWVzIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5uYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE5BTUVTLCBHZW5lcmFsTmFtZXMuZGVmYXVsdFZhbHVlcyhOQU1FUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJuYW1lc1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30sIG9wdGlvbmFsID0gZmFsc2UpIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBOQU1FUywge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuZ2VuZXJhbE5hbWVzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBHZW5lcmFsTmFtZS5zY2hlbWEoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgW1xuICAgICAgICAgICAgTkFNRVMsXG4gICAgICAgICAgICBHRU5FUkFMX05BTUVTXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEdlbmVyYWxOYW1lcy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBibG9ja05hbWU6IE5BTUVTLFxuICAgICAgICAgICAgICAgIGdlbmVyYWxOYW1lczogR0VORVJBTF9OQU1FU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMubmFtZXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmdlbmVyYWxOYW1lcywgZWxlbWVudCA9PiBuZXcgR2VuZXJhbE5hbWUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMubmFtZXMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWVzOiBBcnJheS5mcm9tKHRoaXMubmFtZXMsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG59XG5HZW5lcmFsTmFtZXMuQ0xBU1NfTkFNRSA9IFwiR2VuZXJhbE5hbWVzXCI7XG5cbmNvbnN0IGlkX1N1YmplY3REaXJlY3RvcnlBdHRyaWJ1dGVzID0gXCIyLjUuMjkuOVwiO1xuY29uc3QgaWRfU3ViamVjdEtleUlkZW50aWZpZXIgPSBcIjIuNS4yOS4xNFwiO1xuY29uc3QgaWRfS2V5VXNhZ2UgPSBcIjIuNS4yOS4xNVwiO1xuY29uc3QgaWRfUHJpdmF0ZUtleVVzYWdlUGVyaW9kID0gXCIyLjUuMjkuMTZcIjtcbmNvbnN0IGlkX1N1YmplY3RBbHROYW1lID0gXCIyLjUuMjkuMTdcIjtcbmNvbnN0IGlkX0lzc3VlckFsdE5hbWUgPSBcIjIuNS4yOS4xOFwiO1xuY29uc3QgaWRfQmFzaWNDb25zdHJhaW50cyA9IFwiMi41LjI5LjE5XCI7XG5jb25zdCBpZF9DUkxOdW1iZXIgPSBcIjIuNS4yOS4yMFwiO1xuY29uc3QgaWRfQmFzZUNSTE51bWJlciA9IFwiMi41LjI5LjI3XCI7XG5jb25zdCBpZF9DUkxSZWFzb24gPSBcIjIuNS4yOS4yMVwiO1xuY29uc3QgaWRfSW52YWxpZGl0eURhdGUgPSBcIjIuNS4yOS4yNFwiO1xuY29uc3QgaWRfSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50ID0gXCIyLjUuMjkuMjhcIjtcbmNvbnN0IGlkX0NlcnRpZmljYXRlSXNzdWVyID0gXCIyLjUuMjkuMjlcIjtcbmNvbnN0IGlkX05hbWVDb25zdHJhaW50cyA9IFwiMi41LjI5LjMwXCI7XG5jb25zdCBpZF9DUkxEaXN0cmlidXRpb25Qb2ludHMgPSBcIjIuNS4yOS4zMVwiO1xuY29uc3QgaWRfRnJlc2hlc3RDUkwgPSBcIjIuNS4yOS40NlwiO1xuY29uc3QgaWRfQ2VydGlmaWNhdGVQb2xpY2llcyA9IFwiMi41LjI5LjMyXCI7XG5jb25zdCBpZF9BbnlQb2xpY3kgPSBcIjIuNS4yOS4zMi4wXCI7XG5jb25zdCBpZF9NaWNyb3NvZnRBcHBQb2xpY2llcyA9IFwiMS4zLjYuMS40LjEuMzExLjIxLjEwXCI7XG5jb25zdCBpZF9Qb2xpY3lNYXBwaW5ncyA9IFwiMi41LjI5LjMzXCI7XG5jb25zdCBpZF9BdXRob3JpdHlLZXlJZGVudGlmaWVyID0gXCIyLjUuMjkuMzVcIjtcbmNvbnN0IGlkX1BvbGljeUNvbnN0cmFpbnRzID0gXCIyLjUuMjkuMzZcIjtcbmNvbnN0IGlkX0V4dEtleVVzYWdlID0gXCIyLjUuMjkuMzdcIjtcbmNvbnN0IGlkX0luaGliaXRBbnlQb2xpY3kgPSBcIjIuNS4yOS41NFwiO1xuY29uc3QgaWRfQXV0aG9yaXR5SW5mb0FjY2VzcyA9IFwiMS4zLjYuMS41LjUuNy4xLjFcIjtcbmNvbnN0IGlkX1N1YmplY3RJbmZvQWNjZXNzID0gXCIxLjMuNi4xLjUuNS43LjEuMTFcIjtcbmNvbnN0IGlkX1NpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdCA9IFwiMS4zLjYuMS40LjEuMTExMjkuMi40LjJcIjtcbmNvbnN0IGlkX01pY3Jvc29mdENlcnRUZW1wbGF0ZVYxID0gXCIxLjMuNi4xLjQuMS4zMTEuMjAuMlwiO1xuY29uc3QgaWRfTWljcm9zb2Z0UHJldkNhQ2VydEhhc2ggPSBcIjEuMy42LjEuNC4xLjMxMS4yMS4yXCI7XG5jb25zdCBpZF9NaWNyb3NvZnRDZXJ0VGVtcGxhdGVWMiA9IFwiMS4zLjYuMS40LjEuMzExLjIxLjdcIjtcbmNvbnN0IGlkX01pY3Jvc29mdENhVmVyc2lvbiA9IFwiMS4zLjYuMS40LjEuMzExLjIxLjFcIjtcbmNvbnN0IGlkX1FDU3RhdGVtZW50cyA9IFwiMS4zLjYuMS41LjUuNy4xLjNcIjtcbmNvbnN0IGlkX0NvbnRlbnRUeXBlX0RhdGEgPSBcIjEuMi44NDAuMTEzNTQ5LjEuNy4xXCI7XG5jb25zdCBpZF9Db250ZW50VHlwZV9TaWduZWREYXRhID0gXCIxLjIuODQwLjExMzU0OS4xLjcuMlwiO1xuY29uc3QgaWRfQ29udGVudFR5cGVfRW52ZWxvcGVkRGF0YSA9IFwiMS4yLjg0MC4xMTM1NDkuMS43LjNcIjtcbmNvbnN0IGlkX0NvbnRlbnRUeXBlX0VuY3J5cHRlZERhdGEgPSBcIjEuMi44NDAuMTEzNTQ5LjEuNy42XCI7XG5jb25zdCBpZF9lQ29udGVudFR5cGVfVFNUSW5mbyA9IFwiMS4yLjg0MC4xMTM1NDkuMS45LjE2LjEuNFwiO1xuY29uc3QgaWRfQ2VydEJhZ19YNTA5Q2VydGlmaWNhdGUgPSBcIjEuMi44NDAuMTEzNTQ5LjEuOS4yMi4xXCI7XG5jb25zdCBpZF9DZXJ0QmFnX1NEU0lDZXJ0aWZpY2F0ZSA9IFwiMS4yLjg0MC4xMTM1NDkuMS45LjIyLjJcIjtcbmNvbnN0IGlkX0NlcnRCYWdfQXR0cmlidXRlQ2VydGlmaWNhdGUgPSBcIjEuMi44NDAuMTEzNTQ5LjEuOS4yMi4zXCI7XG5jb25zdCBpZF9DUkxCYWdfWDUwOUNSTCA9IFwiMS4yLjg0MC4xMTM1NDkuMS45LjIzLjFcIjtcbmNvbnN0IGlkX3BraXggPSBcIjEuMy42LjEuNS41LjdcIjtcbmNvbnN0IGlkX2FkID0gYCR7aWRfcGtpeH0uNDhgO1xuY29uc3QgaWRfUEtJWF9PQ1NQX0Jhc2ljID0gYCR7aWRfYWR9LjEuMWA7XG5jb25zdCBpZF9hZF9jYUlzc3VlcnMgPSBgJHtpZF9hZH0uMmA7XG5jb25zdCBpZF9hZF9vY3NwID0gYCR7aWRfYWR9LjFgO1xuY29uc3QgaWRfc2hhMSA9IFwiMS4zLjE0LjMuMi4yNlwiO1xuY29uc3QgaWRfc2hhMjU2ID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMi4xXCI7XG5jb25zdCBpZF9zaGEzODQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4yLjJcIjtcbmNvbnN0IGlkX3NoYTUxMiA9IFwiMi4xNi44NDAuMS4xMDEuMy40LjIuM1wiO1xuXG5jb25zdCBLRVlfSURFTlRJRklFUiQxID0gXCJrZXlJZGVudGlmaWVyXCI7XG5jb25zdCBBVVRIT1JJVFlfQ0VSVF9JU1NVRVIgPSBcImF1dGhvcml0eUNlcnRJc3N1ZXJcIjtcbmNvbnN0IEFVVEhPUklUWV9DRVJUX1NFUklBTF9OVU1CRVIgPSBcImF1dGhvcml0eUNlcnRTZXJpYWxOdW1iZXJcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFxID0gW1xuICAgIEtFWV9JREVOVElGSUVSJDEsXG4gICAgQVVUSE9SSVRZX0NFUlRfSVNTVUVSLFxuICAgIEFVVEhPUklUWV9DRVJUX1NFUklBTF9OVU1CRVIsXG5dO1xuY2xhc3MgQXV0aG9yaXR5S2V5SWRlbnRpZmllciBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGlmIChLRVlfSURFTlRJRklFUiQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMua2V5SWRlbnRpZmllciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEtFWV9JREVOVElGSUVSJDEsIEF1dGhvcml0eUtleUlkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhLRVlfSURFTlRJRklFUiQxKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEFVVEhPUklUWV9DRVJUX0lTU1VFUiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmF1dGhvcml0eUNlcnRJc3N1ZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBVVRIT1JJVFlfQ0VSVF9JU1NVRVIsIEF1dGhvcml0eUtleUlkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhBVVRIT1JJVFlfQ0VSVF9JU1NVRVIpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQVVUSE9SSVRZX0NFUlRfU0VSSUFMX05VTUJFUiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmF1dGhvcml0eUNlcnRTZXJpYWxOdW1iZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBVVRIT1JJVFlfQ0VSVF9TRVJJQUxfTlVNQkVSLCBBdXRob3JpdHlLZXlJZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoQVVUSE9SSVRZX0NFUlRfU0VSSUFMX05VTUJFUikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBLRVlfSURFTlRJRklFUiQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIEFVVEhPUklUWV9DRVJUX0lTU1VFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIEFVVEhPUklUWV9DRVJUX1NFUklBTF9OVU1CRVI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5rZXlJZGVudGlmaWVyIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmF1dGhvcml0eUNlcnRJc3N1ZXIgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogR2VuZXJhbE5hbWUuc2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5hdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxcSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQXV0aG9yaXR5S2V5SWRlbnRpZmllci5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBrZXlJZGVudGlmaWVyOiBLRVlfSURFTlRJRklFUiQxLFxuICAgICAgICAgICAgICAgIGF1dGhvcml0eUNlcnRJc3N1ZXI6IEFVVEhPUklUWV9DRVJUX0lTU1VFUixcbiAgICAgICAgICAgICAgICBhdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyOiBBVVRIT1JJVFlfQ0VSVF9TRVJJQUxfTlVNQkVSXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKEtFWV9JREVOVElGSUVSJDEgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmtleUlkZW50aWZpZXIgPSBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IGFzbjEucmVzdWx0LmtleUlkZW50aWZpZXIudmFsdWVCbG9jay52YWx1ZUhleCB9KTtcbiAgICAgICAgaWYgKEFVVEhPUklUWV9DRVJUX0lTU1VFUiBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuYXV0aG9yaXR5Q2VydElzc3VlciA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuYXV0aG9yaXR5Q2VydElzc3VlciwgbyA9PiBuZXcgR2VuZXJhbE5hbWUoeyBzY2hlbWE6IG8gfSkpO1xuICAgICAgICBpZiAoQVVUSE9SSVRZX0NFUlRfU0VSSUFMX05VTUJFUiBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlciA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlSGV4OiBhc24xLnJlc3VsdC5hdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyLnZhbHVlQmxvY2sudmFsdWVIZXggfSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBpZiAodGhpcy5rZXlJZGVudGlmaWVyKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlSGV4OiB0aGlzLmtleUlkZW50aWZpZXIudmFsdWVCbG9jay52YWx1ZUhleFZpZXdcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hdXRob3JpdHlDZXJ0SXNzdWVyKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5hdXRob3JpdHlDZXJ0SXNzdWVyLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlSGV4OiB0aGlzLmF1dGhvcml0eUNlcnRTZXJpYWxOdW1iZXIudmFsdWVCbG9jay52YWx1ZUhleFZpZXdcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBvYmplY3QgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMua2V5SWRlbnRpZmllcikge1xuICAgICAgICAgICAgb2JqZWN0LmtleUlkZW50aWZpZXIgPSB0aGlzLmtleUlkZW50aWZpZXIudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYXV0aG9yaXR5Q2VydElzc3Vlcikge1xuICAgICAgICAgICAgb2JqZWN0LmF1dGhvcml0eUNlcnRJc3N1ZXIgPSBBcnJheS5mcm9tKHRoaXMuYXV0aG9yaXR5Q2VydElzc3VlciwgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyKSB7XG4gICAgICAgICAgICBvYmplY3QuYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlciA9IHRoaXMuYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlci50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH1cbn1cbkF1dGhvcml0eUtleUlkZW50aWZpZXIuQ0xBU1NfTkFNRSA9IFwiQXV0aG9yaXR5S2V5SWRlbnRpZmllclwiO1xuXG5jb25zdCBQQVRIX0xFTkdUSF9DT05TVFJBSU5UID0gXCJwYXRoTGVuQ29uc3RyYWludFwiO1xuY29uc3QgQ0EgPSBcImNBXCI7XG5jbGFzcyBCYXNpY0NvbnN0cmFpbnRzIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5jQSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENBLCBmYWxzZSk7XG4gICAgICAgIGlmIChQQVRIX0xFTkdUSF9DT05TVFJBSU5UIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucGF0aExlbkNvbnN0cmFpbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQQVRIX0xFTkdUSF9DT05TVFJBSU5ULCAwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ0E6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJvb2xlYW4oe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNBIHx8IEVNUFRZX1NUUklORylcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnBhdGhMZW5Db25zdHJhaW50IHx8IEVNUFRZX1NUUklORylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIFtcbiAgICAgICAgICAgIENBLFxuICAgICAgICAgICAgUEFUSF9MRU5HVEhfQ09OU1RSQUlOVFxuICAgICAgICBdKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBCYXNpY0NvbnN0cmFpbnRzLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGNBOiBDQSxcbiAgICAgICAgICAgICAgICBwYXRoTGVuQ29uc3RyYWludDogUEFUSF9MRU5HVEhfQ09OU1RSQUlOVFxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChDQSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5jQSA9IGFzbjEucmVzdWx0LmNBLnZhbHVlQmxvY2sudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFBBVEhfTEVOR1RIX0NPTlNUUkFJTlQgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGlmIChhc24xLnJlc3VsdC5wYXRoTGVuQ29uc3RyYWludC52YWx1ZUJsb2NrLmlzSGV4T25seSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGF0aExlbkNvbnN0cmFpbnQgPSBhc24xLnJlc3VsdC5wYXRoTGVuQ29uc3RyYWludDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGF0aExlbkNvbnN0cmFpbnQgPSBhc24xLnJlc3VsdC5wYXRoTGVuQ29uc3RyYWludC52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBpZiAodGhpcy5jQSAhPT0gQmFzaWNDb25zdHJhaW50cy5kZWZhdWx0VmFsdWVzKENBKSlcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Cb29sZWFuKHsgdmFsdWU6IHRoaXMuY0EgfSkpO1xuICAgICAgICBpZiAoUEFUSF9MRU5HVEhfQ09OU1RSQUlOVCBpbiB0aGlzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXRoTGVuQ29uc3RyYWludCBpbnN0YW5jZW9mIGFzbjFqcy5JbnRlZ2VyKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnBhdGhMZW5Db25zdHJhaW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMucGF0aExlbkNvbnN0cmFpbnQgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IHt9O1xuICAgICAgICBpZiAodGhpcy5jQSAhPT0gQmFzaWNDb25zdHJhaW50cy5kZWZhdWx0VmFsdWVzKENBKSkge1xuICAgICAgICAgICAgb2JqZWN0LmNBID0gdGhpcy5jQTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoUEFUSF9MRU5HVEhfQ09OU1RSQUlOVCBpbiB0aGlzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXRoTGVuQ29uc3RyYWludCBpbnN0YW5jZW9mIGFzbjFqcy5JbnRlZ2VyKSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0LnBhdGhMZW5Db25zdHJhaW50ID0gdGhpcy5wYXRoTGVuQ29uc3RyYWludC50b0pTT04oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG9iamVjdC5wYXRoTGVuQ29uc3RyYWludCA9IHRoaXMucGF0aExlbkNvbnN0cmFpbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9XG59XG5CYXNpY0NvbnN0cmFpbnRzLkNMQVNTX05BTUUgPSBcIkJhc2ljQ29uc3RyYWludHNcIjtcblxuY29uc3QgQ0VSVElGSUNBVEVfSU5ERVggPSBcImNlcnRpZmljYXRlSW5kZXhcIjtcbmNvbnN0IEtFWV9JTkRFWCA9IFwia2V5SW5kZXhcIjtcbmNsYXNzIENBVmVyc2lvbiBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuY2VydGlmaWNhdGVJbmRleCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENFUlRJRklDQVRFX0lOREVYLCBDQVZlcnNpb24uZGVmYXVsdFZhbHVlcyhDRVJUSUZJQ0FURV9JTkRFWCkpO1xuICAgICAgICB0aGlzLmtleUluZGV4ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX0lOREVYLCBDQVZlcnNpb24uZGVmYXVsdFZhbHVlcyhLRVlfSU5ERVgpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIENFUlRJRklDQVRFX0lOREVYOlxuICAgICAgICAgICAgY2FzZSBLRVlfSU5ERVg6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5JbnRlZ2VyKCkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBpZiAoc2NoZW1hLmNvbnN0cnVjdG9yLmJsb2NrTmFtZSgpICE9PSBhc24xanMuSW50ZWdlci5ibG9ja05hbWUoKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT2JqZWN0J3Mgc2NoZW1hIHdhcyBub3QgdmVyaWZpZWQgYWdhaW5zdCBpbnB1dCBkYXRhIGZvciBDQVZlcnNpb25cIik7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHZhbHVlID0gc2NoZW1hLnZhbHVlQmxvY2sudmFsdWVIZXguc2xpY2UoMCk7XG4gICAgICAgIGNvbnN0IHZhbHVlVmlldyA9IG5ldyBVaW50OEFycmF5KHZhbHVlKTtcbiAgICAgICAgc3dpdGNoICh0cnVlKSB7XG4gICAgICAgICAgICBjYXNlICh2YWx1ZS5ieXRlTGVuZ3RoIDwgNCk6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wVmFsdWUgPSBuZXcgQXJyYXlCdWZmZXIoNCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBWYWx1ZVZpZXcgPSBuZXcgVWludDhBcnJheSh0ZW1wVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wVmFsdWVWaWV3LnNldCh2YWx1ZVZpZXcsIDQgLSB2YWx1ZS5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0ZW1wVmFsdWUuc2xpY2UoMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAodmFsdWUuYnl0ZUxlbmd0aCA+IDQpOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGVtcFZhbHVlID0gbmV3IEFycmF5QnVmZmVyKDQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wVmFsdWVWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodGVtcFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgdGVtcFZhbHVlVmlldy5zZXQodmFsdWVWaWV3LnNsaWNlKDAsIDQpKTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0ZW1wVmFsdWUuc2xpY2UoMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGtleUluZGV4QnVmZmVyID0gdmFsdWUuc2xpY2UoMCwgMik7XG4gICAgICAgIGNvbnN0IGtleUluZGV4VmlldzggPSBuZXcgVWludDhBcnJheShrZXlJbmRleEJ1ZmZlcik7XG4gICAgICAgIGxldCB0ZW1wID0ga2V5SW5kZXhWaWV3OFswXTtcbiAgICAgICAga2V5SW5kZXhWaWV3OFswXSA9IGtleUluZGV4VmlldzhbMV07XG4gICAgICAgIGtleUluZGV4VmlldzhbMV0gPSB0ZW1wO1xuICAgICAgICBjb25zdCBrZXlJbmRleFZpZXcxNiA9IG5ldyBVaW50MTZBcnJheShrZXlJbmRleEJ1ZmZlcik7XG4gICAgICAgIHRoaXMua2V5SW5kZXggPSBrZXlJbmRleFZpZXcxNlswXTtcbiAgICAgICAgY29uc3QgY2VydGlmaWNhdGVJbmRleEJ1ZmZlciA9IHZhbHVlLnNsaWNlKDIpO1xuICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZUluZGV4VmlldzggPSBuZXcgVWludDhBcnJheShjZXJ0aWZpY2F0ZUluZGV4QnVmZmVyKTtcbiAgICAgICAgdGVtcCA9IGNlcnRpZmljYXRlSW5kZXhWaWV3OFswXTtcbiAgICAgICAgY2VydGlmaWNhdGVJbmRleFZpZXc4WzBdID0gY2VydGlmaWNhdGVJbmRleFZpZXc4WzFdO1xuICAgICAgICBjZXJ0aWZpY2F0ZUluZGV4VmlldzhbMV0gPSB0ZW1wO1xuICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZUluZGV4VmlldzE2ID0gbmV3IFVpbnQxNkFycmF5KGNlcnRpZmljYXRlSW5kZXhCdWZmZXIpO1xuICAgICAgICB0aGlzLmNlcnRpZmljYXRlSW5kZXggPSBjZXJ0aWZpY2F0ZUluZGV4VmlldzE2WzBdO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3QgY2VydGlmaWNhdGVJbmRleEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcigyKTtcbiAgICAgICAgY29uc3QgY2VydGlmaWNhdGVJbmRleFZpZXcgPSBuZXcgVWludDE2QXJyYXkoY2VydGlmaWNhdGVJbmRleEJ1ZmZlcik7XG4gICAgICAgIGNlcnRpZmljYXRlSW5kZXhWaWV3WzBdID0gdGhpcy5jZXJ0aWZpY2F0ZUluZGV4O1xuICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZUluZGV4VmlldzggPSBuZXcgVWludDhBcnJheShjZXJ0aWZpY2F0ZUluZGV4QnVmZmVyKTtcbiAgICAgICAgbGV0IHRlbXAgPSBjZXJ0aWZpY2F0ZUluZGV4VmlldzhbMF07XG4gICAgICAgIGNlcnRpZmljYXRlSW5kZXhWaWV3OFswXSA9IGNlcnRpZmljYXRlSW5kZXhWaWV3OFsxXTtcbiAgICAgICAgY2VydGlmaWNhdGVJbmRleFZpZXc4WzFdID0gdGVtcDtcbiAgICAgICAgY29uc3Qga2V5SW5kZXhCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoMik7XG4gICAgICAgIGNvbnN0IGtleUluZGV4VmlldyA9IG5ldyBVaW50MTZBcnJheShrZXlJbmRleEJ1ZmZlcik7XG4gICAgICAgIGtleUluZGV4Vmlld1swXSA9IHRoaXMua2V5SW5kZXg7XG4gICAgICAgIGNvbnN0IGtleUluZGV4VmlldzggPSBuZXcgVWludDhBcnJheShrZXlJbmRleEJ1ZmZlcik7XG4gICAgICAgIHRlbXAgPSBrZXlJbmRleFZpZXc4WzBdO1xuICAgICAgICBrZXlJbmRleFZpZXc4WzBdID0ga2V5SW5kZXhWaWV3OFsxXTtcbiAgICAgICAga2V5SW5kZXhWaWV3OFsxXSA9IHRlbXA7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5JbnRlZ2VyKHtcbiAgICAgICAgICAgIHZhbHVlSGV4OiBwdnV0aWxzLnV0aWxDb25jYXRCdWYoa2V5SW5kZXhCdWZmZXIsIGNlcnRpZmljYXRlSW5kZXhCdWZmZXIpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2VydGlmaWNhdGVJbmRleDogdGhpcy5jZXJ0aWZpY2F0ZUluZGV4LFxuICAgICAgICAgICAga2V5SW5kZXg6IHRoaXMua2V5SW5kZXhcbiAgICAgICAgfTtcbiAgICB9XG59XG5DQVZlcnNpb24uQ0xBU1NfTkFNRSA9IFwiQ0FWZXJzaW9uXCI7XG5cbmNvbnN0IFBPTElDWV9RVUFMSUZJRVJfSUQgPSBcInBvbGljeVF1YWxpZmllcklkXCI7XG5jb25zdCBRVUFMSUZJRVIgPSBcInF1YWxpZmllclwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMXAgPSBbXG4gICAgUE9MSUNZX1FVQUxJRklFUl9JRCxcbiAgICBRVUFMSUZJRVJcbl07XG5jbGFzcyBQb2xpY3lRdWFsaWZpZXJJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5wb2xpY3lRdWFsaWZpZXJJZCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBPTElDWV9RVUFMSUZJRVJfSUQsIFBvbGljeVF1YWxpZmllckluZm8uZGVmYXVsdFZhbHVlcyhQT0xJQ1lfUVVBTElGSUVSX0lEKSk7XG4gICAgICAgIHRoaXMucXVhbGlmaWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUVVBTElGSUVSLCBQb2xpY3lRdWFsaWZpZXJJbmZvLmRlZmF1bHRWYWx1ZXMoUVVBTElGSUVSKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBQT0xJQ1lfUVVBTElGSUVSX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIFFVQUxJRklFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLnBvbGljeVF1YWxpZmllcklkIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5BbnkoeyBuYW1lOiAobmFtZXMucXVhbGlmaWVyIHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxcCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUG9saWN5UXVhbGlmaWVySW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBwb2xpY3lRdWFsaWZpZXJJZDogUE9MSUNZX1FVQUxJRklFUl9JRCxcbiAgICAgICAgICAgICAgICBxdWFsaWZpZXI6IFFVQUxJRklFUlxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMucG9saWN5UXVhbGlmaWVySWQgPSBhc24xLnJlc3VsdC5wb2xpY3lRdWFsaWZpZXJJZC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMucXVhbGlmaWVyID0gYXNuMS5yZXN1bHQucXVhbGlmaWVyO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMucG9saWN5UXVhbGlmaWVySWQgfSksXG4gICAgICAgICAgICAgICAgdGhpcy5xdWFsaWZpZXJcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwb2xpY3lRdWFsaWZpZXJJZDogdGhpcy5wb2xpY3lRdWFsaWZpZXJJZCxcbiAgICAgICAgICAgIHF1YWxpZmllcjogdGhpcy5xdWFsaWZpZXIudG9KU09OKClcbiAgICAgICAgfTtcbiAgICB9XG59XG5Qb2xpY3lRdWFsaWZpZXJJbmZvLkNMQVNTX05BTUUgPSBcIlBvbGljeVF1YWxpZmllckluZm9cIjtcblxuY29uc3QgUE9MSUNZX0lERU5USUZJRVIgPSBcInBvbGljeUlkZW50aWZpZXJcIjtcbmNvbnN0IFBPTElDWV9RVUFMSUZJRVJTID0gXCJwb2xpY3lRdWFsaWZpZXJzXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxbyA9IFtcbiAgICBQT0xJQ1lfSURFTlRJRklFUixcbiAgICBQT0xJQ1lfUVVBTElGSUVSU1xuXTtcbmNsYXNzIFBvbGljeUluZm9ybWF0aW9uIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5wb2xpY3lJZGVudGlmaWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUE9MSUNZX0lERU5USUZJRVIsIFBvbGljeUluZm9ybWF0aW9uLmRlZmF1bHRWYWx1ZXMoUE9MSUNZX0lERU5USUZJRVIpKTtcbiAgICAgICAgaWYgKFBPTElDWV9RVUFMSUZJRVJTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucG9saWN5UXVhbGlmaWVycyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBPTElDWV9RVUFMSUZJRVJTLCBQb2xpY3lJbmZvcm1hdGlvbi5kZWZhdWx0VmFsdWVzKFBPTElDWV9RVUFMSUZJRVJTKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFBPTElDWV9JREVOVElGSUVSOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIFBPTElDWV9RVUFMSUZJRVJTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLnBvbGljeUlkZW50aWZpZXIgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMucG9saWN5UXVhbGlmaWVycyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBQb2xpY3lRdWFsaWZpZXJJbmZvLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxbyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUG9saWN5SW5mb3JtYXRpb24uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgcG9saWN5SWRlbnRpZmllcjogUE9MSUNZX0lERU5USUZJRVIsXG4gICAgICAgICAgICAgICAgcG9saWN5UXVhbGlmaWVyczogUE9MSUNZX1FVQUxJRklFUlNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnBvbGljeUlkZW50aWZpZXIgPSBhc24xLnJlc3VsdC5wb2xpY3lJZGVudGlmaWVyLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgaWYgKFBPTElDWV9RVUFMSUZJRVJTIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLnBvbGljeVF1YWxpZmllcnMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LnBvbGljeVF1YWxpZmllcnMsIGVsZW1lbnQgPT4gbmV3IFBvbGljeVF1YWxpZmllckluZm8oeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLnBvbGljeUlkZW50aWZpZXIgfSkpO1xuICAgICAgICBpZiAodGhpcy5wb2xpY3lRdWFsaWZpZXJzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMucG9saWN5UXVhbGlmaWVycywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgcG9saWN5SWRlbnRpZmllcjogdGhpcy5wb2xpY3lJZGVudGlmaWVyXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnBvbGljeVF1YWxpZmllcnMpXG4gICAgICAgICAgICByZXMucG9saWN5UXVhbGlmaWVycyA9IEFycmF5LmZyb20odGhpcy5wb2xpY3lRdWFsaWZpZXJzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cblBvbGljeUluZm9ybWF0aW9uLkNMQVNTX05BTUUgPSBcIlBvbGljeUluZm9ybWF0aW9uXCI7XG5cbmNvbnN0IENFUlRJRklDQVRFX1BPTElDSUVTID0gXCJjZXJ0aWZpY2F0ZVBvbGljaWVzXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxbiA9IFtcbiAgICBDRVJUSUZJQ0FURV9QT0xJQ0lFUyxcbl07XG5jbGFzcyBDZXJ0aWZpY2F0ZVBvbGljaWVzIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5jZXJ0aWZpY2F0ZVBvbGljaWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ0VSVElGSUNBVEVfUE9MSUNJRVMsIENlcnRpZmljYXRlUG9saWNpZXMuZGVmYXVsdFZhbHVlcyhDRVJUSUZJQ0FURV9QT0xJQ0lFUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ0VSVElGSUNBVEVfUE9MSUNJRVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNlcnRpZmljYXRlUG9saWNpZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFBvbGljeUluZm9ybWF0aW9uLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxbik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQ2VydGlmaWNhdGVQb2xpY2llcy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0ZVBvbGljaWVzOiBDRVJUSUZJQ0FURV9QT0xJQ0lFU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuY2VydGlmaWNhdGVQb2xpY2llcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuY2VydGlmaWNhdGVQb2xpY2llcywgZWxlbWVudCA9PiBuZXcgUG9saWN5SW5mb3JtYXRpb24oeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuY2VydGlmaWNhdGVQb2xpY2llcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2VydGlmaWNhdGVQb2xpY2llczogQXJyYXkuZnJvbSh0aGlzLmNlcnRpZmljYXRlUG9saWNpZXMsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG59XG5DZXJ0aWZpY2F0ZVBvbGljaWVzLkNMQVNTX05BTUUgPSBcIkNlcnRpZmljYXRlUG9saWNpZXNcIjtcblxuY29uc3QgVEVNUExBVEVfSUQgPSBcInRlbXBsYXRlSURcIjtcbmNvbnN0IFRFTVBMQVRFX01BSk9SX1ZFUlNJT04gPSBcInRlbXBsYXRlTWFqb3JWZXJzaW9uXCI7XG5jb25zdCBURU1QTEFURV9NSU5PUl9WRVJTSU9OID0gXCJ0ZW1wbGF0ZU1pbm9yVmVyc2lvblwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMW0gPSBbXG4gICAgVEVNUExBVEVfSUQsXG4gICAgVEVNUExBVEVfTUFKT1JfVkVSU0lPTixcbiAgICBURU1QTEFURV9NSU5PUl9WRVJTSU9OXG5dO1xuY2xhc3MgQ2VydGlmaWNhdGVUZW1wbGF0ZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudGVtcGxhdGVJRCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRFTVBMQVRFX0lELCBDZXJ0aWZpY2F0ZVRlbXBsYXRlLmRlZmF1bHRWYWx1ZXMoVEVNUExBVEVfSUQpKTtcbiAgICAgICAgaWYgKFRFTVBMQVRFX01BSk9SX1ZFUlNJT04gaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZU1ham9yVmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRFTVBMQVRFX01BSk9SX1ZFUlNJT04sIENlcnRpZmljYXRlVGVtcGxhdGUuZGVmYXVsdFZhbHVlcyhURU1QTEFURV9NQUpPUl9WRVJTSU9OKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRFTVBMQVRFX01JTk9SX1ZFUlNJT04gaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZU1pbm9yVmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRFTVBMQVRFX01JTk9SX1ZFUlNJT04sIENlcnRpZmljYXRlVGVtcGxhdGUuZGVmYXVsdFZhbHVlcyhURU1QTEFURV9NSU5PUl9WRVJTSU9OKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRFTVBMQVRFX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIFRFTVBMQVRFX01BSk9SX1ZFUlNJT046XG4gICAgICAgICAgICBjYXNlIFRFTVBMQVRFX01JTk9SX1ZFUlNJT046XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy50ZW1wbGF0ZUlEIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnRlbXBsYXRlTWFqb3JWZXJzaW9uIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnRlbXBsYXRlTWlub3JWZXJzaW9uIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMW0pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIENlcnRpZmljYXRlVGVtcGxhdGUuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVJRDogVEVNUExBVEVfSUQsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVNYWpvclZlcnNpb246IFRFTVBMQVRFX01BSk9SX1ZFUlNJT04sXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVNaW5vclZlcnNpb246IFRFTVBMQVRFX01JTk9SX1ZFUlNJT05cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnRlbXBsYXRlSUQgPSBhc24xLnJlc3VsdC50ZW1wbGF0ZUlELnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgaWYgKFRFTVBMQVRFX01BSk9SX1ZFUlNJT04gaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVNYWpvclZlcnNpb24gPSBhc24xLnJlc3VsdC50ZW1wbGF0ZU1ham9yVmVyc2lvbi52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB9XG4gICAgICAgIGlmIChURU1QTEFURV9NSU5PUl9WRVJTSU9OIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlTWlub3JWZXJzaW9uID0gYXNuMS5yZXN1bHQudGVtcGxhdGVNaW5vclZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy50ZW1wbGF0ZUlEIH0pKTtcbiAgICAgICAgaWYgKFRFTVBMQVRFX01BSk9SX1ZFUlNJT04gaW4gdGhpcykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy50ZW1wbGF0ZU1ham9yVmVyc2lvbiB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRFTVBMQVRFX01JTk9SX1ZFUlNJT04gaW4gdGhpcykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy50ZW1wbGF0ZU1pbm9yVmVyc2lvbiB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgdGVtcGxhdGVJRDogdGhpcy50ZW1wbGF0ZUlEXG4gICAgICAgIH07XG4gICAgICAgIGlmIChURU1QTEFURV9NQUpPUl9WRVJTSU9OIGluIHRoaXMpXG4gICAgICAgICAgICByZXMudGVtcGxhdGVNYWpvclZlcnNpb24gPSB0aGlzLnRlbXBsYXRlTWFqb3JWZXJzaW9uO1xuICAgICAgICBpZiAoVEVNUExBVEVfTUlOT1JfVkVSU0lPTiBpbiB0aGlzKVxuICAgICAgICAgICAgcmVzLnRlbXBsYXRlTWlub3JWZXJzaW9uID0gdGhpcy50ZW1wbGF0ZU1pbm9yVmVyc2lvbjtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5cbmNvbnN0IERJU1RSSUJVVElPTl9QT0lOVCQxID0gXCJkaXN0cmlidXRpb25Qb2ludFwiO1xuY29uc3QgRElTVFJJQlVUSU9OX1BPSU5UX05BTUVTJDEgPSBcImRpc3RyaWJ1dGlvblBvaW50TmFtZXNcIjtcbmNvbnN0IFJFQVNPTlMgPSBcInJlYXNvbnNcIjtcbmNvbnN0IENSTF9JU1NVRVIgPSBcImNSTElzc3VlclwiO1xuY29uc3QgQ1JMX0lTU1VFUl9OQU1FUyA9IFwiY1JMSXNzdWVyTmFtZXNcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFsID0gW1xuICAgIERJU1RSSUJVVElPTl9QT0lOVCQxLFxuICAgIERJU1RSSUJVVElPTl9QT0lOVF9OQU1FUyQxLFxuICAgIFJFQVNPTlMsXG4gICAgQ1JMX0lTU1VFUixcbiAgICBDUkxfSVNTVUVSX05BTUVTLFxuXTtcbmNsYXNzIERpc3RyaWJ1dGlvblBvaW50IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKERJU1RSSUJVVElPTl9QT0lOVCQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBESVNUUklCVVRJT05fUE9JTlQkMSwgRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhESVNUUklCVVRJT05fUE9JTlQkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChSRUFTT05TIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucmVhc29ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFQVNPTlMsIERpc3RyaWJ1dGlvblBvaW50LmRlZmF1bHRWYWx1ZXMoUkVBU09OUykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChDUkxfSVNTVUVSIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuY1JMSXNzdWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ1JMX0lTU1VFUiwgRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhDUkxfSVNTVUVSKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIERJU1RSSUJVVElPTl9QT0lOVCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgUkVBU09OUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgQ1JMX0lTU1VFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5kaXN0cmlidXRpb25Qb2ludCB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRpc3RyaWJ1dGlvblBvaW50TmFtZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEdlbmVyYWxOYW1lLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRpc3RyaWJ1dGlvblBvaW50IHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMuc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5yZWFzb25zIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5jUkxJc3N1ZXIgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuY1JMSXNzdWVyTmFtZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogR2VuZXJhbE5hbWUuc2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFsKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBEaXN0cmlidXRpb25Qb2ludC5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBkaXN0cmlidXRpb25Qb2ludDogRElTVFJJQlVUSU9OX1BPSU5UJDEsXG4gICAgICAgICAgICAgICAgZGlzdHJpYnV0aW9uUG9pbnROYW1lczogRElTVFJJQlVUSU9OX1BPSU5UX05BTUVTJDEsXG4gICAgICAgICAgICAgICAgcmVhc29uczogUkVBU09OUyxcbiAgICAgICAgICAgICAgICBjUkxJc3N1ZXI6IENSTF9JU1NVRVIsXG4gICAgICAgICAgICAgICAgY1JMSXNzdWVyTmFtZXM6IENSTF9JU1NVRVJfTkFNRVNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoRElTVFJJQlVUSU9OX1BPSU5UJDEgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGlmIChhc24xLnJlc3VsdC5kaXN0cmlidXRpb25Qb2ludC5pZEJsb2NrLnRhZ051bWJlciA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmRpc3RyaWJ1dGlvblBvaW50TmFtZXMsIGVsZW1lbnQgPT4gbmV3IEdlbmVyYWxOYW1lKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhc24xLnJlc3VsdC5kaXN0cmlidXRpb25Qb2ludC5pZEJsb2NrLnRhZ051bWJlciA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQgPSBuZXcgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMoe1xuICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0LmRpc3RyaWJ1dGlvblBvaW50LnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoUkVBU09OUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5yZWFzb25zID0gbmV3IGFzbjFqcy5CaXRTdHJpbmcoeyB2YWx1ZUhleDogYXNuMS5yZXN1bHQucmVhc29ucy52YWx1ZUJsb2NrLnZhbHVlSGV4IH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChDUkxfSVNTVUVSIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmNSTElzc3VlciA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuY1JMSXNzdWVyTmFtZXMsIGVsZW1lbnQgPT4gbmV3IEdlbmVyYWxOYW1lKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQpIHtcbiAgICAgICAgICAgIGxldCBpbnRlcm5hbFZhbHVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgIGludGVybmFsVmFsdWUgPSBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5kaXN0cmlidXRpb25Qb2ludCwgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbnRlcm5hbFZhbHVlID0gbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5kaXN0cmlidXRpb25Qb2ludC50b1NjaGVtYSgpXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbaW50ZXJuYWxWYWx1ZV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZWFzb25zKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlSGV4OiB0aGlzLnJlYXNvbnMudmFsdWVCbG9jay52YWx1ZUhleFZpZXdcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jUkxJc3N1ZXIpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmNSTElzc3VlciwgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0ge307XG4gICAgICAgIGlmICh0aGlzLmRpc3RyaWJ1dGlvblBvaW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5kaXN0cmlidXRpb25Qb2ludCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0LmRpc3RyaWJ1dGlvblBvaW50ID0gQXJyYXkuZnJvbSh0aGlzLmRpc3RyaWJ1dGlvblBvaW50LCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0LmRpc3RyaWJ1dGlvblBvaW50ID0gdGhpcy5kaXN0cmlidXRpb25Qb2ludC50b0pTT04oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZWFzb25zKSB7XG4gICAgICAgICAgICBvYmplY3QucmVhc29ucyA9IHRoaXMucmVhc29ucy50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jUkxJc3N1ZXIpIHtcbiAgICAgICAgICAgIG9iamVjdC5jUkxJc3N1ZXIgPSBBcnJheS5mcm9tKHRoaXMuY1JMSXNzdWVyLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgfVxufVxuRGlzdHJpYnV0aW9uUG9pbnQuQ0xBU1NfTkFNRSA9IFwiRGlzdHJpYnV0aW9uUG9pbnRcIjtcblxuY29uc3QgRElTVFJJQlVUSU9OX1BPSU5UUyA9IFwiZGlzdHJpYnV0aW9uUG9pbnRzXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxayA9IFtcbiAgICBESVNUUklCVVRJT05fUE9JTlRTXG5dO1xuY2xhc3MgQ1JMRGlzdHJpYnV0aW9uUG9pbnRzIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5kaXN0cmlidXRpb25Qb2ludHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBESVNUUklCVVRJT05fUE9JTlRTLCBDUkxEaXN0cmlidXRpb25Qb2ludHMuZGVmYXVsdFZhbHVlcyhESVNUUklCVVRJT05fUE9JTlRTKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBESVNUUklCVVRJT05fUE9JTlRTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5kaXN0cmlidXRpb25Qb2ludHMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IERpc3RyaWJ1dGlvblBvaW50LnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxayk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQ1JMRGlzdHJpYnV0aW9uUG9pbnRzLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGRpc3RyaWJ1dGlvblBvaW50czogRElTVFJJQlVUSU9OX1BPSU5UU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuZGlzdHJpYnV0aW9uUG9pbnRzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5kaXN0cmlidXRpb25Qb2ludHMsIGVsZW1lbnQgPT4gbmV3IERpc3RyaWJ1dGlvblBvaW50KHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmRpc3RyaWJ1dGlvblBvaW50cywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGlzdHJpYnV0aW9uUG9pbnRzOiBBcnJheS5mcm9tKHRoaXMuZGlzdHJpYnV0aW9uUG9pbnRzLCBvID0+IG8udG9KU09OKCkpXG4gICAgICAgIH07XG4gICAgfVxufVxuQ1JMRGlzdHJpYnV0aW9uUG9pbnRzLkNMQVNTX05BTUUgPSBcIkNSTERpc3RyaWJ1dGlvblBvaW50c1wiO1xuXG5jb25zdCBLRVlfUFVSUE9TRVMgPSBcImtleVB1cnBvc2VzXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxaiA9IFtcbiAgICBLRVlfUFVSUE9TRVMsXG5dO1xuY2xhc3MgRXh0S2V5VXNhZ2UgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmtleVB1cnBvc2VzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX1BVUlBPU0VTLCBFeHRLZXlVc2FnZS5kZWZhdWx0VmFsdWVzKEtFWV9QVVJQT1NFUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgS0VZX1BVUlBPU0VTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5rZXlQdXJwb3NlcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFqKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBFeHRLZXlVc2FnZS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBrZXlQdXJwb3NlczogS0VZX1BVUlBPU0VTXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5rZXlQdXJwb3NlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQua2V5UHVycG9zZXMsIChlbGVtZW50KSA9PiBlbGVtZW50LnZhbHVlQmxvY2sudG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5rZXlQdXJwb3NlcywgZWxlbWVudCA9PiBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogZWxlbWVudCB9KSlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBrZXlQdXJwb3NlczogQXJyYXkuZnJvbSh0aGlzLmtleVB1cnBvc2VzKVxuICAgICAgICB9O1xuICAgIH1cbn1cbkV4dEtleVVzYWdlLkNMQVNTX05BTUUgPSBcIkV4dEtleVVzYWdlXCI7XG5cbmNvbnN0IEFDQ0VTU19ERVNDUklQVElPTlMgPSBcImFjY2Vzc0Rlc2NyaXB0aW9uc1wiO1xuY2xhc3MgSW5mb0FjY2VzcyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuYWNjZXNzRGVzY3JpcHRpb25zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQUNDRVNTX0RFU0NSSVBUSU9OUywgSW5mb0FjY2Vzcy5kZWZhdWx0VmFsdWVzKEFDQ0VTU19ERVNDUklQVElPTlMpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEFDQ0VTU19ERVNDUklQVElPTlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmFjY2Vzc0Rlc2NyaXB0aW9ucyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQWNjZXNzRGVzY3JpcHRpb24uc2NoZW1hKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIFtcbiAgICAgICAgICAgIEFDQ0VTU19ERVNDUklQVElPTlNcbiAgICAgICAgXSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgSW5mb0FjY2Vzcy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBhY2Nlc3NEZXNjcmlwdGlvbnM6IEFDQ0VTU19ERVNDUklQVElPTlNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmFjY2Vzc0Rlc2NyaXB0aW9ucyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuYWNjZXNzRGVzY3JpcHRpb25zLCBlbGVtZW50ID0+IG5ldyBBY2Nlc3NEZXNjcmlwdGlvbih7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5hY2Nlc3NEZXNjcmlwdGlvbnMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFjY2Vzc0Rlc2NyaXB0aW9uczogQXJyYXkuZnJvbSh0aGlzLmFjY2Vzc0Rlc2NyaXB0aW9ucywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cbkluZm9BY2Nlc3MuQ0xBU1NfTkFNRSA9IFwiSW5mb0FjY2Vzc1wiO1xuXG5jb25zdCBESVNUUklCVVRJT05fUE9JTlQgPSBcImRpc3RyaWJ1dGlvblBvaW50XCI7XG5jb25zdCBESVNUUklCVVRJT05fUE9JTlRfTkFNRVMgPSBcImRpc3RyaWJ1dGlvblBvaW50TmFtZXNcIjtcbmNvbnN0IE9OTFlfQ09OVEFJTlNfVVNFUl9DRVJUUyA9IFwib25seUNvbnRhaW5zVXNlckNlcnRzXCI7XG5jb25zdCBPTkxZX0NPTlRBSU5TX0NBX0NFUlRTID0gXCJvbmx5Q29udGFpbnNDQUNlcnRzXCI7XG5jb25zdCBPTkxZX1NPTUVfUkVBU09OID0gXCJvbmx5U29tZVJlYXNvbnNcIjtcbmNvbnN0IElORElSRUNUX0NSTCA9IFwiaW5kaXJlY3RDUkxcIjtcbmNvbnN0IE9OTFlfQ09OVEFJTlNfQVRUUklCVVRFX0NFUlRTID0gXCJvbmx5Q29udGFpbnNBdHRyaWJ1dGVDZXJ0c1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMWkgPSBbXG4gICAgRElTVFJJQlVUSU9OX1BPSU5ULFxuICAgIERJU1RSSUJVVElPTl9QT0lOVF9OQU1FUyxcbiAgICBPTkxZX0NPTlRBSU5TX1VTRVJfQ0VSVFMsXG4gICAgT05MWV9DT05UQUlOU19DQV9DRVJUUyxcbiAgICBPTkxZX1NPTUVfUkVBU09OLFxuICAgIElORElSRUNUX0NSTCxcbiAgICBPTkxZX0NPTlRBSU5TX0FUVFJJQlVURV9DRVJUUyxcbl07XG5jbGFzcyBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBpZiAoRElTVFJJQlVUSU9OX1BPSU5UIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBESVNUUklCVVRJT05fUE9JTlQsIElzc3VpbmdEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKERJU1RSSUJVVElPTl9QT0lOVCkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub25seUNvbnRhaW5zVXNlckNlcnRzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT05MWV9DT05UQUlOU19VU0VSX0NFUlRTLCBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhPTkxZX0NPTlRBSU5TX1VTRVJfQ0VSVFMpKTtcbiAgICAgICAgdGhpcy5vbmx5Q29udGFpbnNDQUNlcnRzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT05MWV9DT05UQUlOU19DQV9DRVJUUywgSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LmRlZmF1bHRWYWx1ZXMoT05MWV9DT05UQUlOU19DQV9DRVJUUykpO1xuICAgICAgICBpZiAoT05MWV9TT01FX1JFQVNPTiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm9ubHlTb21lUmVhc29ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9OTFlfU09NRV9SRUFTT04sIElzc3VpbmdEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKE9OTFlfU09NRV9SRUFTT04pKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluZGlyZWN0Q1JMID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSU5ESVJFQ1RfQ1JMLCBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhJTkRJUkVDVF9DUkwpKTtcbiAgICAgICAgdGhpcy5vbmx5Q29udGFpbnNBdHRyaWJ1dGVDZXJ0cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9OTFlfQ09OVEFJTlNfQVRUUklCVVRFX0NFUlRTLCBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhPTkxZX0NPTlRBSU5TX0FUVFJJQlVURV9DRVJUUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgRElTVFJJQlVUSU9OX1BPSU5UOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgT05MWV9DT05UQUlOU19VU0VSX0NFUlRTOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGNhc2UgT05MWV9DT05UQUlOU19DQV9DRVJUUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBjYXNlIE9OTFlfU09NRV9SRUFTT046XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIElORElSRUNUX0NSTDpcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBjYXNlIE9OTFlfQ09OVEFJTlNfQVRUUklCVVRFX0NFUlRTOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRpc3RyaWJ1dGlvblBvaW50IHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRpc3RyaWJ1dGlvblBvaW50TmFtZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEdlbmVyYWxOYW1lLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRpc3RyaWJ1dGlvblBvaW50IHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMub25seUNvbnRhaW5zVXNlckNlcnRzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMub25seUNvbnRhaW5zQ0FDZXJ0cyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm9ubHlTb21lUmVhc29ucyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmluZGlyZWN0Q1JMIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogNFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMub25seUNvbnRhaW5zQXR0cmlidXRlQ2VydHMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiA1XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFpKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgZGlzdHJpYnV0aW9uUG9pbnQ6IERJU1RSSUJVVElPTl9QT0lOVCxcbiAgICAgICAgICAgICAgICBkaXN0cmlidXRpb25Qb2ludE5hbWVzOiBESVNUUklCVVRJT05fUE9JTlRfTkFNRVMsXG4gICAgICAgICAgICAgICAgb25seUNvbnRhaW5zVXNlckNlcnRzOiBPTkxZX0NPTlRBSU5TX1VTRVJfQ0VSVFMsXG4gICAgICAgICAgICAgICAgb25seUNvbnRhaW5zQ0FDZXJ0czogT05MWV9DT05UQUlOU19DQV9DRVJUUyxcbiAgICAgICAgICAgICAgICBvbmx5U29tZVJlYXNvbnM6IE9OTFlfU09NRV9SRUFTT04sXG4gICAgICAgICAgICAgICAgaW5kaXJlY3RDUkw6IElORElSRUNUX0NSTCxcbiAgICAgICAgICAgICAgICBvbmx5Q29udGFpbnNBdHRyaWJ1dGVDZXJ0czogT05MWV9DT05UQUlOU19BVFRSSUJVVEVfQ0VSVFNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoRElTVFJJQlVUSU9OX1BPSU5UIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIChhc24xLnJlc3VsdC5kaXN0cmlidXRpb25Qb2ludC5pZEJsb2NrLnRhZ051bWJlciA9PT0gMCk6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmRpc3RyaWJ1dGlvblBvaW50TmFtZXMsIGVsZW1lbnQgPT4gbmV3IEdlbmVyYWxOYW1lKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAoYXNuMS5yZXN1bHQuZGlzdHJpYnV0aW9uUG9pbnQuaWRCbG9jay50YWdOdW1iZXIgPT09IDEpOlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3RyaWJ1dGlvblBvaW50ID0gbmV3IFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYXNuMS5yZXN1bHQuZGlzdHJpYnV0aW9uUG9pbnQudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmtub3duIHRhZ051bWJlciBmb3IgZGlzdHJpYnV0aW9uUG9pbnQ6IHskYXNuMS5yZXN1bHQuZGlzdHJpYnV0aW9uUG9pbnQuaWRCbG9jay50YWdOdW1iZXJ9XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChPTkxZX0NPTlRBSU5TX1VTRVJfQ0VSVFMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheShhc24xLnJlc3VsdC5vbmx5Q29udGFpbnNVc2VyQ2VydHMudmFsdWVCbG9jay52YWx1ZUhleCk7XG4gICAgICAgICAgICB0aGlzLm9ubHlDb250YWluc1VzZXJDZXJ0cyA9ICh2aWV3WzBdICE9PSAweDAwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoT05MWV9DT05UQUlOU19DQV9DRVJUUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KGFzbjEucmVzdWx0Lm9ubHlDb250YWluc0NBQ2VydHMudmFsdWVCbG9jay52YWx1ZUhleCk7XG4gICAgICAgICAgICB0aGlzLm9ubHlDb250YWluc0NBQ2VydHMgPSAodmlld1swXSAhPT0gMHgwMCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE9OTFlfU09NRV9SRUFTT04gaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheShhc24xLnJlc3VsdC5vbmx5U29tZVJlYXNvbnMudmFsdWVCbG9jay52YWx1ZUhleCk7XG4gICAgICAgICAgICB0aGlzLm9ubHlTb21lUmVhc29ucyA9IHZpZXdbMF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKElORElSRUNUX0NSTCBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KGFzbjEucmVzdWx0LmluZGlyZWN0Q1JMLnZhbHVlQmxvY2sudmFsdWVIZXgpO1xuICAgICAgICAgICAgdGhpcy5pbmRpcmVjdENSTCA9ICh2aWV3WzBdICE9PSAweDAwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoT05MWV9DT05UQUlOU19BVFRSSUJVVEVfQ0VSVFMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheShhc24xLnJlc3VsdC5vbmx5Q29udGFpbnNBdHRyaWJ1dGVDZXJ0cy52YWx1ZUJsb2NrLnZhbHVlSGV4KTtcbiAgICAgICAgICAgIHRoaXMub25seUNvbnRhaW5zQXR0cmlidXRlQ2VydHMgPSAodmlld1swXSAhPT0gMHgwMCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIGlmICh0aGlzLmRpc3RyaWJ1dGlvblBvaW50KSB7XG4gICAgICAgICAgICBsZXQgdmFsdWU7XG4gICAgICAgICAgICBpZiAodGhpcy5kaXN0cmlidXRpb25Qb2ludCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5kaXN0cmlidXRpb25Qb2ludCwgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQudG9TY2hlbWEoKTtcbiAgICAgICAgICAgICAgICB2YWx1ZS5pZEJsb2NrLnRhZ0NsYXNzID0gMztcbiAgICAgICAgICAgICAgICB2YWx1ZS5pZEJsb2NrLnRhZ051bWJlciA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFt2YWx1ZV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vbmx5Q29udGFpbnNVc2VyQ2VydHMgIT09IElzc3VpbmdEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKE9OTFlfQ09OVEFJTlNfVVNFUl9DRVJUUykpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IChuZXcgVWludDhBcnJheShbMHhGRl0pKS5idWZmZXJcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vbmx5Q29udGFpbnNDQUNlcnRzICE9PSBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhPTkxZX0NPTlRBSU5TX0NBX0NFUlRTKSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZUhleDogKG5ldyBVaW50OEFycmF5KFsweEZGXSkpLmJ1ZmZlclxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9ubHlTb21lUmVhc29ucyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoMSk7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKTtcbiAgICAgICAgICAgIHZpZXdbMF0gPSB0aGlzLm9ubHlTb21lUmVhc29ucztcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogM1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IGJ1ZmZlclxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmluZGlyZWN0Q1JMICE9PSBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhJTkRJUkVDVF9DUkwpKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlSGV4OiAobmV3IFVpbnQ4QXJyYXkoWzB4RkZdKSkuYnVmZmVyXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub25seUNvbnRhaW5zQXR0cmlidXRlQ2VydHMgIT09IElzc3VpbmdEaXN0cmlidXRpb25Qb2ludC5kZWZhdWx0VmFsdWVzKE9OTFlfQ09OVEFJTlNfQVRUUklCVVRFX0NFUlRTKSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiA1XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZUhleDogKG5ldyBVaW50OEFycmF5KFsweEZGXSkpLmJ1ZmZlclxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IHt9O1xuICAgICAgICBpZiAodGhpcy5kaXN0cmlidXRpb25Qb2ludCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgIG9iai5kaXN0cmlidXRpb25Qb2ludCA9IEFycmF5LmZyb20odGhpcy5kaXN0cmlidXRpb25Qb2ludCwgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG9iai5kaXN0cmlidXRpb25Qb2ludCA9IHRoaXMuZGlzdHJpYnV0aW9uUG9pbnQudG9KU09OKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub25seUNvbnRhaW5zVXNlckNlcnRzICE9PSBJc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQuZGVmYXVsdFZhbHVlcyhPTkxZX0NPTlRBSU5TX1VTRVJfQ0VSVFMpKSB7XG4gICAgICAgICAgICBvYmoub25seUNvbnRhaW5zVXNlckNlcnRzID0gdGhpcy5vbmx5Q29udGFpbnNVc2VyQ2VydHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub25seUNvbnRhaW5zQ0FDZXJ0cyAhPT0gSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LmRlZmF1bHRWYWx1ZXMoT05MWV9DT05UQUlOU19DQV9DRVJUUykpIHtcbiAgICAgICAgICAgIG9iai5vbmx5Q29udGFpbnNDQUNlcnRzID0gdGhpcy5vbmx5Q29udGFpbnNDQUNlcnRzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChPTkxZX1NPTUVfUkVBU09OIGluIHRoaXMpIHtcbiAgICAgICAgICAgIG9iai5vbmx5U29tZVJlYXNvbnMgPSB0aGlzLm9ubHlTb21lUmVhc29ucztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pbmRpcmVjdENSTCAhPT0gSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LmRlZmF1bHRWYWx1ZXMoSU5ESVJFQ1RfQ1JMKSkge1xuICAgICAgICAgICAgb2JqLmluZGlyZWN0Q1JMID0gdGhpcy5pbmRpcmVjdENSTDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vbmx5Q29udGFpbnNBdHRyaWJ1dGVDZXJ0cyAhPT0gSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LmRlZmF1bHRWYWx1ZXMoT05MWV9DT05UQUlOU19BVFRSSUJVVEVfQ0VSVFMpKSB7XG4gICAgICAgICAgICBvYmoub25seUNvbnRhaW5zQXR0cmlidXRlQ2VydHMgPSB0aGlzLm9ubHlDb250YWluc0F0dHJpYnV0ZUNlcnRzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxufVxuSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LkNMQVNTX05BTUUgPSBcIklzc3VpbmdEaXN0cmlidXRpb25Qb2ludFwiO1xuXG5jb25zdCBCQVNFID0gXCJiYXNlXCI7XG5jb25zdCBNSU5JTVVNID0gXCJtaW5pbXVtXCI7XG5jb25zdCBNQVhJTVVNID0gXCJtYXhpbXVtXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxaCA9IFtcbiAgICBCQVNFLFxuICAgIE1JTklNVU0sXG4gICAgTUFYSU1VTVxuXTtcbmNsYXNzIEdlbmVyYWxTdWJ0cmVlIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5iYXNlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQkFTRSwgR2VuZXJhbFN1YnRyZWUuZGVmYXVsdFZhbHVlcyhCQVNFKSk7XG4gICAgICAgIHRoaXMubWluaW11bSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE1JTklNVU0sIEdlbmVyYWxTdWJ0cmVlLmRlZmF1bHRWYWx1ZXMoTUlOSU1VTSkpO1xuICAgICAgICBpZiAoTUFYSU1VTSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm1heGltdW0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBNQVhJTVVNLCBHZW5lcmFsU3VidHJlZS5kZWZhdWx0VmFsdWVzKE1BWElNVU0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQkFTRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyYWxOYW1lKCk7XG4gICAgICAgICAgICBjYXNlIE1JTklNVU06XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIE1BWElNVU06XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIEdlbmVyYWxOYW1lLnNjaGVtYShuYW1lcy5iYXNlIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLm1pbmltdW0gfHwgRU1QVFlfU1RSSU5HKSB9KV1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLm1heGltdW0gfHwgRU1QVFlfU1RSSU5HKSB9KV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFoKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBHZW5lcmFsU3VidHJlZS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBiYXNlOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEJBU0VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWluaW11bTogTUlOSU1VTSxcbiAgICAgICAgICAgICAgICBtYXhpbXVtOiBNQVhJTVVNXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5iYXNlID0gbmV3IEdlbmVyYWxOYW1lKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5iYXNlIH0pO1xuICAgICAgICBpZiAoTUlOSU1VTSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKGFzbjEucmVzdWx0Lm1pbmltdW0udmFsdWVCbG9jay5pc0hleE9ubHkpXG4gICAgICAgICAgICAgICAgdGhpcy5taW5pbXVtID0gYXNuMS5yZXN1bHQubWluaW11bTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB0aGlzLm1pbmltdW0gPSBhc24xLnJlc3VsdC5taW5pbXVtLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE1BWElNVU0gaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGlmIChhc24xLnJlc3VsdC5tYXhpbXVtLnZhbHVlQmxvY2suaXNIZXhPbmx5KVxuICAgICAgICAgICAgICAgIHRoaXMubWF4aW11bSA9IGFzbjEucmVzdWx0Lm1heGltdW07XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdGhpcy5tYXhpbXVtID0gYXNuMS5yZXN1bHQubWF4aW11bS52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuYmFzZS50b1NjaGVtYSgpKTtcbiAgICAgICAgaWYgKHRoaXMubWluaW11bSAhPT0gMCkge1xuICAgICAgICAgICAgbGV0IHZhbHVlTWluaW11bSA9IDA7XG4gICAgICAgICAgICBpZiAodGhpcy5taW5pbXVtIGluc3RhbmNlb2YgYXNuMWpzLkludGVnZXIpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZU1pbmltdW0gPSB0aGlzLm1pbmltdW07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWx1ZU1pbmltdW0gPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy5taW5pbXVtIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbdmFsdWVNaW5pbXVtXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChNQVhJTVVNIGluIHRoaXMpIHtcbiAgICAgICAgICAgIGxldCB2YWx1ZU1heGltdW0gPSAwO1xuICAgICAgICAgICAgaWYgKHRoaXMubWF4aW11bSBpbnN0YW5jZW9mIGFzbjFqcy5JbnRlZ2VyKSB7XG4gICAgICAgICAgICAgICAgdmFsdWVNYXhpbXVtID0gdGhpcy5tYXhpbXVtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFsdWVNYXhpbXVtID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMubWF4aW11bSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3ZhbHVlTWF4aW11bV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICBiYXNlOiB0aGlzLmJhc2UudG9KU09OKClcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMubWluaW11bSAhPT0gMCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm1pbmltdW0gPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICByZXMubWluaW11bSA9IHRoaXMubWluaW11bTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcy5taW5pbXVtID0gdGhpcy5taW5pbXVtLnRvSlNPTigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1heGltdW0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm1heGltdW0gPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICByZXMubWF4aW11bSA9IHRoaXMubWF4aW11bTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcy5tYXhpbXVtID0gdGhpcy5tYXhpbXVtLnRvSlNPTigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuR2VuZXJhbFN1YnRyZWUuQ0xBU1NfTkFNRSA9IFwiR2VuZXJhbFN1YnRyZWVcIjtcblxuY29uc3QgUEVSTUlUVEVEX1NVQlRSRUVTID0gXCJwZXJtaXR0ZWRTdWJ0cmVlc1wiO1xuY29uc3QgRVhDTFVERURfU1VCVFJFRVMgPSBcImV4Y2x1ZGVkU3VidHJlZXNcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFnID0gW1xuICAgIFBFUk1JVFRFRF9TVUJUUkVFUyxcbiAgICBFWENMVURFRF9TVUJUUkVFU1xuXTtcbmNsYXNzIE5hbWVDb25zdHJhaW50cyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGlmIChQRVJNSVRURURfU1VCVFJFRVMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5wZXJtaXR0ZWRTdWJ0cmVlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBFUk1JVFRFRF9TVUJUUkVFUywgTmFtZUNvbnN0cmFpbnRzLmRlZmF1bHRWYWx1ZXMoUEVSTUlUVEVEX1NVQlRSRUVTKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEVYQ0xVREVEX1NVQlRSRUVTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZXhjbHVkZWRTdWJ0cmVlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVYQ0xVREVEX1NVQlRSRUVTLCBOYW1lQ29uc3RyYWludHMuZGVmYXVsdFZhbHVlcyhFWENMVURFRF9TVUJUUkVFUykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBQRVJNSVRURURfU1VCVFJFRVM6XG4gICAgICAgICAgICBjYXNlIEVYQ0xVREVEX1NVQlRSRUVTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnBlcm1pdHRlZFN1YnRyZWVzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEdlbmVyYWxTdWJ0cmVlLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmV4Y2x1ZGVkU3VidHJlZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogR2VuZXJhbFN1YnRyZWUuc2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDFnKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBOYW1lQ29uc3RyYWludHMuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgcGVybWl0dGVkU3VidHJlZXM6IFBFUk1JVFRFRF9TVUJUUkVFUyxcbiAgICAgICAgICAgICAgICBleGNsdWRlZFN1YnRyZWVzOiBFWENMVURFRF9TVUJUUkVFU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChQRVJNSVRURURfU1VCVFJFRVMgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnBlcm1pdHRlZFN1YnRyZWVzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5wZXJtaXR0ZWRTdWJ0cmVlcywgZWxlbWVudCA9PiBuZXcgR2VuZXJhbFN1YnRyZWUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICBpZiAoRVhDTFVERURfU1VCVFJFRVMgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmV4Y2x1ZGVkU3VidHJlZXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmV4Y2x1ZGVkU3VidHJlZXMsIGVsZW1lbnQgPT4gbmV3IEdlbmVyYWxTdWJ0cmVlKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIGlmICh0aGlzLnBlcm1pdHRlZFN1YnRyZWVzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5wZXJtaXR0ZWRTdWJ0cmVlcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZXhjbHVkZWRTdWJ0cmVlcykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuZXhjbHVkZWRTdWJ0cmVlcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0ge307XG4gICAgICAgIGlmICh0aGlzLnBlcm1pdHRlZFN1YnRyZWVzKSB7XG4gICAgICAgICAgICBvYmplY3QucGVybWl0dGVkU3VidHJlZXMgPSBBcnJheS5mcm9tKHRoaXMucGVybWl0dGVkU3VidHJlZXMsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZXhjbHVkZWRTdWJ0cmVlcykge1xuICAgICAgICAgICAgb2JqZWN0LmV4Y2x1ZGVkU3VidHJlZXMgPSBBcnJheS5mcm9tKHRoaXMuZXhjbHVkZWRTdWJ0cmVlcywgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH1cbn1cbk5hbWVDb25zdHJhaW50cy5DTEFTU19OQU1FID0gXCJOYW1lQ29uc3RyYWludHNcIjtcblxuY29uc3QgUkVRVUlSRV9FWFBMSUNJVF9QT0xJQ1kgPSBcInJlcXVpcmVFeHBsaWNpdFBvbGljeVwiO1xuY29uc3QgSU5ISUJJVF9QT0xJQ1lfTUFQUElORyA9IFwiaW5oaWJpdFBvbGljeU1hcHBpbmdcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFmID0gW1xuICAgIFJFUVVJUkVfRVhQTElDSVRfUE9MSUNZLFxuICAgIElOSElCSVRfUE9MSUNZX01BUFBJTkcsXG5dO1xuY2xhc3MgUG9saWN5Q29uc3RyYWludHMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBpZiAoUkVRVUlSRV9FWFBMSUNJVF9QT0xJQ1kgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5yZXF1aXJlRXhwbGljaXRQb2xpY3kgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVFVSVJFX0VYUExJQ0lUX1BPTElDWSwgUG9saWN5Q29uc3RyYWludHMuZGVmYXVsdFZhbHVlcyhSRVFVSVJFX0VYUExJQ0lUX1BPTElDWSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChJTkhJQklUX1BPTElDWV9NQVBQSU5HIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuaW5oaWJpdFBvbGljeU1hcHBpbmcgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBJTkhJQklUX1BPTElDWV9NQVBQSU5HLCBQb2xpY3lDb25zdHJhaW50cy5kZWZhdWx0VmFsdWVzKElOSElCSVRfUE9MSUNZX01BUFBJTkcpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgUkVRVUlSRV9FWFBMSUNJVF9QT0xJQ1k6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIElOSElCSVRfUE9MSUNZX01BUFBJTkc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnJlcXVpcmVFeHBsaWNpdFBvbGljeSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmluaGliaXRQb2xpY3lNYXBwaW5nIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxZik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUG9saWN5Q29uc3RyYWludHMuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgcmVxdWlyZUV4cGxpY2l0UG9saWN5OiBSRVFVSVJFX0VYUExJQ0lUX1BPTElDWSxcbiAgICAgICAgICAgICAgICBpbmhpYml0UG9saWN5TWFwcGluZzogSU5ISUJJVF9QT0xJQ1lfTUFQUElOR1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChSRVFVSVJFX0VYUExJQ0lUX1BPTElDWSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgZmllbGQxID0gYXNuMS5yZXN1bHQucmVxdWlyZUV4cGxpY2l0UG9saWN5O1xuICAgICAgICAgICAgZmllbGQxLmlkQmxvY2sudGFnQ2xhc3MgPSAxO1xuICAgICAgICAgICAgZmllbGQxLmlkQmxvY2sudGFnTnVtYmVyID0gMjtcbiAgICAgICAgICAgIGNvbnN0IGJlcjEgPSBmaWVsZDEudG9CRVIoZmFsc2UpO1xuICAgICAgICAgICAgY29uc3QgaW50MSA9IGFzbjFqcy5mcm9tQkVSKGJlcjEpO1xuICAgICAgICAgICAgQXNuRXJyb3IuYXNzZXJ0KGludDEsIFwiSW50ZWdlclwiKTtcbiAgICAgICAgICAgIHRoaXMucmVxdWlyZUV4cGxpY2l0UG9saWN5ID0gaW50MS5yZXN1bHQudmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgfVxuICAgICAgICBpZiAoSU5ISUJJVF9QT0xJQ1lfTUFQUElORyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgY29uc3QgZmllbGQyID0gYXNuMS5yZXN1bHQuaW5oaWJpdFBvbGljeU1hcHBpbmc7XG4gICAgICAgICAgICBmaWVsZDIuaWRCbG9jay50YWdDbGFzcyA9IDE7XG4gICAgICAgICAgICBmaWVsZDIuaWRCbG9jay50YWdOdW1iZXIgPSAyO1xuICAgICAgICAgICAgY29uc3QgYmVyMiA9IGZpZWxkMi50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICBjb25zdCBpbnQyID0gYXNuMWpzLmZyb21CRVIoYmVyMik7XG4gICAgICAgICAgICBBc25FcnJvci5hc3NlcnQoaW50MiwgXCJJbnRlZ2VyXCIpO1xuICAgICAgICAgICAgdGhpcy5pbmhpYml0UG9saWN5TWFwcGluZyA9IGludDIucmVzdWx0LnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIGlmIChSRVFVSVJFX0VYUExJQ0lUX1BPTElDWSBpbiB0aGlzKSB7XG4gICAgICAgICAgICBjb25zdCBpbnQxID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMucmVxdWlyZUV4cGxpY2l0UG9saWN5IH0pO1xuICAgICAgICAgICAgaW50MS5pZEJsb2NrLnRhZ0NsYXNzID0gMztcbiAgICAgICAgICAgIGludDEuaWRCbG9jay50YWdOdW1iZXIgPSAwO1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChpbnQxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoSU5ISUJJVF9QT0xJQ1lfTUFQUElORyBpbiB0aGlzKSB7XG4gICAgICAgICAgICBjb25zdCBpbnQyID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMuaW5oaWJpdFBvbGljeU1hcHBpbmcgfSk7XG4gICAgICAgICAgICBpbnQyLmlkQmxvY2sudGFnQ2xhc3MgPSAzO1xuICAgICAgICAgICAgaW50Mi5pZEJsb2NrLnRhZ051bWJlciA9IDE7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKGludDIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHt9O1xuICAgICAgICBpZiAoUkVRVUlSRV9FWFBMSUNJVF9QT0xJQ1kgaW4gdGhpcykge1xuICAgICAgICAgICAgcmVzLnJlcXVpcmVFeHBsaWNpdFBvbGljeSA9IHRoaXMucmVxdWlyZUV4cGxpY2l0UG9saWN5O1xuICAgICAgICB9XG4gICAgICAgIGlmIChJTkhJQklUX1BPTElDWV9NQVBQSU5HIGluIHRoaXMpIHtcbiAgICAgICAgICAgIHJlcy5pbmhpYml0UG9saWN5TWFwcGluZyA9IHRoaXMuaW5oaWJpdFBvbGljeU1hcHBpbmc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5Qb2xpY3lDb25zdHJhaW50cy5DTEFTU19OQU1FID0gXCJQb2xpY3lDb25zdHJhaW50c1wiO1xuXG5jb25zdCBJU1NVRVJfRE9NQUlOX1BPTElDWSA9IFwiaXNzdWVyRG9tYWluUG9saWN5XCI7XG5jb25zdCBTVUJKRUNUX0RPTUFJTl9QT0xJQ1kgPSBcInN1YmplY3REb21haW5Qb2xpY3lcIjtcbmNvbnN0IENMRUFSX1BST1BTJDFlID0gW1xuICAgIElTU1VFUl9ET01BSU5fUE9MSUNZLFxuICAgIFNVQkpFQ1RfRE9NQUlOX1BPTElDWVxuXTtcbmNsYXNzIFBvbGljeU1hcHBpbmcgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmlzc3VlckRvbWFpblBvbGljeSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIElTU1VFUl9ET01BSU5fUE9MSUNZLCBQb2xpY3lNYXBwaW5nLmRlZmF1bHRWYWx1ZXMoSVNTVUVSX0RPTUFJTl9QT0xJQ1kpKTtcbiAgICAgICAgdGhpcy5zdWJqZWN0RG9tYWluUG9saWN5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU1VCSkVDVF9ET01BSU5fUE9MSUNZLCBQb2xpY3lNYXBwaW5nLmRlZmF1bHRWYWx1ZXMoU1VCSkVDVF9ET01BSU5fUE9MSUNZKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBJU1NVRVJfRE9NQUlOX1BPTElDWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBTVUJKRUNUX0RPTUFJTl9QT0xJQ1k6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLmlzc3VlckRvbWFpblBvbGljeSB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5zdWJqZWN0RG9tYWluUG9saWN5IHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxZSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUG9saWN5TWFwcGluZy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBpc3N1ZXJEb21haW5Qb2xpY3k6IElTU1VFUl9ET01BSU5fUE9MSUNZLFxuICAgICAgICAgICAgICAgIHN1YmplY3REb21haW5Qb2xpY3k6IFNVQkpFQ1RfRE9NQUlOX1BPTElDWVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuaXNzdWVyRG9tYWluUG9saWN5ID0gYXNuMS5yZXN1bHQuaXNzdWVyRG9tYWluUG9saWN5LnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5zdWJqZWN0RG9tYWluUG9saWN5ID0gYXNuMS5yZXN1bHQuc3ViamVjdERvbWFpblBvbGljeS52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5pc3N1ZXJEb21haW5Qb2xpY3kgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMuc3ViamVjdERvbWFpblBvbGljeSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlzc3VlckRvbWFpblBvbGljeTogdGhpcy5pc3N1ZXJEb21haW5Qb2xpY3ksXG4gICAgICAgICAgICBzdWJqZWN0RG9tYWluUG9saWN5OiB0aGlzLnN1YmplY3REb21haW5Qb2xpY3lcbiAgICAgICAgfTtcbiAgICB9XG59XG5Qb2xpY3lNYXBwaW5nLkNMQVNTX05BTUUgPSBcIlBvbGljeU1hcHBpbmdcIjtcblxuY29uc3QgTUFQUElOR1MgPSBcIm1hcHBpbmdzXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxZCA9IFtcbiAgICBNQVBQSU5HUyxcbl07XG5jbGFzcyBQb2xpY3lNYXBwaW5ncyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMubWFwcGluZ3MgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBNQVBQSU5HUywgUG9saWN5TWFwcGluZ3MuZGVmYXVsdFZhbHVlcyhNQVBQSU5HUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgTUFQUElOR1M6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm1hcHBpbmdzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBQb2xpY3lNYXBwaW5nLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxZCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUG9saWN5TWFwcGluZ3Muc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgbWFwcGluZ3M6IE1BUFBJTkdTXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5tYXBwaW5ncyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQubWFwcGluZ3MsIGVsZW1lbnQgPT4gbmV3IFBvbGljeU1hcHBpbmcoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMubWFwcGluZ3MsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1hcHBpbmdzOiBBcnJheS5mcm9tKHRoaXMubWFwcGluZ3MsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG59XG5Qb2xpY3lNYXBwaW5ncy5DTEFTU19OQU1FID0gXCJQb2xpY3lNYXBwaW5nc1wiO1xuXG5jb25zdCBOT1RfQkVGT1JFJDEgPSBcIm5vdEJlZm9yZVwiO1xuY29uc3QgTk9UX0FGVEVSJDEgPSBcIm5vdEFmdGVyXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxYyA9IFtcbiAgICBOT1RfQkVGT1JFJDEsXG4gICAgTk9UX0FGVEVSJDFcbl07XG5jbGFzcyBQcml2YXRlS2V5VXNhZ2VQZXJpb2QgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBpZiAoTk9UX0JFRk9SRSQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMubm90QmVmb3JlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTk9UX0JFRk9SRSQxLCBQcml2YXRlS2V5VXNhZ2VQZXJpb2QuZGVmYXVsdFZhbHVlcyhOT1RfQkVGT1JFJDEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTk9UX0FGVEVSJDEgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5ub3RBZnRlciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE5PVF9BRlRFUiQxLCBQcml2YXRlS2V5VXNhZ2VQZXJpb2QuZGVmYXVsdFZhbHVlcyhOT1RfQUZURVIkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBOT1RfQkVGT1JFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKCk7XG4gICAgICAgICAgICBjYXNlIE5PVF9BRlRFUiQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ub3RCZWZvcmUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ub3RBZnRlciB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMWMpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFByaXZhdGVLZXlVc2FnZVBlcmlvZC5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBub3RCZWZvcmU6IE5PVF9CRUZPUkUkMSxcbiAgICAgICAgICAgICAgICBub3RBZnRlcjogTk9UX0FGVEVSJDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoTk9UX0JFRk9SRSQxIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBjb25zdCBsb2NhbE5vdEJlZm9yZSA9IG5ldyBhc24xanMuR2VuZXJhbGl6ZWRUaW1lKCk7XG4gICAgICAgICAgICBsb2NhbE5vdEJlZm9yZS5mcm9tQnVmZmVyKGFzbjEucmVzdWx0Lm5vdEJlZm9yZS52YWx1ZUJsb2NrLnZhbHVlSGV4KTtcbiAgICAgICAgICAgIHRoaXMubm90QmVmb3JlID0gbG9jYWxOb3RCZWZvcmUudG9EYXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE5PVF9BRlRFUiQxIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBjb25zdCBsb2NhbE5vdEFmdGVyID0gbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoeyB2YWx1ZUhleDogYXNuMS5yZXN1bHQubm90QWZ0ZXIudmFsdWVCbG9jay52YWx1ZUhleCB9KTtcbiAgICAgICAgICAgIGxvY2FsTm90QWZ0ZXIuZnJvbUJ1ZmZlcihhc24xLnJlc3VsdC5ub3RBZnRlci52YWx1ZUJsb2NrLnZhbHVlSGV4KTtcbiAgICAgICAgICAgIHRoaXMubm90QWZ0ZXIgPSBsb2NhbE5vdEFmdGVyLnRvRGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBpZiAoTk9UX0JFRk9SRSQxIGluIHRoaXMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IChuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IHZhbHVlRGF0ZTogdGhpcy5ub3RCZWZvcmUgfSkpLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE5PVF9BRlRFUiQxIGluIHRoaXMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IChuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IHZhbHVlRGF0ZTogdGhpcy5ub3RBZnRlciB9KSkudmFsdWVCbG9jay52YWx1ZUhleFZpZXdcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMubm90QmVmb3JlKSB7XG4gICAgICAgICAgICByZXMubm90QmVmb3JlID0gdGhpcy5ub3RCZWZvcmU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubm90QWZ0ZXIpIHtcbiAgICAgICAgICAgIHJlcy5ub3RBZnRlciA9IHRoaXMubm90QWZ0ZXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5Qcml2YXRlS2V5VXNhZ2VQZXJpb2QuQ0xBU1NfTkFNRSA9IFwiUHJpdmF0ZUtleVVzYWdlUGVyaW9kXCI7XG5cbmNvbnN0IElEID0gXCJpZFwiO1xuY29uc3QgVFlQRSQyID0gXCJ0eXBlXCI7XG5jb25zdCBWQUxVRVMgPSBcInZhbHVlc1wiO1xuY29uc3QgUUNfU1RBVEVNRU5UX0NMRUFSX1BST1BTID0gW1xuICAgIElELFxuICAgIFRZUEUkMlxuXTtcbmNvbnN0IFFDX1NUQVRFTUVOVFNfQ0xFQVJfUFJPUFMgPSBbXG4gICAgVkFMVUVTXG5dO1xuY2xhc3MgUUNTdGF0ZW1lbnQgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmlkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSUQsIFFDU3RhdGVtZW50LmRlZmF1bHRWYWx1ZXMoSUQpKTtcbiAgICAgICAgaWYgKFRZUEUkMiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBUWVBFJDIsIFFDU3RhdGVtZW50LmRlZmF1bHRWYWx1ZXMoVFlQRSQyKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIElEOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIFRZUEUkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5OdWxsKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIElEOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IEVNUFRZX1NUUklORyk7XG4gICAgICAgICAgICBjYXNlIFRZUEUkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlIGluc3RhbmNlb2YgYXNuMWpzLk51bGwpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMuaWQgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkFueSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy50eXBlIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBRQ19TVEFURU1FTlRfQ0xFQVJfUFJPUFMpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFFDU3RhdGVtZW50LnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGlkOiBJRCxcbiAgICAgICAgICAgICAgICB0eXBlOiBUWVBFJDJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmlkID0gYXNuMS5yZXN1bHQuaWQudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICBpZiAoVFlQRSQyIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy50eXBlID0gYXNuMS5yZXN1bHQudHlwZTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gW1xuICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMuaWQgfSlcbiAgICAgICAgXTtcbiAgICAgICAgaWYgKFRZUEUkMiBpbiB0aGlzKVxuICAgICAgICAgICAgdmFsdWUucHVzaCh0aGlzLnR5cGUpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBvYmplY3QgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5pZFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy50eXBlKSB7XG4gICAgICAgICAgICBvYmplY3QudHlwZSA9IHRoaXMudHlwZS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH1cbn1cblFDU3RhdGVtZW50LkNMQVNTX05BTUUgPSBcIlFDU3RhdGVtZW50XCI7XG5jbGFzcyBRQ1N0YXRlbWVudHMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZhbHVlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZBTFVFUywgUUNTdGF0ZW1lbnRzLmRlZmF1bHRWYWx1ZXMoVkFMVUVTKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWQUxVRVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWQUxVRVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnZhbHVlcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogUUNTdGF0ZW1lbnQuc2NoZW1hKG5hbWVzLnZhbHVlIHx8IHt9KVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIFFDX1NUQVRFTUVOVFNfQ0xFQVJfUFJPUFMpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFFDU3RhdGVtZW50cy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IFZBTFVFU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmFsdWVzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC52YWx1ZXMsIGVsZW1lbnQgPT4gbmV3IFFDU3RhdGVtZW50KHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLnZhbHVlcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWVzOiBBcnJheS5mcm9tKHRoaXMudmFsdWVzLCBvID0+IG8udG9KU09OKCkpXG4gICAgICAgIH07XG4gICAgfVxufVxuUUNTdGF0ZW1lbnRzLkNMQVNTX05BTUUgPSBcIlFDU3RhdGVtZW50c1wiO1xuXG52YXIgX2E7XG5jbGFzcyBFQ05hbWVkQ3VydmVzIHtcbiAgICBzdGF0aWMgcmVnaXN0ZXIobmFtZSwgaWQsIHNpemUpIHtcbiAgICAgICAgdGhpcy5uYW1lZEN1cnZlc1tuYW1lLnRvTG93ZXJDYXNlKCldID0gdGhpcy5uYW1lZEN1cnZlc1tpZF0gPSB7IG5hbWUsIGlkLCBzaXplIH07XG4gICAgfVxuICAgIHN0YXRpYyBmaW5kKG5hbWVPcklkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWVkQ3VydmVzW25hbWVPcklkLnRvTG93ZXJDYXNlKCldIHx8IG51bGw7XG4gICAgfVxufVxuX2EgPSBFQ05hbWVkQ3VydmVzO1xuRUNOYW1lZEN1cnZlcy5uYW1lZEN1cnZlcyA9IHt9O1xuKCgpID0+IHtcbiAgICBfYS5yZWdpc3RlcihcIlAtMjU2XCIsIFwiMS4yLjg0MC4xMDA0NS4zLjEuN1wiLCAzMik7XG4gICAgX2EucmVnaXN0ZXIoXCJQLTM4NFwiLCBcIjEuMy4xMzIuMC4zNFwiLCA0OCk7XG4gICAgX2EucmVnaXN0ZXIoXCJQLTUyMVwiLCBcIjEuMy4xMzIuMC4zNVwiLCA2Nik7XG4gICAgX2EucmVnaXN0ZXIoXCJicmFpbnBvb2xQMjU2cjFcIiwgXCIxLjMuMzYuMy4zLjIuOC4xLjEuN1wiLCAzMik7XG4gICAgX2EucmVnaXN0ZXIoXCJicmFpbnBvb2xQMzg0cjFcIiwgXCIxLjMuMzYuMy4zLjIuOC4xLjEuMTFcIiwgNDgpO1xuICAgIF9hLnJlZ2lzdGVyKFwiYnJhaW5wb29sUDUxMnIxXCIsIFwiMS4zLjM2LjMuMy4yLjguMS4xLjEzXCIsIDY0KTtcbn0pKCk7XG5cbmNvbnN0IFggPSBcInhcIjtcbmNvbnN0IFkgPSBcInlcIjtcbmNvbnN0IE5BTUVEX0NVUlZFJDEgPSBcIm5hbWVkQ3VydmVcIjtcbmNsYXNzIEVDUHVibGljS2V5IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy54ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgWCwgRUNQdWJsaWNLZXkuZGVmYXVsdFZhbHVlcyhYKSk7XG4gICAgICAgIHRoaXMueSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFksIEVDUHVibGljS2V5LmRlZmF1bHRWYWx1ZXMoWSkpO1xuICAgICAgICB0aGlzLm5hbWVkQ3VydmUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBOQU1FRF9DVVJWRSQxLCBFQ1B1YmxpY0tleS5kZWZhdWx0VmFsdWVzKE5BTUVEX0NVUlZFJDEpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuanNvbikge1xuICAgICAgICAgICAgdGhpcy5mcm9tSlNPTihwYXJhbWV0ZXJzLmpzb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBYOlxuICAgICAgICAgICAgY2FzZSBZOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9CVUZGRVI7XG4gICAgICAgICAgICBjYXNlIE5BTUVEX0NVUlZFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgWDpcbiAgICAgICAgICAgIGNhc2UgWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciAmJlxuICAgICAgICAgICAgICAgICAgICAocHZ1dGlscy5pc0VxdWFsQnVmZmVyKG1lbWJlclZhbHVlLCBFQ1B1YmxpY0tleS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBjYXNlIE5BTUVEX0NVUlZFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBtZW1iZXJWYWx1ZSA9PT0gXCJzdHJpbmdcIiAmJlxuICAgICAgICAgICAgICAgICAgICBtZW1iZXJWYWx1ZSA9PT0gRUNQdWJsaWNLZXkuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuUmF3RGF0YSgpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYTEpIHtcbiAgICAgICAgY29uc3QgdmlldyA9IEJ1ZmZlclNvdXJjZUNvbnZlcnRlci50b1VpbnQ4QXJyYXkoc2NoZW1hMSk7XG4gICAgICAgIGlmICh2aWV3WzBdICE9PSAweDA0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPYmplY3QncyBzY2hlbWEgd2FzIG5vdCB2ZXJpZmllZCBhZ2FpbnN0IGlucHV0IGRhdGEgZm9yIEVDUHVibGljS2V5XCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5hbWVkQ3VydmUgPSBFQ05hbWVkQ3VydmVzLmZpbmQodGhpcy5uYW1lZEN1cnZlKTtcbiAgICAgICAgaWYgKCFuYW1lZEN1cnZlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBjdXJ2ZSBPSUQ6ICR7dGhpcy5uYW1lZEN1cnZlfWApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvb3JkaW5hdGVMZW5ndGggPSBuYW1lZEN1cnZlLnNpemU7XG4gICAgICAgIGlmICh2aWV3LmJ5dGVMZW5ndGggIT09IChjb29yZGluYXRlTGVuZ3RoICogMiArIDEpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPYmplY3QncyBzY2hlbWEgd2FzIG5vdCB2ZXJpZmllZCBhZ2FpbnN0IGlucHV0IGRhdGEgZm9yIEVDUHVibGljS2V5XCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmFtZWRDdXJ2ZSA9IG5hbWVkQ3VydmUubmFtZTtcbiAgICAgICAgdGhpcy54ID0gdmlldy5zbGljZSgxLCBjb29yZGluYXRlTGVuZ3RoICsgMSkuYnVmZmVyO1xuICAgICAgICB0aGlzLnkgPSB2aWV3LnNsaWNlKDEgKyBjb29yZGluYXRlTGVuZ3RoLCBjb29yZGluYXRlTGVuZ3RoICogMiArIDEpLmJ1ZmZlcjtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiBuZXcgYXNuMWpzLlJhd0RhdGEoe1xuICAgICAgICAgICAgZGF0YTogcHZ1dGlscy51dGlsQ29uY2F0QnVmKChuZXcgVWludDhBcnJheShbMHgwNF0pKS5idWZmZXIsIHRoaXMueCwgdGhpcy55KVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBuYW1lZEN1cnZlID0gRUNOYW1lZEN1cnZlcy5maW5kKHRoaXMubmFtZWRDdXJ2ZSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjcnY6IG5hbWVkQ3VydmUgPyBuYW1lZEN1cnZlLm5hbWUgOiB0aGlzLm5hbWVkQ3VydmUsXG4gICAgICAgICAgICB4OiBwdnV0aWxzLnRvQmFzZTY0KHB2dXRpbHMuYXJyYXlCdWZmZXJUb1N0cmluZyh0aGlzLngpLCB0cnVlLCB0cnVlLCBmYWxzZSksXG4gICAgICAgICAgICB5OiBwdnV0aWxzLnRvQmFzZTY0KHB2dXRpbHMuYXJyYXlCdWZmZXJUb1N0cmluZyh0aGlzLnkpLCB0cnVlLCB0cnVlLCBmYWxzZSlcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnJvbUpTT04oanNvbikge1xuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQoXCJqc29uXCIsIGpzb24sIFwiY3J2XCIsIFwieFwiLCBcInlcIik7XG4gICAgICAgIGxldCBjb29yZGluYXRlTGVuZ3RoID0gMDtcbiAgICAgICAgY29uc3QgbmFtZWRDdXJ2ZSA9IEVDTmFtZWRDdXJ2ZXMuZmluZChqc29uLmNydik7XG4gICAgICAgIGlmIChuYW1lZEN1cnZlKSB7XG4gICAgICAgICAgICB0aGlzLm5hbWVkQ3VydmUgPSBuYW1lZEN1cnZlLmlkO1xuICAgICAgICAgICAgY29vcmRpbmF0ZUxlbmd0aCA9IG5hbWVkQ3VydmUuc2l6ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB4Q29udmVydEJ1ZmZlciA9IHB2dXRpbHMuc3RyaW5nVG9BcnJheUJ1ZmZlcihwdnV0aWxzLmZyb21CYXNlNjQoanNvbi54LCB0cnVlKSk7XG4gICAgICAgIGlmICh4Q29udmVydEJ1ZmZlci5ieXRlTGVuZ3RoIDwgY29vcmRpbmF0ZUxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy54ID0gbmV3IEFycmF5QnVmZmVyKGNvb3JkaW5hdGVMZW5ndGgpO1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KHRoaXMueCk7XG4gICAgICAgICAgICBjb25zdCBjb252ZXJ0QnVmZmVyVmlldyA9IG5ldyBVaW50OEFycmF5KHhDb252ZXJ0QnVmZmVyKTtcbiAgICAgICAgICAgIHZpZXcuc2V0KGNvbnZlcnRCdWZmZXJWaWV3LCAxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMueCA9IHhDb252ZXJ0QnVmZmVyLnNsaWNlKDAsIGNvb3JkaW5hdGVMZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHlDb252ZXJ0QnVmZmVyID0gcHZ1dGlscy5zdHJpbmdUb0FycmF5QnVmZmVyKHB2dXRpbHMuZnJvbUJhc2U2NChqc29uLnksIHRydWUpKTtcbiAgICAgICAgaWYgKHlDb252ZXJ0QnVmZmVyLmJ5dGVMZW5ndGggPCBjb29yZGluYXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnkgPSBuZXcgQXJyYXlCdWZmZXIoY29vcmRpbmF0ZUxlbmd0aCk7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy55KTtcbiAgICAgICAgICAgIGNvbnN0IGNvbnZlcnRCdWZmZXJWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoeUNvbnZlcnRCdWZmZXIpO1xuICAgICAgICAgICAgdmlldy5zZXQoY29udmVydEJ1ZmZlclZpZXcsIDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy55ID0geUNvbnZlcnRCdWZmZXIuc2xpY2UoMCwgY29vcmRpbmF0ZUxlbmd0aCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5FQ1B1YmxpY0tleS5DTEFTU19OQU1FID0gXCJFQ1B1YmxpY0tleVwiO1xuXG5jb25zdCBNT0RVTFVTJDEgPSBcIm1vZHVsdXNcIjtcbmNvbnN0IFBVQkxJQ19FWFBPTkVOVCQxID0gXCJwdWJsaWNFeHBvbmVudFwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMWIgPSBbTU9EVUxVUyQxLCBQVUJMSUNfRVhQT05FTlQkMV07XG5jbGFzcyBSU0FQdWJsaWNLZXkgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm1vZHVsdXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBNT0RVTFVTJDEsIFJTQVB1YmxpY0tleS5kZWZhdWx0VmFsdWVzKE1PRFVMVVMkMSkpO1xuICAgICAgICB0aGlzLnB1YmxpY0V4cG9uZW50ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUFVCTElDX0VYUE9ORU5UJDEsIFJTQVB1YmxpY0tleS5kZWZhdWx0VmFsdWVzKFBVQkxJQ19FWFBPTkVOVCQxKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLmpzb24pIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbUpTT04ocGFyYW1ldGVycy5qc29uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgTU9EVUxVUyQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGNhc2UgUFVCTElDX0VYUE9ORU5UJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMubW9kdWx1cyB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5wdWJsaWNFeHBvbmVudCB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMWIpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJTQVB1YmxpY0tleS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBtb2R1bHVzOiBNT0RVTFVTJDEsXG4gICAgICAgICAgICAgICAgcHVibGljRXhwb25lbnQ6IFBVQkxJQ19FWFBPTkVOVCQxXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5tb2R1bHVzID0gYXNuMS5yZXN1bHQubW9kdWx1cy5jb252ZXJ0RnJvbURFUigyNTYpO1xuICAgICAgICB0aGlzLnB1YmxpY0V4cG9uZW50ID0gYXNuMS5yZXN1bHQucHVibGljRXhwb25lbnQ7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZHVsdXMuY29udmVydFRvREVSKCksXG4gICAgICAgICAgICAgICAgdGhpcy5wdWJsaWNFeHBvbmVudFxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG46IHB2dHN1dGlscy5Db252ZXJ0LlRvQmFzZTY0VXJsKHRoaXMubW9kdWx1cy52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldyksXG4gICAgICAgICAgICBlOiBwdnRzdXRpbHMuQ29udmVydC5Ub0Jhc2U2NFVybCh0aGlzLnB1YmxpY0V4cG9uZW50LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnJvbUpTT04oanNvbikge1xuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQoXCJqc29uXCIsIGpzb24sIFwiblwiLCBcImVcIik7XG4gICAgICAgIGNvbnN0IGFycmF5ID0gcHZ1dGlscy5zdHJpbmdUb0FycmF5QnVmZmVyKHB2dXRpbHMuZnJvbUJhc2U2NChqc29uLm4sIHRydWUpKTtcbiAgICAgICAgdGhpcy5tb2R1bHVzID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IGFycmF5LnNsaWNlKDAsIE1hdGgucG93KDIsIHB2dXRpbHMubmVhcmVzdFBvd2VyT2YyKGFycmF5LmJ5dGVMZW5ndGgpKSkgfSk7XG4gICAgICAgIHRoaXMucHVibGljRXhwb25lbnQgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogcHZ1dGlscy5zdHJpbmdUb0FycmF5QnVmZmVyKHB2dXRpbHMuZnJvbUJhc2U2NChqc29uLmUsIHRydWUpKS5zbGljZSgwLCAzKSB9KTtcbiAgICB9XG59XG5SU0FQdWJsaWNLZXkuQ0xBU1NfTkFNRSA9IFwiUlNBUHVibGljS2V5XCI7XG5cbmNvbnN0IEFMR09SSVRITSQxID0gXCJhbGdvcml0aG1cIjtcbmNvbnN0IFNVQkpFQ1RfUFVCTElDX0tFWSA9IFwic3ViamVjdFB1YmxpY0tleVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMWEgPSBbQUxHT1JJVEhNJDEsIFNVQkpFQ1RfUFVCTElDX0tFWV07XG5jbGFzcyBQdWJsaWNLZXlJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBnZXQgcGFyc2VkS2V5KCkge1xuICAgICAgICBpZiAodGhpcy5fcGFyc2VkS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5hbGdvcml0aG0uYWxnb3JpdGhtSWQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS4yLjFcIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwiYWxnb3JpdGhtUGFyYW1zXCIgaW4gdGhpcy5hbGdvcml0aG0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMuY29uc3RydWN0b3IuYmxvY2tOYW1lKCkgPT09IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyLmJsb2NrTmFtZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGFyc2VkS2V5ID0gbmV3IEVDUHVibGljS2V5KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVkQ3VydmU6IHRoaXMuYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcy52YWx1ZUJsb2NrLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hlbWE6IHRoaXMuc3ViamVjdFB1YmxpY0tleS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlld1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4xLjEuMVwiOlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdWJsaWNLZXlBU04xID0gYXNuMWpzLmZyb21CRVIodGhpcy5zdWJqZWN0UHVibGljS2V5LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwdWJsaWNLZXlBU04xLm9mZnNldCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYXJzZWRLZXkgPSBuZXcgUlNBUHVibGljS2V5KHsgc2NoZW1hOiBwdWJsaWNLZXlBU04xLnJlc3VsdCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcGFyc2VkS2V5IHx8ICh0aGlzLl9wYXJzZWRLZXkgPSBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fcGFyc2VkS2V5IHx8IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgc2V0IHBhcnNlZEtleSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9wYXJzZWRLZXkgPSB2YWx1ZTtcbiAgICB9XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuYWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQUxHT1JJVEhNJDEsIFB1YmxpY0tleUluZm8uZGVmYXVsdFZhbHVlcyhBTEdPUklUSE0kMSkpO1xuICAgICAgICB0aGlzLnN1YmplY3RQdWJsaWNLZXkgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTVUJKRUNUX1BVQkxJQ19LRVksIFB1YmxpY0tleUluZm8uZGVmYXVsdFZhbHVlcyhTVUJKRUNUX1BVQkxJQ19LRVkpKTtcbiAgICAgICAgY29uc3QgcGFyc2VkS2V5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJwYXJzZWRLZXlcIiwgbnVsbCk7XG4gICAgICAgIGlmIChwYXJzZWRLZXkpIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2VkS2V5ID0gcGFyc2VkS2V5O1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLmpzb24pIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbUpTT04ocGFyYW1ldGVycy5qc29uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQUxHT1JJVEhNJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIFNVQkpFQ1RfUFVCTElDX0tFWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuYWxnb3JpdGhtIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5zdWJqZWN0UHVibGljS2V5IHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxYSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUHVibGljS2V5SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQUxHT1JJVEhNJDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc3ViamVjdFB1YmxpY0tleTogU1VCSkVDVF9QVUJMSUNfS0VZXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5hbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuYWxnb3JpdGhtIH0pO1xuICAgICAgICB0aGlzLnN1YmplY3RQdWJsaWNLZXkgPSBhc24xLnJlc3VsdC5zdWJqZWN0UHVibGljS2V5O1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGhpcy5hbGdvcml0aG0udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLnN1YmplY3RQdWJsaWNLZXlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGlmICghdGhpcy5wYXJzZWRLZXkpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB0aGlzLmFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgICAgICBzdWJqZWN0UHVibGljS2V5OiB0aGlzLnN1YmplY3RQdWJsaWNLZXkudG9KU09OKCksXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGp3ayA9IHt9O1xuICAgICAgICBzd2l0Y2ggKHRoaXMuYWxnb3JpdGhtLmFsZ29yaXRobUlkKSB7XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS4yLjFcIjpcbiAgICAgICAgICAgICAgICBqd2sua3R5ID0gXCJFQ1wiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xXCI6XG4gICAgICAgICAgICAgICAgandrLmt0eSA9IFwiUlNBXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcHVibGljS2V5SldLID0gdGhpcy5wYXJzZWRLZXkudG9KU09OKCk7XG4gICAgICAgIE9iamVjdC5hc3NpZ24oandrLCBwdWJsaWNLZXlKV0spO1xuICAgICAgICByZXR1cm4gandrO1xuICAgIH1cbiAgICBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIGlmIChcImt0eVwiIGluIGpzb24pIHtcbiAgICAgICAgICAgIHN3aXRjaCAoanNvbi5rdHkudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJFQ1wiOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlZEtleSA9IG5ldyBFQ1B1YmxpY0tleSh7IGpzb24gfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IFwiMS4yLjg0MC4xMDA0NS4yLjFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMucGFyc2VkS2V5Lm5hbWVkQ3VydmUgfSlcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJSU0FcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZWRLZXkgPSBuZXcgUlNBUHVibGljS2V5KHsganNvbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogXCIxLjIuODQwLjExMzU0OS4xLjEuMVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk51bGwoKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHZhbHVlIGZvciBcImt0eVwiIHBhcmFtZXRlcjogJHtqc29uLmt0eX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3ViamVjdFB1YmxpY0tleSA9IG5ldyBhc24xanMuQml0U3RyaW5nKHsgdmFsdWVIZXg6IHRoaXMucGFyc2VkS2V5LnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIGltcG9ydEtleShwdWJsaWNLZXksIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCFwdWJsaWNLZXkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOZWVkIHRvIHByb3ZpZGUgcHVibGljS2V5IGlucHV0IHBhcmFtZXRlclwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGV4cG9ydGVkS2V5ID0gYXdhaXQgY3J5cHRvLmV4cG9ydEtleShcInNwa2lcIiwgcHVibGljS2V5KTtcbiAgICAgICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuZnJvbUJFUihleHBvcnRlZEtleSk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShhc24xLnJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXhjZXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXJyb3IgZHVyaW5nIGluaXRpYWxpemluZyBvYmplY3QgZnJvbSBzY2hlbWFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlIGluc3RhbmNlb2YgRXJyb3IgPyBlLm1lc3NhZ2UgOiBgJHtlfWA7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGR1cmluZyBleHBvcnRpbmcgcHVibGljIGtleTogJHttZXNzYWdlfWApO1xuICAgICAgICB9XG4gICAgfVxufVxuUHVibGljS2V5SW5mby5DTEFTU19OQU1FID0gXCJQdWJsaWNLZXlJbmZvXCI7XG5cbmNvbnN0IFZFUlNJT04kbCA9IFwidmVyc2lvblwiO1xuY29uc3QgUFJJVkFURV9LRVkkMSA9IFwicHJpdmF0ZUtleVwiO1xuY29uc3QgTkFNRURfQ1VSVkUgPSBcIm5hbWVkQ3VydmVcIjtcbmNvbnN0IFBVQkxJQ19LRVkkMSA9IFwicHVibGljS2V5XCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxOSA9IFtcbiAgICBWRVJTSU9OJGwsXG4gICAgUFJJVkFURV9LRVkkMSxcbiAgICBOQU1FRF9DVVJWRSxcbiAgICBQVUJMSUNfS0VZJDFcbl07XG5jbGFzcyBFQ1ByaXZhdGVLZXkgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWRVJTSU9OJGwsIEVDUHJpdmF0ZUtleS5kZWZhdWx0VmFsdWVzKFZFUlNJT04kbCkpO1xuICAgICAgICB0aGlzLnByaXZhdGVLZXkgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQUklWQVRFX0tFWSQxLCBFQ1ByaXZhdGVLZXkuZGVmYXVsdFZhbHVlcyhQUklWQVRFX0tFWSQxKSk7XG4gICAgICAgIGlmIChOQU1FRF9DVVJWRSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm5hbWVkQ3VydmUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBOQU1FRF9DVVJWRSwgRUNQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMoTkFNRURfQ1VSVkUpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoUFVCTElDX0tFWSQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucHVibGljS2V5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUFVCTElDX0tFWSQxLCBFQ1ByaXZhdGVLZXkuZGVmYXVsdFZhbHVlcyhQVUJMSUNfS0VZJDEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5qc29uKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21KU09OKHBhcmFtZXRlcnMuanNvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kbDpcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIGNhc2UgUFJJVkFURV9LRVkkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBOQU1FRF9DVVJWRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBQVUJMSUNfS0VZJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBFQ1B1YmxpY0tleSgpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGw6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRUNQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpO1xuICAgICAgICAgICAgY2FzZSBQUklWQVRFX0tFWSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChFQ1ByaXZhdGVLZXkuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSkpO1xuICAgICAgICAgICAgY2FzZSBOQU1FRF9DVVJWRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBFTVBUWV9TVFJJTkcpO1xuICAgICAgICAgICAgY2FzZSBQVUJMSUNfS0VZJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoRUNQdWJsaWNLZXkuY29tcGFyZVdpdGhEZWZhdWx0KE5BTUVEX0NVUlZFLCBtZW1iZXJWYWx1ZS5uYW1lZEN1cnZlKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKEVDUHVibGljS2V5LmNvbXBhcmVXaXRoRGVmYXVsdChcInhcIiwgbWVtYmVyVmFsdWUueCkpICYmXG4gICAgICAgICAgICAgICAgICAgIChFQ1B1YmxpY0tleS5jb21wYXJlV2l0aERlZmF1bHQoXCJ5XCIsIG1lbWJlclZhbHVlLnkpKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5wcml2YXRlS2V5IHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLm5hbWVkQ3VydmUgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5CaXRTdHJpbmcoeyBuYW1lOiAobmFtZXMucHVibGljS2V5IHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMTkpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEVDUHJpdmF0ZUtleS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBWRVJTSU9OJGwsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZUtleTogUFJJVkFURV9LRVkkMSxcbiAgICAgICAgICAgICAgICBuYW1lZEN1cnZlOiBOQU1FRF9DVVJWRSxcbiAgICAgICAgICAgICAgICBwdWJsaWNLZXk6IFBVQkxJQ19LRVkkMVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgdGhpcy5wcml2YXRlS2V5ID0gYXNuMS5yZXN1bHQucHJpdmF0ZUtleTtcbiAgICAgICAgaWYgKE5BTUVEX0NVUlZFIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLm5hbWVkQ3VydmUgPSBhc24xLnJlc3VsdC5uYW1lZEN1cnZlLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoUFVCTElDX0tFWSQxIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBjb25zdCBwdWJsaWNLZXlEYXRhID0geyBzY2hlbWE6IGFzbjEucmVzdWx0LnB1YmxpY0tleS52YWx1ZUJsb2NrLnZhbHVlSGV4IH07XG4gICAgICAgICAgICBpZiAoTkFNRURfQ1VSVkUgaW4gdGhpcykge1xuICAgICAgICAgICAgICAgIHB1YmxpY0tleURhdGEubmFtZWRDdXJ2ZSA9IHRoaXMubmFtZWRDdXJ2ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHVibGljS2V5ID0gbmV3IEVDUHVibGljS2V5KHB1YmxpY0tleURhdGEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtcbiAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSksXG4gICAgICAgICAgICB0aGlzLnByaXZhdGVLZXlcbiAgICAgICAgXTtcbiAgICAgICAgaWYgKHRoaXMubmFtZWRDdXJ2ZSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLm5hbWVkQ3VydmUgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHVibGljS2V5KSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5CaXRTdHJpbmcoeyB2YWx1ZUhleDogdGhpcy5wdWJsaWNLZXkudG9TY2hlbWEoKS50b0JFUihmYWxzZSkgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGlmICghdGhpcy5uYW1lZEN1cnZlIHx8IEVDUHJpdmF0ZUtleS5jb21wYXJlV2l0aERlZmF1bHQoTkFNRURfQ1VSVkUsIHRoaXMubmFtZWRDdXJ2ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCBlbm91Z2ggaW5mb3JtYXRpb24gZm9yIG1ha2luZyBKU09OOiBhYnNlbnQgXFxcIm5hbWVkQ3VydmVcXFwiIHZhbHVlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGN1cnZlID0gRUNOYW1lZEN1cnZlcy5maW5kKHRoaXMubmFtZWRDdXJ2ZSk7XG4gICAgICAgIGNvbnN0IHByaXZhdGVLZXlKU09OID0ge1xuICAgICAgICAgICAgY3J2OiBjdXJ2ZSA/IGN1cnZlLm5hbWUgOiB0aGlzLm5hbWVkQ3VydmUsXG4gICAgICAgICAgICBkOiBwdnRzdXRpbHMuQ29udmVydC5Ub0Jhc2U2NFVybCh0aGlzLnByaXZhdGVLZXkudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5wdWJsaWNLZXkpIHtcbiAgICAgICAgICAgIGNvbnN0IHB1YmxpY0tleUpTT04gPSB0aGlzLnB1YmxpY0tleS50b0pTT04oKTtcbiAgICAgICAgICAgIHByaXZhdGVLZXlKU09OLnggPSBwdWJsaWNLZXlKU09OLng7XG4gICAgICAgICAgICBwcml2YXRlS2V5SlNPTi55ID0gcHVibGljS2V5SlNPTi55O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcml2YXRlS2V5SlNPTjtcbiAgICB9XG4gICAgZnJvbUpTT04oanNvbikge1xuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQoXCJqc29uXCIsIGpzb24sIFwiY3J2XCIsIFwiZFwiKTtcbiAgICAgICAgbGV0IGNvb3JkaW5hdGVMZW5ndGggPSAwO1xuICAgICAgICBjb25zdCBjdXJ2ZSA9IEVDTmFtZWRDdXJ2ZXMuZmluZChqc29uLmNydik7XG4gICAgICAgIGlmIChjdXJ2ZSkge1xuICAgICAgICAgICAgdGhpcy5uYW1lZEN1cnZlID0gY3VydmUuaWQ7XG4gICAgICAgICAgICBjb29yZGluYXRlTGVuZ3RoID0gY3VydmUuc2l6ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb252ZXJ0QnVmZmVyID0gcHZ0c3V0aWxzLkNvbnZlcnQuRnJvbUJhc2U2NFVybChqc29uLmQpO1xuICAgICAgICBpZiAoY29udmVydEJ1ZmZlci5ieXRlTGVuZ3RoIDwgY29vcmRpbmF0ZUxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgYnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKGNvb3JkaW5hdGVMZW5ndGgpO1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG4gICAgICAgICAgICBjb25zdCBjb252ZXJ0QnVmZmVyVmlldyA9IG5ldyBVaW50OEFycmF5KGNvbnZlcnRCdWZmZXIpO1xuICAgICAgICAgICAgdmlldy5zZXQoY29udmVydEJ1ZmZlclZpZXcsIDEpO1xuICAgICAgICAgICAgdGhpcy5wcml2YXRlS2V5ID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBidWZmZXIgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByaXZhdGVLZXkgPSBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IGNvbnZlcnRCdWZmZXIuc2xpY2UoMCwgY29vcmRpbmF0ZUxlbmd0aCkgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpzb24ueCAmJiBqc29uLnkpIHtcbiAgICAgICAgICAgIHRoaXMucHVibGljS2V5ID0gbmV3IEVDUHVibGljS2V5KHsganNvbiB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbkVDUHJpdmF0ZUtleS5DTEFTU19OQU1FID0gXCJFQ1ByaXZhdGVLZXlcIjtcblxuY29uc3QgUFJJTUUgPSBcInByaW1lXCI7XG5jb25zdCBFWFBPTkVOVCA9IFwiZXhwb25lbnRcIjtcbmNvbnN0IENPRUZGSUNJRU5UJDEgPSBcImNvZWZmaWNpZW50XCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxOCA9IFtcbiAgICBQUklNRSxcbiAgICBFWFBPTkVOVCxcbiAgICBDT0VGRklDSUVOVCQxLFxuXTtcbmNsYXNzIE90aGVyUHJpbWVJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5wcmltZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBSSU1FLCBPdGhlclByaW1lSW5mby5kZWZhdWx0VmFsdWVzKFBSSU1FKSk7XG4gICAgICAgIHRoaXMuZXhwb25lbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFWFBPTkVOVCwgT3RoZXJQcmltZUluZm8uZGVmYXVsdFZhbHVlcyhFWFBPTkVOVCkpO1xuICAgICAgICB0aGlzLmNvZWZmaWNpZW50ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ09FRkZJQ0lFTlQkMSwgT3RoZXJQcmltZUluZm8uZGVmYXVsdFZhbHVlcyhDT0VGRklDSUVOVCQxKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLmpzb24pIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbUpTT04ocGFyYW1ldGVycy5qc29uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgUFJJTUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBFWFBPTkVOVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIENPRUZGSUNJRU5UJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMucHJpbWUgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuZXhwb25lbnQgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuY29lZmZpY2llbnQgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDE4KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBPdGhlclByaW1lSW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBwcmltZTogUFJJTUUsXG4gICAgICAgICAgICAgICAgZXhwb25lbnQ6IEVYUE9ORU5ULFxuICAgICAgICAgICAgICAgIGNvZWZmaWNpZW50OiBDT0VGRklDSUVOVCQxXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5wcmltZSA9IGFzbjEucmVzdWx0LnByaW1lLmNvbnZlcnRGcm9tREVSKCk7XG4gICAgICAgIHRoaXMuZXhwb25lbnQgPSBhc24xLnJlc3VsdC5leHBvbmVudC5jb252ZXJ0RnJvbURFUigpO1xuICAgICAgICB0aGlzLmNvZWZmaWNpZW50ID0gYXNuMS5yZXN1bHQuY29lZmZpY2llbnQuY29udmVydEZyb21ERVIoKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMucHJpbWUuY29udmVydFRvREVSKCksXG4gICAgICAgICAgICAgICAgdGhpcy5leHBvbmVudC5jb252ZXJ0VG9ERVIoKSxcbiAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50LmNvbnZlcnRUb0RFUigpXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcjogcHZ0c3V0aWxzLkNvbnZlcnQuVG9CYXNlNjRVcmwodGhpcy5wcmltZS52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldyksXG4gICAgICAgICAgICBkOiBwdnRzdXRpbHMuQ29udmVydC5Ub0Jhc2U2NFVybCh0aGlzLmV4cG9uZW50LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSxcbiAgICAgICAgICAgIHQ6IHB2dHN1dGlscy5Db252ZXJ0LlRvQmFzZTY0VXJsKHRoaXMuY29lZmZpY2llbnQudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChcImpzb25cIiwganNvbiwgXCJyXCIsIFwiZFwiLCBcInJcIik7XG4gICAgICAgIHRoaXMucHJpbWUgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogcHZ0c3V0aWxzLkNvbnZlcnQuRnJvbUJhc2U2NFVybChqc29uLnIpIH0pO1xuICAgICAgICB0aGlzLmV4cG9uZW50ID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IHB2dHN1dGlscy5Db252ZXJ0LkZyb21CYXNlNjRVcmwoanNvbi5kKSB9KTtcbiAgICAgICAgdGhpcy5jb2VmZmljaWVudCA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlSGV4OiBwdnRzdXRpbHMuQ29udmVydC5Gcm9tQmFzZTY0VXJsKGpzb24udCkgfSk7XG4gICAgfVxufVxuT3RoZXJQcmltZUluZm8uQ0xBU1NfTkFNRSA9IFwiT3RoZXJQcmltZUluZm9cIjtcblxuY29uc3QgVkVSU0lPTiRrID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBNT0RVTFVTID0gXCJtb2R1bHVzXCI7XG5jb25zdCBQVUJMSUNfRVhQT05FTlQgPSBcInB1YmxpY0V4cG9uZW50XCI7XG5jb25zdCBQUklWQVRFX0VYUE9ORU5UID0gXCJwcml2YXRlRXhwb25lbnRcIjtcbmNvbnN0IFBSSU1FMSA9IFwicHJpbWUxXCI7XG5jb25zdCBQUklNRTIgPSBcInByaW1lMlwiO1xuY29uc3QgRVhQT05FTlQxID0gXCJleHBvbmVudDFcIjtcbmNvbnN0IEVYUE9ORU5UMiA9IFwiZXhwb25lbnQyXCI7XG5jb25zdCBDT0VGRklDSUVOVCA9IFwiY29lZmZpY2llbnRcIjtcbmNvbnN0IE9USEVSX1BSSU1FX0lORk9TID0gXCJvdGhlclByaW1lSW5mb3NcIjtcbmNvbnN0IENMRUFSX1BST1BTJDE3ID0gW1xuICAgIFZFUlNJT04kayxcbiAgICBNT0RVTFVTLFxuICAgIFBVQkxJQ19FWFBPTkVOVCxcbiAgICBQUklWQVRFX0VYUE9ORU5ULFxuICAgIFBSSU1FMSxcbiAgICBQUklNRTIsXG4gICAgRVhQT05FTlQxLFxuICAgIEVYUE9ORU5UMixcbiAgICBDT0VGRklDSUVOVCxcbiAgICBPVEhFUl9QUklNRV9JTkZPU1xuXTtcbmNsYXNzIFJTQVByaXZhdGVLZXkgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWRVJTSU9OJGssIFJTQVByaXZhdGVLZXkuZGVmYXVsdFZhbHVlcyhWRVJTSU9OJGspKTtcbiAgICAgICAgdGhpcy5tb2R1bHVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTU9EVUxVUywgUlNBUHJpdmF0ZUtleS5kZWZhdWx0VmFsdWVzKE1PRFVMVVMpKTtcbiAgICAgICAgdGhpcy5wdWJsaWNFeHBvbmVudCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBVQkxJQ19FWFBPTkVOVCwgUlNBUHJpdmF0ZUtleS5kZWZhdWx0VmFsdWVzKFBVQkxJQ19FWFBPTkVOVCkpO1xuICAgICAgICB0aGlzLnByaXZhdGVFeHBvbmVudCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBSSVZBVEVfRVhQT05FTlQsIFJTQVByaXZhdGVLZXkuZGVmYXVsdFZhbHVlcyhQUklWQVRFX0VYUE9ORU5UKSk7XG4gICAgICAgIHRoaXMucHJpbWUxID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUFJJTUUxLCBSU0FQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMoUFJJTUUxKSk7XG4gICAgICAgIHRoaXMucHJpbWUyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUFJJTUUyLCBSU0FQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMoUFJJTUUyKSk7XG4gICAgICAgIHRoaXMuZXhwb25lbnQxID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRVhQT05FTlQxLCBSU0FQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMoRVhQT05FTlQxKSk7XG4gICAgICAgIHRoaXMuZXhwb25lbnQyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRVhQT05FTlQyLCBSU0FQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMoRVhQT05FTlQyKSk7XG4gICAgICAgIHRoaXMuY29lZmZpY2llbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDT0VGRklDSUVOVCwgUlNBUHJpdmF0ZUtleS5kZWZhdWx0VmFsdWVzKENPRUZGSUNJRU5UKSk7XG4gICAgICAgIGlmIChPVEhFUl9QUklNRV9JTkZPUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm90aGVyUHJpbWVJbmZvcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9USEVSX1BSSU1FX0lORk9TLCBSU0FQcml2YXRlS2V5LmRlZmF1bHRWYWx1ZXMoT1RIRVJfUFJJTUVfSU5GT1MpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5qc29uKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21KU09OKHBhcmFtZXRlcnMuanNvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kazpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgTU9EVUxVUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIFBVQkxJQ19FWFBPTkVOVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIFBSSVZBVEVfRVhQT05FTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBQUklNRTE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBQUklNRTI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBFWFBPTkVOVDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBFWFBPTkVOVDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBDT0VGRklDSUVOVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIE9USEVSX1BSSU1FX0lORk9TOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnZlcnNpb24gfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMubW9kdWx1cyB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5wdWJsaWNFeHBvbmVudCB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5wcml2YXRlRXhwb25lbnQgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMucHJpbWUxIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnByaW1lMiB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5leHBvbmVudDEgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuZXhwb25lbnQyIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLmNvZWZmaWNpZW50IHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm90aGVyUHJpbWVJbmZvc05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogT3RoZXJQcmltZUluZm8uc2NoZW1hKG5hbWVzLm90aGVyUHJpbWVJbmZvIHx8IHt9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMTcpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJTQVByaXZhdGVLZXkuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgdmVyc2lvbjogVkVSU0lPTiRrLFxuICAgICAgICAgICAgICAgIG1vZHVsdXM6IE1PRFVMVVMsXG4gICAgICAgICAgICAgICAgcHVibGljRXhwb25lbnQ6IFBVQkxJQ19FWFBPTkVOVCxcbiAgICAgICAgICAgICAgICBwcml2YXRlRXhwb25lbnQ6IFBSSVZBVEVfRVhQT05FTlQsXG4gICAgICAgICAgICAgICAgcHJpbWUxOiBQUklNRTEsXG4gICAgICAgICAgICAgICAgcHJpbWUyOiBQUklNRTIsXG4gICAgICAgICAgICAgICAgZXhwb25lbnQxOiBFWFBPTkVOVDEsXG4gICAgICAgICAgICAgICAgZXhwb25lbnQyOiBFWFBPTkVOVDIsXG4gICAgICAgICAgICAgICAgY29lZmZpY2llbnQ6IENPRUZGSUNJRU5ULFxuICAgICAgICAgICAgICAgIG90aGVyUHJpbWVJbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IE9USEVSX1BSSU1FX0lORk9TXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gYXNuMS5yZXN1bHQudmVyc2lvbi52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLm1vZHVsdXMgPSBhc24xLnJlc3VsdC5tb2R1bHVzLmNvbnZlcnRGcm9tREVSKDI1Nik7XG4gICAgICAgIHRoaXMucHVibGljRXhwb25lbnQgPSBhc24xLnJlc3VsdC5wdWJsaWNFeHBvbmVudDtcbiAgICAgICAgdGhpcy5wcml2YXRlRXhwb25lbnQgPSBhc24xLnJlc3VsdC5wcml2YXRlRXhwb25lbnQuY29udmVydEZyb21ERVIoMjU2KTtcbiAgICAgICAgdGhpcy5wcmltZTEgPSBhc24xLnJlc3VsdC5wcmltZTEuY29udmVydEZyb21ERVIoMTI4KTtcbiAgICAgICAgdGhpcy5wcmltZTIgPSBhc24xLnJlc3VsdC5wcmltZTIuY29udmVydEZyb21ERVIoMTI4KTtcbiAgICAgICAgdGhpcy5leHBvbmVudDEgPSBhc24xLnJlc3VsdC5leHBvbmVudDEuY29udmVydEZyb21ERVIoMTI4KTtcbiAgICAgICAgdGhpcy5leHBvbmVudDIgPSBhc24xLnJlc3VsdC5leHBvbmVudDIuY29udmVydEZyb21ERVIoMTI4KTtcbiAgICAgICAgdGhpcy5jb2VmZmljaWVudCA9IGFzbjEucmVzdWx0LmNvZWZmaWNpZW50LmNvbnZlcnRGcm9tREVSKDEyOCk7XG4gICAgICAgIGlmIChPVEhFUl9QUklNRV9JTkZPUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMub3RoZXJQcmltZUluZm9zID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5vdGhlclByaW1lSW5mb3MsIGVsZW1lbnQgPT4gbmV3IE90aGVyUHJpbWVJbmZvKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5tb2R1bHVzLmNvbnZlcnRUb0RFUigpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnB1YmxpY0V4cG9uZW50KTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnByaXZhdGVFeHBvbmVudC5jb252ZXJ0VG9ERVIoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5wcmltZTEuY29udmVydFRvREVSKCkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMucHJpbWUyLmNvbnZlcnRUb0RFUigpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmV4cG9uZW50MS5jb252ZXJ0VG9ERVIoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5leHBvbmVudDIuY29udmVydFRvREVSKCkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuY29lZmZpY2llbnQuY29udmVydFRvREVSKCkpO1xuICAgICAgICBpZiAodGhpcy5vdGhlclByaW1lSW5mb3MpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5vdGhlclByaW1lSW5mb3MsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IGp3ayA9IHtcbiAgICAgICAgICAgIG46IHB2dHN1dGlscy5Db252ZXJ0LlRvQmFzZTY0VXJsKHRoaXMubW9kdWx1cy52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldyksXG4gICAgICAgICAgICBlOiBwdnRzdXRpbHMuQ29udmVydC5Ub0Jhc2U2NFVybCh0aGlzLnB1YmxpY0V4cG9uZW50LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSxcbiAgICAgICAgICAgIGQ6IHB2dHN1dGlscy5Db252ZXJ0LlRvQmFzZTY0VXJsKHRoaXMucHJpdmF0ZUV4cG9uZW50LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSxcbiAgICAgICAgICAgIHA6IHB2dHN1dGlscy5Db252ZXJ0LlRvQmFzZTY0VXJsKHRoaXMucHJpbWUxLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSxcbiAgICAgICAgICAgIHE6IHB2dHN1dGlscy5Db252ZXJ0LlRvQmFzZTY0VXJsKHRoaXMucHJpbWUyLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KSxcbiAgICAgICAgICAgIGRwOiBwdnRzdXRpbHMuQ29udmVydC5Ub0Jhc2U2NFVybCh0aGlzLmV4cG9uZW50MS52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldyksXG4gICAgICAgICAgICBkcTogcHZ0c3V0aWxzLkNvbnZlcnQuVG9CYXNlNjRVcmwodGhpcy5leHBvbmVudDIudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpLFxuICAgICAgICAgICAgcWk6IHB2dHN1dGlscy5Db252ZXJ0LlRvQmFzZTY0VXJsKHRoaXMuY29lZmZpY2llbnQudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5vdGhlclByaW1lSW5mb3MpIHtcbiAgICAgICAgICAgIGp3ay5vdGggPSBBcnJheS5mcm9tKHRoaXMub3RoZXJQcmltZUluZm9zLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBqd2s7XG4gICAgfVxuICAgIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0KFwianNvblwiLCBqc29uLCBcIm5cIiwgXCJlXCIsIFwiZFwiLCBcInBcIiwgXCJxXCIsIFwiZHBcIiwgXCJkcVwiLCBcInFpXCIpO1xuICAgICAgICB0aGlzLm1vZHVsdXMgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogcHZ0c3V0aWxzLkNvbnZlcnQuRnJvbUJhc2U2NFVybChqc29uLm4pIH0pO1xuICAgICAgICB0aGlzLnB1YmxpY0V4cG9uZW50ID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IHB2dHN1dGlscy5Db252ZXJ0LkZyb21CYXNlNjRVcmwoanNvbi5lKSB9KTtcbiAgICAgICAgdGhpcy5wcml2YXRlRXhwb25lbnQgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogcHZ0c3V0aWxzLkNvbnZlcnQuRnJvbUJhc2U2NFVybChqc29uLmQpIH0pO1xuICAgICAgICB0aGlzLnByaW1lMSA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlSGV4OiBwdnRzdXRpbHMuQ29udmVydC5Gcm9tQmFzZTY0VXJsKGpzb24ucCkgfSk7XG4gICAgICAgIHRoaXMucHJpbWUyID0gbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWVIZXg6IHB2dHN1dGlscy5Db252ZXJ0LkZyb21CYXNlNjRVcmwoanNvbi5xKSB9KTtcbiAgICAgICAgdGhpcy5leHBvbmVudDEgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogcHZ0c3V0aWxzLkNvbnZlcnQuRnJvbUJhc2U2NFVybChqc29uLmRwKSB9KTtcbiAgICAgICAgdGhpcy5leHBvbmVudDIgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogcHZ0c3V0aWxzLkNvbnZlcnQuRnJvbUJhc2U2NFVybChqc29uLmRxKSB9KTtcbiAgICAgICAgdGhpcy5jb2VmZmljaWVudCA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlSGV4OiBwdnRzdXRpbHMuQ29udmVydC5Gcm9tQmFzZTY0VXJsKGpzb24ucWkpIH0pO1xuICAgICAgICBpZiAoanNvbi5vdGgpIHtcbiAgICAgICAgICAgIHRoaXMub3RoZXJQcmltZUluZm9zID0gQXJyYXkuZnJvbShqc29uLm90aCwgKGVsZW1lbnQpID0+IG5ldyBPdGhlclByaW1lSW5mbyh7IGpzb246IGVsZW1lbnQgfSkpO1xuICAgICAgICB9XG4gICAgfVxufVxuUlNBUHJpdmF0ZUtleS5DTEFTU19OQU1FID0gXCJSU0FQcml2YXRlS2V5XCI7XG5cbmNvbnN0IFZFUlNJT04kaiA9IFwidmVyc2lvblwiO1xuY29uc3QgUFJJVkFURV9LRVlfQUxHT1JJVEhNID0gXCJwcml2YXRlS2V5QWxnb3JpdGhtXCI7XG5jb25zdCBQUklWQVRFX0tFWSA9IFwicHJpdmF0ZUtleVwiO1xuY29uc3QgQVRUUklCVVRFUyQ1ID0gXCJhdHRyaWJ1dGVzXCI7XG5jb25zdCBQQVJTRURfS0VZID0gXCJwYXJzZWRLZXlcIjtcbmNvbnN0IENMRUFSX1BST1BTJDE2ID0gW1xuICAgIFZFUlNJT04kaixcbiAgICBQUklWQVRFX0tFWV9BTEdPUklUSE0sXG4gICAgUFJJVkFURV9LRVksXG4gICAgQVRUUklCVVRFUyQ1XG5dO1xuY2xhc3MgUHJpdmF0ZUtleUluZm8gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWRVJTSU9OJGosIFByaXZhdGVLZXlJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRqKSk7XG4gICAgICAgIHRoaXMucHJpdmF0ZUtleUFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBSSVZBVEVfS0VZX0FMR09SSVRITSwgUHJpdmF0ZUtleUluZm8uZGVmYXVsdFZhbHVlcyhQUklWQVRFX0tFWV9BTEdPUklUSE0pKTtcbiAgICAgICAgdGhpcy5wcml2YXRlS2V5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUFJJVkFURV9LRVksIFByaXZhdGVLZXlJbmZvLmRlZmF1bHRWYWx1ZXMoUFJJVkFURV9LRVkpKTtcbiAgICAgICAgaWYgKEFUVFJJQlVURVMkNSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBVFRSSUJVVEVTJDUsIFByaXZhdGVLZXlJbmZvLmRlZmF1bHRWYWx1ZXMoQVRUUklCVVRFUyQ1KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFBBUlNFRF9LRVkgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5wYXJzZWRLZXkgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQQVJTRURfS0VZLCBQcml2YXRlS2V5SW5mby5kZWZhdWx0VmFsdWVzKFBBUlNFRF9LRVkpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5qc29uKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21KU09OKHBhcmFtZXRlcnMuanNvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kajpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgUFJJVkFURV9LRVlfQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBQUklWQVRFX0tFWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBBVFRSSUJVVEVTJDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBQQVJTRURfS0VZOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnZlcnNpb24gfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5wcml2YXRlS2V5QWxnb3JpdGhtIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgbmFtZTogKG5hbWVzLnByaXZhdGVLZXkgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYXR0cmlidXRlcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBdHRyaWJ1dGUuc2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDE2KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQcml2YXRlS2V5SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBWRVJTSU9OJGosXG4gICAgICAgICAgICAgICAgcHJpdmF0ZUtleUFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBQUklWQVRFX0tFWV9BTEdPUklUSE1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcHJpdmF0ZUtleTogUFJJVkFURV9LRVksXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczogQVRUUklCVVRFUyQ1XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gYXNuMS5yZXN1bHQudmVyc2lvbi52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLnByaXZhdGVLZXlBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQucHJpdmF0ZUtleUFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5wcml2YXRlS2V5ID0gYXNuMS5yZXN1bHQucHJpdmF0ZUtleTtcbiAgICAgICAgaWYgKEFUVFJJQlVURVMkNSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuYXR0cmlidXRlcywgZWxlbWVudCA9PiBuZXcgQXR0cmlidXRlKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgc3dpdGNoICh0aGlzLnByaXZhdGVLZXlBbGdvcml0aG0uYWxnb3JpdGhtSWQpIHtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4xLjEuMVwiOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJpdmF0ZUtleUFTTjEgPSBhc24xanMuZnJvbUJFUih0aGlzLnByaXZhdGVLZXkudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJpdmF0ZUtleUFTTjEub2Zmc2V0ICE9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VkS2V5ID0gbmV3IFJTQVByaXZhdGVLZXkoeyBzY2hlbWE6IHByaXZhdGVLZXlBU04xLnJlc3VsdCB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS4yLjFcIjpcbiAgICAgICAgICAgICAgICBpZiAoXCJhbGdvcml0aG1QYXJhbXNcIiBpbiB0aGlzLnByaXZhdGVLZXlBbGdvcml0aG0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdmF0ZUtleUFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMgaW5zdGFuY2VvZiBhc24xanMuT2JqZWN0SWRlbnRpZmllcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJpdmF0ZUtleUFTTjEgPSBhc24xanMuZnJvbUJFUih0aGlzLnByaXZhdGVLZXkudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByaXZhdGVLZXlBU04xLm9mZnNldCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlZEtleSA9IG5ldyBFQ1ByaXZhdGVLZXkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lZEN1cnZlOiB0aGlzLnByaXZhdGVLZXlBbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zLnZhbHVlQmxvY2sudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiBwcml2YXRlS2V5QVNOMS5yZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pLFxuICAgICAgICAgICAgdGhpcy5wcml2YXRlS2V5QWxnb3JpdGhtLnRvU2NoZW1hKCksXG4gICAgICAgICAgICB0aGlzLnByaXZhdGVLZXlcbiAgICAgICAgXTtcbiAgICAgICAgaWYgKHRoaXMuYXR0cmlidXRlcykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuYXR0cmlidXRlcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcnNlZEtleSkge1xuICAgICAgICAgICAgY29uc3Qgb2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgICAgICBwcml2YXRlS2V5QWxnb3JpdGhtOiB0aGlzLnByaXZhdGVLZXlBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICAgICAgcHJpdmF0ZUtleTogdGhpcy5wcml2YXRlS2V5LnRvSlNPTigpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICh0aGlzLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICBvYmplY3QuYXR0cmlidXRlcyA9IEFycmF5LmZyb20odGhpcy5hdHRyaWJ1dGVzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBqd2sgPSB7fTtcbiAgICAgICAgc3dpdGNoICh0aGlzLnByaXZhdGVLZXlBbGdvcml0aG0uYWxnb3JpdGhtSWQpIHtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjEwMDQ1LjIuMVwiOlxuICAgICAgICAgICAgICAgIGp3ay5rdHkgPSBcIkVDXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjFcIjpcbiAgICAgICAgICAgICAgICBqd2sua3R5ID0gXCJSU0FcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwdWJsaWNLZXlKV0sgPSB0aGlzLnBhcnNlZEtleS50b0pTT04oKTtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihqd2ssIHB1YmxpY0tleUpXSyk7XG4gICAgICAgIHJldHVybiBqd2s7XG4gICAgfVxuICAgIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgaWYgKFwia3R5XCIgaW4ganNvbikge1xuICAgICAgICAgICAgc3dpdGNoIChqc29uLmt0eS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIkVDXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VkS2V5ID0gbmV3IEVDUHJpdmF0ZUtleSh7IGpzb24gfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdmF0ZUtleUFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMi44NDAuMTAwNDUuMi4xXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbXM6IG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLnBhcnNlZEtleS5uYW1lZEN1cnZlIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiUlNBXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VkS2V5ID0gbmV3IFJTQVByaXZhdGVLZXkoeyBqc29uIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZhdGVLZXlBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogXCIxLjIuODQwLjExMzU0OS4xLjEuMVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk51bGwoKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHZhbHVlIGZvciBcImt0eVwiIHBhcmFtZXRlcjogJHtqc29uLmt0eX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdmF0ZUtleSA9IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogdGhpcy5wYXJzZWRLZXkudG9TY2hlbWEoKS50b0JFUihmYWxzZSkgfSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5Qcml2YXRlS2V5SW5mby5DTEFTU19OQU1FID0gXCJQcml2YXRlS2V5SW5mb1wiO1xuXG5jb25zdCBDT05URU5UX1RZUEUkMSA9IFwiY29udGVudFR5cGVcIjtcbmNvbnN0IENPTlRFTlRfRU5DUllQVElPTl9BTEdPUklUSE0gPSBcImNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtXCI7XG5jb25zdCBFTkNSWVBURURfQ09OVEVOVCA9IFwiZW5jcnlwdGVkQ29udGVudFwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMTUgPSBbXG4gICAgQ09OVEVOVF9UWVBFJDEsXG4gICAgQ09OVEVOVF9FTkNSWVBUSU9OX0FMR09SSVRITSxcbiAgICBFTkNSWVBURURfQ09OVEVOVCxcbl07XG5jb25zdCBQSUVDRV9TSVpFID0gMTAyNDtcbmNsYXNzIEVuY3J5cHRlZENvbnRlbnRJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5jb250ZW50VHlwZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENPTlRFTlRfVFlQRSQxLCBFbmNyeXB0ZWRDb250ZW50SW5mby5kZWZhdWx0VmFsdWVzKENPTlRFTlRfVFlQRSQxKSk7XG4gICAgICAgIHRoaXMuY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDT05URU5UX0VOQ1JZUFRJT05fQUxHT1JJVEhNLCBFbmNyeXB0ZWRDb250ZW50SW5mby5kZWZhdWx0VmFsdWVzKENPTlRFTlRfRU5DUllQVElPTl9BTEdPUklUSE0pKTtcbiAgICAgICAgaWYgKEVOQ1JZUFRFRF9DT05URU5UIGluIHBhcmFtZXRlcnMgJiYgcGFyYW1ldGVycy5lbmNyeXB0ZWRDb250ZW50KSB7XG4gICAgICAgICAgICB0aGlzLmVuY3J5cHRlZENvbnRlbnQgPSBwYXJhbWV0ZXJzLmVuY3J5cHRlZENvbnRlbnQ7XG4gICAgICAgICAgICBpZiAoKHRoaXMuZW5jcnlwdGVkQ29udGVudC5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSAmJlxuICAgICAgICAgICAgICAgICh0aGlzLmVuY3J5cHRlZENvbnRlbnQuaWRCbG9jay50YWdOdW1iZXIgPT09IDQpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZW5jcnlwdGVkQ29udGVudC5pZEJsb2NrLmlzQ29uc3RydWN0ZWQgPT09IGZhbHNlICYmICFwYXJhbWV0ZXJzLmRpc2FibGVTcGxpdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25zdHJTdHJpbmcgPSBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHsgaXNDb25zdHJ1Y3RlZDogdHJ1ZSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNDb25zdHJ1Y3RlZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG9mZnNldCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlSGV4ID0gdGhpcy5lbmNyeXB0ZWRDb250ZW50LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3LnNsaWNlKCkuYnVmZmVyO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbGVuZ3RoID0gdmFsdWVIZXguYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBpZWNlVmlldyA9IG5ldyBVaW50OEFycmF5KHZhbHVlSGV4LCBvZmZzZXQsICgob2Zmc2V0ICsgUElFQ0VfU0laRSkgPiB2YWx1ZUhleC5ieXRlTGVuZ3RoKSA/ICh2YWx1ZUhleC5ieXRlTGVuZ3RoIC0gb2Zmc2V0KSA6IFBJRUNFX1NJWkUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgX2FycmF5ID0gbmV3IEFycmF5QnVmZmVyKHBpZWNlVmlldy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgX3ZpZXcgPSBuZXcgVWludDhBcnJheShfYXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBfdmlldy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdmlld1tpXSA9IHBpZWNlVmlld1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0clN0cmluZy52YWx1ZUJsb2NrLnZhbHVlLnB1c2gobmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBfYXJyYXkgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoIC09IHBpZWNlVmlldy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gcGllY2VWaWV3Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuY3J5cHRlZENvbnRlbnQgPSBjb25zdHJTdHJpbmc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDT05URU5UX1RZUEUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBDT05URU5UX0VOQ1JZUFRJT05fQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBFTkNSWVBURURfQ09OVEVOVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDT05URU5UX1RZUEUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBFTVBUWV9TVFJJTkcpO1xuICAgICAgICAgICAgY2FzZSBDT05URU5UX0VOQ1JZUFRJT05fQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKG1lbWJlclZhbHVlLmFsZ29yaXRobUlkID09PSBFTVBUWV9TVFJJTkcpICYmICgoXCJhbGdvcml0aG1QYXJhbXNcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9DT05URU5UOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChFbmNyeXB0ZWRDb250ZW50SW5mby5kZWZhdWx0VmFsdWVzKEVOQ1JZUFRFRF9DT05URU5UKSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMuY29udGVudFR5cGUgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5jb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmVuY3J5cHRlZENvbnRlbnQgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5lbmNyeXB0ZWRDb250ZW50IHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkMTUpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEVuY3J5cHRlZENvbnRlbnRJbmZvLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBDT05URU5UX1RZUEUkMSxcbiAgICAgICAgICAgICAgICBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBDT05URU5UX0VOQ1JZUFRJT05fQUxHT1JJVEhNXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZENvbnRlbnQ6IEVOQ1JZUFRFRF9DT05URU5UXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jb250ZW50VHlwZSA9IGFzbjEucmVzdWx0LmNvbnRlbnRUeXBlLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5jb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5jb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSB9KTtcbiAgICAgICAgaWYgKEVOQ1JZUFRFRF9DT05URU5UIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmVuY3J5cHRlZENvbnRlbnQgPSBhc24xLnJlc3VsdC5lbmNyeXB0ZWRDb250ZW50O1xuICAgICAgICAgICAgdGhpcy5lbmNyeXB0ZWRDb250ZW50LmlkQmxvY2sudGFnQ2xhc3MgPSAxO1xuICAgICAgICAgICAgdGhpcy5lbmNyeXB0ZWRDb250ZW50LmlkQmxvY2sudGFnTnVtYmVyID0gNDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgc2VxdWVuY2VMZW5ndGhCbG9jayA9IHtcbiAgICAgICAgICAgIGlzSW5kZWZpbml0ZUZvcm06IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMuY29udGVudFR5cGUgfSkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0udG9TY2hlbWEoKSk7XG4gICAgICAgIGlmICh0aGlzLmVuY3J5cHRlZENvbnRlbnQpIHtcbiAgICAgICAgICAgIHNlcXVlbmNlTGVuZ3RoQmxvY2suaXNJbmRlZmluaXRlRm9ybSA9IHRoaXMuZW5jcnlwdGVkQ29udGVudC5pZEJsb2NrLmlzQ29uc3RydWN0ZWQ7XG4gICAgICAgICAgICBjb25zdCBlbmNyeXB0ZWRWYWx1ZSA9IHRoaXMuZW5jcnlwdGVkQ29udGVudDtcbiAgICAgICAgICAgIGVuY3J5cHRlZFZhbHVlLmlkQmxvY2sudGFnQ2xhc3MgPSAzO1xuICAgICAgICAgICAgZW5jcnlwdGVkVmFsdWUuaWRCbG9jay50YWdOdW1iZXIgPSAwO1xuICAgICAgICAgICAgZW5jcnlwdGVkVmFsdWUubGVuQmxvY2suaXNJbmRlZmluaXRlRm9ybSA9IHRoaXMuZW5jcnlwdGVkQ29udGVudC5pZEJsb2NrLmlzQ29uc3RydWN0ZWQ7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKGVuY3J5cHRlZFZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbGVuQmxvY2s6IHNlcXVlbmNlTGVuZ3RoQmxvY2ssXG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlOiB0aGlzLmNvbnRlbnRUeXBlLFxuICAgICAgICAgICAgY29udGVudEVuY3J5cHRpb25BbGdvcml0aG06IHRoaXMuY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0udG9KU09OKClcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuZW5jcnlwdGVkQ29udGVudCkge1xuICAgICAgICAgICAgcmVzLmVuY3J5cHRlZENvbnRlbnQgPSB0aGlzLmVuY3J5cHRlZENvbnRlbnQudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgZ2V0RW5jcnlwdGVkQ29udGVudCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmVuY3J5cHRlZENvbnRlbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBhcmFtZXRlciAnZW5jcnlwdGVkQ29udGVudCcgaXMgdW5kZWZpbmVkXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhc24xanMuT2N0ZXRTdHJpbmcucHJvdG90eXBlLmdldFZhbHVlLmNhbGwodGhpcy5lbmNyeXB0ZWRDb250ZW50KTtcbiAgICB9XG59XG5FbmNyeXB0ZWRDb250ZW50SW5mby5DTEFTU19OQU1FID0gXCJFbmNyeXB0ZWRDb250ZW50SW5mb1wiO1xuXG5jb25zdCBIQVNIX0FMR09SSVRITSQ0ID0gXCJoYXNoQWxnb3JpdGhtXCI7XG5jb25zdCBNQVNLX0dFTl9BTEdPUklUSE0kMSA9IFwibWFza0dlbkFsZ29yaXRobVwiO1xuY29uc3QgU0FMVF9MRU5HVEggPSBcInNhbHRMZW5ndGhcIjtcbmNvbnN0IFRSQUlMRVJfRklFTEQgPSBcInRyYWlsZXJGaWVsZFwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMTQgPSBbXG4gICAgSEFTSF9BTEdPUklUSE0kNCxcbiAgICBNQVNLX0dFTl9BTEdPUklUSE0kMSxcbiAgICBTQUxUX0xFTkdUSCxcbiAgICBUUkFJTEVSX0ZJRUxEXG5dO1xuY2xhc3MgUlNBU1NBUFNTUGFyYW1zIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSEFTSF9BTEdPUklUSE0kNCwgUlNBU1NBUFNTUGFyYW1zLmRlZmF1bHRWYWx1ZXMoSEFTSF9BTEdPUklUSE0kNCkpO1xuICAgICAgICB0aGlzLm1hc2tHZW5BbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBNQVNLX0dFTl9BTEdPUklUSE0kMSwgUlNBU1NBUFNTUGFyYW1zLmRlZmF1bHRWYWx1ZXMoTUFTS19HRU5fQUxHT1JJVEhNJDEpKTtcbiAgICAgICAgdGhpcy5zYWx0TGVuZ3RoID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0FMVF9MRU5HVEgsIFJTQVNTQVBTU1BhcmFtcy5kZWZhdWx0VmFsdWVzKFNBTFRfTEVOR1RIKSk7XG4gICAgICAgIHRoaXMudHJhaWxlckZpZWxkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVFJBSUxFUl9GSUVMRCwgUlNBU1NBUFNTUGFyYW1zLmRlZmF1bHRWYWx1ZXMoVFJBSUxFUl9GSUVMRCkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSEFTSF9BTEdPUklUSE0kNDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogXCIxLjMuMTQuMy4yLjI2XCIsXG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNhc2UgTUFTS19HRU5fQUxHT1JJVEhNJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjhcIixcbiAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiAobmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IFwiMS4zLjE0LjMuMi4yNlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk51bGwoKVxuICAgICAgICAgICAgICAgICAgICB9KSkudG9TY2hlbWEoKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY2FzZSBTQUxUX0xFTkdUSDpcbiAgICAgICAgICAgICAgICByZXR1cm4gMjA7XG4gICAgICAgICAgICBjYXNlIFRSQUlMRVJfRklFTEQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5oYXNoQWxnb3JpdGhtIHx8IHt9KV1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMubWFza0dlbkFsZ29yaXRobSB8fCB7fSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5zYWx0TGVuZ3RoIHx8IEVNUFRZX1NUUklORykgfSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAzXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy50cmFpbGVyRmllbGQgfHwgRU1QVFlfU1RSSU5HKSB9KV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDE0KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBSU0FTU0FQU1NQYXJhbXMuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgaGFzaEFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBIQVNIX0FMR09SSVRITSQ0XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG1hc2tHZW5BbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogTUFTS19HRU5fQUxHT1JJVEhNJDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2FsdExlbmd0aDogU0FMVF9MRU5HVEgsXG4gICAgICAgICAgICAgICAgdHJhaWxlckZpZWxkOiBUUkFJTEVSX0ZJRUxEXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKEhBU0hfQUxHT1JJVEhNJDQgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmhhc2hBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuaGFzaEFsZ29yaXRobSB9KTtcbiAgICAgICAgaWYgKE1BU0tfR0VOX0FMR09SSVRITSQxIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5tYXNrR2VuQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0Lm1hc2tHZW5BbGdvcml0aG0gfSk7XG4gICAgICAgIGlmIChTQUxUX0xFTkdUSCBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuc2FsdExlbmd0aCA9IGFzbjEucmVzdWx0LnNhbHRMZW5ndGgudmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgaWYgKFRSQUlMRVJfRklFTEQgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnRyYWlsZXJGaWVsZCA9IGFzbjEucmVzdWx0LnRyYWlsZXJGaWVsZC52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKCF0aGlzLmhhc2hBbGdvcml0aG0uaXNFcXVhbChSU0FTU0FQU1NQYXJhbXMuZGVmYXVsdFZhbHVlcyhIQVNIX0FMR09SSVRITSQ0KSkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMuaGFzaEFsZ29yaXRobS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5tYXNrR2VuQWxnb3JpdGhtLmlzRXF1YWwoUlNBU1NBUFNTUGFyYW1zLmRlZmF1bHRWYWx1ZXMoTUFTS19HRU5fQUxHT1JJVEhNJDEpKSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5tYXNrR2VuQWxnb3JpdGhtLnRvU2NoZW1hKCldXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2FsdExlbmd0aCAhPT0gUlNBU1NBUFNTUGFyYW1zLmRlZmF1bHRWYWx1ZXMoU0FMVF9MRU5HVEgpKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy5zYWx0TGVuZ3RoIH0pXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnRyYWlsZXJGaWVsZCAhPT0gUlNBU1NBUFNTUGFyYW1zLmRlZmF1bHRWYWx1ZXMoVFJBSUxFUl9GSUVMRCkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAzXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnRyYWlsZXJGaWVsZCB9KV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7fTtcbiAgICAgICAgaWYgKCF0aGlzLmhhc2hBbGdvcml0aG0uaXNFcXVhbChSU0FTU0FQU1NQYXJhbXMuZGVmYXVsdFZhbHVlcyhIQVNIX0FMR09SSVRITSQ0KSkpIHtcbiAgICAgICAgICAgIHJlcy5oYXNoQWxnb3JpdGhtID0gdGhpcy5oYXNoQWxnb3JpdGhtLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5tYXNrR2VuQWxnb3JpdGhtLmlzRXF1YWwoUlNBU1NBUFNTUGFyYW1zLmRlZmF1bHRWYWx1ZXMoTUFTS19HRU5fQUxHT1JJVEhNJDEpKSkge1xuICAgICAgICAgICAgcmVzLm1hc2tHZW5BbGdvcml0aG0gPSB0aGlzLm1hc2tHZW5BbGdvcml0aG0udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2FsdExlbmd0aCAhPT0gUlNBU1NBUFNTUGFyYW1zLmRlZmF1bHRWYWx1ZXMoU0FMVF9MRU5HVEgpKSB7XG4gICAgICAgICAgICByZXMuc2FsdExlbmd0aCA9IHRoaXMuc2FsdExlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50cmFpbGVyRmllbGQgIT09IFJTQVNTQVBTU1BhcmFtcy5kZWZhdWx0VmFsdWVzKFRSQUlMRVJfRklFTEQpKSB7XG4gICAgICAgICAgICByZXMudHJhaWxlckZpZWxkID0gdGhpcy50cmFpbGVyRmllbGQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5SU0FTU0FQU1NQYXJhbXMuQ0xBU1NfTkFNRSA9IFwiUlNBU1NBUFNTUGFyYW1zXCI7XG5cbmNvbnN0IFNBTFQgPSBcInNhbHRcIjtcbmNvbnN0IElURVJBVElPTl9DT1VOVCA9IFwiaXRlcmF0aW9uQ291bnRcIjtcbmNvbnN0IEtFWV9MRU5HVEggPSBcImtleUxlbmd0aFwiO1xuY29uc3QgUFJGID0gXCJwcmZcIjtcbmNvbnN0IENMRUFSX1BST1BTJDEzID0gW1xuICAgIFNBTFQsXG4gICAgSVRFUkFUSU9OX0NPVU5ULFxuICAgIEtFWV9MRU5HVEgsXG4gICAgUFJGXG5dO1xuY2xhc3MgUEJLREYyUGFyYW1zIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5zYWx0ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0FMVCwgUEJLREYyUGFyYW1zLmRlZmF1bHRWYWx1ZXMoU0FMVCkpO1xuICAgICAgICB0aGlzLml0ZXJhdGlvbkNvdW50ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVRFUkFUSU9OX0NPVU5ULCBQQktERjJQYXJhbXMuZGVmYXVsdFZhbHVlcyhJVEVSQVRJT05fQ09VTlQpKTtcbiAgICAgICAgaWYgKEtFWV9MRU5HVEggaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5rZXlMZW5ndGggPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBLRVlfTEVOR1RILCBQQktERjJQYXJhbXMuZGVmYXVsdFZhbHVlcyhLRVlfTEVOR1RIKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFBSRiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnByZiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBSRiwgUEJLREYyUGFyYW1zLmRlZmF1bHRWYWx1ZXMoUFJGKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFNBTFQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgY2FzZSBJVEVSQVRJT05fQ09VTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgtMSk7XG4gICAgICAgICAgICBjYXNlIEtFWV9MRU5HVEg6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIFBSRjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogXCIxLjMuMTQuMy4yLjI2XCIsXG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5zYWx0UHJpbWl0aXZlIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5zYWx0Q29uc3RydWN0ZWQgfHwge30pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuaXRlcmF0aW9uQ291bnQgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMua2V5TGVuZ3RoIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMucHJmIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDEzKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQQktERjJQYXJhbXMuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgc2FsdFByaW1pdGl2ZTogU0FMVCxcbiAgICAgICAgICAgICAgICBzYWx0Q29uc3RydWN0ZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogU0FMVFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBpdGVyYXRpb25Db3VudDogSVRFUkFUSU9OX0NPVU5ULFxuICAgICAgICAgICAgICAgIGtleUxlbmd0aDogS0VZX0xFTkdUSCxcbiAgICAgICAgICAgICAgICBwcmY6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogUFJGLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnNhbHQgPSBhc24xLnJlc3VsdC5zYWx0O1xuICAgICAgICB0aGlzLml0ZXJhdGlvbkNvdW50ID0gYXNuMS5yZXN1bHQuaXRlcmF0aW9uQ291bnQudmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgaWYgKEtFWV9MRU5HVEggaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmtleUxlbmd0aCA9IGFzbjEucmVzdWx0LmtleUxlbmd0aC52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICBpZiAoUFJGIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5wcmYgPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQucHJmIH0pO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNhbHQpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLml0ZXJhdGlvbkNvdW50IH0pKTtcbiAgICAgICAgaWYgKEtFWV9MRU5HVEggaW4gdGhpcykge1xuICAgICAgICAgICAgaWYgKFBCS0RGMlBhcmFtcy5kZWZhdWx0VmFsdWVzKEtFWV9MRU5HVEgpICE9PSB0aGlzLmtleUxlbmd0aClcbiAgICAgICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLmtleUxlbmd0aCB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJmKSB7XG4gICAgICAgICAgICBpZiAoUEJLREYyUGFyYW1zLmRlZmF1bHRWYWx1ZXMoUFJGKS5pc0VxdWFsKHRoaXMucHJmKSA9PT0gZmFsc2UpXG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnByZi50b1NjaGVtYSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICBzYWx0OiB0aGlzLnNhbHQudG9KU09OKCksXG4gICAgICAgICAgICBpdGVyYXRpb25Db3VudDogdGhpcy5pdGVyYXRpb25Db3VudFxuICAgICAgICB9O1xuICAgICAgICBpZiAoS0VZX0xFTkdUSCBpbiB0aGlzKSB7XG4gICAgICAgICAgICBpZiAoUEJLREYyUGFyYW1zLmRlZmF1bHRWYWx1ZXMoS0VZX0xFTkdUSCkgIT09IHRoaXMua2V5TGVuZ3RoKVxuICAgICAgICAgICAgICAgIHJlcy5rZXlMZW5ndGggPSB0aGlzLmtleUxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcmYpIHtcbiAgICAgICAgICAgIGlmIChQQktERjJQYXJhbXMuZGVmYXVsdFZhbHVlcyhQUkYpLmlzRXF1YWwodGhpcy5wcmYpID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICByZXMucHJmID0gdGhpcy5wcmYudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5QQktERjJQYXJhbXMuQ0xBU1NfTkFNRSA9IFwiUEJLREYyUGFyYW1zXCI7XG5cbmNvbnN0IEtFWV9ERVJJVkFUSU9OX0ZVTkMgPSBcImtleURlcml2YXRpb25GdW5jXCI7XG5jb25zdCBFTkNSWVBUSU9OX1NDSEVNRSA9IFwiZW5jcnlwdGlvblNjaGVtZVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkMTIgPSBbXG4gICAgS0VZX0RFUklWQVRJT05fRlVOQyxcbiAgICBFTkNSWVBUSU9OX1NDSEVNRVxuXTtcbmNsYXNzIFBCRVMyUGFyYW1zIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5rZXlEZXJpdmF0aW9uRnVuYyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEtFWV9ERVJJVkFUSU9OX0ZVTkMsIFBCRVMyUGFyYW1zLmRlZmF1bHRWYWx1ZXMoS0VZX0RFUklWQVRJT05fRlVOQykpO1xuICAgICAgICB0aGlzLmVuY3J5cHRpb25TY2hlbWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFTkNSWVBUSU9OX1NDSEVNRSwgUEJFUzJQYXJhbXMuZGVmYXVsdFZhbHVlcyhFTkNSWVBUSU9OX1NDSEVNRSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgS0VZX0RFUklWQVRJT05fRlVOQzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVElPTl9TQ0hFTUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLmtleURlcml2YXRpb25GdW5jIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5lbmNyeXB0aW9uU2NoZW1lIHx8IHt9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDEyKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQQkVTMlBhcmFtcy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBrZXlEZXJpdmF0aW9uRnVuYzoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBLRVlfREVSSVZBVElPTl9GVU5DXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVuY3J5cHRpb25TY2hlbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogRU5DUllQVElPTl9TQ0hFTUVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmtleURlcml2YXRpb25GdW5jID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmtleURlcml2YXRpb25GdW5jIH0pO1xuICAgICAgICB0aGlzLmVuY3J5cHRpb25TY2hlbWUgPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuZW5jcnlwdGlvblNjaGVtZSB9KTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMua2V5RGVyaXZhdGlvbkZ1bmMudG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLmVuY3J5cHRpb25TY2hlbWUudG9TY2hlbWEoKVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGtleURlcml2YXRpb25GdW5jOiB0aGlzLmtleURlcml2YXRpb25GdW5jLnRvSlNPTigpLFxuICAgICAgICAgICAgZW5jcnlwdGlvblNjaGVtZTogdGhpcy5lbmNyeXB0aW9uU2NoZW1lLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgfVxufVxuUEJFUzJQYXJhbXMuQ0xBU1NfTkFNRSA9IFwiUEJFUzJQYXJhbXNcIjtcblxuY2xhc3MgQWJzdHJhY3RDcnlwdG9FbmdpbmUge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHtcbiAgICAgICAgdGhpcy5jcnlwdG8gPSBwYXJhbWV0ZXJzLmNyeXB0bztcbiAgICAgICAgdGhpcy5zdWJ0bGUgPSBcIndlYmtpdFN1YnRsZVwiIGluIHBhcmFtZXRlcnMuY3J5cHRvXG4gICAgICAgICAgICA/IHBhcmFtZXRlcnMuY3J5cHRvLndlYmtpdFN1YnRsZVxuICAgICAgICAgICAgOiBwYXJhbWV0ZXJzLmNyeXB0by5zdWJ0bGU7XG4gICAgICAgIHRoaXMubmFtZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZVwiLCBFTVBUWV9TVFJJTkcpO1xuICAgIH1cbiAgICBhc3luYyBlbmNyeXB0KC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3VidGxlLmVuY3J5cHQoLi4uYXJncyk7XG4gICAgfVxuICAgIGFzeW5jIGRlY3J5cHQoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuZGVjcnlwdCguLi5hcmdzKTtcbiAgICB9XG4gICAgc2lnbiguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS5zaWduKC4uLmFyZ3MpO1xuICAgIH1cbiAgICBhc3luYyB2ZXJpZnkoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUudmVyaWZ5KC4uLmFyZ3MpO1xuICAgIH1cbiAgICBhc3luYyBkaWdlc3QoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuZGlnZXN0KC4uLmFyZ3MpO1xuICAgIH1cbiAgICBhc3luYyBnZW5lcmF0ZUtleSguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS5nZW5lcmF0ZUtleSguLi5hcmdzKTtcbiAgICB9XG4gICAgYXN5bmMgZGVyaXZlS2V5KC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3VidGxlLmRlcml2ZUtleSguLi5hcmdzKTtcbiAgICB9XG4gICAgYXN5bmMgZGVyaXZlQml0cyguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS5kZXJpdmVCaXRzKC4uLmFyZ3MpO1xuICAgIH1cbiAgICBhc3luYyB3cmFwS2V5KC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3VidGxlLndyYXBLZXkoLi4uYXJncyk7XG4gICAgfVxuICAgIGFzeW5jIHVud3JhcEtleSguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS51bndyYXBLZXkoLi4uYXJncyk7XG4gICAgfVxuICAgIGV4cG9ydEtleSguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS5leHBvcnRLZXkoLi4uYXJncyk7XG4gICAgfVxuICAgIGltcG9ydEtleSguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS5pbXBvcnRLZXkoLi4uYXJncyk7XG4gICAgfVxuICAgIGdldFJhbmRvbVZhbHVlcyhhcnJheSkge1xuICAgICAgICByZXR1cm4gdGhpcy5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGFycmF5KTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIG1ha2VQS0NTMTJCMktleShoYXNoQWxnb3JpdGhtLCBrZXlMZW5ndGgsIHBhc3N3b3JkLCBzYWx0LCBpdGVyYXRpb25Db3VudCkge1xuICAgIGxldCB1O1xuICAgIGxldCB2O1xuICAgIGxldCBtZDtcbiAgICBzd2l0Y2ggKGhhc2hBbGdvcml0aG0udG9VcHBlckNhc2UoKSkge1xuICAgICAgICBjYXNlIFwiU0hBLTFcIjpcbiAgICAgICAgICAgIHUgPSAyMDtcbiAgICAgICAgICAgIHYgPSA2NDtcbiAgICAgICAgICAgIG1kID0gc2hhMTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICAgICAgdSA9IDMyO1xuICAgICAgICAgICAgdiA9IDY0O1xuICAgICAgICAgICAgbWQgPSBzaGEyNTY7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIlNIQS0zODRcIjpcbiAgICAgICAgICAgIHUgPSA0ODtcbiAgICAgICAgICAgIHYgPSAxMjg7XG4gICAgICAgICAgICBtZCA9IHNoYTM4NDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiU0hBLTUxMlwiOlxuICAgICAgICAgICAgdSA9IDY0O1xuICAgICAgICAgICAgdiA9IDEyODtcbiAgICAgICAgICAgIG1kID0gc2hhNTEyO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbnN1cHBvcnRlZCBoYXNoaW5nIGFsZ29yaXRobVwiKTtcbiAgICB9XG4gICAgY29uc3Qgb3JpZ2luYWxQYXNzd29yZCA9IG5ldyBVaW50OEFycmF5KHBhc3N3b3JkKTtcbiAgICBsZXQgZGVjb2RlZFBhc3N3b3JkID0gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKHBhc3N3b3JkKTtcbiAgICBjb25zdCBlbmNvZGVkUGFzc3dvcmQgPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoZGVjb2RlZFBhc3N3b3JkKTtcbiAgICBpZiAoZW5jb2RlZFBhc3N3b3JkLnNvbWUoKGJ5dGUsIGkpID0+IGJ5dGUgIT09IG9yaWdpbmFsUGFzc3dvcmRbaV0pKSB7XG4gICAgICAgIGRlY29kZWRQYXNzd29yZCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoLi4ub3JpZ2luYWxQYXNzd29yZCk7XG4gICAgfVxuICAgIGNvbnN0IHBhc3N3b3JkVHJhbnNmb3JtZWQgPSBuZXcgVWludDhBcnJheShkZWNvZGVkUGFzc3dvcmQubGVuZ3RoICogMiArIDIpO1xuICAgIGNvbnN0IHBhc3N3b3JkVmlldyA9IG5ldyBEYXRhVmlldyhwYXNzd29yZFRyYW5zZm9ybWVkLmJ1ZmZlcik7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkZWNvZGVkUGFzc3dvcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgcGFzc3dvcmRWaWV3LnNldFVpbnQxNihpICogMiwgZGVjb2RlZFBhc3N3b3JkLmNoYXJDb2RlQXQoaSksIGZhbHNlKTtcbiAgICB9XG4gICAgcGFzc3dvcmRWaWV3LnNldFVpbnQxNihkZWNvZGVkUGFzc3dvcmQubGVuZ3RoICogMiwgMCwgZmFsc2UpO1xuICAgIGNvbnN0IEQgPSBuZXcgVWludDhBcnJheSh2KS5maWxsKDMpO1xuICAgIGNvbnN0IHNhbHRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoc2FsdCk7XG4gICAgY29uc3QgUyA9IG5ldyBVaW50OEFycmF5KHYgKiBNYXRoLmNlaWwoc2FsdFZpZXcubGVuZ3RoIC8gdikpLm1hcCgoXywgaSkgPT4gc2FsdFZpZXdbaSAlIHNhbHRWaWV3Lmxlbmd0aF0pO1xuICAgIGNvbnN0IFAgPSBuZXcgVWludDhBcnJheSh2ICogTWF0aC5jZWlsKHBhc3N3b3JkVHJhbnNmb3JtZWQubGVuZ3RoIC8gdikpLm1hcCgoXywgaSkgPT4gcGFzc3dvcmRUcmFuc2Zvcm1lZFtpICUgcGFzc3dvcmRUcmFuc2Zvcm1lZC5sZW5ndGhdKTtcbiAgICBsZXQgSSA9IG5ldyBVaW50OEFycmF5KFMubGVuZ3RoICsgUC5sZW5ndGgpO1xuICAgIEkuc2V0KFMpO1xuICAgIEkuc2V0KFAsIFMubGVuZ3RoKTtcbiAgICBjb25zdCBjID0gTWF0aC5jZWlsKChrZXlMZW5ndGggPj4gMykgLyB1KTtcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGM7IGkrKykge1xuICAgICAgICBsZXQgQSA9IG5ldyBVaW50OEFycmF5KEQubGVuZ3RoICsgSS5sZW5ndGgpO1xuICAgICAgICBBLnNldChEKTtcbiAgICAgICAgQS5zZXQoSSwgRC5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGl0ZXJhdGlvbkNvdW50OyBqKyspIHtcbiAgICAgICAgICAgIEEgPSBtZChBKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBCID0gbmV3IFVpbnQ4QXJyYXkodikubWFwKChfLCBpKSA9PiBBW2kgJSBBLmxlbmd0aF0pO1xuICAgICAgICBjb25zdCBrID0gTWF0aC5jZWlsKHNhbHRWaWV3Lmxlbmd0aCAvIHYpICsgTWF0aC5jZWlsKHBhc3N3b3JkVHJhbnNmb3JtZWQubGVuZ3RoIC8gdik7XG4gICAgICAgIGNvbnN0IGlSb3VuZCA9IFtdO1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGs7IGorKykge1xuICAgICAgICAgICAgY29uc3QgY2h1bmsgPSBBcnJheS5mcm9tKEkuc2xpY2UoaiAqIHYsIChqICsgMSkgKiB2KSk7XG4gICAgICAgICAgICBsZXQgeCA9IDB4MWZmO1xuICAgICAgICAgICAgZm9yIChsZXQgbCA9IEIubGVuZ3RoIC0gMTsgbCA+PSAwOyBsLS0pIHtcbiAgICAgICAgICAgICAgICB4ID4+PSA4O1xuICAgICAgICAgICAgICAgIHggKz0gQltsXSArIChjaHVua1tsXSB8fCAwKTtcbiAgICAgICAgICAgICAgICBjaHVua1tsXSA9IHggJiAweGZmO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaVJvdW5kLnB1c2goLi4uY2h1bmspO1xuICAgICAgICB9XG4gICAgICAgIEkgPSBuZXcgVWludDhBcnJheShpUm91bmQpO1xuICAgICAgICByZXN1bHQucHVzaCguLi5BKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KHJlc3VsdC5zbGljZSgwLCBrZXlMZW5ndGggPj4gMykpLmJ1ZmZlcjtcbn1cbmZ1bmN0aW9uIHByZXBhcmVBbGdvcml0aG0oZGF0YSkge1xuICAgIGNvbnN0IHJlcyA9IHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiXG4gICAgICAgID8geyBuYW1lOiBkYXRhIH1cbiAgICAgICAgOiBkYXRhO1xuICAgIGlmIChcImhhc2hcIiBpbiByZXMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnJlcyxcbiAgICAgICAgICAgIGhhc2g6IHByZXBhcmVBbGdvcml0aG0ocmVzLmhhc2gpXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG5jbGFzcyBDcnlwdG9FbmdpbmUgZXh0ZW5kcyBBYnN0cmFjdENyeXB0b0VuZ2luZSB7XG4gICAgYXN5bmMgaW1wb3J0S2V5KGZvcm1hdCwga2V5RGF0YSwgYWxnb3JpdGhtLCBleHRyYWN0YWJsZSwga2V5VXNhZ2VzKSB7XG4gICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2UsIF9mO1xuICAgICAgICBsZXQgandrID0ge307XG4gICAgICAgIGNvbnN0IGFsZyA9IHByZXBhcmVBbGdvcml0aG0oYWxnb3JpdGhtKTtcbiAgICAgICAgc3dpdGNoIChmb3JtYXQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSBcInJhd1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN1YnRsZS5pbXBvcnRLZXkoXCJyYXdcIiwga2V5RGF0YSwgYWxnb3JpdGhtLCBleHRyYWN0YWJsZSwga2V5VXNhZ2VzKTtcbiAgICAgICAgICAgIGNhc2UgXCJzcGtpXCI6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmZyb21CRVIocHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci50b0FycmF5QnVmZmVyKGtleURhdGEpKTtcbiAgICAgICAgICAgICAgICAgICAgQXNuRXJyb3IuYXNzZXJ0KGFzbjEsIFwia2V5RGF0YVwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHVibGljS2V5SW5mbyA9IG5ldyBQdWJsaWNLZXlJbmZvKCk7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWNLZXlJbmZvLmZyb21TY2hlbWEoYXNuMS5yZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudEVycm9yKFwiSW5jb3JyZWN0IGtleURhdGFcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChhbGcubmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiUlNBLVBTU1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbGcuaGFzaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFBhcmFtZXRlckVycm9yKFwiaGFzaFwiLCBcImFsZ29yaXRobS5oYXNoXCIsIFwiSW5jb3JyZWN0IGhhc2ggYWxnb3JpdGhtOiBIYXNoIGFsZ29yaXRobSBpcyBtaXNzZWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChhbGcuaGFzaC5uYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlBTMVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0yNTZcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJQUzI1NlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0zODRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJQUzM4NFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS01MTJcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJQUzUxMlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBoYXNoIGFsZ29yaXRobTogJHthbGcuaGFzaC5uYW1lLnRvVXBwZXJDYXNlKCl9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiUlNBU1NBLVBLQ1MxLVYxXzVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleVVzYWdlcyA9IFtcInZlcmlmeVwiXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmt0eSA9IFwiUlNBXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5leHQgPSBleHRyYWN0YWJsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmtleV9vcHMgPSBrZXlVc2FnZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwdWJsaWNLZXlJbmZvLmFsZ29yaXRobS5hbGdvcml0aG1JZCAhPT0gXCIxLjIuODQwLjExMzU0OS4xLjEuMVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgcHVibGljIGtleSBhbGdvcml0aG06ICR7cHVibGljS2V5SW5mby5hbGdvcml0aG0uYWxnb3JpdGhtSWR9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghandrLmFsZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbGcuaGFzaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBQYXJhbWV0ZXJFcnJvcihcImhhc2hcIiwgXCJhbGdvcml0aG0uaGFzaFwiLCBcIkluY29ycmVjdCBoYXNoIGFsZ29yaXRobTogSGFzaCBhbGdvcml0aG0gaXMgbWlzc2VkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChhbGcuaGFzaC5uYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUlMxXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMjU2XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTMjU2XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMzg0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTMzg0XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTNTEyXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGhhc2ggYWxnb3JpdGhtOiAke2FsZy5oYXNoLm5hbWUudG9VcHBlckNhc2UoKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdWJsaWNLZXlKU09OID0gcHVibGljS2V5SW5mby50b0pTT04oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihqd2ssIHB1YmxpY0tleUpTT04pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJFQ0RTQVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleVVzYWdlcyA9IFtcInZlcmlmeVwiXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJFQ0RIXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2sgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrdHk6IFwiRUNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dDogZXh0cmFjdGFibGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlfb3BzOiBrZXlVc2FnZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobUlkICE9PSBcIjEuMi44NDAuMTAwNDUuMi4xXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IHB1YmxpYyBrZXkgYWxnb3JpdGhtOiAke3B1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobUlkfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHB1YmxpY0tleUpTT04gPSBwdWJsaWNLZXlJbmZvLnRvSlNPTigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGp3aywgcHVibGljS2V5SlNPTik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlJTQS1PQUVQXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2sua3R5ID0gXCJSU0FcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmV4dCA9IGV4dHJhY3RhYmxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2sua2V5X29wcyA9IGtleVVzYWdlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubmFtZS50b0xvd2VyQ2FzZSgpID09PSBcInNhZmFyaVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUlNBLU9BRVBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFsZy5oYXNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFBhcmFtZXRlckVycm9yKFwiaGFzaFwiLCBcImFsZ29yaXRobS5oYXNoXCIsIFwiSW5jb3JyZWN0IGhhc2ggYWxnb3JpdGhtOiBIYXNoIGFsZ29yaXRobSBpcyBtaXNzZWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGFsZy5oYXNoLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSU0EtT0FFUFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSU0EtT0FFUC0yNTZcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0zODRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUlNBLU9BRVAtMzg0XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTQS1PQUVQLTUxMlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBoYXNoIGFsZ29yaXRobTogJHthbGcuaGFzaC5uYW1lLnRvVXBwZXJDYXNlKCl9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHVibGljS2V5SlNPTiA9IHB1YmxpY0tleUluZm8udG9KU09OKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oandrLCBwdWJsaWNLZXlKU09OKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiUlNBRVMtUEtDUzEtVjFfNVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmt0eSA9IFwiUlNBXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5leHQgPSBleHRyYWN0YWJsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmtleV9vcHMgPSBrZXlVc2FnZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlBTMVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdWJsaWNLZXlKU09OID0gcHVibGljS2V5SW5mby50b0pTT04oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihqd2ssIHB1YmxpY0tleUpTT04pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgYWxnb3JpdGhtIG5hbWU6ICR7YWxnLm5hbWUudG9VcHBlckNhc2UoKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJwa2NzOFwiOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJpdmF0ZUtleUluZm8gPSBuZXcgUHJpdmF0ZUtleUluZm8oKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5mcm9tQkVSKHB2dHN1dGlscy5CdWZmZXJTb3VyY2VDb252ZXJ0ZXIudG9BcnJheUJ1ZmZlcihrZXlEYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgIEFzbkVycm9yLmFzc2VydChhc24xLCBcImtleURhdGFcIik7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcml2YXRlS2V5SW5mby5mcm9tU2NoZW1hKGFzbjEucmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdCBrZXlEYXRhXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcHJpdmF0ZUtleUluZm8ucGFyc2VkS2V5KVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0IGtleURhdGFcIik7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoYWxnLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlJTQS1QU1NcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoKF9hID0gYWxnLmhhc2gpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5uYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlBTMVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0yNTZcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJQUzI1NlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0zODRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJQUzM4NFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS01MTJcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJQUzUxMlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBoYXNoIGFsZ29yaXRobTogJHsoX2IgPSBhbGcuaGFzaCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLm5hbWUudG9VcHBlckNhc2UoKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJSU0FTU0EtUEtDUzEtVjFfNVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5VXNhZ2VzID0gW1wic2lnblwiXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmt0eSA9IFwiUlNBXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5leHQgPSBleHRyYWN0YWJsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmtleV9vcHMgPSBrZXlVc2FnZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcml2YXRlS2V5SW5mby5wcml2YXRlS2V5QWxnb3JpdGhtLmFsZ29yaXRobUlkICE9PSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBwcml2YXRlIGtleSBhbGdvcml0aG06ICR7cHJpdmF0ZUtleUluZm8ucHJpdmF0ZUtleUFsZ29yaXRobS5hbGdvcml0aG1JZH1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChcImFsZ1wiIGluIGp3aykgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKChfYyA9IGFsZy5oYXNoKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MubmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0xXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTMVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSUzI1NlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTM4NFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSUzM4NFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTUxMlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSUzUxMlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBoYXNoIGFsZ29yaXRobTogJHsoX2QgPSBhbGcuaGFzaCkgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLm5hbWUudG9VcHBlckNhc2UoKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcml2YXRlS2V5SlNPTiA9IHByaXZhdGVLZXlJbmZvLnRvSlNPTigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGp3aywgcHJpdmF0ZUtleUpTT04pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJFQ0RTQVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleVVzYWdlcyA9IFtcInNpZ25cIl07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiRUNESFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga3R5OiBcIkVDXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHQ6IGV4dHJhY3RhYmxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5X29wczoga2V5VXNhZ2VzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcml2YXRlS2V5SW5mby5wcml2YXRlS2V5QWxnb3JpdGhtLmFsZ29yaXRobUlkICE9PSBcIjEuMi44NDAuMTAwNDUuMi4xXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBhbGdvcml0aG06ICR7cHJpdmF0ZUtleUluZm8ucHJpdmF0ZUtleUFsZ29yaXRobS5hbGdvcml0aG1JZH1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJpdmF0ZUtleUpTT04gPSBwcml2YXRlS2V5SW5mby50b0pTT04oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihqd2ssIHByaXZhdGVLZXlKU09OKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiUlNBLU9BRVBcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5rdHkgPSBcIlJTQVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suZXh0ID0gZXh0cmFjdGFibGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5rZXlfb3BzID0ga2V5VXNhZ2VzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IFwic2FmYXJpXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSU0EtT0FFUFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoKF9lID0gYWxnLmhhc2gpID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZS5uYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUlNBLU9BRVBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0yNTZcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmFsZyA9IFwiUlNBLU9BRVAtMjU2XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMzg0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlJTQS1PQUVQLTM4NFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTUxMlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqd2suYWxnID0gXCJSU0EtT0FFUC01MTJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgaGFzaCBhbGdvcml0aG06ICR7KF9mID0gYWxnLmhhc2gpID09PSBudWxsIHx8IF9mID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZi5uYW1lLnRvVXBwZXJDYXNlKCl9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJpdmF0ZUtleUpTT04gPSBwcml2YXRlS2V5SW5mby50b0pTT04oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihqd2ssIHByaXZhdGVLZXlKU09OKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiUlNBRVMtUEtDUzEtVjFfNVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5VXNhZ2VzID0gW1wiZGVjcnlwdFwiXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmt0eSA9IFwiUlNBXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5leHQgPSBleHRyYWN0YWJsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgandrLmtleV9vcHMgPSBrZXlVc2FnZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp3ay5hbGcgPSBcIlBTMVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcml2YXRlS2V5SlNPTiA9IHByaXZhdGVLZXlJbmZvLnRvSlNPTigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGp3aywgcHJpdmF0ZUtleUpTT04pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgYWxnb3JpdGhtIG5hbWU6ICR7YWxnLm5hbWUudG9VcHBlckNhc2UoKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJqd2tcIjpcbiAgICAgICAgICAgICAgICBqd2sgPSBrZXlEYXRhO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBmb3JtYXQ6ICR7Zm9ybWF0fWApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJzYWZhcmlcIikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuaW1wb3J0S2V5KFwiandrXCIsIHB2dXRpbHMuc3RyaW5nVG9BcnJheUJ1ZmZlcihKU09OLnN0cmluZ2lmeShqd2spKSwgYWxnb3JpdGhtLCBleHRyYWN0YWJsZSwga2V5VXNhZ2VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuaW1wb3J0S2V5KFwiandrXCIsIGp3aywgYWxnb3JpdGhtLCBleHRyYWN0YWJsZSwga2V5VXNhZ2VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zdWJ0bGUuaW1wb3J0S2V5KFwiandrXCIsIGp3aywgYWxnb3JpdGhtLCBleHRyYWN0YWJsZSwga2V5VXNhZ2VzKTtcbiAgICB9XG4gICAgYXN5bmMgZXhwb3J0S2V5KGZvcm1hdCwga2V5KSB7XG4gICAgICAgIGxldCBqd2sgPSBhd2FpdCB0aGlzLnN1YnRsZS5leHBvcnRLZXkoXCJqd2tcIiwga2V5KTtcbiAgICAgICAgaWYgKHRoaXMubmFtZS50b0xvd2VyQ2FzZSgpID09PSBcInNhZmFyaVwiKSB7XG4gICAgICAgICAgICBpZiAoandrIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgICAgICBqd2sgPSBKU09OLnBhcnNlKHB2dXRpbHMuYXJyYXlCdWZmZXJUb1N0cmluZyhqd2spKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKGZvcm1hdC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIFwicmF3XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3VidGxlLmV4cG9ydEtleShcInJhd1wiLCBrZXkpO1xuICAgICAgICAgICAgY2FzZSBcInNwa2lcIjoge1xuICAgICAgICAgICAgICAgIGNvbnN0IHB1YmxpY0tleUluZm8gPSBuZXcgUHVibGljS2V5SW5mbygpO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHB1YmxpY0tleUluZm8uZnJvbUpTT04oandrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdCBrZXkgZGF0YVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHB1YmxpY0tleUluZm8udG9TY2hlbWEoKS50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwicGtjczhcIjoge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByaXZhdGVLZXlJbmZvID0gbmV3IFByaXZhdGVLZXlJbmZvKCk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcHJpdmF0ZUtleUluZm8uZnJvbUpTT04oandrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdCBrZXkgZGF0YVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByaXZhdGVLZXlJbmZvLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBcImp3a1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBqd2s7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGZvcm1hdDogJHtmb3JtYXR9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgY29udmVydChpbnB1dEZvcm1hdCwgb3V0cHV0Rm9ybWF0LCBrZXlEYXRhLCBhbGdvcml0aG0sIGV4dHJhY3RhYmxlLCBrZXlVc2FnZXMpIHtcbiAgICAgICAgaWYgKGlucHV0Rm9ybWF0LnRvTG93ZXJDYXNlKCkgPT09IG91dHB1dEZvcm1hdC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICByZXR1cm4ga2V5RGF0YTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBrZXkgPSBhd2FpdCB0aGlzLmltcG9ydEtleShpbnB1dEZvcm1hdCwga2V5RGF0YSwgYWxnb3JpdGhtLCBleHRyYWN0YWJsZSwga2V5VXNhZ2VzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXhwb3J0S2V5KG91dHB1dEZvcm1hdCwga2V5KTtcbiAgICB9XG4gICAgZ2V0QWxnb3JpdGhtQnlPSUQob2lkLCBzYWZldHkgPSBmYWxzZSwgdGFyZ2V0KSB7XG4gICAgICAgIHN3aXRjaCAob2lkKSB7XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjFcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQUVTLVBLQ1MxLXYxXzVcIlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjVcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQVNTQS1QS0NTMS12MV81XCIsXG4gICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTFcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4xLjEuMTFcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQVNTQS1QS0NTMS12MV81XCIsXG4gICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTI1NlwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xMlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUlNBU1NBLVBLQ1MxLXYxXzVcIixcbiAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMzg0XCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjEzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0FTU0EtUEtDUzEtdjFfNVwiLFxuICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS01MTJcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4xLjEuMTBcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQS1QU1NcIlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQS1PQUVQXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTAwNDUuMi4xXCI6XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS40LjFcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkVDRFNBXCIsXG4gICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTFcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjEwMDQ1LjQuMy4yXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RTQVwiLFxuICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0yNTZcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjEwMDQ1LjQuMy4zXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RTQVwiLFxuICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0zODRcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjEwMDQ1LjQuMy40XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RTQVwiLFxuICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS01MTJcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjMuMTMzLjE2Ljg0MC42My4wLjJcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkVDREhcIixcbiAgICAgICAgICAgICAgICAgICAga2RmOiBcIlNIQS0xXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMy4xMzIuMS4xMS4xXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RIXCIsXG4gICAgICAgICAgICAgICAgICAgIGtkZjogXCJTSEEtMjU2XCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMy4xMzIuMS4xMS4yXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RIXCIsXG4gICAgICAgICAgICAgICAgICAgIGtkZjogXCJTSEEtMzg0XCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMy4xMzIuMS4xMS4zXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RIXCIsXG4gICAgICAgICAgICAgICAgICAgIGtkZjogXCJTSEEtNTEyXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjJcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1DQkNcIixcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAxMjhcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjIyXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtQ0JDXCIsXG4gICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMTkyXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS40MlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUNCQ1wiLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDI1NlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMi4xNi44NDAuMS4xMDEuMy40LjEuNlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUdDTVwiLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDEyOFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMi4xNi44NDAuMS4xMDEuMy40LjEuMjZcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1HQ01cIixcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAxOTJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjQ2XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtR0NNXCIsXG4gICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMjU2XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS40XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtQ0ZCXCIsXG4gICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMTI4XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS4yNFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUNGQlwiLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDE5MlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMi4xNi44NDAuMS4xMDEuMy40LjEuNDRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1DRkJcIixcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAyNTZcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjVcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1LV1wiLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDEyOFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMi4xNi44NDAuMS4xMDEuMy40LjEuMjVcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1LV1wiLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDE5MlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMi4xNi44NDAuMS4xMDEuMy40LjEuNDVcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1LV1wiLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDI1NlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMi43XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJITUFDXCIsXG4gICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTFcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4yLjlcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkhNQUNcIixcbiAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMjU2XCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMi4xMFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiLFxuICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0zODRcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4yLjExXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJITUFDXCIsXG4gICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTUxMlwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuOS4xNi4zLjVcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkRIXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMy4xNC4zLjIuMjZcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0xXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjIuMTYuODQwLjEuMTAxLjMuNC4yLjFcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0yNTZcIlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMi4xNi44NDAuMS4xMDEuMy40LjIuMlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTM4NFwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhc2UgXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMi4zXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtNTEyXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuNS4xMlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUEJLREYyXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTAwNDUuMy4xLjdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlAtMjU2XCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBcIjEuMy4xMzIuMC4zNFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUC0zODRcIlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFwiMS4zLjEzMi4wLjM1XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJQLTUyMVwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2FmZXR5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIGFsZ29yaXRobSBpZGVudGlmaWVyICR7dGFyZ2V0ID8gYGZvciAke3RhcmdldH0gYCA6IEVNUFRZX1NUUklOR306ICR7b2lkfWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gICAgZ2V0T0lEQnlBbGdvcml0aG0oYWxnb3JpdGhtLCBzYWZldHkgPSBmYWxzZSwgdGFyZ2V0KSB7XG4gICAgICAgIGxldCByZXN1bHQgPSBFTVBUWV9TVFJJTkc7XG4gICAgICAgIHN3aXRjaCAoYWxnb3JpdGhtLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSBcIlJTQUVTLVBLQ1MxLVYxXzVcIjpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiUlNBU1NBLVBLQ1MxLVYxXzVcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGFsZ29yaXRobS5oYXNoLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjVcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjExMzU0OS4xLjEuMTFcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTM4NFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjExMzU0OS4xLjEuMTJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTUxMlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjExMzU0OS4xLjEuMTNcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJSU0EtUFNTXCI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjExMzU0OS4xLjEuMTBcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJSU0EtT0FFUFwiOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjdcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJFQ0RTQVwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAoYWxnb3JpdGhtLmhhc2gubmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjEwMDQ1LjQuMVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMjU2XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMi44NDAuMTAwNDUuNC4zLjJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTM4NFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjEwMDQ1LjQuMy4zXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS01MTJcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMDA0NS40LjMuNFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkVDREhcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGFsZ29yaXRobS5rZGYudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4zLjEzMy4xNi44NDAuNjMuMC4yXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS0yNTZcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4zLjEzMi4xLjExLjFcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTM4NFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjMuMTMyLjEuMTEuMlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMy4xMzIuMS4xMS4zXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiQUVTLUNUUlwiOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkFFUy1DQkNcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGFsZ29yaXRobS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjg6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE5MjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMi4xNi44NDAuMS4xMDEuMy40LjEuMjJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI1NjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMi4xNi44NDAuMS4xMDEuMy40LjEuNDJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJBRVMtQ01BQ1wiOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkFFUy1HQ01cIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGFsZ29yaXRobS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjg6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjZcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE5MjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMi4xNi44NDAuMS4xMDEuMy40LjEuMjZcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI1NjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMi4xNi44NDAuMS4xMDEuMy40LjEuNDZcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJBRVMtQ0ZCXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChhbGdvcml0aG0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTI4OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS40XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOTI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjI0XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyNTY6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjQ0XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiQUVTLUtXXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChhbGdvcml0aG0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTI4OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMS41XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOTI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjI1XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyNTY6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4xLjQ1XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiSE1BQ1wiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAoYWxnb3JpdGhtLmhhc2gubmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjExMzU0OS4yLjdcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTI1NlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjExMzU0OS4yLjlcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU0hBLTM4NFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjExMzU0OS4yLjEwXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlNIQS01MTJcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMTM1NDkuMi4xMVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkRIXCI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjExMzU0OS4xLjkuMTYuMy41XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiU0hBLTFcIjpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjEuMy4xNC4zLjIuMjZcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJTSEEtMjU2XCI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIyLjE2Ljg0MC4xLjEwMS4zLjQuMi4xXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiU0hBLTM4NFwiOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMi4xNi44NDAuMS4xMDEuMy40LjIuMlwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIlNIQS01MTJcIjpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjIuMTYuODQwLjEuMTAxLjMuNC4yLjNcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJDT05DQVRcIjpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJIS0RGXCI6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiUEJLREYyXCI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjIuODQwLjExMzU0OS4xLjUuMTJcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJQLTI1NlwiOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4yLjg0MC4xMDA0NS4zLjEuN1wiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIlAtMzg0XCI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCIxLjMuMTMyLjAuMzRcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJQLTUyMVwiOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiMS4zLjEzMi4wLjM1XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyZXN1bHQgJiYgc2FmZXR5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIGFsZ29yaXRobSAke3RhcmdldCA/IGBmb3IgJHt0YXJnZXR9IGAgOiBFTVBUWV9TVFJJTkd9OiAke2FsZ29yaXRobS5uYW1lfWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGdldEFsZ29yaXRobVBhcmFtZXRlcnMoYWxnb3JpdGhtTmFtZSwgb3BlcmF0aW9uKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSB7XG4gICAgICAgICAgICBhbGdvcml0aG06IHt9LFxuICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICB9O1xuICAgICAgICBzd2l0Y2ggKGFsZ29yaXRobU5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSBcIlJTQUVTLVBLQ1MxLVYxXzVcIjpcbiAgICAgICAgICAgIGNhc2UgXCJSU0FTU0EtUEtDUzEtVjFfNVwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImdlbmVyYXRla2V5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUlNBU1NBLVBLQ1MxLXYxXzVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWx1c0xlbmd0aDogMjA0OCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljRXhwb25lbnQ6IG5ldyBVaW50OEFycmF5KFsweDAxLCAweDAwLCAweDAxXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTI1NlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wic2lnblwiLCBcInZlcmlmeVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwidmVyaWZ5XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzaWduXCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpbXBvcnRrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0FTU0EtUEtDUzEtdjFfNVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0yNTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcInZlcmlmeVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZXhwb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQVNTQS1QS0NTMS12MV81XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW11cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIlJTQS1QU1NcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzaWduXCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ2ZXJpZnlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0EtUFNTXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWx0TGVuZ3RoOiAyMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJzaWduXCIsIFwidmVyaWZ5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJnZW5lcmF0ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQS1QU1NcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWx1c0xlbmd0aDogMjA0OCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljRXhwb25lbnQ6IG5ldyBVaW50OEFycmF5KFsweDAxLCAweDAwLCAweDAxXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiU0hBLTFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcInNpZ25cIiwgXCJ2ZXJpZnlcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImltcG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQS1QU1NcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1widmVyaWZ5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJleHBvcnRrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUlNBLVBTU1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJSU0EtT0FFUFwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImVuY3J5cHRcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImRlY3J5cHRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0EtT0FFUFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcImVuY3J5cHRcIiwgXCJkZWNyeXB0XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJnZW5lcmF0ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlJTQS1PQUVQXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsdXNMZW5ndGg6IDIwNDgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1YmxpY0V4cG9uZW50OiBuZXcgVWludDhBcnJheShbMHgwMSwgMHgwMCwgMHgwMV0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0yNTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcImVuY3J5cHRcIiwgXCJkZWNyeXB0XCIsIFwid3JhcEtleVwiLCBcInVud3JhcEtleVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaW1wb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUlNBLU9BRVBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJTSEEtMjU2XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJlbmNyeXB0XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJleHBvcnRrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUlNBLU9BRVBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiRUNEU0FcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJnZW5lcmF0ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkVDRFNBXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVkQ3VydmU6IFwiUC0yNTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJzaWduXCIsIFwidmVyaWZ5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpbXBvcnRrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RTQVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lZEN1cnZlOiBcIlAtMjU2XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1widmVyaWZ5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ2ZXJpZnlcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNpZ25cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RTQVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0yNTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcInNpZ25cIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNEU0FcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiRUNESFwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImV4cG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaW1wb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJnZW5lcmF0ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkVDREhcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZWRDdXJ2ZTogXCJQLTI1NlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcImRlcml2ZUtleVwiLCBcImRlcml2ZUJpdHNcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImRlcml2ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGVyaXZlYml0c1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkVDREhcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZWRDdXJ2ZTogXCJQLTI1NlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWM6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcImVuY3J5cHRcIiwgXCJkZWNyeXB0XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkVDREhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiQUVTLUNUUlwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImltcG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZXhwb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJnZW5lcmF0ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1DVFJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAyNTZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wiZW5jcnlwdFwiLCBcImRlY3J5cHRcIiwgXCJ3cmFwS2V5XCIsIFwidW53cmFwS2V5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkZWNyeXB0XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJlbmNyeXB0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUNUUlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyOiBuZXcgVWludDhBcnJheSgxNiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMTBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wiZW5jcnlwdFwiLCBcImRlY3J5cHRcIiwgXCJ3cmFwS2V5XCIsIFwidW53cmFwS2V5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1DVFJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiQUVTLUNCQ1wiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImltcG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZXhwb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJnZW5lcmF0ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkFFUy1DQkNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAyNTZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wiZW5jcnlwdFwiLCBcImRlY3J5cHRcIiwgXCJ3cmFwS2V5XCIsIFwidW53cmFwS2V5XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkZWNyeXB0XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJlbmNyeXB0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUNCQ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdjogdGhpcy5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMTYpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJlbmNyeXB0XCIsIFwiZGVjcnlwdFwiLCBcIndyYXBLZXlcIiwgXCJ1bndyYXBLZXlcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUNCQ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJBRVMtR0NNXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChvcGVyYXRpb24udG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaW1wb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJleHBvcnRrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImdlbmVyYXRla2V5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUdDTVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDI1NlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXCJlbmNyeXB0XCIsIFwiZGVjcnlwdFwiLCBcIndyYXBLZXlcIiwgXCJ1bndyYXBLZXlcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImRlY3J5cHRcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImVuY3J5cHRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtR0NNXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl2OiB0aGlzLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheSgxNikpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcImVuY3J5cHRcIiwgXCJkZWNyeXB0XCIsIFwid3JhcEtleVwiLCBcInVud3JhcEtleVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtR0NNXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW11cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkFFUy1LV1wiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAob3BlcmF0aW9uLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImltcG9ydGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZXhwb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJnZW5lcmF0ZWtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwid3JhcGtleVwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwidW53cmFwa2V5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUtXXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aDogMjU2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcIndyYXBLZXlcIiwgXCJ1bndyYXBLZXlcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiQUVTLUtXXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW11cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIkhNQUNcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzaWduXCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ2ZXJpZnlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJITUFDXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wic2lnblwiLCBcInZlcmlmeVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaW1wb3J0a2V5XCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJleHBvcnRrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImdlbmVyYXRla2V5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDMyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlNIQS0yNTZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcInNpZ25cIiwgXCJ2ZXJpZnlcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJIS0RGXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoIChvcGVyYXRpb24udG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGVyaXZla2V5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiSEtERlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoOiBcIlNIQS0yNTZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsdDogbmV3IFVpbnQ4QXJyYXkoW10pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvOiBuZXcgVWludDhBcnJheShbXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wiZW5jcnlwdFwiLCBcImRlY3J5cHRcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiSEtERlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJQQktERjJcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbi50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkZXJpdmVrZXlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJQQktERjJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDogeyBuYW1lOiBcIlNIQS0yNTZcIiB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWx0OiBuZXcgVWludDhBcnJheShbXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnM6IDEwMDAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtcImVuY3J5cHRcIiwgXCJkZWNyeXB0XCJdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlBCS0RGMlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZXM6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBnZXRIYXNoQWxnb3JpdGhtKHNpZ25hdHVyZUFsZ29yaXRobSkge1xuICAgICAgICBsZXQgcmVzdWx0ID0gRU1QVFlfU1RSSU5HO1xuICAgICAgICBzd2l0Y2ggKHNpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1JZCkge1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTAwNDUuNC4xXCI6XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjVcIjpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcIlNIQS0xXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS40LjMuMlwiOlxuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xMVwiOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFwiU0hBLTI1NlwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIjEuMi44NDAuMTAwNDUuNC4zLjNcIjpcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjExMzU0OS4xLjEuMTJcIjpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcIlNIQS0zODRcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCIxLjIuODQwLjEwMDQ1LjQuMy40XCI6XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjEzXCI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gXCJTSEEtNTEyXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMTM1NDkuMS4xLjEwXCI6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFJTQVNTQVBTU1BhcmFtcyh7IHNjaGVtYTogc2lnbmF0dXJlQWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMuaGFzaEFsZ29yaXRobSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFsZ29yaXRobSA9IHRoaXMuZ2V0QWxnb3JpdGhtQnlPSUQocGFyYW1zLmhhc2hBbGdvcml0aG0uYWxnb3JpdGhtSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcIm5hbWVcIiBpbiBhbGdvcml0aG0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYWxnb3JpdGhtLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBcIlNIQS0xXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGFzeW5jIGVuY3J5cHRFbmNyeXB0ZWRDb250ZW50SW5mbyhwYXJhbWV0ZXJzKSB7XG4gICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChwYXJhbWV0ZXJzLCBcInBhc3N3b3JkXCIsIFwiY29udGVudEVuY3J5cHRpb25BbGdvcml0aG1cIiwgXCJobWFjSGFzaEFsZ29yaXRobVwiLCBcIml0ZXJhdGlvbkNvdW50XCIsIFwiY29udGVudFRvRW5jcnlwdFwiLCBcImNvbnRlbnRUb0VuY3J5cHRcIiwgXCJjb250ZW50VHlwZVwiKTtcbiAgICAgICAgY29uc3QgY29udGVudEVuY3J5cHRpb25PSUQgPSB0aGlzLmdldE9JREJ5QWxnb3JpdGhtKHBhcmFtZXRlcnMuY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0sIHRydWUsIFwiY29udGVudEVuY3J5cHRpb25BbGdvcml0aG1cIik7XG4gICAgICAgIGNvbnN0IHBia2RmMk9JRCA9IHRoaXMuZ2V0T0lEQnlBbGdvcml0aG0oe1xuICAgICAgICAgICAgbmFtZTogXCJQQktERjJcIlxuICAgICAgICB9LCB0cnVlLCBcIlBCS0RGMlwiKTtcbiAgICAgICAgY29uc3QgaG1hY09JRCA9IHRoaXMuZ2V0T0lEQnlBbGdvcml0aG0oe1xuICAgICAgICAgICAgbmFtZTogXCJITUFDXCIsXG4gICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogcGFyYW1ldGVycy5obWFjSGFzaEFsZ29yaXRobVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCB0cnVlLCBcImhtYWNIYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICBjb25zdCBpdkJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcigxNik7XG4gICAgICAgIGNvbnN0IGl2VmlldyA9IG5ldyBVaW50OEFycmF5KGl2QnVmZmVyKTtcbiAgICAgICAgdGhpcy5nZXRSYW5kb21WYWx1ZXMoaXZWaWV3KTtcbiAgICAgICAgY29uc3Qgc2FsdEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcig2NCk7XG4gICAgICAgIGNvbnN0IHNhbHRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoc2FsdEJ1ZmZlcik7XG4gICAgICAgIHRoaXMuZ2V0UmFuZG9tVmFsdWVzKHNhbHRWaWV3KTtcbiAgICAgICAgY29uc3QgY29udGVudFZpZXcgPSBuZXcgVWludDhBcnJheShwYXJhbWV0ZXJzLmNvbnRlbnRUb0VuY3J5cHQpO1xuICAgICAgICBjb25zdCBwYmtkZjJQYXJhbXMgPSBuZXcgUEJLREYyUGFyYW1zKHtcbiAgICAgICAgICAgIHNhbHQ6IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogc2FsdEJ1ZmZlciB9KSxcbiAgICAgICAgICAgIGl0ZXJhdGlvbkNvdW50OiBwYXJhbWV0ZXJzLml0ZXJhdGlvbkNvdW50LFxuICAgICAgICAgICAgcHJmOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IGhtYWNPSUQsXG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk51bGwoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHBhc3N3b3JkVmlldyA9IG5ldyBVaW50OEFycmF5KHBhcmFtZXRlcnMucGFzc3dvcmQpO1xuICAgICAgICBjb25zdCBwYmtkZktleSA9IGF3YWl0IHRoaXMuaW1wb3J0S2V5KFwicmF3XCIsIHBhc3N3b3JkVmlldywgXCJQQktERjJcIiwgZmFsc2UsIFtcImRlcml2ZUtleVwiXSk7XG4gICAgICAgIGNvbnN0IGRlcml2ZWRLZXkgPSBhd2FpdCB0aGlzLmRlcml2ZUtleSh7XG4gICAgICAgICAgICBuYW1lOiBcIlBCS0RGMlwiLFxuICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgIG5hbWU6IHBhcmFtZXRlcnMuaG1hY0hhc2hBbGdvcml0aG1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzYWx0OiBzYWx0VmlldyxcbiAgICAgICAgICAgIGl0ZXJhdGlvbnM6IHBhcmFtZXRlcnMuaXRlcmF0aW9uQ291bnRcbiAgICAgICAgfSwgcGJrZGZLZXksIHBhcmFtZXRlcnMuY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0sIGZhbHNlLCBbXCJlbmNyeXB0XCJdKTtcbiAgICAgICAgY29uc3QgZW5jcnlwdGVkRGF0YSA9IGF3YWl0IHRoaXMuZW5jcnlwdCh7XG4gICAgICAgICAgICBuYW1lOiBwYXJhbWV0ZXJzLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLm5hbWUsXG4gICAgICAgICAgICBpdjogaXZWaWV3XG4gICAgICAgIH0sIGRlcml2ZWRLZXksIGNvbnRlbnRWaWV3KTtcbiAgICAgICAgY29uc3QgcGJlczJQYXJhbWV0ZXJzID0gbmV3IFBCRVMyUGFyYW1zKHtcbiAgICAgICAgICAgIGtleURlcml2YXRpb25GdW5jOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IHBia2RmMk9JRCxcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbXM6IHBia2RmMlBhcmFtcy50b1NjaGVtYSgpXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGVuY3J5cHRpb25TY2hlbWU6IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogY29udGVudEVuY3J5cHRpb25PSUQsXG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IGl2QnVmZmVyIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5ldyBFbmNyeXB0ZWRDb250ZW50SW5mbyh7XG4gICAgICAgICAgICBjb250ZW50VHlwZTogcGFyYW1ldGVycy5jb250ZW50VHlwZSxcbiAgICAgICAgICAgIGNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IFwiMS4yLjg0MC4xMTM1NDkuMS41LjEzXCIsXG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBwYmVzMlBhcmFtZXRlcnMudG9TY2hlbWEoKVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBlbmNyeXB0ZWRDb250ZW50OiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IGVuY3J5cHRlZERhdGEgfSlcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFzeW5jIGRlY3J5cHRFbmNyeXB0ZWRDb250ZW50SW5mbyhwYXJhbWV0ZXJzKSB7XG4gICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChwYXJhbWV0ZXJzLCBcInBhc3N3b3JkXCIsIFwiZW5jcnlwdGVkQ29udGVudEluZm9cIik7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLmVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobUlkICE9PSBcIjEuMi44NDAuMTEzNTQ5LjEuNS4xM1wiKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIFwiY29udGVudEVuY3J5cHRpb25BbGdvcml0aG1cIjogJHtwYXJhbWV0ZXJzLmVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobUlkfWApO1xuICAgICAgICBsZXQgcGJlczJQYXJhbWV0ZXJzO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcGJlczJQYXJhbWV0ZXJzID0gbmV3IFBCRVMyUGFyYW1zKHsgc2NoZW1hOiBwYXJhbWV0ZXJzLmVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcyB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdGx5IGVuY29kZWQgXFxcInBiZXMyUGFyYW1ldGVyc1xcXCJcIik7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHBia2RmMlBhcmFtcztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHBia2RmMlBhcmFtcyA9IG5ldyBQQktERjJQYXJhbXMoeyBzY2hlbWE6IHBiZXMyUGFyYW1ldGVycy5rZXlEZXJpdmF0aW9uRnVuYy5hbGdvcml0aG1QYXJhbXMgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3RseSBlbmNvZGVkIFxcXCJwYmtkZjJQYXJhbXNcXFwiXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtID0gdGhpcy5nZXRBbGdvcml0aG1CeU9JRChwYmVzMlBhcmFtZXRlcnMuZW5jcnlwdGlvblNjaGVtZS5hbGdvcml0aG1JZCwgdHJ1ZSk7XG4gICAgICAgIGNvbnN0IGl2QnVmZmVyID0gcGJlczJQYXJhbWV0ZXJzLmVuY3J5cHRpb25TY2hlbWUuYWxnb3JpdGhtUGFyYW1zLnZhbHVlQmxvY2sudmFsdWVIZXg7XG4gICAgICAgIGNvbnN0IGl2VmlldyA9IG5ldyBVaW50OEFycmF5KGl2QnVmZmVyKTtcbiAgICAgICAgY29uc3Qgc2FsdEJ1ZmZlciA9IHBia2RmMlBhcmFtcy5zYWx0LnZhbHVlQmxvY2sudmFsdWVIZXg7XG4gICAgICAgIGNvbnN0IHNhbHRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoc2FsdEJ1ZmZlcik7XG4gICAgICAgIGNvbnN0IGl0ZXJhdGlvbkNvdW50ID0gcGJrZGYyUGFyYW1zLml0ZXJhdGlvbkNvdW50O1xuICAgICAgICBsZXQgaG1hY0hhc2hBbGdvcml0aG0gPSBcIlNIQS0xXCI7XG4gICAgICAgIGlmIChwYmtkZjJQYXJhbXMucHJmKSB7XG4gICAgICAgICAgICBjb25zdCBhbGdvcml0aG0gPSB0aGlzLmdldEFsZ29yaXRobUJ5T0lEKHBia2RmMlBhcmFtcy5wcmYuYWxnb3JpdGhtSWQsIHRydWUpO1xuICAgICAgICAgICAgaG1hY0hhc2hBbGdvcml0aG0gPSBhbGdvcml0aG0uaGFzaC5uYW1lO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBia2RmS2V5ID0gYXdhaXQgdGhpcy5pbXBvcnRLZXkoXCJyYXdcIiwgcGFyYW1ldGVycy5wYXNzd29yZCwgXCJQQktERjJcIiwgZmFsc2UsIFtcImRlcml2ZUtleVwiXSk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZGVyaXZlS2V5KHtcbiAgICAgICAgICAgIG5hbWU6IFwiUEJLREYyXCIsXG4gICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogaG1hY0hhc2hBbGdvcml0aG1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzYWx0OiBzYWx0VmlldyxcbiAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGl0ZXJhdGlvbkNvdW50XG4gICAgICAgIH0sIHBia2RmS2V5LCBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSwgZmFsc2UsIFtcImRlY3J5cHRcIl0pO1xuICAgICAgICBjb25zdCBkYXRhQnVmZmVyID0gcGFyYW1ldGVycy5lbmNyeXB0ZWRDb250ZW50SW5mby5nZXRFbmNyeXB0ZWRDb250ZW50KCk7XG4gICAgICAgIHJldHVybiB0aGlzLmRlY3J5cHQoe1xuICAgICAgICAgICAgbmFtZTogY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0ubmFtZSxcbiAgICAgICAgICAgIGl2OiBpdlZpZXdcbiAgICAgICAgfSwgcmVzdWx0LCBkYXRhQnVmZmVyKTtcbiAgICB9XG4gICAgYXN5bmMgc3RhbXBEYXRhV2l0aFBhc3N3b3JkKHBhcmFtZXRlcnMpIHtcbiAgICAgICAgaWYgKChwYXJhbWV0ZXJzIGluc3RhbmNlb2YgT2JqZWN0KSA9PT0gZmFsc2UpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJhbWV0ZXJzIG11c3QgaGF2ZSB0eXBlIFxcXCJPYmplY3RcXFwiXCIpO1xuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQocGFyYW1ldGVycywgXCJwYXNzd29yZFwiLCBcImhhc2hBbGdvcml0aG1cIiwgXCJpdGVyYXRpb25Db3VudFwiLCBcInNhbHRcIiwgXCJjb250ZW50VG9TdGFtcFwiKTtcbiAgICAgICAgbGV0IGxlbmd0aDtcbiAgICAgICAgc3dpdGNoIChwYXJhbWV0ZXJzLmhhc2hBbGdvcml0aG0udG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSBcInNoYS0xXCI6XG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gMTYwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInNoYS0yNTZcIjpcbiAgICAgICAgICAgICAgICBsZW5ndGggPSAyNTY7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic2hhLTM4NFwiOlxuICAgICAgICAgICAgICAgIGxlbmd0aCA9IDM4NDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzaGEtNTEyXCI6XG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gNTEyO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBcInBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobVwiIHBhcmFtZXRlcjogJHtwYXJhbWV0ZXJzLmhhc2hBbGdvcml0aG19YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaG1hY0FsZ29yaXRobSA9IHtcbiAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiLFxuICAgICAgICAgICAgbGVuZ3RoLFxuICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgIG5hbWU6IHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBwa2NzS2V5ID0gYXdhaXQgbWFrZVBLQ1MxMkIyS2V5KHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobSwgbGVuZ3RoLCBwYXJhbWV0ZXJzLnBhc3N3b3JkLCBwYXJhbWV0ZXJzLnNhbHQsIHBhcmFtZXRlcnMuaXRlcmF0aW9uQ291bnQpO1xuICAgICAgICBjb25zdCBobWFjS2V5ID0gYXdhaXQgdGhpcy5pbXBvcnRLZXkoXCJyYXdcIiwgbmV3IFVpbnQ4QXJyYXkocGtjc0tleSksIGhtYWNBbGdvcml0aG0sIGZhbHNlLCBbXCJzaWduXCJdKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2lnbihobWFjQWxnb3JpdGhtLCBobWFjS2V5LCBuZXcgVWludDhBcnJheShwYXJhbWV0ZXJzLmNvbnRlbnRUb1N0YW1wKSk7XG4gICAgfVxuICAgIGFzeW5jIHZlcmlmeURhdGFTdGFtcGVkV2l0aFBhc3N3b3JkKHBhcmFtZXRlcnMpIHtcbiAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0KHBhcmFtZXRlcnMsIFwicGFzc3dvcmRcIiwgXCJoYXNoQWxnb3JpdGhtXCIsIFwic2FsdFwiLCBcIml0ZXJhdGlvbkNvdW50XCIsIFwiY29udGVudFRvVmVyaWZ5XCIsIFwic2lnbmF0dXJlVG9WZXJpZnlcIik7XG4gICAgICAgIGxldCBsZW5ndGggPSAwO1xuICAgICAgICBzd2l0Y2ggKHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIFwic2hhLTFcIjpcbiAgICAgICAgICAgICAgICBsZW5ndGggPSAxNjA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic2hhLTI1NlwiOlxuICAgICAgICAgICAgICAgIGxlbmd0aCA9IDI1NjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzaGEtMzg0XCI6XG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gMzg0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInNoYS01MTJcIjpcbiAgICAgICAgICAgICAgICBsZW5ndGggPSA1MTI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IFwicGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtXCIgcGFyYW1ldGVyOiAke3BhcmFtZXRlcnMuaGFzaEFsZ29yaXRobX1gKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBobWFjQWxnb3JpdGhtID0ge1xuICAgICAgICAgICAgbmFtZTogXCJITUFDXCIsXG4gICAgICAgICAgICBsZW5ndGgsXG4gICAgICAgICAgICBoYXNoOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogcGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHBrY3NLZXkgPSBhd2FpdCBtYWtlUEtDUzEyQjJLZXkocGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtLCBsZW5ndGgsIHBhcmFtZXRlcnMucGFzc3dvcmQsIHBhcmFtZXRlcnMuc2FsdCwgcGFyYW1ldGVycy5pdGVyYXRpb25Db3VudCk7XG4gICAgICAgIGNvbnN0IGhtYWNLZXkgPSBhd2FpdCB0aGlzLmltcG9ydEtleShcInJhd1wiLCBuZXcgVWludDhBcnJheShwa2NzS2V5KSwgaG1hY0FsZ29yaXRobSwgZmFsc2UsIFtcInZlcmlmeVwiXSk7XG4gICAgICAgIHJldHVybiB0aGlzLnZlcmlmeShobWFjQWxnb3JpdGhtLCBobWFjS2V5LCBuZXcgVWludDhBcnJheShwYXJhbWV0ZXJzLnNpZ25hdHVyZVRvVmVyaWZ5KSwgbmV3IFVpbnQ4QXJyYXkocGFyYW1ldGVycy5jb250ZW50VG9WZXJpZnkpKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0U2lnbmF0dXJlUGFyYW1ldGVycyhwcml2YXRlS2V5LCBoYXNoQWxnb3JpdGhtID0gXCJTSEEtMVwiKSB7XG4gICAgICAgIHRoaXMuZ2V0T0lEQnlBbGdvcml0aG0oeyBuYW1lOiBoYXNoQWxnb3JpdGhtIH0sIHRydWUsIFwiaGFzaEFsZ29yaXRobVwiKTtcbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHRoaXMuZ2V0QWxnb3JpdGhtUGFyYW1ldGVycyhwcml2YXRlS2V5LmFsZ29yaXRobS5uYW1lLCBcInNpZ25cIik7XG4gICAgICAgIGlmICghT2JqZWN0LmtleXMocGFyYW1ldGVycy5hbGdvcml0aG0pLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyYW1ldGVyICdhbGdvcml0aG0nIGlzIGVtcHR5XCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFsZ29yaXRobSA9IHBhcmFtZXRlcnMuYWxnb3JpdGhtO1xuICAgICAgICBpZiAoXCJoYXNoXCIgaW4gcHJpdmF0ZUtleS5hbGdvcml0aG0gJiYgcHJpdmF0ZUtleS5hbGdvcml0aG0uaGFzaCAmJiBwcml2YXRlS2V5LmFsZ29yaXRobS5oYXNoLm5hbWUpIHtcbiAgICAgICAgICAgIGFsZ29yaXRobS5oYXNoLm5hbWUgPSBwcml2YXRlS2V5LmFsZ29yaXRobS5oYXNoLm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhbGdvcml0aG0uaGFzaC5uYW1lID0gaGFzaEFsZ29yaXRobTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHByaXZhdGVLZXkuYWxnb3JpdGhtLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSBcIlJTQVNTQS1QS0NTMS1WMV81XCI6XG4gICAgICAgICAgICBjYXNlIFwiRUNEU0FcIjpcbiAgICAgICAgICAgICAgICBzaWduYXR1cmVBbGdvcml0aG0uYWxnb3JpdGhtSWQgPSB0aGlzLmdldE9JREJ5QWxnb3JpdGhtKGFsZ29yaXRobSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiUlNBLVBTU1wiOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChhbGdvcml0aG0uaGFzaC5uYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMjU2XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtLnNhbHRMZW5ndGggPSAzMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtMzg0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtLnNhbHRMZW5ndGggPSA0ODtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtLnNhbHRMZW5ndGggPSA2NDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJhbXNPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFsZ29yaXRobS5oYXNoLm5hbWUudG9VcHBlckNhc2UoKSAhPT0gXCJTSEEtMVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoYXNoQWxnb3JpdGhtT0lEID0gdGhpcy5nZXRPSURCeUFsZ29yaXRobSh7IG5hbWU6IGFsZ29yaXRobS5oYXNoLm5hbWUgfSwgdHJ1ZSwgXCJoYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zT2JqZWN0Lmhhc2hBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IGhhc2hBbGdvcml0aG1PSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk51bGwoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXNPYmplY3QubWFza0dlbkFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogXCIxLjIuODQwLjExMzU0OS4xLjEuOFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogcGFyYW1zT2JqZWN0Lmhhc2hBbGdvcml0aG0udG9TY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFsZ29yaXRobS5zYWx0TGVuZ3RoICE9PSAyMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtc09iamVjdC5zYWx0TGVuZ3RoID0gYWxnb3JpdGhtLnNhbHRMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBzc1BhcmFtZXRlcnMgPSBuZXcgUlNBU1NBUFNTUGFyYW1zKHBhcmFtc09iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1JZCA9IFwiMS4yLjg0MC4xMTM1NDkuMS4xLjEwXCI7XG4gICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMgPSBwc3NQYXJhbWV0ZXJzLnRvU2NoZW1hKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIHNpZ25hdHVyZSBhbGdvcml0aG06ICR7cHJpdmF0ZUtleS5hbGdvcml0aG0ubmFtZX1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtLFxuICAgICAgICAgICAgcGFyYW1ldGVyc1xuICAgICAgICB9O1xuICAgIH1cbiAgICBhc3luYyBzaWduV2l0aFByaXZhdGVLZXkoZGF0YSwgcHJpdmF0ZUtleSwgcGFyYW1ldGVycykge1xuICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCB0aGlzLnNpZ24ocGFyYW1ldGVycy5hbGdvcml0aG0sIHByaXZhdGVLZXksIGRhdGEpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5hbGdvcml0aG0ubmFtZSA9PT0gXCJFQ0RTQVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlQ01TRUNEU0FTaWduYXR1cmUoc2lnbmF0dXJlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2lnbmF0dXJlO1xuICAgIH1cbiAgICBmaWxsUHVibGljS2V5UGFyYW1ldGVycyhwdWJsaWNLZXlJbmZvLCBzaWduYXR1cmVBbGdvcml0aG0pIHtcbiAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHt9O1xuICAgICAgICBjb25zdCBzaGFBbGdvcml0aG0gPSB0aGlzLmdldEhhc2hBbGdvcml0aG0oc2lnbmF0dXJlQWxnb3JpdGhtKTtcbiAgICAgICAgaWYgKHNoYUFsZ29yaXRobSA9PT0gRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBzaWduYXR1cmUgYWxnb3JpdGhtOiAke3NpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1JZH1gKTtcbiAgICAgICAgbGV0IGFsZ29yaXRobUlkO1xuICAgICAgICBpZiAoc2lnbmF0dXJlQWxnb3JpdGhtLmFsZ29yaXRobUlkID09PSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xMFwiKVxuICAgICAgICAgICAgYWxnb3JpdGhtSWQgPSBzaWduYXR1cmVBbGdvcml0aG0uYWxnb3JpdGhtSWQ7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGFsZ29yaXRobUlkID0gcHVibGljS2V5SW5mby5hbGdvcml0aG0uYWxnb3JpdGhtSWQ7XG4gICAgICAgIGNvbnN0IGFsZ29yaXRobU9iamVjdCA9IHRoaXMuZ2V0QWxnb3JpdGhtQnlPSUQoYWxnb3JpdGhtSWQsIHRydWUpO1xuICAgICAgICBwYXJhbWV0ZXJzLmFsZ29yaXRobSA9IHRoaXMuZ2V0QWxnb3JpdGhtUGFyYW1ldGVycyhhbGdvcml0aG1PYmplY3QubmFtZSwgXCJpbXBvcnRLZXlcIik7XG4gICAgICAgIGlmIChcImhhc2hcIiBpbiBwYXJhbWV0ZXJzLmFsZ29yaXRobS5hbGdvcml0aG0pXG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmFsZ29yaXRobS5hbGdvcml0aG0uaGFzaC5uYW1lID0gc2hhQWxnb3JpdGhtO1xuICAgICAgICBpZiAoYWxnb3JpdGhtT2JqZWN0Lm5hbWUgPT09IFwiRUNEU0FcIikge1xuICAgICAgICAgICAgY29uc3QgcHVibGljS2V5QWxnb3JpdGhtID0gcHVibGljS2V5SW5mby5hbGdvcml0aG07XG4gICAgICAgICAgICBpZiAoIXB1YmxpY0tleUFsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBbGdvcml0aG0gcGFyYW1ldGVycyBmb3IgRUNEU0EgcHVibGljIGtleSBhcmUgbWlzc2VkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcHVibGljS2V5QWxnb3JpdGhtUGFyYW1zID0gcHVibGljS2V5QWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcztcbiAgICAgICAgICAgIGlmIChcImlkQmxvY2tcIiBpbiBwdWJsaWNLZXlBbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoKHB1YmxpY0tleUFsZ29yaXRobVBhcmFtcy5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSAmJiAocHVibGljS2V5QWxnb3JpdGhtUGFyYW1zLmlkQmxvY2sudGFnTnVtYmVyID09PSA2KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0IHR5cGUgZm9yIEVDRFNBIHB1YmxpYyBrZXkgcGFyYW1ldGVyc1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjdXJ2ZU9iamVjdCA9IHRoaXMuZ2V0QWxnb3JpdGhtQnlPSUQocHVibGljS2V5QWxnb3JpdGhtUGFyYW1zLnZhbHVlQmxvY2sudG9TdHJpbmcoKSwgdHJ1ZSk7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmFsZ29yaXRobS5hbGdvcml0aG0ubmFtZWRDdXJ2ZSA9IGN1cnZlT2JqZWN0Lm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmFtZXRlcnM7XG4gICAgfVxuICAgIGFzeW5jIGdldFB1YmxpY0tleShwdWJsaWNLZXlJbmZvLCBzaWduYXR1cmVBbGdvcml0aG0sIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgaWYgKCFwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzID0gdGhpcy5maWxsUHVibGljS2V5UGFyYW1ldGVycyhwdWJsaWNLZXlJbmZvLCBzaWduYXR1cmVBbGdvcml0aG0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHB1YmxpY0tleUluZm9CdWZmZXIgPSBwdWJsaWNLZXlJbmZvLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpO1xuICAgICAgICByZXR1cm4gdGhpcy5pbXBvcnRLZXkoXCJzcGtpXCIsIHB1YmxpY0tleUluZm9CdWZmZXIsIHBhcmFtZXRlcnMuYWxnb3JpdGhtLmFsZ29yaXRobSwgdHJ1ZSwgcGFyYW1ldGVycy5hbGdvcml0aG0udXNhZ2VzKTtcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5V2l0aFB1YmxpY0tleShkYXRhLCBzaWduYXR1cmUsIHB1YmxpY0tleUluZm8sIHNpZ25hdHVyZUFsZ29yaXRobSwgc2hhQWxnb3JpdGhtKSB7XG4gICAgICAgIGxldCBwdWJsaWNLZXk7XG4gICAgICAgIGlmICghc2hhQWxnb3JpdGhtKSB7XG4gICAgICAgICAgICBzaGFBbGdvcml0aG0gPSB0aGlzLmdldEhhc2hBbGdvcml0aG0oc2lnbmF0dXJlQWxnb3JpdGhtKTtcbiAgICAgICAgICAgIGlmICghc2hhQWxnb3JpdGhtKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgc2lnbmF0dXJlIGFsZ29yaXRobTogJHtzaWduYXR1cmVBbGdvcml0aG0uYWxnb3JpdGhtSWR9YCk7XG4gICAgICAgICAgICBwdWJsaWNLZXkgPSBhd2FpdCB0aGlzLmdldFB1YmxpY0tleShwdWJsaWNLZXlJbmZvLCBzaWduYXR1cmVBbGdvcml0aG0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHt9O1xuICAgICAgICAgICAgbGV0IGFsZ29yaXRobUlkO1xuICAgICAgICAgICAgaWYgKHNpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1JZCA9PT0gXCIxLjIuODQwLjExMzU0OS4xLjEuMTBcIilcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1JZCA9IHNpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1JZDtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1JZCA9IHB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobUlkO1xuICAgICAgICAgICAgY29uc3QgYWxnb3JpdGhtT2JqZWN0ID0gdGhpcy5nZXRBbGdvcml0aG1CeU9JRChhbGdvcml0aG1JZCwgdHJ1ZSk7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmFsZ29yaXRobSA9IHRoaXMuZ2V0QWxnb3JpdGhtUGFyYW1ldGVycyhhbGdvcml0aG1PYmplY3QubmFtZSwgXCJpbXBvcnRLZXlcIik7XG4gICAgICAgICAgICBpZiAoXCJoYXNoXCIgaW4gcGFyYW1ldGVycy5hbGdvcml0aG0uYWxnb3JpdGhtKVxuICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMuYWxnb3JpdGhtLmFsZ29yaXRobS5oYXNoLm5hbWUgPSBzaGFBbGdvcml0aG07XG4gICAgICAgICAgICBpZiAoYWxnb3JpdGhtT2JqZWN0Lm5hbWUgPT09IFwiRUNEU0FcIikge1xuICAgICAgICAgICAgICAgIGxldCBhbGdvcml0aG1QYXJhbXNDaGVja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKChcImFsZ29yaXRobVBhcmFtc1wiIGluIHB1YmxpY0tleUluZm8uYWxnb3JpdGhtKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoXCJpZEJsb2NrXCIgaW4gcHVibGljS2V5SW5mby5hbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcy5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSAmJiAocHVibGljS2V5SW5mby5hbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zLmlkQmxvY2sudGFnTnVtYmVyID09PSA2KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbXNDaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWxnb3JpdGhtUGFyYW1zQ2hlY2tlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0IHR5cGUgZm9yIEVDRFNBIHB1YmxpYyBrZXkgcGFyYW1ldGVyc1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgY3VydmVPYmplY3QgPSB0aGlzLmdldEFsZ29yaXRobUJ5T0lEKHB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcy52YWx1ZUJsb2NrLnRvU3RyaW5nKCksIHRydWUpO1xuICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMuYWxnb3JpdGhtLmFsZ29yaXRobS5uYW1lZEN1cnZlID0gY3VydmVPYmplY3QubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHB1YmxpY0tleSA9IGF3YWl0IHRoaXMuZ2V0UHVibGljS2V5KHB1YmxpY0tleUluZm8sIG51bGwsIHBhcmFtZXRlcnMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFsZ29yaXRobSA9IHRoaXMuZ2V0QWxnb3JpdGhtUGFyYW1ldGVycyhwdWJsaWNLZXkuYWxnb3JpdGhtLm5hbWUsIFwidmVyaWZ5XCIpO1xuICAgICAgICBpZiAoXCJoYXNoXCIgaW4gYWxnb3JpdGhtLmFsZ29yaXRobSlcbiAgICAgICAgICAgIGFsZ29yaXRobS5hbGdvcml0aG0uaGFzaC5uYW1lID0gc2hhQWxnb3JpdGhtO1xuICAgICAgICBsZXQgc2lnbmF0dXJlVmFsdWUgPSBzaWduYXR1cmUudmFsdWVCbG9jay52YWx1ZUhleFZpZXc7XG4gICAgICAgIGlmIChwdWJsaWNLZXkuYWxnb3JpdGhtLm5hbWUgPT09IFwiRUNEU0FcIikge1xuICAgICAgICAgICAgY29uc3QgbmFtZWRDdXJ2ZSA9IEVDTmFtZWRDdXJ2ZXMuZmluZChwdWJsaWNLZXkuYWxnb3JpdGhtLm5hbWVkQ3VydmUpO1xuICAgICAgICAgICAgaWYgKCFuYW1lZEN1cnZlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5zdXBwb3J0ZWQgbmFtZWQgY3VydmUgaW4gdXNlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5mcm9tQkVSKHNpZ25hdHVyZVZhbHVlKTtcbiAgICAgICAgICAgIEFzbkVycm9yLmFzc2VydChhc24xLCBcIlNpZ25hdHVyZSB2YWx1ZVwiKTtcbiAgICAgICAgICAgIHNpZ25hdHVyZVZhbHVlID0gY3JlYXRlRUNEU0FTaWduYXR1cmVGcm9tQ01TKGFzbjEucmVzdWx0LCBuYW1lZEN1cnZlLnNpemUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwdWJsaWNLZXkuYWxnb3JpdGhtLm5hbWUgPT09IFwiUlNBLVBTU1wiKSB7XG4gICAgICAgICAgICBjb25zdCBwc3NQYXJhbWV0ZXJzID0gbmV3IFJTQVNTQVBTU1BhcmFtcyh7IHNjaGVtYTogc2lnbmF0dXJlQWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcyB9KTtcbiAgICAgICAgICAgIGlmIChcInNhbHRMZW5ndGhcIiBpbiBwc3NQYXJhbWV0ZXJzKVxuICAgICAgICAgICAgICAgIGFsZ29yaXRobS5hbGdvcml0aG0uc2FsdExlbmd0aCA9IHBzc1BhcmFtZXRlcnMuc2FsdExlbmd0aDtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBhbGdvcml0aG0uYWxnb3JpdGhtLnNhbHRMZW5ndGggPSAyMDtcbiAgICAgICAgICAgIGxldCBoYXNoQWxnbyA9IFwiU0hBLTFcIjtcbiAgICAgICAgICAgIGlmIChcImhhc2hBbGdvcml0aG1cIiBpbiBwc3NQYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGFzaEFsZ29yaXRobSA9IHRoaXMuZ2V0QWxnb3JpdGhtQnlPSUQocHNzUGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtLmFsZ29yaXRobUlkLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBoYXNoQWxnbyA9IGhhc2hBbGdvcml0aG0ubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFsZ29yaXRobS5hbGdvcml0aG0uaGFzaC5uYW1lID0gaGFzaEFsZ287XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMudmVyaWZ5KGFsZ29yaXRobS5hbGdvcml0aG0sIHB1YmxpY0tleSwgc2lnbmF0dXJlVmFsdWUsIGRhdGEpO1xuICAgIH1cbn1cblxubGV0IGVuZ2luZSA9IHtcbiAgICBuYW1lOiBcIm5vbmVcIixcbiAgICBjcnlwdG86IG51bGwsXG59O1xuZnVuY3Rpb24gaXNDcnlwdG9FbmdpbmUoZW5naW5lKSB7XG4gICAgcmV0dXJuIGVuZ2luZVxuICAgICAgICAmJiB0eXBlb2YgZW5naW5lID09PSBcIm9iamVjdFwiXG4gICAgICAgICYmIFwiY3J5cHRvXCIgaW4gZW5naW5lXG4gICAgICAgID8gdHJ1ZVxuICAgICAgICA6IGZhbHNlO1xufVxuZnVuY3Rpb24gc2V0RW5naW5lKG5hbWUsIC4uLmFyZ3MpIHtcbiAgICBsZXQgY3J5cHRvID0gbnVsbDtcbiAgICBpZiAoYXJncy5sZW5ndGggPCAyKSB7XG4gICAgICAgIGlmIChhcmdzLmxlbmd0aCkge1xuICAgICAgICAgICAgY3J5cHRvID0gYXJnc1swXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNyeXB0byA9IHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYuY3J5cHRvID8gbmV3IENyeXB0b0VuZ2luZSh7IG5hbWU6IFwiYnJvd3NlclwiLCBjcnlwdG86IHNlbGYuY3J5cHRvIH0pIDogbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgY3J5cHRvQXJnID0gYXJnc1swXTtcbiAgICAgICAgY29uc3Qgc3VidGxlQXJnID0gYXJnc1sxXTtcbiAgICAgICAgaWYgKGlzQ3J5cHRvRW5naW5lKHN1YnRsZUFyZykpIHtcbiAgICAgICAgICAgIGNyeXB0byA9IHN1YnRsZUFyZztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc0NyeXB0b0VuZ2luZShjcnlwdG9BcmcpKSB7XG4gICAgICAgICAgICBjcnlwdG8gPSBjcnlwdG9Bcmc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoXCJzdWJ0bGVcIiBpbiBjcnlwdG9BcmcgJiYgXCJnZXRSYW5kb21WYWx1ZXNcIiBpbiBjcnlwdG9BcmcpIHtcbiAgICAgICAgICAgIGNyeXB0byA9IG5ldyBDcnlwdG9FbmdpbmUoe1xuICAgICAgICAgICAgICAgIGNyeXB0bzogY3J5cHRvQXJnLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIikgJiYgKFwicGlkXCIgaW4gcHJvY2VzcykgJiYgKHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIpICYmICh0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiKSkge1xuICAgICAgICBpZiAodHlwZW9mIGdsb2JhbFtwcm9jZXNzLnBpZF0gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIGdsb2JhbFtwcm9jZXNzLnBpZF0gPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZ2xvYmFsW3Byb2Nlc3MucGlkXSAhPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTmFtZSBnbG9iYWwuJHtwcm9jZXNzLnBpZH0gYWxyZWFkeSBleGlzdHMgYW5kIGl0IGlzIG5vdCBhbiBvYmplY3RgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGdsb2JhbFtwcm9jZXNzLnBpZF0ucGtpanMgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIGdsb2JhbFtwcm9jZXNzLnBpZF0ucGtpanMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZ2xvYmFsW3Byb2Nlc3MucGlkXS5wa2lqcyAhPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTmFtZSBnbG9iYWwuJHtwcm9jZXNzLnBpZH0ucGtpanMgYWxyZWFkeSBleGlzdHMgYW5kIGl0IGlzIG5vdCBhbiBvYmplY3RgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBnbG9iYWxbcHJvY2Vzcy5waWRdLnBraWpzLmVuZ2luZSA9IHtcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBjcnlwdG8sXG4gICAgICAgIH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBlbmdpbmUgPSB7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgY3J5cHRvLFxuICAgICAgICB9O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldEVuZ2luZSgpIHtcbiAgICBpZiAoKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiKSAmJiAoXCJwaWRcIiBpbiBwcm9jZXNzKSAmJiAodHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIikgJiYgKHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIpKSB7XG4gICAgICAgIGxldCBfZW5naW5lO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgX2VuZ2luZSA9IGdsb2JhbFtwcm9jZXNzLnBpZF0ucGtpanMuZW5naW5lO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGxlYXNlIGNhbGwgJ3NldEVuZ2luZScgYmVmb3JlIGNhbGwgdG8gJ2dldEVuZ2luZSdcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9lbmdpbmU7XG4gICAgfVxuICAgIHJldHVybiBlbmdpbmU7XG59XG5mdW5jdGlvbiBnZXRDcnlwdG8oc2FmZXR5ID0gZmFsc2UpIHtcbiAgICBjb25zdCBfZW5naW5lID0gZ2V0RW5naW5lKCk7XG4gICAgaWYgKCFfZW5naW5lLmNyeXB0byAmJiBzYWZldHkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIGNyZWF0ZSBXZWJDcnlwdG8gb2JqZWN0XCIpO1xuICAgIH1cbiAgICByZXR1cm4gX2VuZ2luZS5jcnlwdG87XG59XG5mdW5jdGlvbiBnZXRSYW5kb21WYWx1ZXModmlldykge1xuICAgIHJldHVybiBnZXRDcnlwdG8odHJ1ZSkuZ2V0UmFuZG9tVmFsdWVzKHZpZXcpO1xufVxuZnVuY3Rpb24gZ2V0T0lEQnlBbGdvcml0aG0oYWxnb3JpdGhtLCBzYWZldHksIHRhcmdldCkge1xuICAgIHJldHVybiBnZXRDcnlwdG8odHJ1ZSkuZ2V0T0lEQnlBbGdvcml0aG0oYWxnb3JpdGhtLCBzYWZldHksIHRhcmdldCk7XG59XG5mdW5jdGlvbiBnZXRBbGdvcml0aG1QYXJhbWV0ZXJzKGFsZ29yaXRobU5hbWUsIG9wZXJhdGlvbikge1xuICAgIHJldHVybiBnZXRDcnlwdG8odHJ1ZSkuZ2V0QWxnb3JpdGhtUGFyYW1ldGVycyhhbGdvcml0aG1OYW1lLCBvcGVyYXRpb24pO1xufVxuZnVuY3Rpb24gY3JlYXRlQ01TRUNEU0FTaWduYXR1cmUoc2lnbmF0dXJlQnVmZmVyKSB7XG4gICAgaWYgKChzaWduYXR1cmVCdWZmZXIuYnl0ZUxlbmd0aCAlIDIpICE9PSAwKVxuICAgICAgICByZXR1cm4gRU1QVFlfQlVGRkVSO1xuICAgIGNvbnN0IGxlbmd0aCA9IHNpZ25hdHVyZUJ1ZmZlci5ieXRlTGVuZ3RoIC8gMjtcbiAgICBjb25zdCByQnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKGxlbmd0aCk7XG4gICAgY29uc3QgclZpZXcgPSBuZXcgVWludDhBcnJheShyQnVmZmVyKTtcbiAgICByVmlldy5zZXQobmV3IFVpbnQ4QXJyYXkoc2lnbmF0dXJlQnVmZmVyLCAwLCBsZW5ndGgpKTtcbiAgICBjb25zdCBySW50ZWdlciA9IG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlSGV4OiByQnVmZmVyIH0pO1xuICAgIGNvbnN0IHNCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIobGVuZ3RoKTtcbiAgICBjb25zdCBzVmlldyA9IG5ldyBVaW50OEFycmF5KHNCdWZmZXIpO1xuICAgIHNWaWV3LnNldChuZXcgVWludDhBcnJheShzaWduYXR1cmVCdWZmZXIsIGxlbmd0aCwgbGVuZ3RoKSk7XG4gICAgY29uc3Qgc0ludGVnZXIgPSBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZUhleDogc0J1ZmZlciB9KTtcbiAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgckludGVnZXIuY29udmVydFRvREVSKCksXG4gICAgICAgICAgICBzSW50ZWdlci5jb252ZXJ0VG9ERVIoKVxuICAgICAgICBdXG4gICAgfSkpLnRvQkVSKGZhbHNlKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUVDRFNBU2lnbmF0dXJlRnJvbUNNUyhjbXNTaWduYXR1cmUsIHBvaW50U2l6ZSkge1xuICAgIGlmICghKGNtc1NpZ25hdHVyZSBpbnN0YW5jZW9mIGFzbjFqcy5TZXF1ZW5jZVxuICAgICAgICAmJiBjbXNTaWduYXR1cmUudmFsdWVCbG9jay52YWx1ZS5sZW5ndGggPT09IDJcbiAgICAgICAgJiYgY21zU2lnbmF0dXJlLnZhbHVlQmxvY2sudmFsdWVbMF0gaW5zdGFuY2VvZiBhc24xanMuSW50ZWdlclxuICAgICAgICAmJiBjbXNTaWduYXR1cmUudmFsdWVCbG9jay52YWx1ZVsxXSBpbnN0YW5jZW9mIGFzbjFqcy5JbnRlZ2VyKSlcbiAgICAgICAgcmV0dXJuIEVNUFRZX0JVRkZFUjtcbiAgICBjb25zdCByVmFsdWVWaWV3ID0gY21zU2lnbmF0dXJlLnZhbHVlQmxvY2sudmFsdWVbMF0uY29udmVydEZyb21ERVIoKS52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldztcbiAgICBjb25zdCBzVmFsdWVWaWV3ID0gY21zU2lnbmF0dXJlLnZhbHVlQmxvY2sudmFsdWVbMV0uY29udmVydEZyb21ERVIoKS52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldztcbiAgICBjb25zdCByZXMgPSBuZXcgVWludDhBcnJheShwb2ludFNpemUgKiAyKTtcbiAgICByZXMuc2V0KHJWYWx1ZVZpZXcsIHBvaW50U2l6ZSAtIHJWYWx1ZVZpZXcuYnl0ZUxlbmd0aCk7XG4gICAgcmVzLnNldChzVmFsdWVWaWV3LCAoMiAqIHBvaW50U2l6ZSkgLSBzVmFsdWVWaWV3LmJ5dGVMZW5ndGgpO1xuICAgIHJldHVybiByZXMuYnVmZmVyO1xufVxuZnVuY3Rpb24gZ2V0QWxnb3JpdGhtQnlPSUQob2lkLCBzYWZldHkgPSBmYWxzZSwgdGFyZ2V0KSB7XG4gICAgcmV0dXJuIGdldENyeXB0byh0cnVlKS5nZXRBbGdvcml0aG1CeU9JRChvaWQsIHNhZmV0eSwgdGFyZ2V0KTtcbn1cbmZ1bmN0aW9uIGdldEhhc2hBbGdvcml0aG0oc2lnbmF0dXJlQWxnb3JpdGhtKSB7XG4gICAgcmV0dXJuIGdldENyeXB0byh0cnVlKS5nZXRIYXNoQWxnb3JpdGhtKHNpZ25hdHVyZUFsZ29yaXRobSk7XG59XG5hc3luYyBmdW5jdGlvbiBrZGZXaXRoQ291bnRlcihoYXNoRnVuY3Rpb24sIHpCdWZmZXIsIENvdW50ZXIsIFNoYXJlZEluZm8sIGNyeXB0bykge1xuICAgIHN3aXRjaCAoaGFzaEZ1bmN0aW9uLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgY2FzZSBcIlNIQS0xXCI6XG4gICAgICAgIGNhc2UgXCJTSEEtMjU2XCI6XG4gICAgICAgIGNhc2UgXCJTSEEtMzg0XCI6XG4gICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudEVycm9yKGBVbmtub3duIGhhc2ggZnVuY3Rpb246ICR7aGFzaEZ1bmN0aW9ufWApO1xuICAgIH1cbiAgICBBcmd1bWVudEVycm9yLmFzc2VydCh6QnVmZmVyLCBcInpCdWZmZXJcIiwgXCJBcnJheUJ1ZmZlclwiKTtcbiAgICBpZiAoekJ1ZmZlci5ieXRlTGVuZ3RoID09PSAwKVxuICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFcnJvcihcIid6QnVmZmVyJyBoYXMgemVybyBsZW5ndGgsIGVycm9yXCIpO1xuICAgIEFyZ3VtZW50RXJyb3IuYXNzZXJ0KFNoYXJlZEluZm8sIFwiU2hhcmVkSW5mb1wiLCBcIkFycmF5QnVmZmVyXCIpO1xuICAgIGlmIChDb3VudGVyID4gMjU1KVxuICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFcnJvcihcIlBsZWFzZSBzZXQgJ0NvdW50ZXInIGFyZ3VtZW50IHRvIHZhbHVlIGxlc3Mgb3IgZXF1YWwgdG8gMjU1XCIpO1xuICAgIGNvbnN0IGNvdW50ZXJCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoNCk7XG4gICAgY29uc3QgY291bnRlclZpZXcgPSBuZXcgVWludDhBcnJheShjb3VudGVyQnVmZmVyKTtcbiAgICBjb3VudGVyVmlld1swXSA9IDB4MDA7XG4gICAgY291bnRlclZpZXdbMV0gPSAweDAwO1xuICAgIGNvdW50ZXJWaWV3WzJdID0gMHgwMDtcbiAgICBjb3VudGVyVmlld1szXSA9IENvdW50ZXI7XG4gICAgbGV0IGNvbWJpbmVkQnVmZmVyID0gRU1QVFlfQlVGRkVSO1xuICAgIGNvbWJpbmVkQnVmZmVyID0gcHZ1dGlscy51dGlsQ29uY2F0QnVmKGNvbWJpbmVkQnVmZmVyLCB6QnVmZmVyKTtcbiAgICBjb21iaW5lZEJ1ZmZlciA9IHB2dXRpbHMudXRpbENvbmNhdEJ1Zihjb21iaW5lZEJ1ZmZlciwgY291bnRlckJ1ZmZlcik7XG4gICAgY29tYmluZWRCdWZmZXIgPSBwdnV0aWxzLnV0aWxDb25jYXRCdWYoY29tYmluZWRCdWZmZXIsIFNoYXJlZEluZm8pO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNyeXB0by5kaWdlc3QoeyBuYW1lOiBoYXNoRnVuY3Rpb24gfSwgY29tYmluZWRCdWZmZXIpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvdW50ZXI6IENvdW50ZXIsXG4gICAgICAgIHJlc3VsdFxuICAgIH07XG59XG5hc3luYyBmdW5jdGlvbiBrZGYoaGFzaEZ1bmN0aW9uLCBaYnVmZmVyLCBrZXlkYXRhbGVuLCBTaGFyZWRJbmZvLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICBsZXQgaGFzaExlbmd0aCA9IDA7XG4gICAgbGV0IG1heENvdW50ZXIgPSAxO1xuICAgIHN3aXRjaCAoaGFzaEZ1bmN0aW9uLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgY2FzZSBcIlNIQS0xXCI6XG4gICAgICAgICAgICBoYXNoTGVuZ3RoID0gMTYwO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJTSEEtMjU2XCI6XG4gICAgICAgICAgICBoYXNoTGVuZ3RoID0gMjU2O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJTSEEtMzg0XCI6XG4gICAgICAgICAgICBoYXNoTGVuZ3RoID0gMzg0O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJTSEEtNTEyXCI6XG4gICAgICAgICAgICBoYXNoTGVuZ3RoID0gNTEyO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFcnJvcihgVW5rbm93biBoYXNoIGZ1bmN0aW9uOiAke2hhc2hGdW5jdGlvbn1gKTtcbiAgICB9XG4gICAgQXJndW1lbnRFcnJvci5hc3NlcnQoWmJ1ZmZlciwgXCJaYnVmZmVyXCIsIFwiQXJyYXlCdWZmZXJcIik7XG4gICAgaWYgKFpidWZmZXIuYnl0ZUxlbmd0aCA9PT0gMClcbiAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXJyb3IoXCInWmJ1ZmZlcicgaGFzIHplcm8gbGVuZ3RoLCBlcnJvclwiKTtcbiAgICBBcmd1bWVudEVycm9yLmFzc2VydChTaGFyZWRJbmZvLCBcIlNoYXJlZEluZm9cIiwgXCJBcnJheUJ1ZmZlclwiKTtcbiAgICBjb25zdCBxdW90aWVudCA9IGtleWRhdGFsZW4gLyBoYXNoTGVuZ3RoO1xuICAgIGlmIChNYXRoLmZsb29yKHF1b3RpZW50KSA+IDApIHtcbiAgICAgICAgbWF4Q291bnRlciA9IE1hdGguZmxvb3IocXVvdGllbnQpO1xuICAgICAgICBpZiAoKHF1b3RpZW50IC0gbWF4Q291bnRlcikgPiAwKVxuICAgICAgICAgICAgbWF4Q291bnRlcisrO1xuICAgIH1cbiAgICBjb25zdCBpbmNvbWluZ1Jlc3VsdCA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IG1heENvdW50ZXI7IGkrKylcbiAgICAgICAgaW5jb21pbmdSZXN1bHQucHVzaChhd2FpdCBrZGZXaXRoQ291bnRlcihoYXNoRnVuY3Rpb24sIFpidWZmZXIsIGksIFNoYXJlZEluZm8sIGNyeXB0bykpO1xuICAgIGxldCBjb21iaW5lZEJ1ZmZlciA9IEVNUFRZX0JVRkZFUjtcbiAgICBsZXQgY3VycmVudENvdW50ZXIgPSAxO1xuICAgIGxldCBmb3VuZCA9IHRydWU7XG4gICAgd2hpbGUgKGZvdW5kKSB7XG4gICAgICAgIGZvdW5kID0gZmFsc2U7XG4gICAgICAgIGZvciAoY29uc3QgcmVzdWx0IG9mIGluY29taW5nUmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAocmVzdWx0LmNvdW50ZXIgPT09IGN1cnJlbnRDb3VudGVyKSB7XG4gICAgICAgICAgICAgICAgY29tYmluZWRCdWZmZXIgPSBwdnV0aWxzLnV0aWxDb25jYXRCdWYoY29tYmluZWRCdWZmZXIsIHJlc3VsdC5yZXN1bHQpO1xuICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjdXJyZW50Q291bnRlcisrO1xuICAgIH1cbiAgICBrZXlkYXRhbGVuID4+PSAzO1xuICAgIGlmIChjb21iaW5lZEJ1ZmZlci5ieXRlTGVuZ3RoID4ga2V5ZGF0YWxlbikge1xuICAgICAgICBjb25zdCBuZXdCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoa2V5ZGF0YWxlbik7XG4gICAgICAgIGNvbnN0IG5ld1ZpZXcgPSBuZXcgVWludDhBcnJheShuZXdCdWZmZXIpO1xuICAgICAgICBjb25zdCBjb21iaW5lZFZpZXcgPSBuZXcgVWludDhBcnJheShjb21iaW5lZEJ1ZmZlcik7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5ZGF0YWxlbjsgaSsrKVxuICAgICAgICAgICAgbmV3Vmlld1tpXSA9IGNvbWJpbmVkVmlld1tpXTtcbiAgICAgICAgcmV0dXJuIG5ld0J1ZmZlcjtcbiAgICB9XG4gICAgcmV0dXJuIGNvbWJpbmVkQnVmZmVyO1xufVxuXG5jb25zdCBWRVJTSU9OJGkgPSBcInZlcnNpb25cIjtcbmNvbnN0IExPR19JRCA9IFwibG9nSURcIjtcbmNvbnN0IEVYVEVOU0lPTlMkNiA9IFwiZXh0ZW5zaW9uc1wiO1xuY29uc3QgVElNRVNUQU1QID0gXCJ0aW1lc3RhbXBcIjtcbmNvbnN0IEhBU0hfQUxHT1JJVEhNJDMgPSBcImhhc2hBbGdvcml0aG1cIjtcbmNvbnN0IFNJR05BVFVSRV9BTEdPUklUSE0kOCA9IFwic2lnbmF0dXJlQWxnb3JpdGhtXCI7XG5jb25zdCBTSUdOQVRVUkUkNyA9IFwic2lnbmF0dXJlXCI7XG5jb25zdCBOT05FID0gXCJub25lXCI7XG5jb25zdCBNRDUgPSBcIm1kNVwiO1xuY29uc3QgU0hBMSA9IFwic2hhMVwiO1xuY29uc3QgU0hBMjI0ID0gXCJzaGEyMjRcIjtcbmNvbnN0IFNIQTI1NiA9IFwic2hhMjU2XCI7XG5jb25zdCBTSEEzODQgPSBcInNoYTM4NFwiO1xuY29uc3QgU0hBNTEyID0gXCJzaGE1MTJcIjtcbmNvbnN0IEFOT05ZTU9VUyA9IFwiYW5vbnltb3VzXCI7XG5jb25zdCBSU0EgPSBcInJzYVwiO1xuY29uc3QgRFNBID0gXCJkc2FcIjtcbmNvbnN0IEVDRFNBID0gXCJlY2RzYVwiO1xuY2xhc3MgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXAgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWRVJTSU9OJGksIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRpKSk7XG4gICAgICAgIHRoaXMubG9nSUQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBMT0dfSUQsIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wLmRlZmF1bHRWYWx1ZXMoTE9HX0lEKSk7XG4gICAgICAgIHRoaXMudGltZXN0YW1wID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVElNRVNUQU1QLCBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcC5kZWZhdWx0VmFsdWVzKFRJTUVTVEFNUCkpO1xuICAgICAgICB0aGlzLmV4dGVuc2lvbnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFWFRFTlNJT05TJDYsIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wLmRlZmF1bHRWYWx1ZXMoRVhURU5TSU9OUyQ2KSk7XG4gICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEhBU0hfQUxHT1JJVEhNJDMsIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wLmRlZmF1bHRWYWx1ZXMoSEFTSF9BTEdPUklUSE0kMykpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9BTEdPUklUSE0kOCwgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXAuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfQUxHT1JJVEhNJDgpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkUkNywgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXAuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkUkNykpO1xuICAgICAgICBpZiAoXCJzdHJlYW1cIiBpbiBwYXJhbWV0ZXJzICYmIHBhcmFtZXRlcnMuc3RyZWFtKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TdHJlYW0ocGFyYW1ldGVycy5zdHJlYW0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIExPR19JRDpcbiAgICAgICAgICAgIGNhc2UgRVhURU5TSU9OUyQ2OlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9CVUZGRVI7XG4gICAgICAgICAgICBjYXNlIFRJTUVTVEFNUDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoMCk7XG4gICAgICAgICAgICBjYXNlIEhBU0hfQUxHT1JJVEhNJDM6XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRV9BTEdPUklUSE0kODpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkUkNzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgaWYgKChzY2hlbWEgaW5zdGFuY2VvZiBhc24xanMuUmF3RGF0YSkgPT09IGZhbHNlKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT2JqZWN0J3Mgc2NoZW1hIHdhcyBub3QgdmVyaWZpZWQgYWdhaW5zdCBpbnB1dCBkYXRhIGZvciBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcFwiKTtcbiAgICAgICAgY29uc3Qgc2VxU3RyZWFtID0gbmV3IGJzLlNlcVN0cmVhbSh7XG4gICAgICAgICAgICBzdHJlYW06IG5ldyBicy5CeXRlU3RyZWFtKHtcbiAgICAgICAgICAgICAgICBidWZmZXI6IHNjaGVtYS5kYXRhXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5mcm9tU3RyZWFtKHNlcVN0cmVhbSk7XG4gICAgfVxuICAgIGZyb21TdHJlYW0oc3RyZWFtKSB7XG4gICAgICAgIGNvbnN0IGJsb2NrTGVuZ3RoID0gc3RyZWFtLmdldFVpbnQxNigpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSAoc3RyZWFtLmdldEJsb2NrKDEpKVswXTtcbiAgICAgICAgaWYgKHRoaXMudmVyc2lvbiA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5sb2dJRCA9IChuZXcgVWludDhBcnJheShzdHJlYW0uZ2V0QmxvY2soMzIpKSkuYnVmZmVyLnNsaWNlKDApO1xuICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBuZXcgRGF0ZShwdnV0aWxzLnV0aWxGcm9tQmFzZShuZXcgVWludDhBcnJheShzdHJlYW0uZ2V0QmxvY2soOCkpLCA4KSk7XG4gICAgICAgICAgICBjb25zdCBleHRlbnNpb25zTGVuZ3RoID0gc3RyZWFtLmdldFVpbnQxNigpO1xuICAgICAgICAgICAgdGhpcy5leHRlbnNpb25zID0gKG5ldyBVaW50OEFycmF5KHN0cmVhbS5nZXRCbG9jayhleHRlbnNpb25zTGVuZ3RoKSkpLmJ1ZmZlci5zbGljZSgwKTtcbiAgICAgICAgICAgIHN3aXRjaCAoKHN0cmVhbS5nZXRCbG9jaygxKSlbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IE5PTkU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gTUQ1O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IFNIQTE7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gU0hBMjI0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IFNIQTI1NjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhc2hBbGdvcml0aG0gPSBTSEEzODQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gU0hBNTEyO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPYmplY3QncyBzdHJlYW0gd2FzIG5vdCBjb3JyZWN0IGZvciBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN3aXRjaCAoKHN0cmVhbS5nZXRCbG9jaygxKSlbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gQU5PTllNT1VTO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gUlNBO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gRFNBO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gRUNEU0E7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9iamVjdCdzIHN0cmVhbSB3YXMgbm90IGNvcnJlY3QgZm9yIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc2lnbmF0dXJlTGVuZ3RoID0gc3RyZWFtLmdldFVpbnQxNigpO1xuICAgICAgICAgICAgY29uc3Qgc2lnbmF0dXJlRGF0YSA9IG5ldyBVaW50OEFycmF5KHN0cmVhbS5nZXRCbG9jayhzaWduYXR1cmVMZW5ndGgpKS5idWZmZXIuc2xpY2UoMCk7XG4gICAgICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmZyb21CRVIoc2lnbmF0dXJlRGF0YSk7XG4gICAgICAgICAgICBBc25FcnJvci5hc3NlcnQoYXNuMSwgXCJTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcFwiKTtcbiAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlID0gYXNuMS5yZXN1bHQ7XG4gICAgICAgICAgICBpZiAoYmxvY2tMZW5ndGggIT09ICg0NyArIGV4dGVuc2lvbnNMZW5ndGggKyBzaWduYXR1cmVMZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT2JqZWN0J3Mgc3RyZWFtIHdhcyBub3QgY29ycmVjdCBmb3IgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMudG9TdHJlYW0oKTtcbiAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuUmF3RGF0YSh7IGRhdGE6IHN0cmVhbS5zdHJlYW0uYnVmZmVyIH0pO1xuICAgIH1cbiAgICB0b1N0cmVhbSgpIHtcbiAgICAgICAgY29uc3Qgc3RyZWFtID0gbmV3IGJzLlNlcVN0cmVhbSgpO1xuICAgICAgICBzdHJlYW0uYXBwZW5kVWludDE2KDQ3ICsgdGhpcy5leHRlbnNpb25zLmJ5dGVMZW5ndGggKyB0aGlzLnNpZ25hdHVyZS52YWx1ZUJlZm9yZURlY29kZVZpZXcuYnl0ZUxlbmd0aCk7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRDaGFyKHRoaXMudmVyc2lvbik7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRWaWV3KG5ldyBVaW50OEFycmF5KHRoaXMubG9nSUQpKTtcbiAgICAgICAgY29uc3QgdGltZUJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcig4KTtcbiAgICAgICAgY29uc3QgdGltZVZpZXcgPSBuZXcgVWludDhBcnJheSh0aW1lQnVmZmVyKTtcbiAgICAgICAgY29uc3QgYmFzZUFycmF5ID0gcHZ1dGlscy51dGlsVG9CYXNlKHRoaXMudGltZXN0YW1wLnZhbHVlT2YoKSwgOCk7XG4gICAgICAgIHRpbWVWaWV3LnNldChuZXcgVWludDhBcnJheShiYXNlQXJyYXkpLCA4IC0gYmFzZUFycmF5LmJ5dGVMZW5ndGgpO1xuICAgICAgICBzdHJlYW0uYXBwZW5kVmlldyh0aW1lVmlldyk7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRVaW50MTYodGhpcy5leHRlbnNpb25zLmJ5dGVMZW5ndGgpO1xuICAgICAgICBpZiAodGhpcy5leHRlbnNpb25zLmJ5dGVMZW5ndGgpXG4gICAgICAgICAgICBzdHJlYW0uYXBwZW5kVmlldyhuZXcgVWludDhBcnJheSh0aGlzLmV4dGVuc2lvbnMpKTtcbiAgICAgICAgbGV0IF9oYXNoQWxnb3JpdGhtO1xuICAgICAgICBzd2l0Y2ggKHRoaXMuaGFzaEFsZ29yaXRobS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIE5PTkU6XG4gICAgICAgICAgICAgICAgX2hhc2hBbGdvcml0aG0gPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBNRDU6XG4gICAgICAgICAgICAgICAgX2hhc2hBbGdvcml0aG0gPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBTSEExOlxuICAgICAgICAgICAgICAgIF9oYXNoQWxnb3JpdGhtID0gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgU0hBMjI0OlxuICAgICAgICAgICAgICAgIF9oYXNoQWxnb3JpdGhtID0gMztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgU0hBMjU2OlxuICAgICAgICAgICAgICAgIF9oYXNoQWxnb3JpdGhtID0gNDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgU0hBMzg0OlxuICAgICAgICAgICAgICAgIF9oYXNoQWxnb3JpdGhtID0gNTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgU0hBNTEyOlxuICAgICAgICAgICAgICAgIF9oYXNoQWxnb3JpdGhtID0gNjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgZGF0YSBmb3IgaGFzaEFsZ29yaXRobTogJHt0aGlzLmhhc2hBbGdvcml0aG19YCk7XG4gICAgICAgIH1cbiAgICAgICAgc3RyZWFtLmFwcGVuZENoYXIoX2hhc2hBbGdvcml0aG0pO1xuICAgICAgICBsZXQgX3NpZ25hdHVyZUFsZ29yaXRobTtcbiAgICAgICAgc3dpdGNoICh0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIEFOT05ZTU9VUzpcbiAgICAgICAgICAgICAgICBfc2lnbmF0dXJlQWxnb3JpdGhtID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUlNBOlxuICAgICAgICAgICAgICAgIF9zaWduYXR1cmVBbGdvcml0aG0gPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBEU0E6XG4gICAgICAgICAgICAgICAgX3NpZ25hdHVyZUFsZ29yaXRobSA9IDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEVDRFNBOlxuICAgICAgICAgICAgICAgIF9zaWduYXR1cmVBbGdvcml0aG0gPSAzO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBkYXRhIGZvciBzaWduYXR1cmVBbGdvcml0aG06ICR7dGhpcy5zaWduYXR1cmVBbGdvcml0aG19YCk7XG4gICAgICAgIH1cbiAgICAgICAgc3RyZWFtLmFwcGVuZENoYXIoX3NpZ25hdHVyZUFsZ29yaXRobSk7XG4gICAgICAgIGNvbnN0IF9zaWduYXR1cmUgPSB0aGlzLnNpZ25hdHVyZS50b0JFUihmYWxzZSk7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRVaW50MTYoX3NpZ25hdHVyZS5ieXRlTGVuZ3RoKTtcbiAgICAgICAgc3RyZWFtLmFwcGVuZFZpZXcobmV3IFVpbnQ4QXJyYXkoX3NpZ25hdHVyZSkpO1xuICAgICAgICByZXR1cm4gc3RyZWFtO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnZlcnNpb24sXG4gICAgICAgICAgICBsb2dJRDogcHZ1dGlscy5idWZmZXJUb0hleENvZGVzKHRoaXMubG9nSUQpLFxuICAgICAgICAgICAgdGltZXN0YW1wOiB0aGlzLnRpbWVzdGFtcCxcbiAgICAgICAgICAgIGV4dGVuc2lvbnM6IHB2dXRpbHMuYnVmZmVyVG9IZXhDb2Rlcyh0aGlzLmV4dGVuc2lvbnMpLFxuICAgICAgICAgICAgaGFzaEFsZ29yaXRobTogdGhpcy5oYXNoQWxnb3JpdGhtLFxuICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtOiB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSxcbiAgICAgICAgICAgIHNpZ25hdHVyZTogdGhpcy5zaWduYXR1cmUudG9KU09OKClcbiAgICAgICAgfTtcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5KGxvZ3MsIGRhdGEsIGRhdGFUeXBlID0gMCwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIGNvbnN0IGxvZ0lkID0gcHZ1dGlscy50b0Jhc2U2NChwdnV0aWxzLmFycmF5QnVmZmVyVG9TdHJpbmcodGhpcy5sb2dJRCkpO1xuICAgICAgICBsZXQgcHVibGljS2V5QmFzZTY0ID0gbnVsbDtcbiAgICAgICAgY29uc3Qgc3RyZWFtID0gbmV3IGJzLlNlcVN0cmVhbSgpO1xuICAgICAgICBmb3IgKGNvbnN0IGxvZyBvZiBsb2dzKSB7XG4gICAgICAgICAgICBpZiAobG9nLmxvZ19pZCA9PT0gbG9nSWQpIHtcbiAgICAgICAgICAgICAgICBwdWJsaWNLZXlCYXNlNjQgPSBsb2cua2V5O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghcHVibGljS2V5QmFzZTY0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFB1YmxpYyBrZXkgbm90IGZvdW5kIGZvciBDVCB3aXRoIGxvZ0lkOiAke2xvZ0lkfWApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBraSA9IHB2dXRpbHMuc3RyaW5nVG9BcnJheUJ1ZmZlcihwdnV0aWxzLmZyb21CYXNlNjQocHVibGljS2V5QmFzZTY0KSk7XG4gICAgICAgIGNvbnN0IHB1YmxpY0tleUluZm8gPSBQdWJsaWNLZXlJbmZvLmZyb21CRVIocGtpKTtcbiAgICAgICAgc3RyZWFtLmFwcGVuZENoYXIoMHgwMCk7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRDaGFyKDB4MDApO1xuICAgICAgICBjb25zdCB0aW1lQnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKDgpO1xuICAgICAgICBjb25zdCB0aW1lVmlldyA9IG5ldyBVaW50OEFycmF5KHRpbWVCdWZmZXIpO1xuICAgICAgICBjb25zdCBiYXNlQXJyYXkgPSBwdnV0aWxzLnV0aWxUb0Jhc2UodGhpcy50aW1lc3RhbXAudmFsdWVPZigpLCA4KTtcbiAgICAgICAgdGltZVZpZXcuc2V0KG5ldyBVaW50OEFycmF5KGJhc2VBcnJheSksIDggLSBiYXNlQXJyYXkuYnl0ZUxlbmd0aCk7XG4gICAgICAgIHN0cmVhbS5hcHBlbmRWaWV3KHRpbWVWaWV3KTtcbiAgICAgICAgc3RyZWFtLmFwcGVuZFVpbnQxNihkYXRhVHlwZSk7XG4gICAgICAgIGlmIChkYXRhVHlwZSA9PT0gMClcbiAgICAgICAgICAgIHN0cmVhbS5hcHBlbmRVaW50MjQoZGF0YS5ieXRlTGVuZ3RoKTtcbiAgICAgICAgc3RyZWFtLmFwcGVuZFZpZXcobmV3IFVpbnQ4QXJyYXkoZGF0YSkpO1xuICAgICAgICBzdHJlYW0uYXBwZW5kVWludDE2KHRoaXMuZXh0ZW5zaW9ucy5ieXRlTGVuZ3RoKTtcbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9ucy5ieXRlTGVuZ3RoICE9PSAwKVxuICAgICAgICAgICAgc3RyZWFtLmFwcGVuZFZpZXcobmV3IFVpbnQ4QXJyYXkodGhpcy5leHRlbnNpb25zKSk7XG4gICAgICAgIHJldHVybiBjcnlwdG8udmVyaWZ5V2l0aFB1YmxpY0tleShzdHJlYW0uYnVmZmVyLnNsaWNlKDAsIHN0cmVhbS5sZW5ndGgpLCBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IHRoaXMuc2lnbmF0dXJlLnRvQkVSKGZhbHNlKSB9KSwgcHVibGljS2V5SW5mbywgeyBhbGdvcml0aG1JZDogRU1QVFlfU1RSSU5HIH0sIFwiU0hBLTI1NlwiKTtcbiAgICB9XG59XG5TaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcC5DTEFTU19OQU1FID0gXCJTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcFwiO1xuYXN5bmMgZnVuY3Rpb24gdmVyaWZ5U0NUc0ZvckNlcnRpZmljYXRlKGNlcnRpZmljYXRlLCBpc3N1ZXJDZXJ0aWZpY2F0ZSwgbG9ncywgaW5kZXggPSAoLTEpLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICBsZXQgcGFyc2VkVmFsdWUgPSBudWxsO1xuICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBicy5TZXFTdHJlYW0oKTtcbiAgICBpZiAoY2VydGlmaWNhdGUuZXh0ZW5zaW9ucykge1xuICAgICAgICBmb3IgKGxldCBpID0gY2VydGlmaWNhdGUuZXh0ZW5zaW9ucy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgc3dpdGNoIChjZXJ0aWZpY2F0ZS5leHRlbnNpb25zW2ldLmV4dG5JRCkge1xuICAgICAgICAgICAgICAgIGNhc2UgaWRfU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0OlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWRWYWx1ZSA9IGNlcnRpZmljYXRlLmV4dGVuc2lvbnNbaV0ucGFyc2VkVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcnNlZFZhbHVlIHx8IHBhcnNlZFZhbHVlLnRpbWVzdGFtcHMubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdGhpbmcgdG8gdmVyaWZ5IGluIHRoZSBjZXJ0aWZpY2F0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRlLmV4dGVuc2lvbnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChwYXJzZWRWYWx1ZSA9PT0gbnVsbClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0IGV4dGVuc2lvbiBpbiB0aGUgc3BlY2lmaWVkIGNlcnRpZmljYXRlXCIpO1xuICAgIGNvbnN0IHRicyA9IGNlcnRpZmljYXRlLmVuY29kZVRCUygpLnRvQkVSKCk7XG4gICAgY29uc3QgaXNzdWVySWQgPSBhd2FpdCBjcnlwdG8uZGlnZXN0KHsgbmFtZTogXCJTSEEtMjU2XCIgfSwgbmV3IFVpbnQ4QXJyYXkoaXNzdWVyQ2VydGlmaWNhdGUuc3ViamVjdFB1YmxpY0tleUluZm8udG9TY2hlbWEoKS50b0JFUihmYWxzZSkpKTtcbiAgICBzdHJlYW0uYXBwZW5kVmlldyhuZXcgVWludDhBcnJheShpc3N1ZXJJZCkpO1xuICAgIHN0cmVhbS5hcHBlbmRVaW50MjQodGJzLmJ5dGVMZW5ndGgpO1xuICAgIHN0cmVhbS5hcHBlbmRWaWV3KG5ldyBVaW50OEFycmF5KHRicykpO1xuICAgIGNvbnN0IHByZUNlcnQgPSBzdHJlYW0uc3RyZWFtLnNsaWNlKDAsIHN0cmVhbS5sZW5ndGgpO1xuICAgIGlmIChpbmRleCA9PT0gKC0xKSkge1xuICAgICAgICBjb25zdCB2ZXJpZnlBcnJheSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHRpbWVzdGFtcCBvZiBwYXJzZWRWYWx1ZS50aW1lc3RhbXBzKSB7XG4gICAgICAgICAgICBjb25zdCB2ZXJpZnlSZXN1bHQgPSBhd2FpdCB0aW1lc3RhbXAudmVyaWZ5KGxvZ3MsIHByZUNlcnQuYnVmZmVyLCAxLCBjcnlwdG8pO1xuICAgICAgICAgICAgdmVyaWZ5QXJyYXkucHVzaCh2ZXJpZnlSZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2ZXJpZnlBcnJheTtcbiAgICB9XG4gICAgaWYgKGluZGV4ID49IHBhcnNlZFZhbHVlLnRpbWVzdGFtcHMubGVuZ3RoKVxuICAgICAgICBpbmRleCA9IChwYXJzZWRWYWx1ZS50aW1lc3RhbXBzLmxlbmd0aCAtIDEpO1xuICAgIHJldHVybiBbYXdhaXQgcGFyc2VkVmFsdWUudGltZXN0YW1wc1tpbmRleF0udmVyaWZ5KGxvZ3MsIHByZUNlcnQuYnVmZmVyLCAxLCBjcnlwdG8pXTtcbn1cblxuY29uc3QgVElNRVNUQU1QUyA9IFwidGltZXN0YW1wc1wiO1xuY2xhc3MgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50aW1lc3RhbXBzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVElNRVNUQU1QUywgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0LmRlZmF1bHRWYWx1ZXMoVElNRVNUQU1QUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVElNRVNUQU1QUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRJTUVTVEFNUFM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIChfYSA9IG5hbWVzLm9wdGlvbmFsKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAobmFtZXMub3B0aW9uYWwgPSBmYWxzZSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5PY3RldFN0cmluZyh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IFwiU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0XCIpLFxuICAgICAgICAgICAgb3B0aW9uYWw6IG5hbWVzLm9wdGlvbmFsXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgaWYgKChzY2hlbWEgaW5zdGFuY2VvZiBhc24xanMuT2N0ZXRTdHJpbmcpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT2JqZWN0J3Mgc2NoZW1hIHdhcyBub3QgdmVyaWZpZWQgYWdhaW5zdCBpbnB1dCBkYXRhIGZvciBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcExpc3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2VxU3RyZWFtID0gbmV3IGJzLlNlcVN0cmVhbSh7XG4gICAgICAgICAgICBzdHJlYW06IG5ldyBicy5CeXRlU3RyZWFtKHtcbiAgICAgICAgICAgICAgICBidWZmZXI6IHNjaGVtYS52YWx1ZUJsb2NrLnZhbHVlSGV4XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgZGF0YUxlbmd0aCA9IHNlcVN0cmVhbS5nZXRVaW50MTYoKTtcbiAgICAgICAgaWYgKGRhdGFMZW5ndGggIT09IHNlcVN0cmVhbS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9iamVjdCdzIHNjaGVtYSB3YXMgbm90IHZlcmlmaWVkIGFnYWluc3QgaW5wdXQgZGF0YSBmb3IgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0XCIpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChzZXFTdHJlYW0ubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVzdGFtcHMucHVzaChuZXcgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXAoeyBzdHJlYW06IHNlcVN0cmVhbSB9KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBicy5TZXFTdHJlYW0oKTtcbiAgICAgICAgbGV0IG92ZXJhbGxMZW5ndGggPSAwO1xuICAgICAgICBjb25zdCB0aW1lc3RhbXBzRGF0YSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHRpbWVzdGFtcCBvZiB0aGlzLnRpbWVzdGFtcHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcFN0cmVhbSA9IHRpbWVzdGFtcC50b1N0cmVhbSgpO1xuICAgICAgICAgICAgdGltZXN0YW1wc0RhdGEucHVzaCh0aW1lc3RhbXBTdHJlYW0pO1xuICAgICAgICAgICAgb3ZlcmFsbExlbmd0aCArPSB0aW1lc3RhbXBTdHJlYW0uc3RyZWFtLmJ1ZmZlci5ieXRlTGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIHN0cmVhbS5hcHBlbmRVaW50MTYob3ZlcmFsbExlbmd0aCk7XG4gICAgICAgIGZvciAoY29uc3QgdGltZXN0YW1wIG9mIHRpbWVzdGFtcHNEYXRhKSB7XG4gICAgICAgICAgICBzdHJlYW0uYXBwZW5kVmlldyh0aW1lc3RhbXAuc3RyZWFtLnZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IHN0cmVhbS5zdHJlYW0uYnVmZmVyLnNsaWNlKDApIH0pO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0aW1lc3RhbXBzOiBBcnJheS5mcm9tKHRoaXMudGltZXN0YW1wcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cblNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdC5DTEFTU19OQU1FID0gXCJTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcExpc3RcIjtcblxuY29uc3QgQVRUUklCVVRFUyQ0ID0gXCJhdHRyaWJ1dGVzXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQxMSA9IFtcbiAgICBBVFRSSUJVVEVTJDRcbl07XG5jbGFzcyBTdWJqZWN0RGlyZWN0b3J5QXR0cmlidXRlcyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFUVFJJQlVURVMkNCwgU3ViamVjdERpcmVjdG9yeUF0dHJpYnV0ZXMuZGVmYXVsdFZhbHVlcyhBVFRSSUJVVEVTJDQpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEFUVFJJQlVURVMkNDpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYXR0cmlidXRlcyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXR0cmlidXRlLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxMSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgU3ViamVjdERpcmVjdG9yeUF0dHJpYnV0ZXMuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczogQVRUUklCVVRFUyQ0XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5hdHRyaWJ1dGVzLCBlbGVtZW50ID0+IG5ldyBBdHRyaWJ1dGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuYXR0cmlidXRlcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXR0cmlidXRlczogQXJyYXkuZnJvbSh0aGlzLmF0dHJpYnV0ZXMsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG59XG5TdWJqZWN0RGlyZWN0b3J5QXR0cmlidXRlcy5DTEFTU19OQU1FID0gXCJTdWJqZWN0RGlyZWN0b3J5QXR0cmlidXRlc1wiO1xuXG5jbGFzcyBFeHRlbnNpb25WYWx1ZUZhY3Rvcnkge1xuICAgIHN0YXRpYyBnZXRJdGVtcygpIHtcbiAgICAgICAgaWYgKCF0aGlzLnR5cGVzKSB7XG4gICAgICAgICAgICB0aGlzLnR5cGVzID0ge307XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfU3ViamVjdEFsdE5hbWUsIFwiU3ViamVjdEFsdE5hbWVcIiwgQWx0TmFtZSk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfSXNzdWVyQWx0TmFtZSwgXCJJc3N1ZXJBbHROYW1lXCIsIEFsdE5hbWUpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX0F1dGhvcml0eUtleUlkZW50aWZpZXIsIFwiQXV0aG9yaXR5S2V5SWRlbnRpZmllclwiLCBBdXRob3JpdHlLZXlJZGVudGlmaWVyKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9CYXNpY0NvbnN0cmFpbnRzLCBcIkJhc2ljQ29uc3RyYWludHNcIiwgQmFzaWNDb25zdHJhaW50cyk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfTWljcm9zb2Z0Q2FWZXJzaW9uLCBcIk1pY3Jvc29mdENhVmVyc2lvblwiLCBDQVZlcnNpb24pO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX0NlcnRpZmljYXRlUG9saWNpZXMsIFwiQ2VydGlmaWNhdGVQb2xpY2llc1wiLCBDZXJ0aWZpY2F0ZVBvbGljaWVzKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9NaWNyb3NvZnRBcHBQb2xpY2llcywgXCJDZXJ0aWZpY2F0ZVBvbGljaWVzTWljcm9zb2Z0XCIsIENlcnRpZmljYXRlUG9saWNpZXMpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX01pY3Jvc29mdENlcnRUZW1wbGF0ZVYyLCBcIk1pY3Jvc29mdENlcnRUZW1wbGF0ZVYyXCIsIENlcnRpZmljYXRlVGVtcGxhdGUpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX0NSTERpc3RyaWJ1dGlvblBvaW50cywgXCJDUkxEaXN0cmlidXRpb25Qb2ludHNcIiwgQ1JMRGlzdHJpYnV0aW9uUG9pbnRzKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9GcmVzaGVzdENSTCwgXCJGcmVzaGVzdENSTFwiLCBDUkxEaXN0cmlidXRpb25Qb2ludHMpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX0V4dEtleVVzYWdlLCBcIkV4dEtleVVzYWdlXCIsIEV4dEtleVVzYWdlKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9DZXJ0aWZpY2F0ZUlzc3VlciwgXCJDZXJ0aWZpY2F0ZUlzc3VlclwiLCBHZW5lcmFsTmFtZXMpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX0F1dGhvcml0eUluZm9BY2Nlc3MsIFwiQXV0aG9yaXR5SW5mb0FjY2Vzc1wiLCBJbmZvQWNjZXNzKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9TdWJqZWN0SW5mb0FjY2VzcywgXCJTdWJqZWN0SW5mb0FjY2Vzc1wiLCBJbmZvQWNjZXNzKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9Jc3N1aW5nRGlzdHJpYnV0aW9uUG9pbnQsIFwiSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50XCIsIElzc3VpbmdEaXN0cmlidXRpb25Qb2ludCk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfTmFtZUNvbnN0cmFpbnRzLCBcIk5hbWVDb25zdHJhaW50c1wiLCBOYW1lQ29uc3RyYWludHMpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX1BvbGljeUNvbnN0cmFpbnRzLCBcIlBvbGljeUNvbnN0cmFpbnRzXCIsIFBvbGljeUNvbnN0cmFpbnRzKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9Qb2xpY3lNYXBwaW5ncywgXCJQb2xpY3lNYXBwaW5nc1wiLCBQb2xpY3lNYXBwaW5ncyk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfUHJpdmF0ZUtleVVzYWdlUGVyaW9kLCBcIlByaXZhdGVLZXlVc2FnZVBlcmlvZFwiLCBQcml2YXRlS2V5VXNhZ2VQZXJpb2QpO1xuICAgICAgICAgICAgRXh0ZW5zaW9uVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKGlkX1FDU3RhdGVtZW50cywgXCJRQ1N0YXRlbWVudHNcIiwgUUNTdGF0ZW1lbnRzKTtcbiAgICAgICAgICAgIEV4dGVuc2lvblZhbHVlRmFjdG9yeS5yZWdpc3RlcihpZF9TaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcExpc3QsIFwiU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0XCIsIFNpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdCk7XG4gICAgICAgICAgICBFeHRlbnNpb25WYWx1ZUZhY3RvcnkucmVnaXN0ZXIoaWRfU3ViamVjdERpcmVjdG9yeUF0dHJpYnV0ZXMsIFwiU3ViamVjdERpcmVjdG9yeUF0dHJpYnV0ZXNcIiwgU3ViamVjdERpcmVjdG9yeUF0dHJpYnV0ZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnR5cGVzO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUJFUihpZCwgcmF3KSB7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuZnJvbUJFUihyYXcpO1xuICAgICAgICBpZiAoYXNuMS5vZmZzZXQgPT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5maW5kKGlkKTtcbiAgICAgICAgaWYgKGl0ZW0pIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBpdGVtLnR5cGUoeyBzY2hlbWE6IGFzbjEucmVzdWx0IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzID0gbmV3IGl0ZW0udHlwZSgpO1xuICAgICAgICAgICAgICAgIHJlcy5wYXJzaW5nRXJyb3IgPSBgSW5jb3JyZWN0bHkgZm9ybWF0dGVkIHZhbHVlIG9mIGV4dGVuc2lvbiAke2l0ZW0ubmFtZX0gKCR7aWR9KWA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXNuMS5yZXN1bHQ7XG4gICAgfVxuICAgIHN0YXRpYyBmaW5kKGlkKSB7XG4gICAgICAgIGNvbnN0IHR5cGVzID0gdGhpcy5nZXRJdGVtcygpO1xuICAgICAgICByZXR1cm4gdHlwZXNbaWRdIHx8IG51bGw7XG4gICAgfVxuICAgIHN0YXRpYyByZWdpc3RlcihpZCwgbmFtZSwgdHlwZSkge1xuICAgICAgICB0aGlzLmdldEl0ZW1zKClbaWRdID0geyBuYW1lLCB0eXBlIH07XG4gICAgfVxufVxuXG5jb25zdCBFWFROX0lEID0gXCJleHRuSURcIjtcbmNvbnN0IENSSVRJQ0FMID0gXCJjcml0aWNhbFwiO1xuY29uc3QgRVhUTl9WQUxVRSA9IFwiZXh0blZhbHVlXCI7XG5jb25zdCBQQVJTRURfVkFMVUUkNSA9IFwicGFyc2VkVmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJDEwID0gW1xuICAgIEVYVE5fSUQsXG4gICAgQ1JJVElDQUwsXG4gICAgRVhUTl9WQUxVRVxuXTtcbmNsYXNzIEV4dGVuc2lvbiBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgZ2V0IHBhcnNlZFZhbHVlKCkge1xuICAgICAgICBpZiAodGhpcy5fcGFyc2VkVmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgcGFyc2VkVmFsdWUgPSBFeHRlbnNpb25WYWx1ZUZhY3RvcnkuZnJvbUJFUih0aGlzLmV4dG5JRCwgdGhpcy5leHRuVmFsdWUudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpO1xuICAgICAgICAgICAgdGhpcy5fcGFyc2VkVmFsdWUgPSBwYXJzZWRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fcGFyc2VkVmFsdWUgfHwgdW5kZWZpbmVkO1xuICAgIH1cbiAgICBzZXQgcGFyc2VkVmFsdWUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fcGFyc2VkVmFsdWUgPSB2YWx1ZTtcbiAgICB9XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZXh0bklEID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRVhUTl9JRCwgRXh0ZW5zaW9uLmRlZmF1bHRWYWx1ZXMoRVhUTl9JRCkpO1xuICAgICAgICB0aGlzLmNyaXRpY2FsID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ1JJVElDQUwsIEV4dGVuc2lvbi5kZWZhdWx0VmFsdWVzKENSSVRJQ0FMKSk7XG4gICAgICAgIGlmIChFWFROX1ZBTFVFIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZXh0blZhbHVlID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBwYXJhbWV0ZXJzLmV4dG5WYWx1ZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZXh0blZhbHVlID0gRXh0ZW5zaW9uLmRlZmF1bHRWYWx1ZXMoRVhUTl9WQUxVRSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFBBUlNFRF9WQUxVRSQ1IGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2VkVmFsdWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQQVJTRURfVkFMVUUkNSwgRXh0ZW5zaW9uLmRlZmF1bHRWYWx1ZXMoUEFSU0VEX1ZBTFVFJDUpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgRVhUTl9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBDUklUSUNBTDpcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBjYXNlIEVYVE5fVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgUEFSU0VEX1ZBTFVFJDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMuZXh0bklEIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Cb29sZWFuKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNyaXRpY2FsIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5leHRuVmFsdWUgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDEwKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBFeHRlbnNpb24uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgZXh0bklEOiBFWFROX0lELFxuICAgICAgICAgICAgICAgIGNyaXRpY2FsOiBDUklUSUNBTCxcbiAgICAgICAgICAgICAgICBleHRuVmFsdWU6IEVYVE5fVkFMVUVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmV4dG5JRCA9IGFzbjEucmVzdWx0LmV4dG5JRC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmIChDUklUSUNBTCBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5jcml0aWNhbCA9IGFzbjEucmVzdWx0LmNyaXRpY2FsLnZhbHVlQmxvY2sudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5leHRuVmFsdWUgPSBhc24xLnJlc3VsdC5leHRuVmFsdWU7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLmV4dG5JRCB9KSk7XG4gICAgICAgIGlmICh0aGlzLmNyaXRpY2FsICE9PSBFeHRlbnNpb24uZGVmYXVsdFZhbHVlcyhDUklUSUNBTCkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Cb29sZWFuKHsgdmFsdWU6IHRoaXMuY3JpdGljYWwgfSkpO1xuICAgICAgICB9XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5leHRuVmFsdWUpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBvYmplY3QgPSB7XG4gICAgICAgICAgICBleHRuSUQ6IHRoaXMuZXh0bklELFxuICAgICAgICAgICAgZXh0blZhbHVlOiB0aGlzLmV4dG5WYWx1ZS50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuY3JpdGljYWwgIT09IEV4dGVuc2lvbi5kZWZhdWx0VmFsdWVzKENSSVRJQ0FMKSkge1xuICAgICAgICAgICAgb2JqZWN0LmNyaXRpY2FsID0gdGhpcy5jcml0aWNhbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJzZWRWYWx1ZSAmJiB0aGlzLnBhcnNlZFZhbHVlLnRvSlNPTikge1xuICAgICAgICAgICAgb2JqZWN0LnBhcnNlZFZhbHVlID0gdGhpcy5wYXJzZWRWYWx1ZS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH1cbn1cbkV4dGVuc2lvbi5DTEFTU19OQU1FID0gXCJFeHRlbnNpb25cIjtcblxuY29uc3QgRVhURU5TSU9OUyQ1ID0gXCJleHRlbnNpb25zXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQkID0gW1xuICAgIEVYVEVOU0lPTlMkNSxcbl07XG5jbGFzcyBFeHRlbnNpb25zIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5leHRlbnNpb25zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRVhURU5TSU9OUyQ1LCBFeHRlbnNpb25zLmRlZmF1bHRWYWx1ZXMoRVhURU5TSU9OUyQ1KSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBFWFRFTlNJT05TJDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSwgb3B0aW9uYWwgPSBmYWxzZSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgb3B0aW9uYWwsXG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuZXh0ZW5zaW9ucyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogRXh0ZW5zaW9uLnNjaGVtYShuYW1lcy5leHRlbnNpb24gfHwge30pXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQkKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBFeHRlbnNpb25zLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGV4dGVuc2lvbnM6IEVYVEVOU0lPTlMkNVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuZXh0ZW5zaW9ucywgZWxlbWVudCA9PiBuZXcgRXh0ZW5zaW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmV4dGVuc2lvbnMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGV4dGVuc2lvbnM6IHRoaXMuZXh0ZW5zaW9ucy5tYXAobyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cbkV4dGVuc2lvbnMuQ0xBU1NfTkFNRSA9IFwiRXh0ZW5zaW9uc1wiO1xuXG5jb25zdCBJU1NVRVIkNSA9IFwiaXNzdWVyXCI7XG5jb25zdCBTRVJJQUxfTlVNQkVSJDYgPSBcInNlcmlhbE51bWJlclwiO1xuY29uc3QgSVNTVUVSX1VJRCA9IFwiaXNzdWVyVUlEXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRfID0gW1xuICAgIElTU1VFUiQ1LFxuICAgIFNFUklBTF9OVU1CRVIkNixcbiAgICBJU1NVRVJfVUlELFxuXTtcbmNsYXNzIElzc3VlclNlcmlhbCBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaXNzdWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSJDUsIElzc3VlclNlcmlhbC5kZWZhdWx0VmFsdWVzKElTU1VFUiQ1KSk7XG4gICAgICAgIHRoaXMuc2VyaWFsTnVtYmVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0VSSUFMX05VTUJFUiQ2LCBJc3N1ZXJTZXJpYWwuZGVmYXVsdFZhbHVlcyhTRVJJQUxfTlVNQkVSJDYpKTtcbiAgICAgICAgaWYgKElTU1VFUl9VSUQgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5pc3N1ZXJVSUQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBJU1NVRVJfVUlELCBJc3N1ZXJTZXJpYWwuZGVmYXVsdFZhbHVlcyhJU1NVRVJfVUlEKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIElTU1VFUiQ1OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgR2VuZXJhbE5hbWVzKCk7XG4gICAgICAgICAgICBjYXNlIFNFUklBTF9OVU1CRVIkNjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIElTU1VFUl9VSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuQml0U3RyaW5nKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIEdlbmVyYWxOYW1lcy5zY2hlbWEobmFtZXMuaXNzdWVyIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuc2VyaWFsTnVtYmVyIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5CaXRTdHJpbmcoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmlzc3VlclVJRCB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRfKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBJc3N1ZXJTZXJpYWwuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgaXNzdWVyOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IElTU1VFUiQ1XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNlcmlhbE51bWJlcjogU0VSSUFMX05VTUJFUiQ2LFxuICAgICAgICAgICAgICAgIGlzc3VlclVJRDogSVNTVUVSX1VJRFxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuaXNzdWVyID0gbmV3IEdlbmVyYWxOYW1lcyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuaXNzdWVyIH0pO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IGFzbjEucmVzdWx0LnNlcmlhbE51bWJlcjtcbiAgICAgICAgaWYgKElTU1VFUl9VSUQgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmlzc3VlclVJRCA9IGFzbjEucmVzdWx0Lmlzc3VlclVJRDtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICB0aGlzLmlzc3Vlci50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsTnVtYmVyXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5pc3N1ZXJVSUQpIHtcbiAgICAgICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2godGhpcy5pc3N1ZXJVSUQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgaXNzdWVyOiB0aGlzLmlzc3Vlci50b0pTT04oKSxcbiAgICAgICAgICAgIHNlcmlhbE51bWJlcjogdGhpcy5zZXJpYWxOdW1iZXIudG9KU09OKClcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuaXNzdWVyVUlEKSB7XG4gICAgICAgICAgICByZXN1bHQuaXNzdWVyVUlEID0gdGhpcy5pc3N1ZXJVSUQudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG59XG5Jc3N1ZXJTZXJpYWwuQ0xBU1NfTkFNRSA9IFwiSXNzdWVyU2VyaWFsXCI7XG5cbmNvbnN0IFZFUlNJT04kaCA9IFwidmVyc2lvblwiO1xuY29uc3QgQkFTRV9DRVJUSUZJQ0FURV9JRCQyID0gXCJiYXNlQ2VydGlmaWNhdGVJRFwiO1xuY29uc3QgU1VCSkVDVF9OQU1FID0gXCJzdWJqZWN0TmFtZVwiO1xuY29uc3QgSVNTVUVSJDQgPSBcImlzc3VlclwiO1xuY29uc3QgU0lHTkFUVVJFJDYgPSBcInNpZ25hdHVyZVwiO1xuY29uc3QgU0VSSUFMX05VTUJFUiQ1ID0gXCJzZXJpYWxOdW1iZXJcIjtcbmNvbnN0IEFUVFJfQ0VSVF9WQUxJRElUWV9QRVJJT0QkMSA9IFwiYXR0ckNlcnRWYWxpZGl0eVBlcmlvZFwiO1xuY29uc3QgQVRUUklCVVRFUyQzID0gXCJhdHRyaWJ1dGVzXCI7XG5jb25zdCBJU1NVRVJfVU5JUVVFX0lEJDIgPSBcImlzc3VlclVuaXF1ZUlEXCI7XG5jb25zdCBFWFRFTlNJT05TJDQgPSBcImV4dGVuc2lvbnNcIjtcbmNvbnN0IENMRUFSX1BST1BTJFogPSBbXG4gICAgVkVSU0lPTiRoLFxuICAgIEJBU0VfQ0VSVElGSUNBVEVfSUQkMixcbiAgICBTVUJKRUNUX05BTUUsXG4gICAgSVNTVUVSJDQsXG4gICAgU0lHTkFUVVJFJDYsXG4gICAgU0VSSUFMX05VTUJFUiQ1LFxuICAgIEFUVFJfQ0VSVF9WQUxJRElUWV9QRVJJT0QkMSxcbiAgICBBVFRSSUJVVEVTJDMsXG4gICAgSVNTVUVSX1VOSVFVRV9JRCQyLFxuICAgIEVYVEVOU0lPTlMkNCxcbl07XG5jbGFzcyBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kaCwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjEuZGVmYXVsdFZhbHVlcyhWRVJTSU9OJGgpKTtcbiAgICAgICAgaWYgKEJBU0VfQ0VSVElGSUNBVEVfSUQkMiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlEID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQkFTRV9DRVJUSUZJQ0FURV9JRCQyLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMS5kZWZhdWx0VmFsdWVzKEJBU0VfQ0VSVElGSUNBVEVfSUQkMikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChTVUJKRUNUX05BTUUgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5zdWJqZWN0TmFtZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNVQkpFQ1RfTkFNRSwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjEuZGVmYXVsdFZhbHVlcyhTVUJKRUNUX05BTUUpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzc3VlciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIElTU1VFUiQ0LCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMS5kZWZhdWx0VmFsdWVzKElTU1VFUiQ0KSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFJDYsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFJDYpKTtcbiAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTRVJJQUxfTlVNQkVSJDUsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxLmRlZmF1bHRWYWx1ZXMoU0VSSUFMX05VTUJFUiQ1KSk7XG4gICAgICAgIHRoaXMuYXR0ckNlcnRWYWxpZGl0eVBlcmlvZCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFUVFJfQ0VSVF9WQUxJRElUWV9QRVJJT0QkMSwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjEuZGVmYXVsdFZhbHVlcyhBVFRSX0NFUlRfVkFMSURJVFlfUEVSSU9EJDEpKTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQVRUUklCVVRFUyQzLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMS5kZWZhdWx0VmFsdWVzKEFUVFJJQlVURVMkMykpO1xuICAgICAgICBpZiAoSVNTVUVSX1VOSVFVRV9JRCQyIGluIHBhcmFtZXRlcnMpXG4gICAgICAgICAgICB0aGlzLmlzc3VlclVuaXF1ZUlEID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSX1VOSVFVRV9JRCQyLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMS5kZWZhdWx0VmFsdWVzKElTU1VFUl9VTklRVUVfSUQkMikpO1xuICAgICAgICBpZiAoRVhURU5TSU9OUyQ0IGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVYVEVOU0lPTlMkNCwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjEuZGVmYXVsdFZhbHVlcyhFWFRFTlNJT05TJDQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiRoOlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSBCQVNFX0NFUlRJRklDQVRFX0lEJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJc3N1ZXJTZXJpYWwoKTtcbiAgICAgICAgICAgIGNhc2UgU1VCSkVDVF9OQU1FOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgR2VuZXJhbE5hbWVzKCk7XG4gICAgICAgICAgICBjYXNlIElTU1VFUiQ0OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgR2VuZXJhbE5hbWVzKCk7XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRSQ2OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBTRVJJQUxfTlVNQkVSJDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBBVFRSX0NFUlRfVkFMSURJVFlfUEVSSU9EJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdHRDZXJ0VmFsaWRpdHlQZXJpb2QoKTtcbiAgICAgICAgICAgIGNhc2UgQVRUUklCVVRFUyQzOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSX1VOSVFVRV9JRCQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBFWFRFTlNJT05TJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBFeHRlbnNpb25zKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJhc2VDZXJ0aWZpY2F0ZUlEIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogSXNzdWVyU2VyaWFsLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnN1YmplY3ROYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogR2VuZXJhbE5hbWVzLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgR2VuZXJhbE5hbWVzLnNjaGVtYSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IChuYW1lcy5pc3N1ZXIgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2lnbmF0dXJlIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuc2VyaWFsTnVtYmVyIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgQXR0Q2VydFZhbGlkaXR5UGVyaW9kLnNjaGVtYShuYW1lcy5hdHRyQ2VydFZhbGlkaXR5UGVyaW9kIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmF0dHJpYnV0ZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBdHRyaWJ1dGUuc2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuaXNzdWVyVW5pcXVlSUQgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIEV4dGVuc2lvbnMuc2NoZW1hKG5hbWVzLmV4dGVuc2lvbnMgfHwge30sIHRydWUpXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkWik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjEuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgdmVyc2lvbjogVkVSU0lPTiRoLFxuICAgICAgICAgICAgICAgIGJhc2VDZXJ0aWZpY2F0ZUlEOiBCQVNFX0NFUlRJRklDQVRFX0lEJDIsXG4gICAgICAgICAgICAgICAgc3ViamVjdE5hbWU6IFNVQkpFQ1RfTkFNRSxcbiAgICAgICAgICAgICAgICBpc3N1ZXI6IElTU1VFUiQ0LFxuICAgICAgICAgICAgICAgIHNpZ25hdHVyZToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBTSUdOQVRVUkUkNlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzZXJpYWxOdW1iZXI6IFNFUklBTF9OVU1CRVIkNSxcbiAgICAgICAgICAgICAgICBhdHRyQ2VydFZhbGlkaXR5UGVyaW9kOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEFUVFJfQ0VSVF9WQUxJRElUWV9QRVJJT0QkMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiBBVFRSSUJVVEVTJDMsXG4gICAgICAgICAgICAgICAgaXNzdWVyVW5pcXVlSUQ6IElTU1VFUl9VTklRVUVfSUQkMixcbiAgICAgICAgICAgICAgICBleHRlbnNpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEVYVEVOU0lPTlMkNFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgaWYgKEJBU0VfQ0VSVElGSUNBVEVfSUQkMiBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5iYXNlQ2VydGlmaWNhdGVJRCA9IG5ldyBJc3N1ZXJTZXJpYWwoe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdC5iYXNlQ2VydGlmaWNhdGVJRC52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChTVUJKRUNUX05BTUUgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuc3ViamVjdE5hbWUgPSBuZXcgR2VuZXJhbE5hbWVzKHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYXNuMS5yZXN1bHQuc3ViamVjdE5hbWUudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzc3VlciA9IGFzbjEucmVzdWx0Lmlzc3VlcjtcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuc2lnbmF0dXJlIH0pO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IGFzbjEucmVzdWx0LnNlcmlhbE51bWJlcjtcbiAgICAgICAgdGhpcy5hdHRyQ2VydFZhbGlkaXR5UGVyaW9kID0gbmV3IEF0dENlcnRWYWxpZGl0eVBlcmlvZCh7IHNjaGVtYTogYXNuMS5yZXN1bHQuYXR0ckNlcnRWYWxpZGl0eVBlcmlvZCB9KTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5hdHRyaWJ1dGVzLnZhbHVlQmxvY2sudmFsdWUsIGVsZW1lbnQgPT4gbmV3IEF0dHJpYnV0ZSh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgICAgIGlmIChJU1NVRVJfVU5JUVVFX0lEJDIgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuaXNzdWVyVW5pcXVlSUQgPSBhc24xLnJlc3VsdC5pc3N1ZXJVbmlxdWVJRDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoRVhURU5TSU9OUyQ0IGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmV4dGVuc2lvbnMgPSBuZXcgRXh0ZW5zaW9ucyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuZXh0ZW5zaW9ucyB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSldXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5iYXNlQ2VydGlmaWNhdGVJRCkge1xuICAgICAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlELnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnN1YmplY3ROYW1lKSB7XG4gICAgICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuc3ViamVjdE5hbWUudG9TY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLmlzc3Vlci50b1NjaGVtYSgpKTtcbiAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLnNpZ25hdHVyZS50b1NjaGVtYSgpKTtcbiAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLnNlcmlhbE51bWJlcik7XG4gICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2godGhpcy5hdHRyQ2VydFZhbGlkaXR5UGVyaW9kLnRvU2NoZW1hKCkpO1xuICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5hdHRyaWJ1dGVzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgfSkpO1xuICAgICAgICBpZiAodGhpcy5pc3N1ZXJVbmlxdWVJRCkge1xuICAgICAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLmlzc3VlclVuaXF1ZUlEKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKHRoaXMuZXh0ZW5zaW9ucy50b1NjaGVtYSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvblxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5iYXNlQ2VydGlmaWNhdGVJRCkge1xuICAgICAgICAgICAgcmVzdWx0LmJhc2VDZXJ0aWZpY2F0ZUlEID0gdGhpcy5iYXNlQ2VydGlmaWNhdGVJRC50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdWJqZWN0TmFtZSkge1xuICAgICAgICAgICAgcmVzdWx0LnN1YmplY3ROYW1lID0gdGhpcy5zdWJqZWN0TmFtZS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQuaXNzdWVyID0gdGhpcy5pc3N1ZXIudG9KU09OKCk7XG4gICAgICAgIHJlc3VsdC5zaWduYXR1cmUgPSB0aGlzLnNpZ25hdHVyZS50b0pTT04oKTtcbiAgICAgICAgcmVzdWx0LnNlcmlhbE51bWJlciA9IHRoaXMuc2VyaWFsTnVtYmVyLnRvSlNPTigpO1xuICAgICAgICByZXN1bHQuYXR0ckNlcnRWYWxpZGl0eVBlcmlvZCA9IHRoaXMuYXR0ckNlcnRWYWxpZGl0eVBlcmlvZC50b0pTT04oKTtcbiAgICAgICAgcmVzdWx0LmF0dHJpYnV0ZXMgPSBBcnJheS5mcm9tKHRoaXMuYXR0cmlidXRlcywgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgaWYgKHRoaXMuaXNzdWVyVW5pcXVlSUQpIHtcbiAgICAgICAgICAgIHJlc3VsdC5pc3N1ZXJVbmlxdWVJRCA9IHRoaXMuaXNzdWVyVW5pcXVlSUQudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgcmVzdWx0LmV4dGVuc2lvbnMgPSB0aGlzLmV4dGVuc2lvbnMudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG59XG5BdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMS5DTEFTU19OQU1FID0gXCJBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMVwiO1xuXG5jb25zdCBBQ0lORk8kMSA9IFwiYWNpbmZvXCI7XG5jb25zdCBTSUdOQVRVUkVfQUxHT1JJVEhNJDcgPSBcInNpZ25hdHVyZUFsZ29yaXRobVwiO1xuY29uc3QgU0lHTkFUVVJFX1ZBTFVFJDQgPSBcInNpZ25hdHVyZVZhbHVlXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRZID0gW1xuICAgIEFDSU5GTyQxLFxuICAgIFNJR05BVFVSRV9WQUxVRSQ0LFxuICAgIFNJR05BVFVSRV9BTEdPUklUSE0kN1xuXTtcbmNsYXNzIEF0dHJpYnV0ZUNlcnRpZmljYXRlVjEgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmFjaW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFDSU5GTyQxLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYxLmRlZmF1bHRWYWx1ZXMoQUNJTkZPJDEpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkVfQUxHT1JJVEhNJDcsIEF0dHJpYnV0ZUNlcnRpZmljYXRlVjEuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfQUxHT1JJVEhNJDcpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVWYWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9WQUxVRSQ0LCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYxLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFX1ZBTFVFJDQpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEFDSU5GTyQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjEoKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX0FMR09SSVRITSQ3OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfVkFMVUUkNDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjEuc2NoZW1hKG5hbWVzLmFjaW5mbyB8fCB7fSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2lnbmF0dXJlQWxnb3JpdGhtIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5zaWduYXR1cmVWYWx1ZSB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkWSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQXR0cmlidXRlQ2VydGlmaWNhdGVWMS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBhY2luZm86IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQUNJTkZPJDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFNJR05BVFVSRV9BTEdPUklUSE0kN1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzaWduYXR1cmVWYWx1ZTogU0lHTkFUVVJFX1ZBTFVFJDRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmFjaW5mbyA9IG5ldyBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMSh7IHNjaGVtYTogYXNuMS5yZXN1bHQuYWNpbmZvIH0pO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5zaWduYXR1cmVBbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlVmFsdWUgPSBhc24xLnJlc3VsdC5zaWduYXR1cmVWYWx1ZTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMuYWNpbmZvLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWNpbmZvOiB0aGlzLmFjaW5mby50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobTogdGhpcy5zaWduYXR1cmVBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBzaWduYXR1cmVWYWx1ZTogdGhpcy5zaWduYXR1cmVWYWx1ZS50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5BdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYxLkNMQVNTX05BTUUgPSBcIkF0dHJpYnV0ZUNlcnRpZmljYXRlVjFcIjtcblxuY29uc3QgRElHRVNURURfT0JKRUNUX1RZUEUgPSBcImRpZ2VzdGVkT2JqZWN0VHlwZVwiO1xuY29uc3QgT1RIRVJfT0JKRUNUX1RZUEVfSUQgPSBcIm90aGVyT2JqZWN0VHlwZUlEXCI7XG5jb25zdCBESUdFU1RfQUxHT1JJVEhNJDIgPSBcImRpZ2VzdEFsZ29yaXRobVwiO1xuY29uc3QgT0JKRUNUX0RJR0VTVCA9IFwib2JqZWN0RGlnZXN0XCI7XG5jb25zdCBDTEVBUl9QUk9QUyRYID0gW1xuICAgIERJR0VTVEVEX09CSkVDVF9UWVBFLFxuICAgIE9USEVSX09CSkVDVF9UWVBFX0lELFxuICAgIERJR0VTVF9BTEdPUklUSE0kMixcbiAgICBPQkpFQ1RfRElHRVNULFxuXTtcbmNsYXNzIE9iamVjdERpZ2VzdEluZm8gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmRpZ2VzdGVkT2JqZWN0VHlwZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIERJR0VTVEVEX09CSkVDVF9UWVBFLCBPYmplY3REaWdlc3RJbmZvLmRlZmF1bHRWYWx1ZXMoRElHRVNURURfT0JKRUNUX1RZUEUpKTtcbiAgICAgICAgaWYgKE9USEVSX09CSkVDVF9UWVBFX0lEIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMub3RoZXJPYmplY3RUeXBlSUQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPVEhFUl9PQkpFQ1RfVFlQRV9JRCwgT2JqZWN0RGlnZXN0SW5mby5kZWZhdWx0VmFsdWVzKE9USEVSX09CSkVDVF9UWVBFX0lEKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kaWdlc3RBbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBESUdFU1RfQUxHT1JJVEhNJDIsIE9iamVjdERpZ2VzdEluZm8uZGVmYXVsdFZhbHVlcyhESUdFU1RfQUxHT1JJVEhNJDIpKTtcbiAgICAgICAgdGhpcy5vYmplY3REaWdlc3QgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPQkpFQ1RfRElHRVNULCBPYmplY3REaWdlc3RJbmZvLmRlZmF1bHRWYWx1ZXMoT0JKRUNUX0RJR0VTVCkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgRElHRVNURURfT0JKRUNUX1RZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuRW51bWVyYXRlZCgpO1xuICAgICAgICAgICAgY2FzZSBPVEhFUl9PQkpFQ1RfVFlQRV9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIERJR0VTVF9BTEdPUklUSE0kMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgT0JKRUNUX0RJR0VTVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5FbnVtZXJhdGVkKHsgbmFtZTogKG5hbWVzLmRpZ2VzdGVkT2JqZWN0VHlwZSB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMub3RoZXJPYmplY3RUeXBlSUQgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLmRpZ2VzdEFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5CaXRTdHJpbmcoeyBuYW1lOiAobmFtZXMub2JqZWN0RGlnZXN0IHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkWCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgT2JqZWN0RGlnZXN0SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBkaWdlc3RlZE9iamVjdFR5cGU6IERJR0VTVEVEX09CSkVDVF9UWVBFLFxuICAgICAgICAgICAgICAgIG90aGVyT2JqZWN0VHlwZUlEOiBPVEhFUl9PQkpFQ1RfVFlQRV9JRCxcbiAgICAgICAgICAgICAgICBkaWdlc3RBbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogRElHRVNUX0FMR09SSVRITSQyXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9iamVjdERpZ2VzdDogT0JKRUNUX0RJR0VTVFxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuZGlnZXN0ZWRPYmplY3RUeXBlID0gYXNuMS5yZXN1bHQuZGlnZXN0ZWRPYmplY3RUeXBlO1xuICAgICAgICBpZiAoT1RIRVJfT0JKRUNUX1RZUEVfSUQgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMub3RoZXJPYmplY3RUeXBlSUQgPSBhc24xLnJlc3VsdC5vdGhlck9iamVjdFR5cGVJRDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpZ2VzdEFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5kaWdlc3RBbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMub2JqZWN0RGlnZXN0ID0gYXNuMS5yZXN1bHQub2JqZWN0RGlnZXN0O1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW3RoaXMuZGlnZXN0ZWRPYmplY3RUeXBlXVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMub3RoZXJPYmplY3RUeXBlSUQpIHtcbiAgICAgICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2godGhpcy5vdGhlck9iamVjdFR5cGVJRCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLmRpZ2VzdEFsZ29yaXRobS50b1NjaGVtYSgpKTtcbiAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLm9iamVjdERpZ2VzdCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgZGlnZXN0ZWRPYmplY3RUeXBlOiB0aGlzLmRpZ2VzdGVkT2JqZWN0VHlwZS50b0pTT04oKSxcbiAgICAgICAgICAgIGRpZ2VzdEFsZ29yaXRobTogdGhpcy5kaWdlc3RBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBvYmplY3REaWdlc3Q6IHRoaXMub2JqZWN0RGlnZXN0LnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5vdGhlck9iamVjdFR5cGVJRCkge1xuICAgICAgICAgICAgcmVzdWx0Lm90aGVyT2JqZWN0VHlwZUlEID0gdGhpcy5vdGhlck9iamVjdFR5cGVJRC50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn1cbk9iamVjdERpZ2VzdEluZm8uQ0xBU1NfTkFNRSA9IFwiT2JqZWN0RGlnZXN0SW5mb1wiO1xuXG5jb25zdCBJU1NVRVJfTkFNRSA9IFwiaXNzdWVyTmFtZVwiO1xuY29uc3QgQkFTRV9DRVJUSUZJQ0FURV9JRCQxID0gXCJiYXNlQ2VydGlmaWNhdGVJRFwiO1xuY29uc3QgT0JKRUNUX0RJR0VTVF9JTkZPJDEgPSBcIm9iamVjdERpZ2VzdEluZm9cIjtcbmNvbnN0IENMRUFSX1BST1BTJFcgPSBbXG4gICAgSVNTVUVSX05BTUUsXG4gICAgQkFTRV9DRVJUSUZJQ0FURV9JRCQxLFxuICAgIE9CSkVDVF9ESUdFU1RfSU5GTyQxXG5dO1xuY2xhc3MgVjJGb3JtIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKElTU1VFUl9OQU1FIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuaXNzdWVyTmFtZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIElTU1VFUl9OQU1FLCBWMkZvcm0uZGVmYXVsdFZhbHVlcyhJU1NVRVJfTkFNRSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChCQVNFX0NFUlRJRklDQVRFX0lEJDEgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5iYXNlQ2VydGlmaWNhdGVJRCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEJBU0VfQ0VSVElGSUNBVEVfSUQkMSwgVjJGb3JtLmRlZmF1bHRWYWx1ZXMoQkFTRV9DRVJUSUZJQ0FURV9JRCQxKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE9CSkVDVF9ESUdFU1RfSU5GTyQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMub2JqZWN0RGlnZXN0SW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9CSkVDVF9ESUdFU1RfSU5GTyQxLCBWMkZvcm0uZGVmYXVsdFZhbHVlcyhPQkpFQ1RfRElHRVNUX0lORk8kMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBJU1NVRVJfTkFNRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyYWxOYW1lcygpO1xuICAgICAgICAgICAgY2FzZSBCQVNFX0NFUlRJRklDQVRFX0lEJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJc3N1ZXJTZXJpYWwoKTtcbiAgICAgICAgICAgIGNhc2UgT0JKRUNUX0RJR0VTVF9JTkZPJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBPYmplY3REaWdlc3RJbmZvKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIEdlbmVyYWxOYW1lcy5zY2hlbWEoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBuYW1lcy5pc3N1ZXJOYW1lXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCB0cnVlKSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5iYXNlQ2VydGlmaWNhdGVJRCB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogSXNzdWVyU2VyaWFsLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vYmplY3REaWdlc3RJbmZvIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBPYmplY3REaWdlc3RJbmZvLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJFcpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFYyRm9ybS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBpc3N1ZXJOYW1lOiBJU1NVRVJfTkFNRSxcbiAgICAgICAgICAgICAgICBiYXNlQ2VydGlmaWNhdGVJRDogQkFTRV9DRVJUSUZJQ0FURV9JRCQxLFxuICAgICAgICAgICAgICAgIG9iamVjdERpZ2VzdEluZm86IE9CSkVDVF9ESUdFU1RfSU5GTyQxXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKElTU1VFUl9OQU1FIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5pc3N1ZXJOYW1lID0gbmV3IEdlbmVyYWxOYW1lcyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuaXNzdWVyTmFtZSB9KTtcbiAgICAgICAgaWYgKEJBU0VfQ0VSVElGSUNBVEVfSUQkMSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5iYXNlQ2VydGlmaWNhdGVJRCA9IG5ldyBJc3N1ZXJTZXJpYWwoe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdC5iYXNlQ2VydGlmaWNhdGVJRC52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChPQkpFQ1RfRElHRVNUX0lORk8kMSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5vYmplY3REaWdlc3RJbmZvID0gbmV3IE9iamVjdERpZ2VzdEluZm8oe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdC5vYmplY3REaWdlc3RJbmZvLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBhc24xanMuU2VxdWVuY2UoKTtcbiAgICAgICAgaWYgKHRoaXMuaXNzdWVyTmFtZSlcbiAgICAgICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2godGhpcy5pc3N1ZXJOYW1lLnRvU2NoZW1hKCkpO1xuICAgICAgICBpZiAodGhpcy5iYXNlQ2VydGlmaWNhdGVJRCkge1xuICAgICAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlELnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9iamVjdERpZ2VzdEluZm8pIHtcbiAgICAgICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5vYmplY3REaWdlc3RJbmZvLnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgICAgIGlmICh0aGlzLmlzc3Vlck5hbWUpIHtcbiAgICAgICAgICAgIHJlc3VsdC5pc3N1ZXJOYW1lID0gdGhpcy5pc3N1ZXJOYW1lLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlEKSB7XG4gICAgICAgICAgICByZXN1bHQuYmFzZUNlcnRpZmljYXRlSUQgPSB0aGlzLmJhc2VDZXJ0aWZpY2F0ZUlELnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9iamVjdERpZ2VzdEluZm8pIHtcbiAgICAgICAgICAgIHJlc3VsdC5vYmplY3REaWdlc3RJbmZvID0gdGhpcy5vYmplY3REaWdlc3RJbmZvLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxufVxuVjJGb3JtLkNMQVNTX05BTUUgPSBcIlYyRm9ybVwiO1xuXG5jb25zdCBCQVNFX0NFUlRJRklDQVRFX0lEID0gXCJiYXNlQ2VydGlmaWNhdGVJRFwiO1xuY29uc3QgRU5USVRZX05BTUUgPSBcImVudGl0eU5hbWVcIjtcbmNvbnN0IE9CSkVDVF9ESUdFU1RfSU5GTyA9IFwib2JqZWN0RGlnZXN0SW5mb1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkViA9IFtcbiAgICBCQVNFX0NFUlRJRklDQVRFX0lELFxuICAgIEVOVElUWV9OQU1FLFxuICAgIE9CSkVDVF9ESUdFU1RfSU5GT1xuXTtcbmNsYXNzIEhvbGRlciBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGlmIChCQVNFX0NFUlRJRklDQVRFX0lEIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuYmFzZUNlcnRpZmljYXRlSUQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBCQVNFX0NFUlRJRklDQVRFX0lELCBIb2xkZXIuZGVmYXVsdFZhbHVlcyhCQVNFX0NFUlRJRklDQVRFX0lEKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEVOVElUWV9OQU1FIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZW50aXR5TmFtZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOVElUWV9OQU1FLCBIb2xkZXIuZGVmYXVsdFZhbHVlcyhFTlRJVFlfTkFNRSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChPQkpFQ1RfRElHRVNUX0lORk8gaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5vYmplY3REaWdlc3RJbmZvID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT0JKRUNUX0RJR0VTVF9JTkZPLCBIb2xkZXIuZGVmYXVsdFZhbHVlcyhPQkpFQ1RfRElHRVNUX0lORk8pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQkFTRV9DRVJUSUZJQ0FURV9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IElzc3VlclNlcmlhbCgpO1xuICAgICAgICAgICAgY2FzZSBFTlRJVFlfTkFNRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyYWxOYW1lcygpO1xuICAgICAgICAgICAgY2FzZSBPQkpFQ1RfRElHRVNUX0lORk86XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBPYmplY3REaWdlc3RJbmZvKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJhc2VDZXJ0aWZpY2F0ZUlEIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBJc3N1ZXJTZXJpYWwuc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmVudGl0eU5hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEdlbmVyYWxOYW1lcy5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMub2JqZWN0RGlnZXN0SW5mbyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogT2JqZWN0RGlnZXN0SW5mby5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRWKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBIb2xkZXIuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYmFzZUNlcnRpZmljYXRlSUQ6IEJBU0VfQ0VSVElGSUNBVEVfSUQsXG4gICAgICAgICAgICAgICAgZW50aXR5TmFtZTogRU5USVRZX05BTUUsXG4gICAgICAgICAgICAgICAgb2JqZWN0RGlnZXN0SW5mbzogT0JKRUNUX0RJR0VTVF9JTkZPXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKEJBU0VfQ0VSVElGSUNBVEVfSUQgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuYmFzZUNlcnRpZmljYXRlSUQgPSBuZXcgSXNzdWVyU2VyaWFsKHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYXNuMS5yZXN1bHQuYmFzZUNlcnRpZmljYXRlSUQudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoRU5USVRZX05BTUUgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuZW50aXR5TmFtZSA9IG5ldyBHZW5lcmFsTmFtZXMoe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdC5lbnRpdHlOYW1lLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE9CSkVDVF9ESUdFU1RfSU5GTyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5vYmplY3REaWdlc3RJbmZvID0gbmV3IE9iamVjdERpZ2VzdEluZm8oe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdC5vYmplY3REaWdlc3RJbmZvLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBhc24xanMuU2VxdWVuY2UoKTtcbiAgICAgICAgaWYgKHRoaXMuYmFzZUNlcnRpZmljYXRlSUQpIHtcbiAgICAgICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5iYXNlQ2VydGlmaWNhdGVJRC50b1NjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5lbnRpdHlOYW1lKSB7XG4gICAgICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuZW50aXR5TmFtZS50b1NjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vYmplY3REaWdlc3RJbmZvKSB7XG4gICAgICAgICAgICByZXN1bHQudmFsdWVCbG9jay52YWx1ZS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMub2JqZWN0RGlnZXN0SW5mby50b1NjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgICAgICBpZiAodGhpcy5iYXNlQ2VydGlmaWNhdGVJRCkge1xuICAgICAgICAgICAgcmVzdWx0LmJhc2VDZXJ0aWZpY2F0ZUlEID0gdGhpcy5iYXNlQ2VydGlmaWNhdGVJRC50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5lbnRpdHlOYW1lKSB7XG4gICAgICAgICAgICByZXN1bHQuZW50aXR5TmFtZSA9IHRoaXMuZW50aXR5TmFtZS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vYmplY3REaWdlc3RJbmZvKSB7XG4gICAgICAgICAgICByZXN1bHQub2JqZWN0RGlnZXN0SW5mbyA9IHRoaXMub2JqZWN0RGlnZXN0SW5mby50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn1cbkhvbGRlci5DTEFTU19OQU1FID0gXCJIb2xkZXJcIjtcblxuY29uc3QgVkVSU0lPTiRnID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBIT0xERVIgPSBcImhvbGRlclwiO1xuY29uc3QgSVNTVUVSJDMgPSBcImlzc3VlclwiO1xuY29uc3QgU0lHTkFUVVJFJDUgPSBcInNpZ25hdHVyZVwiO1xuY29uc3QgU0VSSUFMX05VTUJFUiQ0ID0gXCJzZXJpYWxOdW1iZXJcIjtcbmNvbnN0IEFUVFJfQ0VSVF9WQUxJRElUWV9QRVJJT0QgPSBcImF0dHJDZXJ0VmFsaWRpdHlQZXJpb2RcIjtcbmNvbnN0IEFUVFJJQlVURVMkMiA9IFwiYXR0cmlidXRlc1wiO1xuY29uc3QgSVNTVUVSX1VOSVFVRV9JRCQxID0gXCJpc3N1ZXJVbmlxdWVJRFwiO1xuY29uc3QgRVhURU5TSU9OUyQzID0gXCJleHRlbnNpb25zXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRVID0gW1xuICAgIFZFUlNJT04kZyxcbiAgICBIT0xERVIsXG4gICAgSVNTVUVSJDMsXG4gICAgU0lHTkFUVVJFJDUsXG4gICAgU0VSSUFMX05VTUJFUiQ0LFxuICAgIEFUVFJfQ0VSVF9WQUxJRElUWV9QRVJJT0QsXG4gICAgQVRUUklCVVRFUyQyLFxuICAgIElTU1VFUl9VTklRVUVfSUQkMSxcbiAgICBFWFRFTlNJT05TJDNcbl07XG5jbGFzcyBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMiBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kZywgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjIuZGVmYXVsdFZhbHVlcyhWRVJTSU9OJGcpKTtcbiAgICAgICAgdGhpcy5ob2xkZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBIT0xERVIsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YyLmRlZmF1bHRWYWx1ZXMoSE9MREVSKSk7XG4gICAgICAgIHRoaXMuaXNzdWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSJDMsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YyLmRlZmF1bHRWYWx1ZXMoSVNTVUVSJDMpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkUkNSwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjIuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkUkNSkpO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNFUklBTF9OVU1CRVIkNCwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjIuZGVmYXVsdFZhbHVlcyhTRVJJQUxfTlVNQkVSJDQpKTtcbiAgICAgICAgdGhpcy5hdHRyQ2VydFZhbGlkaXR5UGVyaW9kID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQVRUUl9DRVJUX1ZBTElESVRZX1BFUklPRCwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjIuZGVmYXVsdFZhbHVlcyhBVFRSX0NFUlRfVkFMSURJVFlfUEVSSU9EKSk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFUVFJJQlVURVMkMiwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjIuZGVmYXVsdFZhbHVlcyhBVFRSSUJVVEVTJDIpKTtcbiAgICAgICAgaWYgKElTU1VFUl9VTklRVUVfSUQkMSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmlzc3VlclVuaXF1ZUlEID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSX1VOSVFVRV9JRCQxLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMi5kZWZhdWx0VmFsdWVzKElTU1VFUl9VTklRVUVfSUQkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChFWFRFTlNJT05TJDMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5leHRlbnNpb25zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRVhURU5TSU9OUyQzLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMi5kZWZhdWx0VmFsdWVzKEVYVEVOU0lPTlMkMykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICBjYXNlIEhPTERFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEhvbGRlcigpO1xuICAgICAgICAgICAgY2FzZSBJU1NVRVIkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRSQ1OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBTRVJJQUxfTlVNQkVSJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBBVFRSX0NFUlRfVkFMSURJVFlfUEVSSU9EOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXR0Q2VydFZhbGlkaXR5UGVyaW9kKCk7XG4gICAgICAgICAgICBjYXNlIEFUVFJJQlVURVMkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIElTU1VFUl9VTklRVUVfSUQkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgRVhURU5TSU9OUyQzOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRXh0ZW5zaW9ucygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudmVyc2lvbiB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIEhvbGRlci5zY2hlbWEobmFtZXMuaG9sZGVyIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBHZW5lcmFsTmFtZXMuc2NoZW1hKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IChuYW1lcy5pc3N1ZXIgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmlzc3VlciB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFYyRm9ybS5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2lnbmF0dXJlIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuc2VyaWFsTnVtYmVyIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgQXR0Q2VydFZhbGlkaXR5UGVyaW9kLnNjaGVtYShuYW1lcy5hdHRyQ2VydFZhbGlkaXR5UGVyaW9kIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmF0dHJpYnV0ZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBdHRyaWJ1dGUuc2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuaXNzdWVyVW5pcXVlSUQgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIEV4dGVuc2lvbnMuc2NoZW1hKG5hbWVzLmV4dGVuc2lvbnMgfHwge30sIHRydWUpXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkVSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjIuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgdmVyc2lvbjogVkVSU0lPTiRnLFxuICAgICAgICAgICAgICAgIGhvbGRlcjoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBIT0xERVJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaXNzdWVyOiBJU1NVRVIkMyxcbiAgICAgICAgICAgICAgICBzaWduYXR1cmU6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogU0lHTkFUVVJFJDVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiBTRVJJQUxfTlVNQkVSJDQsXG4gICAgICAgICAgICAgICAgYXR0ckNlcnRWYWxpZGl0eVBlcmlvZDoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBBVFRSX0NFUlRfVkFMSURJVFlfUEVSSU9EXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IEFUVFJJQlVURVMkMixcbiAgICAgICAgICAgICAgICBpc3N1ZXJVbmlxdWVJRDogSVNTVUVSX1VOSVFVRV9JRCQxLFxuICAgICAgICAgICAgICAgIGV4dGVuc2lvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogRVhURU5TSU9OUyQzXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gYXNuMS5yZXN1bHQudmVyc2lvbi52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLmhvbGRlciA9IG5ldyBIb2xkZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmhvbGRlciB9KTtcbiAgICAgICAgc3dpdGNoIChhc24xLnJlc3VsdC5pc3N1ZXIuaWRCbG9jay50YWdDbGFzcykge1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHRoaXMuaXNzdWVyID0gbmV3IFYyRm9ybSh7XG4gICAgICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYXNuMS5yZXN1bHQuaXNzdWVyLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0IHZhbHVlIGZvciAnaXNzdWVyJyBpbiBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNpZ25hdHVyZSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5zaWduYXR1cmUgfSk7XG4gICAgICAgIHRoaXMuc2VyaWFsTnVtYmVyID0gYXNuMS5yZXN1bHQuc2VyaWFsTnVtYmVyO1xuICAgICAgICB0aGlzLmF0dHJDZXJ0VmFsaWRpdHlQZXJpb2QgPSBuZXcgQXR0Q2VydFZhbGlkaXR5UGVyaW9kKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5hdHRyQ2VydFZhbGlkaXR5UGVyaW9kIH0pO1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmF0dHJpYnV0ZXMudmFsdWVCbG9jay52YWx1ZSwgZWxlbWVudCA9PiBuZXcgQXR0cmlidXRlKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgaWYgKElTU1VFUl9VTklRVUVfSUQkMSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5pc3N1ZXJVbmlxdWVJRCA9IGFzbjEucmVzdWx0Lmlzc3VlclVuaXF1ZUlEO1xuICAgICAgICB9XG4gICAgICAgIGlmIChFWFRFTlNJT05TJDMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IG5ldyBFeHRlbnNpb25zKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5leHRlbnNpb25zIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KSxcbiAgICAgICAgICAgICAgICB0aGlzLmhvbGRlci50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5pc3N1ZXIudG9TY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgdGhpcy5zaWduYXR1cmUudG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLnNlcmlhbE51bWJlcixcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHJDZXJ0VmFsaWRpdHlQZXJpb2QudG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5hdHRyaWJ1dGVzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuaXNzdWVyVW5pcXVlSUQpIHtcbiAgICAgICAgICAgIHJlc3VsdC52YWx1ZUJsb2NrLnZhbHVlLnB1c2godGhpcy5pc3N1ZXJVbmlxdWVJRCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgcmVzdWx0LnZhbHVlQmxvY2sudmFsdWUucHVzaCh0aGlzLmV4dGVuc2lvbnMudG9TY2hlbWEoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnZlcnNpb24sXG4gICAgICAgICAgICBob2xkZXI6IHRoaXMuaG9sZGVyLnRvSlNPTigpLFxuICAgICAgICAgICAgaXNzdWVyOiB0aGlzLmlzc3Vlci50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZTogdGhpcy5zaWduYXR1cmUudG9KU09OKCksXG4gICAgICAgICAgICBzZXJpYWxOdW1iZXI6IHRoaXMuc2VyaWFsTnVtYmVyLnRvSlNPTigpLFxuICAgICAgICAgICAgYXR0ckNlcnRWYWxpZGl0eVBlcmlvZDogdGhpcy5hdHRyQ2VydFZhbGlkaXR5UGVyaW9kLnRvSlNPTigpLFxuICAgICAgICAgICAgYXR0cmlidXRlczogQXJyYXkuZnJvbSh0aGlzLmF0dHJpYnV0ZXMsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuaXNzdWVyVW5pcXVlSUQpIHtcbiAgICAgICAgICAgIHJlc3VsdC5pc3N1ZXJVbmlxdWVJRCA9IHRoaXMuaXNzdWVyVW5pcXVlSUQudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgcmVzdWx0LmV4dGVuc2lvbnMgPSB0aGlzLmV4dGVuc2lvbnMudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG59XG5BdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMi5DTEFTU19OQU1FID0gXCJBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMlwiO1xuXG5jb25zdCBBQ0lORk8gPSBcImFjaW5mb1wiO1xuY29uc3QgU0lHTkFUVVJFX0FMR09SSVRITSQ2ID0gXCJzaWduYXR1cmVBbGdvcml0aG1cIjtcbmNvbnN0IFNJR05BVFVSRV9WQUxVRSQzID0gXCJzaWduYXR1cmVWYWx1ZVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkVCA9IFtcbiAgICBBQ0lORk8sXG4gICAgU0lHTkFUVVJFX0FMR09SSVRITSQ2LFxuICAgIFNJR05BVFVSRV9WQUxVRSQzLFxuXTtcbmNsYXNzIEF0dHJpYnV0ZUNlcnRpZmljYXRlVjIgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmFjaW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFDSU5GTywgQXR0cmlidXRlQ2VydGlmaWNhdGVWMi5kZWZhdWx0VmFsdWVzKEFDSU5GTykpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9BTEdPUklUSE0kNiwgQXR0cmlidXRlQ2VydGlmaWNhdGVWMi5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRV9BTEdPUklUSE0kNikpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFX1ZBTFVFJDMsIEF0dHJpYnV0ZUNlcnRpZmljYXRlVjIuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfVkFMVUUkMykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQUNJTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjIoKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX0FMR09SSVRITSQ2OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfVkFMVUUkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjIuc2NoZW1hKG5hbWVzLmFjaW5mbyB8fCB7fSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2lnbmF0dXJlQWxnb3JpdGhtIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5zaWduYXR1cmVWYWx1ZSB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkVCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQXR0cmlidXRlQ2VydGlmaWNhdGVWMi5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBhY2luZm86IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQUNJTkZPXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBTSUdOQVRVUkVfQUxHT1JJVEhNJDZcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2lnbmF0dXJlVmFsdWU6IFNJR05BVFVSRV9WQUxVRSQzXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5hY2luZm8gPSBuZXcgQXR0cmlidXRlQ2VydGlmaWNhdGVJbmZvVjIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmFjaW5mbyB9KTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuc2lnbmF0dXJlQWxnb3JpdGhtIH0pO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlID0gYXNuMS5yZXN1bHQuc2lnbmF0dXJlVmFsdWU7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICB0aGlzLmFjaW5mby50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgdGhpcy5zaWduYXR1cmVWYWx1ZVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFjaW5mbzogdGhpcy5hY2luZm8udG9KU09OKCksXG4gICAgICAgICAgICBzaWduYXR1cmVBbGdvcml0aG06IHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtLnRvSlNPTigpLFxuICAgICAgICAgICAgc2lnbmF0dXJlVmFsdWU6IHRoaXMuc2lnbmF0dXJlVmFsdWUudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgfVxufVxuQXR0cmlidXRlQ2VydGlmaWNhdGVWMi5DTEFTU19OQU1FID0gXCJBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYyXCI7XG5cbmNvbnN0IENPTlRFTlRfVFlQRSA9IFwiY29udGVudFR5cGVcIjtcbmNvbnN0IENPTlRFTlQgPSBcImNvbnRlbnRcIjtcbmNvbnN0IENMRUFSX1BST1BTJFMgPSBbQ09OVEVOVF9UWVBFLCBDT05URU5UXTtcbmNsYXNzIENvbnRlbnRJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5jb250ZW50VHlwZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENPTlRFTlRfVFlQRSwgQ29udGVudEluZm8uZGVmYXVsdFZhbHVlcyhDT05URU5UX1RZUEUpKTtcbiAgICAgICAgdGhpcy5jb250ZW50ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ09OVEVOVCwgQ29udGVudEluZm8uZGVmYXVsdFZhbHVlcyhDT05URU5UKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDT05URU5UX1RZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgQ09OVEVOVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ09OVEVOVF9UWVBFOlxuICAgICAgICAgICAgICAgIHJldHVybiAodHlwZW9mIG1lbWJlclZhbHVlID09PSBcInN0cmluZ1wiICYmXG4gICAgICAgICAgICAgICAgICAgIG1lbWJlclZhbHVlID09PSB0aGlzLmRlZmF1bHRWYWx1ZXMoQ09OVEVOVF9UWVBFKSk7XG4gICAgICAgICAgICBjYXNlIENPTlRFTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICBpZiAoKFwib3B0aW9uYWxcIiBpbiBuYW1lcykgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBuYW1lcy5vcHRpb25hbCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IFwiQ29udGVudEluZm9cIiksXG4gICAgICAgICAgICBvcHRpb25hbDogbmFtZXMub3B0aW9uYWwsXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5jb250ZW50VHlwZSB8fCBDT05URU5UX1RZUEUpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuQW55KHsgbmFtZTogKG5hbWVzLmNvbnRlbnQgfHwgQ09OVEVOVCkgfSldXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRTKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBDb250ZW50SW5mby5zY2hlbWEoKSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuY29udGVudFR5cGUgPSBhc24xLnJlc3VsdC5jb250ZW50VHlwZS52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMuY29udGVudCA9IGFzbjEucmVzdWx0LmNvbnRlbnQ7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5jb250ZW50VHlwZSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFt0aGlzLmNvbnRlbnRdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IHtcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlOiB0aGlzLmNvbnRlbnRUeXBlXG4gICAgICAgIH07XG4gICAgICAgIGlmICghKHRoaXMuY29udGVudCBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpKSB7XG4gICAgICAgICAgICBvYmplY3QuY29udGVudCA9IHRoaXMuY29udGVudC50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH1cbn1cbkNvbnRlbnRJbmZvLkNMQVNTX05BTUUgPSBcIkNvbnRlbnRJbmZvXCI7XG5Db250ZW50SW5mby5EQVRBID0gaWRfQ29udGVudFR5cGVfRGF0YTtcbkNvbnRlbnRJbmZvLlNJR05FRF9EQVRBID0gaWRfQ29udGVudFR5cGVfU2lnbmVkRGF0YTtcbkNvbnRlbnRJbmZvLkVOVkVMT1BFRF9EQVRBID0gaWRfQ29udGVudFR5cGVfRW52ZWxvcGVkRGF0YTtcbkNvbnRlbnRJbmZvLkVOQ1JZUFRFRF9EQVRBID0gaWRfQ29udGVudFR5cGVfRW5jcnlwdGVkRGF0YTtcblxuY29uc3QgVFlQRSQxID0gXCJ0eXBlXCI7XG5jb25zdCBWQUxVRSQ0ID0gXCJ2YWx1ZVwiO1xuY29uc3QgVVRDX1RJTUVfTkFNRSA9IFwidXRjVGltZU5hbWVcIjtcbmNvbnN0IEdFTkVSQUxfVElNRV9OQU1FID0gXCJnZW5lcmFsVGltZU5hbWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJFIgPSBbVVRDX1RJTUVfTkFNRSwgR0VORVJBTF9USU1FX05BTUVdO1xudmFyIFRpbWVUeXBlO1xuKGZ1bmN0aW9uIChUaW1lVHlwZSkge1xuICAgIFRpbWVUeXBlW1RpbWVUeXBlW1wiVVRDVGltZVwiXSA9IDBdID0gXCJVVENUaW1lXCI7XG4gICAgVGltZVR5cGVbVGltZVR5cGVbXCJHZW5lcmFsaXplZFRpbWVcIl0gPSAxXSA9IFwiR2VuZXJhbGl6ZWRUaW1lXCI7XG4gICAgVGltZVR5cGVbVGltZVR5cGVbXCJlbXB0eVwiXSA9IDJdID0gXCJlbXB0eVwiO1xufSkoVGltZVR5cGUgfHwgKFRpbWVUeXBlID0ge30pKTtcbmNsYXNzIFRpbWUgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnR5cGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBUWVBFJDEsIFRpbWUuZGVmYXVsdFZhbHVlcyhUWVBFJDEpKTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZBTFVFJDQsIFRpbWUuZGVmYXVsdFZhbHVlcyhWQUxVRSQ0KSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUWVBFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIFZBTFVFJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKDAsIDAsIDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSwgb3B0aW9uYWwgPSBmYWxzZSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgIG9wdGlvbmFsLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlVUQ1RpbWUoeyBuYW1lOiAobmFtZXMudXRjVGltZU5hbWUgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IG5hbWU6IChuYW1lcy5nZW5lcmFsVGltZU5hbWUgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJFIpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFRpbWUuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgdXRjVGltZU5hbWU6IFVUQ19USU1FX05BTUUsXG4gICAgICAgICAgICAgICAgZ2VuZXJhbFRpbWVOYW1lOiBHRU5FUkFMX1RJTUVfTkFNRVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChVVENfVElNRV9OQU1FIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSAwO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFzbjEucmVzdWx0LnV0Y1RpbWVOYW1lLnRvRGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChHRU5FUkFMX1RJTUVfTkFNRSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy50eXBlID0gMTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBhc24xLnJlc3VsdC5nZW5lcmFsVGltZU5hbWUudG9EYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGlmICh0aGlzLnR5cGUgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLlVUQ1RpbWUoeyB2YWx1ZURhdGU6IHRoaXMudmFsdWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy50eXBlID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoeyB2YWx1ZURhdGU6IHRoaXMudmFsdWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiB0aGlzLnR5cGUsXG4gICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZVxuICAgICAgICB9O1xuICAgIH1cbn1cblRpbWUuQ0xBU1NfTkFNRSA9IFwiVGltZVwiO1xuXG5jb25zdCBUQlMkNCA9IFwidGJzXCI7XG5jb25zdCBWRVJTSU9OJGYgPSBcInZlcnNpb25cIjtcbmNvbnN0IFNFUklBTF9OVU1CRVIkMyA9IFwic2VyaWFsTnVtYmVyXCI7XG5jb25zdCBTSUdOQVRVUkUkNCA9IFwic2lnbmF0dXJlXCI7XG5jb25zdCBJU1NVRVIkMiA9IFwiaXNzdWVyXCI7XG5jb25zdCBOT1RfQkVGT1JFID0gXCJub3RCZWZvcmVcIjtcbmNvbnN0IE5PVF9BRlRFUiA9IFwibm90QWZ0ZXJcIjtcbmNvbnN0IFNVQkpFQ1QkMSA9IFwic3ViamVjdFwiO1xuY29uc3QgU1VCSkVDVF9QVUJMSUNfS0VZX0lORk8gPSBcInN1YmplY3RQdWJsaWNLZXlJbmZvXCI7XG5jb25zdCBJU1NVRVJfVU5JUVVFX0lEID0gXCJpc3N1ZXJVbmlxdWVJRFwiO1xuY29uc3QgU1VCSkVDVF9VTklRVUVfSUQgPSBcInN1YmplY3RVbmlxdWVJRFwiO1xuY29uc3QgRVhURU5TSU9OUyQyID0gXCJleHRlbnNpb25zXCI7XG5jb25zdCBTSUdOQVRVUkVfQUxHT1JJVEhNJDUgPSBcInNpZ25hdHVyZUFsZ29yaXRobVwiO1xuY29uc3QgU0lHTkFUVVJFX1ZBTFVFJDIgPSBcInNpZ25hdHVyZVZhbHVlXCI7XG5jb25zdCBUQlNfQ0VSVElGSUNBVEUgPSBcInRic0NlcnRpZmljYXRlXCI7XG5jb25zdCBUQlNfQ0VSVElGSUNBVEVfVkVSU0lPTiA9IGAke1RCU19DRVJUSUZJQ0FURX0uJHtWRVJTSU9OJGZ9YDtcbmNvbnN0IFRCU19DRVJUSUZJQ0FURV9TRVJJQUxfTlVNQkVSID0gYCR7VEJTX0NFUlRJRklDQVRFfS4ke1NFUklBTF9OVU1CRVIkM31gO1xuY29uc3QgVEJTX0NFUlRJRklDQVRFX1NJR05BVFVSRSA9IGAke1RCU19DRVJUSUZJQ0FURX0uJHtTSUdOQVRVUkUkNH1gO1xuY29uc3QgVEJTX0NFUlRJRklDQVRFX0lTU1VFUiA9IGAke1RCU19DRVJUSUZJQ0FURX0uJHtJU1NVRVIkMn1gO1xuY29uc3QgVEJTX0NFUlRJRklDQVRFX05PVF9CRUZPUkUgPSBgJHtUQlNfQ0VSVElGSUNBVEV9LiR7Tk9UX0JFRk9SRX1gO1xuY29uc3QgVEJTX0NFUlRJRklDQVRFX05PVF9BRlRFUiA9IGAke1RCU19DRVJUSUZJQ0FURX0uJHtOT1RfQUZURVJ9YDtcbmNvbnN0IFRCU19DRVJUSUZJQ0FURV9TVUJKRUNUID0gYCR7VEJTX0NFUlRJRklDQVRFfS4ke1NVQkpFQ1QkMX1gO1xuY29uc3QgVEJTX0NFUlRJRklDQVRFX1NVQkpFQ1RfUFVCTElDX0tFWSA9IGAke1RCU19DRVJUSUZJQ0FURX0uJHtTVUJKRUNUX1BVQkxJQ19LRVlfSU5GT31gO1xuY29uc3QgVEJTX0NFUlRJRklDQVRFX0lTU1VFUl9VTklRVUVfSUQgPSBgJHtUQlNfQ0VSVElGSUNBVEV9LiR7SVNTVUVSX1VOSVFVRV9JRH1gO1xuY29uc3QgVEJTX0NFUlRJRklDQVRFX1NVQkpFQ1RfVU5JUVVFX0lEID0gYCR7VEJTX0NFUlRJRklDQVRFfS4ke1NVQkpFQ1RfVU5JUVVFX0lEfWA7XG5jb25zdCBUQlNfQ0VSVElGSUNBVEVfRVhURU5TSU9OUyA9IGAke1RCU19DRVJUSUZJQ0FURX0uJHtFWFRFTlNJT05TJDJ9YDtcbmNvbnN0IENMRUFSX1BST1BTJFEgPSBbXG4gICAgVEJTX0NFUlRJRklDQVRFLFxuICAgIFRCU19DRVJUSUZJQ0FURV9WRVJTSU9OLFxuICAgIFRCU19DRVJUSUZJQ0FURV9TRVJJQUxfTlVNQkVSLFxuICAgIFRCU19DRVJUSUZJQ0FURV9TSUdOQVRVUkUsXG4gICAgVEJTX0NFUlRJRklDQVRFX0lTU1VFUixcbiAgICBUQlNfQ0VSVElGSUNBVEVfTk9UX0JFRk9SRSxcbiAgICBUQlNfQ0VSVElGSUNBVEVfTk9UX0FGVEVSLFxuICAgIFRCU19DRVJUSUZJQ0FURV9TVUJKRUNULFxuICAgIFRCU19DRVJUSUZJQ0FURV9TVUJKRUNUX1BVQkxJQ19LRVksXG4gICAgVEJTX0NFUlRJRklDQVRFX0lTU1VFUl9VTklRVUVfSUQsXG4gICAgVEJTX0NFUlRJRklDQVRFX1NVQkpFQ1RfVU5JUVVFX0lELFxuICAgIFRCU19DRVJUSUZJQ0FURV9FWFRFTlNJT05TLFxuICAgIFNJR05BVFVSRV9BTEdPUklUSE0kNSxcbiAgICBTSUdOQVRVUkVfVkFMVUUkMlxuXTtcbmZ1bmN0aW9uIHRic0NlcnRpZmljYXRlKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBUQlNfQ0VSVElGSUNBVEUpLFxuICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudGJzQ2VydGlmaWNhdGVWZXJzaW9uIHx8IFRCU19DRVJUSUZJQ0FURV9WRVJTSU9OKSB9KVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnRic0NlcnRpZmljYXRlU2VyaWFsTnVtYmVyIHx8IFRCU19DRVJUSUZJQ0FURV9TRVJJQUxfTlVNQkVSKSB9KSxcbiAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnNpZ25hdHVyZSB8fCB7XG4gICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBUQlNfQ0VSVElGSUNBVEVfU0lHTkFUVVJFXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcy5zY2hlbWEobmFtZXMuaXNzdWVyIHx8IHtcbiAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRCU19DRVJUSUZJQ0FURV9JU1NVRVJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy50YnNDZXJ0aWZpY2F0ZVZhbGlkaXR5IHx8IFwidGJzQ2VydGlmaWNhdGUudmFsaWRpdHlcIiksXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgVGltZS5zY2hlbWEobmFtZXMubm90QmVmb3JlIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRjVGltZU5hbWU6IFRCU19DRVJUSUZJQ0FURV9OT1RfQkVGT1JFLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdlbmVyYWxUaW1lTmFtZTogVEJTX0NFUlRJRklDQVRFX05PVF9CRUZPUkVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgIFRpbWUuc2NoZW1hKG5hbWVzLm5vdEFmdGVyIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRjVGltZU5hbWU6IFRCU19DRVJUSUZJQ0FURV9OT1RfQUZURVIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2VuZXJhbFRpbWVOYW1lOiBUQlNfQ0VSVElGSUNBVEVfTk9UX0FGVEVSXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcy5zY2hlbWEobmFtZXMuc3ViamVjdCB8fCB7XG4gICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBUQlNfQ0VSVElGSUNBVEVfU1VCSkVDVFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgUHVibGljS2V5SW5mby5zY2hlbWEobmFtZXMuc3ViamVjdFB1YmxpY0tleUluZm8gfHwge1xuICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogVEJTX0NFUlRJRklDQVRFX1NVQkpFQ1RfUFVCTElDX0tFWVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy50YnNDZXJ0aWZpY2F0ZUlzc3VlclVuaXF1ZUlEIHx8IFRCU19DRVJUSUZJQ0FURV9JU1NVRVJfVU5JUVVFX0lEKSxcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMudGJzQ2VydGlmaWNhdGVTdWJqZWN0VW5pcXVlSUQgfHwgVEJTX0NFUlRJRklDQVRFX1NVQkpFQ1RfVU5JUVVFX0lEKSxcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogM1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtFeHRlbnNpb25zLnNjaGVtYShuYW1lcy5leHRlbnNpb25zIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBUQlNfQ0VSVElGSUNBVEVfRVhURU5TSU9OU1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIF1cbiAgICB9KSk7XG59XG5jbGFzcyBDZXJ0aWZpY2F0ZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgZ2V0IHRicygpIHtcbiAgICAgICAgcmV0dXJuIHB2dHN1dGlscy5CdWZmZXJTb3VyY2VDb252ZXJ0ZXIudG9BcnJheUJ1ZmZlcih0aGlzLnRic1ZpZXcpO1xuICAgIH1cbiAgICBzZXQgdGJzKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudGJzVmlldyA9IG5ldyBVaW50OEFycmF5KHZhbHVlKTtcbiAgICB9XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudGJzVmlldyA9IG5ldyBVaW50OEFycmF5KHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRCUyQ0LCBDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKFRCUyQ0KSkpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWRVJTSU9OJGYsIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRmKSk7XG4gICAgICAgIHRoaXMuc2VyaWFsTnVtYmVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0VSSUFMX05VTUJFUiQzLCBDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKFNFUklBTF9OVU1CRVIkMykpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRSQ0LCBDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRSQ0KSk7XG4gICAgICAgIHRoaXMuaXNzdWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSJDIsIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoSVNTVUVSJDIpKTtcbiAgICAgICAgdGhpcy5ub3RCZWZvcmUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBOT1RfQkVGT1JFLCBDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKE5PVF9CRUZPUkUpKTtcbiAgICAgICAgdGhpcy5ub3RBZnRlciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE5PVF9BRlRFUiwgQ2VydGlmaWNhdGUuZGVmYXVsdFZhbHVlcyhOT1RfQUZURVIpKTtcbiAgICAgICAgdGhpcy5zdWJqZWN0ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU1VCSkVDVCQxLCBDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKFNVQkpFQ1QkMSkpO1xuICAgICAgICB0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU1VCSkVDVF9QVUJMSUNfS0VZX0lORk8sIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoU1VCSkVDVF9QVUJMSUNfS0VZX0lORk8pKTtcbiAgICAgICAgaWYgKElTU1VFUl9VTklRVUVfSUQgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5pc3N1ZXJVbmlxdWVJRCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIElTU1VFUl9VTklRVUVfSUQsIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoSVNTVUVSX1VOSVFVRV9JRCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChTVUJKRUNUX1VOSVFVRV9JRCBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnN1YmplY3RVbmlxdWVJRCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNVQkpFQ1RfVU5JUVVFX0lELCBDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKFNVQkpFQ1RfVU5JUVVFX0lEKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEVYVEVOU0lPTlMkMiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmV4dGVuc2lvbnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFWFRFTlNJT05TJDIsIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoRVhURU5TSU9OUyQyKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkVfQUxHT1JJVEhNJDUsIENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFX0FMR09SSVRITSQ1KSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlVmFsdWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkVfVkFMVUUkMiwgQ2VydGlmaWNhdGUuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfVkFMVUUkMikpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVEJTJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX0JVRkZFUjtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiRmOlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSBTRVJJQUxfTlVNQkVSJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuSW50ZWdlcigpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkUkNDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcygpO1xuICAgICAgICAgICAgY2FzZSBOT1RfQkVGT1JFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVGltZSgpO1xuICAgICAgICAgICAgY2FzZSBOT1RfQUZURVI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUaW1lKCk7XG4gICAgICAgICAgICBjYXNlIFNVQkpFQ1QkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzKCk7XG4gICAgICAgICAgICBjYXNlIFNVQkpFQ1RfUFVCTElDX0tFWV9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHVibGljS2V5SW5mbygpO1xuICAgICAgICAgICAgY2FzZSBJU1NVRVJfVU5JUVVFX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9CVUZGRVI7XG4gICAgICAgICAgICBjYXNlIFNVQkpFQ1RfVU5JUVVFX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9CVUZGRVI7XG4gICAgICAgICAgICBjYXNlIEVYVEVOU0lPTlMkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRV9BTEdPUklUSE0kNTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX1ZBTFVFJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuQml0U3RyaW5nKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRic0NlcnRpZmljYXRlKG5hbWVzLnRic0NlcnRpZmljYXRlKSxcbiAgICAgICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5zaWduYXR1cmVBbGdvcml0aG0gfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBTSUdOQVRVUkVfQUxHT1JJVEhNJDVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQml0U3RyaW5nKHsgbmFtZTogKG5hbWVzLnNpZ25hdHVyZVZhbHVlIHx8IFNJR05BVFVSRV9WQUxVRSQyKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJFEpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIENlcnRpZmljYXRlLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHRic0NlcnRpZmljYXRlOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHRlbnNpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uczogVEJTX0NFUlRJRklDQVRFX0VYVEVOU0lPTlNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gYXNuMS5yZXN1bHQudGJzQ2VydGlmaWNhdGUudmFsdWVCZWZvcmVEZWNvZGVWaWV3O1xuICAgICAgICBpZiAoVEJTX0NFUlRJRklDQVRFX1ZFUlNJT04gaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdFtUQlNfQ0VSVElGSUNBVEVfVkVSU0lPTl0udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXIgPSBhc24xLnJlc3VsdFtUQlNfQ0VSVElGSUNBVEVfU0VSSUFMX05VTUJFUl07XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1RCU19DRVJUSUZJQ0FURV9TSUdOQVRVUkVdIH0pO1xuICAgICAgICB0aGlzLmlzc3VlciA9IG5ldyBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcyh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRJRklDQVRFX0lTU1VFUl0gfSk7XG4gICAgICAgIHRoaXMubm90QmVmb3JlID0gbmV3IFRpbWUoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1RCU19DRVJUSUZJQ0FURV9OT1RfQkVGT1JFXSB9KTtcbiAgICAgICAgdGhpcy5ub3RBZnRlciA9IG5ldyBUaW1lKHsgc2NoZW1hOiBhc24xLnJlc3VsdFtUQlNfQ0VSVElGSUNBVEVfTk9UX0FGVEVSXSB9KTtcbiAgICAgICAgdGhpcy5zdWJqZWN0ID0gbmV3IFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzKHsgc2NoZW1hOiBhc24xLnJlc3VsdFtUQlNfQ0VSVElGSUNBVEVfU1VCSkVDVF0gfSk7XG4gICAgICAgIHRoaXMuc3ViamVjdFB1YmxpY0tleUluZm8gPSBuZXcgUHVibGljS2V5SW5mbyh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRJRklDQVRFX1NVQkpFQ1RfUFVCTElDX0tFWV0gfSk7XG4gICAgICAgIGlmIChUQlNfQ0VSVElGSUNBVEVfSVNTVUVSX1VOSVFVRV9JRCBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuaXNzdWVyVW5pcXVlSUQgPSBhc24xLnJlc3VsdFtUQlNfQ0VSVElGSUNBVEVfSVNTVUVSX1VOSVFVRV9JRF0udmFsdWVCbG9jay52YWx1ZUhleDtcbiAgICAgICAgaWYgKFRCU19DRVJUSUZJQ0FURV9TVUJKRUNUX1VOSVFVRV9JRCBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuc3ViamVjdFVuaXF1ZUlEID0gYXNuMS5yZXN1bHRbVEJTX0NFUlRJRklDQVRFX1NVQkpFQ1RfVU5JUVVFX0lEXS52YWx1ZUJsb2NrLnZhbHVlSGV4O1xuICAgICAgICBpZiAoVEJTX0NFUlRJRklDQVRFX0VYVEVOU0lPTlMgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0W1RCU19DRVJUSUZJQ0FURV9FWFRFTlNJT05TXSwgZWxlbWVudCA9PiBuZXcgRXh0ZW5zaW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuc2lnbmF0dXJlQWxnb3JpdGhtIH0pO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlID0gYXNuMS5yZXN1bHQuc2lnbmF0dXJlVmFsdWU7XG4gICAgfVxuICAgIGVuY29kZVRCUygpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKChWRVJTSU9OJGYgaW4gdGhpcykgJiYgKHRoaXMudmVyc2lvbiAhPT0gQ2VydGlmaWNhdGUuZGVmYXVsdFZhbHVlcyhWRVJTSU9OJGYpKSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNlcmlhbE51bWJlcik7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5zaWduYXR1cmUudG9TY2hlbWEoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5pc3N1ZXIudG9TY2hlbWEoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMubm90QmVmb3JlLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgdGhpcy5ub3RBZnRlci50b1NjaGVtYSgpXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnN1YmplY3QudG9TY2hlbWEoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5zdWJqZWN0UHVibGljS2V5SW5mby50b1NjaGVtYSgpKTtcbiAgICAgICAgaWYgKHRoaXMuaXNzdWVyVW5pcXVlSUQpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IHRoaXMuaXNzdWVyVW5pcXVlSURcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdWJqZWN0VW5pcXVlSUQpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IHRoaXMuc3ViamVjdFVuaXF1ZUlEXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDNcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmV4dGVuc2lvbnMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoZW5jb2RlRmxhZyA9IGZhbHNlKSB7XG4gICAgICAgIGxldCB0YnNTY2hlbWE7XG4gICAgICAgIGlmIChlbmNvZGVGbGFnID09PSBmYWxzZSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnRic1ZpZXcuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBDZXJ0aWZpY2F0ZS5zY2hlbWEoKS52YWx1ZVswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuZnJvbUJFUih0aGlzLnRic1ZpZXcpO1xuICAgICAgICAgICAgQXNuRXJyb3IuYXNzZXJ0KGFzbjEsIFwiVEJTIENlcnRpZmljYXRlXCIpO1xuICAgICAgICAgICAgdGJzU2NoZW1hID0gYXNuMS5yZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0YnNTY2hlbWEgPSB0aGlzLmVuY29kZVRCUygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRic1NjaGVtYSxcbiAgICAgICAgICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlVmFsdWVcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHRiczogcHZ0c3V0aWxzLkNvbnZlcnQuVG9IZXgodGhpcy50YnNWaWV3KSxcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIHNlcmlhbE51bWJlcjogdGhpcy5zZXJpYWxOdW1iZXIudG9KU09OKCksXG4gICAgICAgICAgICBzaWduYXR1cmU6IHRoaXMuc2lnbmF0dXJlLnRvSlNPTigpLFxuICAgICAgICAgICAgaXNzdWVyOiB0aGlzLmlzc3Vlci50b0pTT04oKSxcbiAgICAgICAgICAgIG5vdEJlZm9yZTogdGhpcy5ub3RCZWZvcmUudG9KU09OKCksXG4gICAgICAgICAgICBub3RBZnRlcjogdGhpcy5ub3RBZnRlci50b0pTT04oKSxcbiAgICAgICAgICAgIHN1YmplY3Q6IHRoaXMuc3ViamVjdC50b0pTT04oKSxcbiAgICAgICAgICAgIHN1YmplY3RQdWJsaWNLZXlJbmZvOiB0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvLnRvSlNPTigpLFxuICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtOiB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZVZhbHVlOiB0aGlzLnNpZ25hdHVyZVZhbHVlLnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAoKFZFUlNJT04kZiBpbiB0aGlzKSAmJiAodGhpcy52ZXJzaW9uICE9PSBDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKFZFUlNJT04kZikpKSB7XG4gICAgICAgICAgICByZXMudmVyc2lvbiA9IHRoaXMudmVyc2lvbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc3N1ZXJVbmlxdWVJRCkge1xuICAgICAgICAgICAgcmVzLmlzc3VlclVuaXF1ZUlEID0gcHZ0c3V0aWxzLkNvbnZlcnQuVG9IZXgodGhpcy5pc3N1ZXJVbmlxdWVJRCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc3ViamVjdFVuaXF1ZUlEKSB7XG4gICAgICAgICAgICByZXMuc3ViamVjdFVuaXF1ZUlEID0gcHZ0c3V0aWxzLkNvbnZlcnQuVG9IZXgodGhpcy5zdWJqZWN0VW5pcXVlSUQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIHJlcy5leHRlbnNpb25zID0gQXJyYXkuZnJvbSh0aGlzLmV4dGVuc2lvbnMsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgYXN5bmMgZ2V0UHVibGljS2V5KHBhcmFtZXRlcnMsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICByZXR1cm4gY3J5cHRvLmdldFB1YmxpY0tleSh0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvLCB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSwgcGFyYW1ldGVycyk7XG4gICAgfVxuICAgIGFzeW5jIGdldEtleUhhc2goaGFzaEFsZ29yaXRobSA9IFwiU0hBLTFcIiwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIHJldHVybiBjcnlwdG8uZGlnZXN0KHsgbmFtZTogaGFzaEFsZ29yaXRobSB9LCB0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvLnN1YmplY3RQdWJsaWNLZXkudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpO1xuICAgIH1cbiAgICBhc3luYyBzaWduKHByaXZhdGVLZXksIGhhc2hBbGdvcml0aG0gPSBcIlNIQS0xXCIsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBpZiAoIXByaXZhdGVLZXkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5lZWQgdG8gcHJvdmlkZSBhIHByaXZhdGUga2V5IGZvciBzaWduaW5nXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNpZ25hdHVyZVBhcmFtZXRlcnMgPSBhd2FpdCBjcnlwdG8uZ2V0U2lnbmF0dXJlUGFyYW1ldGVycyhwcml2YXRlS2V5LCBoYXNoQWxnb3JpdGhtKTtcbiAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHNpZ25hdHVyZVBhcmFtZXRlcnMucGFyYW1ldGVycztcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBzaWduYXR1cmVQYXJhbWV0ZXJzLnNpZ25hdHVyZUFsZ29yaXRobTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBzaWduYXR1cmVQYXJhbWV0ZXJzLnNpZ25hdHVyZUFsZ29yaXRobTtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5lbmNvZGVUQlMoKS50b0JFUigpKTtcbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnNpZ25XaXRoUHJpdmF0ZUtleSh0aGlzLnRic1ZpZXcsIHByaXZhdGVLZXksIHBhcmFtZXRlcnMpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlID0gbmV3IGFzbjFqcy5CaXRTdHJpbmcoeyB2YWx1ZUhleDogc2lnbmF0dXJlIH0pO1xuICAgIH1cbiAgICBhc3luYyB2ZXJpZnkoaXNzdWVyQ2VydGlmaWNhdGUsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBsZXQgc3ViamVjdFB1YmxpY0tleUluZm87XG4gICAgICAgIGlmIChpc3N1ZXJDZXJ0aWZpY2F0ZSkge1xuICAgICAgICAgICAgc3ViamVjdFB1YmxpY0tleUluZm8gPSBpc3N1ZXJDZXJ0aWZpY2F0ZS5zdWJqZWN0UHVibGljS2V5SW5mbztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmlzc3Vlci5pc0VxdWFsKHRoaXMuc3ViamVjdCkpIHtcbiAgICAgICAgICAgIHN1YmplY3RQdWJsaWNLZXlJbmZvID0gdGhpcy5zdWJqZWN0UHVibGljS2V5SW5mbztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIShzdWJqZWN0UHVibGljS2V5SW5mbyBpbnN0YW5jZW9mIFB1YmxpY0tleUluZm8pKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQbGVhc2UgcHJvdmlkZSBpc3N1ZXIgY2VydGlmaWNhdGUgYXMgYSBwYXJhbWV0ZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyeXB0by52ZXJpZnlXaXRoUHVibGljS2V5KHRoaXMudGJzVmlldywgdGhpcy5zaWduYXR1cmVWYWx1ZSwgc3ViamVjdFB1YmxpY0tleUluZm8sIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtKTtcbiAgICB9XG59XG5DZXJ0aWZpY2F0ZS5DTEFTU19OQU1FID0gXCJDZXJ0aWZpY2F0ZVwiO1xuZnVuY3Rpb24gY2hlY2tDQShjZXJ0LCBzaWduZXJDZXJ0ID0gbnVsbCkge1xuICAgIGlmIChzaWduZXJDZXJ0ICYmIGNlcnQuaXNzdWVyLmlzRXF1YWwoc2lnbmVyQ2VydC5pc3N1ZXIpICYmIGNlcnQuc2VyaWFsTnVtYmVyLmlzRXF1YWwoc2lnbmVyQ2VydC5zZXJpYWxOdW1iZXIpKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBsZXQgaXNDQSA9IGZhbHNlO1xuICAgIGlmIChjZXJ0LmV4dGVuc2lvbnMpIHtcbiAgICAgICAgZm9yIChjb25zdCBleHRlbnNpb24gb2YgY2VydC5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmV4dG5JRCA9PT0gaWRfQmFzaWNDb25zdHJhaW50cyAmJiBleHRlbnNpb24ucGFyc2VkVmFsdWUgaW5zdGFuY2VvZiBCYXNpY0NvbnN0cmFpbnRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5jQSkge1xuICAgICAgICAgICAgICAgICAgICBpc0NBID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChpc0NBKSB7XG4gICAgICAgIHJldHVybiBjZXJ0O1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cblxuY29uc3QgQ0VSVF9JRCQxID0gXCJjZXJ0SWRcIjtcbmNvbnN0IENFUlRfVkFMVUUgPSBcImNlcnRWYWx1ZVwiO1xuY29uc3QgUEFSU0VEX1ZBTFVFJDQgPSBcInBhcnNlZFZhbHVlXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRQID0gW1xuICAgIENFUlRfSUQkMSxcbiAgICBDRVJUX1ZBTFVFXG5dO1xuY2xhc3MgQ2VydEJhZyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuY2VydElkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ0VSVF9JRCQxLCBDZXJ0QmFnLmRlZmF1bHRWYWx1ZXMoQ0VSVF9JRCQxKSk7XG4gICAgICAgIHRoaXMuY2VydFZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ0VSVF9WQUxVRSwgQ2VydEJhZy5kZWZhdWx0VmFsdWVzKENFUlRfVkFMVUUpKTtcbiAgICAgICAgaWYgKFBBUlNFRF9WQUxVRSQ0IGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2VkVmFsdWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQQVJTRURfVkFMVUUkNCwgQ2VydEJhZy5kZWZhdWx0VmFsdWVzKFBBUlNFRF9WQUxVRSQ0KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIENFUlRfSUQkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBDRVJUX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5BbnkoKSk7XG4gICAgICAgICAgICBjYXNlIFBBUlNFRF9WQUxVRSQ0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ0VSVF9JRCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IEVNUFRZX1NUUklORyk7XG4gICAgICAgICAgICBjYXNlIENFUlRfVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpO1xuICAgICAgICAgICAgY2FzZSBQQVJTRURfVkFMVUUkNDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZSBpbnN0YW5jZW9mIE9iamVjdCkgJiYgKE9iamVjdC5rZXlzKG1lbWJlclZhbHVlKS5sZW5ndGggPT09IDApKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLmlkIHx8IFwiaWRcIikgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5BbnkoeyBuYW1lOiAobmFtZXMudmFsdWUgfHwgXCJ2YWx1ZVwiKSB9KV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJFApO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIENlcnRCYWcuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgaWQ6IENFUlRfSUQkMSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogQ0VSVF9WQUxVRVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuY2VydElkID0gYXNuMS5yZXN1bHQuY2VydElkLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5jZXJ0VmFsdWUgPSBhc24xLnJlc3VsdC5jZXJ0VmFsdWU7XG4gICAgICAgIGNvbnN0IGNlcnRWYWx1ZUhleCA9IHRoaXMuY2VydFZhbHVlLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3O1xuICAgICAgICBzd2l0Y2ggKHRoaXMuY2VydElkKSB7XG4gICAgICAgICAgICBjYXNlIGlkX0NlcnRCYWdfWDUwOUNlcnRpZmljYXRlOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VkVmFsdWUgPSBDZXJ0aWZpY2F0ZS5mcm9tQkVSKGNlcnRWYWx1ZUhleCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYyLmZyb21CRVIoY2VydFZhbHVlSGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgaWRfQ2VydEJhZ19BdHRyaWJ1dGVDZXJ0aWZpY2F0ZTpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VkVmFsdWUgPSBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYyLmZyb21CRVIoY2VydFZhbHVlSGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGlkX0NlcnRCYWdfU0RTSUNlcnRpZmljYXRlOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBDRVJUX0lEIHZhbHVlIGluIENlcnRCYWc6ICR7dGhpcy5jZXJ0SWR9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGlmIChQQVJTRURfVkFMVUUkNCBpbiB0aGlzKSB7XG4gICAgICAgICAgICBpZiAoXCJhY2luZm9cIiBpbiB0aGlzLnBhcnNlZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jZXJ0SWQgPSBpZF9DZXJ0QmFnX0F0dHJpYnV0ZUNlcnRpZmljYXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jZXJ0SWQgPSBpZF9DZXJ0QmFnX1g1MDlDZXJ0aWZpY2F0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY2VydFZhbHVlID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiB0aGlzLnBhcnNlZFZhbHVlLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLmNlcnRJZCB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFsoKFwidG9TY2hlbWFcIiBpbiB0aGlzLmNlcnRWYWx1ZSkgPyB0aGlzLmNlcnRWYWx1ZS50b1NjaGVtYSgpIDogdGhpcy5jZXJ0VmFsdWUpXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2VydElkOiB0aGlzLmNlcnRJZCxcbiAgICAgICAgICAgIGNlcnRWYWx1ZTogdGhpcy5jZXJ0VmFsdWUudG9KU09OKClcbiAgICAgICAgfTtcbiAgICB9XG59XG5DZXJ0QmFnLkNMQVNTX05BTUUgPSBcIkNlcnRCYWdcIjtcblxuY29uc3QgVVNFUl9DRVJUSUZJQ0FURSA9IFwidXNlckNlcnRpZmljYXRlXCI7XG5jb25zdCBSRVZPQ0FUSU9OX0RBVEUgPSBcInJldm9jYXRpb25EYXRlXCI7XG5jb25zdCBDUkxfRU5UUllfRVhURU5TSU9OUyA9IFwiY3JsRW50cnlFeHRlbnNpb25zXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRPID0gW1xuICAgIFVTRVJfQ0VSVElGSUNBVEUsXG4gICAgUkVWT0NBVElPTl9EQVRFLFxuICAgIENSTF9FTlRSWV9FWFRFTlNJT05TXG5dO1xuY2xhc3MgUmV2b2tlZENlcnRpZmljYXRlIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy51c2VyQ2VydGlmaWNhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBVU0VSX0NFUlRJRklDQVRFLCBSZXZva2VkQ2VydGlmaWNhdGUuZGVmYXVsdFZhbHVlcyhVU0VSX0NFUlRJRklDQVRFKSk7XG4gICAgICAgIHRoaXMucmV2b2NhdGlvbkRhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVZPQ0FUSU9OX0RBVEUsIFJldm9rZWRDZXJ0aWZpY2F0ZS5kZWZhdWx0VmFsdWVzKFJFVk9DQVRJT05fREFURSkpO1xuICAgICAgICBpZiAoQ1JMX0VOVFJZX0VYVEVOU0lPTlMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5jcmxFbnRyeUV4dGVuc2lvbnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDUkxfRU5UUllfRVhURU5TSU9OUywgUmV2b2tlZENlcnRpZmljYXRlLmRlZmF1bHRWYWx1ZXMoQ1JMX0VOVFJZX0VYVEVOU0lPTlMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVVNFUl9DRVJUSUZJQ0FURTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIFJFVk9DQVRJT05fREFURTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRpbWUoKTtcbiAgICAgICAgICAgIGNhc2UgQ1JMX0VOVFJZX0VYVEVOU0lPTlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBFeHRlbnNpb25zKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnVzZXJDZXJ0aWZpY2F0ZSB8fCBVU0VSX0NFUlRJRklDQVRFKSB9KSxcbiAgICAgICAgICAgICAgICBUaW1lLnNjaGVtYSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1dGNUaW1lTmFtZTogKG5hbWVzLnJldm9jYXRpb25EYXRlIHx8IFJFVk9DQVRJT05fREFURSksXG4gICAgICAgICAgICAgICAgICAgICAgICBnZW5lcmFsVGltZU5hbWU6IChuYW1lcy5yZXZvY2F0aW9uRGF0ZSB8fCBSRVZPQ0FUSU9OX0RBVEUpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBFeHRlbnNpb25zLnNjaGVtYSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IChuYW1lcy5jcmxFbnRyeUV4dGVuc2lvbnMgfHwgQ1JMX0VOVFJZX0VYVEVOU0lPTlMpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCB0cnVlKVxuICAgICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkTyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUmV2b2tlZENlcnRpZmljYXRlLnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy51c2VyQ2VydGlmaWNhdGUgPSBhc24xLnJlc3VsdC51c2VyQ2VydGlmaWNhdGU7XG4gICAgICAgIHRoaXMucmV2b2NhdGlvbkRhdGUgPSBuZXcgVGltZSh7IHNjaGVtYTogYXNuMS5yZXN1bHQucmV2b2NhdGlvbkRhdGUgfSk7XG4gICAgICAgIGlmIChDUkxfRU5UUllfRVhURU5TSU9OUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5jcmxFbnRyeUV4dGVuc2lvbnMgPSBuZXcgRXh0ZW5zaW9ucyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuY3JsRW50cnlFeHRlbnNpb25zIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtcbiAgICAgICAgICAgIHRoaXMudXNlckNlcnRpZmljYXRlLFxuICAgICAgICAgICAgdGhpcy5yZXZvY2F0aW9uRGF0ZS50b1NjaGVtYSgpXG4gICAgICAgIF07XG4gICAgICAgIGlmICh0aGlzLmNybEVudHJ5RXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmNybEVudHJ5RXh0ZW5zaW9ucy50b1NjaGVtYSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB1c2VyQ2VydGlmaWNhdGU6IHRoaXMudXNlckNlcnRpZmljYXRlLnRvSlNPTigpLFxuICAgICAgICAgICAgcmV2b2NhdGlvbkRhdGU6IHRoaXMucmV2b2NhdGlvbkRhdGUudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmNybEVudHJ5RXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgcmVzLmNybEVudHJ5RXh0ZW5zaW9ucyA9IHRoaXMuY3JsRW50cnlFeHRlbnNpb25zLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuUmV2b2tlZENlcnRpZmljYXRlLkNMQVNTX05BTUUgPSBcIlJldm9rZWRDZXJ0aWZpY2F0ZVwiO1xuXG5jb25zdCBUQlMkMyA9IFwidGJzXCI7XG5jb25zdCBWRVJTSU9OJGUgPSBcInZlcnNpb25cIjtcbmNvbnN0IFNJR05BVFVSRSQzID0gXCJzaWduYXR1cmVcIjtcbmNvbnN0IElTU1VFUiQxID0gXCJpc3N1ZXJcIjtcbmNvbnN0IFRISVNfVVBEQVRFJDEgPSBcInRoaXNVcGRhdGVcIjtcbmNvbnN0IE5FWFRfVVBEQVRFJDEgPSBcIm5leHRVcGRhdGVcIjtcbmNvbnN0IFJFVk9LRURfQ0VSVElGSUNBVEVTID0gXCJyZXZva2VkQ2VydGlmaWNhdGVzXCI7XG5jb25zdCBDUkxfRVhURU5TSU9OUyA9IFwiY3JsRXh0ZW5zaW9uc1wiO1xuY29uc3QgU0lHTkFUVVJFX0FMR09SSVRITSQ0ID0gXCJzaWduYXR1cmVBbGdvcml0aG1cIjtcbmNvbnN0IFNJR05BVFVSRV9WQUxVRSQxID0gXCJzaWduYXR1cmVWYWx1ZVwiO1xuY29uc3QgVEJTX0NFUlRfTElTVCA9IFwidGJzQ2VydExpc3RcIjtcbmNvbnN0IFRCU19DRVJUX0xJU1RfVkVSU0lPTiA9IGAke1RCU19DRVJUX0xJU1R9LnZlcnNpb25gO1xuY29uc3QgVEJTX0NFUlRfTElTVF9TSUdOQVRVUkUgPSBgJHtUQlNfQ0VSVF9MSVNUfS5zaWduYXR1cmVgO1xuY29uc3QgVEJTX0NFUlRfTElTVF9JU1NVRVIgPSBgJHtUQlNfQ0VSVF9MSVNUfS5pc3N1ZXJgO1xuY29uc3QgVEJTX0NFUlRfTElTVF9USElTX1VQREFURSA9IGAke1RCU19DRVJUX0xJU1R9LnRoaXNVcGRhdGVgO1xuY29uc3QgVEJTX0NFUlRfTElTVF9ORVhUX1VQREFURSA9IGAke1RCU19DRVJUX0xJU1R9Lm5leHRVcGRhdGVgO1xuY29uc3QgVEJTX0NFUlRfTElTVF9SRVZPS0VEX0NFUlRJRklDQVRFUyA9IGAke1RCU19DRVJUX0xJU1R9LnJldm9rZWRDZXJ0aWZpY2F0ZXNgO1xuY29uc3QgVEJTX0NFUlRfTElTVF9FWFRFTlNJT05TID0gYCR7VEJTX0NFUlRfTElTVH0uZXh0ZW5zaW9uc2A7XG5jb25zdCBDTEVBUl9QUk9QUyROID0gW1xuICAgIFRCU19DRVJUX0xJU1QsXG4gICAgVEJTX0NFUlRfTElTVF9WRVJTSU9OLFxuICAgIFRCU19DRVJUX0xJU1RfU0lHTkFUVVJFLFxuICAgIFRCU19DRVJUX0xJU1RfSVNTVUVSLFxuICAgIFRCU19DRVJUX0xJU1RfVEhJU19VUERBVEUsXG4gICAgVEJTX0NFUlRfTElTVF9ORVhUX1VQREFURSxcbiAgICBUQlNfQ0VSVF9MSVNUX1JFVk9LRURfQ0VSVElGSUNBVEVTLFxuICAgIFRCU19DRVJUX0xJU1RfRVhURU5TSU9OUyxcbiAgICBTSUdOQVRVUkVfQUxHT1JJVEhNJDQsXG4gICAgU0lHTkFUVVJFX1ZBTFVFJDFcbl07XG5mdW5jdGlvbiB0YnNDZXJ0TGlzdChwYXJhbWV0ZXJzID0ge30pIHtcbiAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgVEJTX0NFUlRfTElTVCksXG4gICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy50YnNDZXJ0TGlzdFZlcnNpb24gfHwgVEJTX0NFUlRfTElTVF9WRVJTSU9OKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogMlxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5zaWduYXR1cmUgfHwge1xuICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogVEJTX0NFUlRfTElTVF9TSUdOQVRVUkVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzLnNjaGVtYShuYW1lcy5pc3N1ZXIgfHwge1xuICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogVEJTX0NFUlRfTElTVF9JU1NVRVJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIFRpbWUuc2NoZW1hKG5hbWVzLnRic0NlcnRMaXN0VGhpc1VwZGF0ZSB8fCB7XG4gICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdXRjVGltZU5hbWU6IFRCU19DRVJUX0xJU1RfVEhJU19VUERBVEUsXG4gICAgICAgICAgICAgICAgICAgIGdlbmVyYWxUaW1lTmFtZTogVEJTX0NFUlRfTElTVF9USElTX1VQREFURVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgVGltZS5zY2hlbWEobmFtZXMudGJzQ2VydExpc3ROZXh0VXBkYXRlIHx8IHtcbiAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICB1dGNUaW1lTmFtZTogVEJTX0NFUlRfTElTVF9ORVhUX1VQREFURSxcbiAgICAgICAgICAgICAgICAgICAgZ2VuZXJhbFRpbWVOYW1lOiBUQlNfQ0VSVF9MSVNUX05FWFRfVVBEQVRFXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgdHJ1ZSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy50YnNDZXJ0TGlzdFJldm9rZWRDZXJ0aWZpY2F0ZXMgfHwgVEJTX0NFUlRfTElTVF9SRVZPS0VEX0NFUlRJRklDQVRFUyksXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpbWUuc2NoZW1hKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV4dGVuc2lvbnMuc2NoZW1hKHt9LCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbRXh0ZW5zaW9ucy5zY2hlbWEobmFtZXMuY3JsRXh0ZW5zaW9ucyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogVEJTX0NFUlRfTElTVF9FWFRFTlNJT05TXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXVxuICAgICAgICAgICAgfSlcbiAgICAgICAgXVxuICAgIH0pKTtcbn1cbmNvbnN0IFdFTExfS05PV05fRVhURU5TSU9OUyA9IFtcbiAgICBpZF9BdXRob3JpdHlLZXlJZGVudGlmaWVyLFxuICAgIGlkX0lzc3VlckFsdE5hbWUsXG4gICAgaWRfQ1JMTnVtYmVyLFxuICAgIGlkX0Jhc2VDUkxOdW1iZXIsXG4gICAgaWRfSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LFxuICAgIGlkX0ZyZXNoZXN0Q1JMLFxuICAgIGlkX0F1dGhvcml0eUluZm9BY2Nlc3MsXG4gICAgaWRfQ1JMUmVhc29uLFxuICAgIGlkX0ludmFsaWRpdHlEYXRlLFxuICAgIGlkX0NlcnRpZmljYXRlSXNzdWVyLFxuXTtcbmNsYXNzIENlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3QgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGdldCB0YnMoKSB7XG4gICAgICAgIHJldHVybiBwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLnRvQXJyYXlCdWZmZXIodGhpcy50YnNWaWV3KTtcbiAgICB9XG4gICAgc2V0IHRicyh2YWx1ZSkge1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBuZXcgVWludDhBcnJheSh2YWx1ZSk7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBuZXcgVWludDhBcnJheShwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBUQlMkMywgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5kZWZhdWx0VmFsdWVzKFRCUyQzKSkpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWRVJTSU9OJGUsIENlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3QuZGVmYXVsdFZhbHVlcyhWRVJTSU9OJGUpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkUkMywgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRSQzKSk7XG4gICAgICAgIHRoaXMuaXNzdWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSJDEsIENlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3QuZGVmYXVsdFZhbHVlcyhJU1NVRVIkMSkpO1xuICAgICAgICB0aGlzLnRoaXNVcGRhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBUSElTX1VQREFURSQxLCBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LmRlZmF1bHRWYWx1ZXMoVEhJU19VUERBVEUkMSkpO1xuICAgICAgICBpZiAoTkVYVF9VUERBVEUkMSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm5leHRVcGRhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBORVhUX1VQREFURSQxLCBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LmRlZmF1bHRWYWx1ZXMoTkVYVF9VUERBVEUkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChSRVZPS0VEX0NFUlRJRklDQVRFUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnJldm9rZWRDZXJ0aWZpY2F0ZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVZPS0VEX0NFUlRJRklDQVRFUywgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5kZWZhdWx0VmFsdWVzKFJFVk9LRURfQ0VSVElGSUNBVEVTKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKENSTF9FWFRFTlNJT05TIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuY3JsRXh0ZW5zaW9ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENSTF9FWFRFTlNJT05TLCBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LmRlZmF1bHRWYWx1ZXMoQ1JMX0VYVEVOU0lPTlMpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9BTEdPUklUSE0kNCwgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRV9BTEdPUklUSE0kNCkpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFX1ZBTFVFJDEsIENlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3QuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfVkFMVUUkMSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVEJTJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX0JVRkZFUjtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiRlOlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkUkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcygpO1xuICAgICAgICAgICAgY2FzZSBUSElTX1VQREFURSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVGltZSgpO1xuICAgICAgICAgICAgY2FzZSBORVhUX1VQREFURSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVGltZSgpO1xuICAgICAgICAgICAgY2FzZSBSRVZPS0VEX0NFUlRJRklDQVRFUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIENSTF9FWFRFTlNJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRXh0ZW5zaW9ucygpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfQUxHT1JJVEhNJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRV9WQUxVRSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBcIkNlcnRpZmljYXRlTGlzdFwiKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGJzQ2VydExpc3QocGFyYW1ldGVycyksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2lnbmF0dXJlQWxnb3JpdGhtIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogU0lHTkFUVVJFX0FMR09SSVRITSQ0XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5zaWduYXR1cmVWYWx1ZSB8fCBTSUdOQVRVUkVfVkFMVUUkMSkgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyROKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gYXNuMS5yZXN1bHQudGJzQ2VydExpc3QudmFsdWVCZWZvcmVEZWNvZGVWaWV3O1xuICAgICAgICBpZiAoVEJTX0NFUlRfTElTVF9WRVJTSU9OIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdFtUQlNfQ0VSVF9MSVNUX1ZFUlNJT05dLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRfTElTVF9TSUdOQVRVUkVdIH0pO1xuICAgICAgICB0aGlzLmlzc3VlciA9IG5ldyBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcyh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRfTElTVF9JU1NVRVJdIH0pO1xuICAgICAgICB0aGlzLnRoaXNVcGRhdGUgPSBuZXcgVGltZSh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRfTElTVF9USElTX1VQREFURV0gfSk7XG4gICAgICAgIGlmIChUQlNfQ0VSVF9MSVNUX05FWFRfVVBEQVRFIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLm5leHRVcGRhdGUgPSBuZXcgVGltZSh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVEJTX0NFUlRfTElTVF9ORVhUX1VQREFURV0gfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRCU19DRVJUX0xJU1RfUkVWT0tFRF9DRVJUSUZJQ0FURVMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMucmV2b2tlZENlcnRpZmljYXRlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbVEJTX0NFUlRfTElTVF9SRVZPS0VEX0NFUlRJRklDQVRFU10sIGVsZW1lbnQgPT4gbmV3IFJldm9rZWRDZXJ0aWZpY2F0ZSh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRCU19DRVJUX0xJU1RfRVhURU5TSU9OUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5jcmxFeHRlbnNpb25zID0gbmV3IEV4dGVuc2lvbnMoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1RCU19DRVJUX0xJU1RfRVhURU5TSU9OU10gfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuc2lnbmF0dXJlQWxnb3JpdGhtIH0pO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlID0gYXNuMS5yZXN1bHQuc2lnbmF0dXJlVmFsdWU7XG4gICAgfVxuICAgIGVuY29kZVRCUygpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMudmVyc2lvbiAhPT0gQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5kZWZhdWx0VmFsdWVzKFZFUlNJT04kZSkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25hdHVyZS50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmlzc3Vlci50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnRoaXNVcGRhdGUudG9TY2hlbWEoKSk7XG4gICAgICAgIGlmICh0aGlzLm5leHRVcGRhdGUpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5uZXh0VXBkYXRlLnRvU2NoZW1hKCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJldm9rZWRDZXJ0aWZpY2F0ZXMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5yZXZva2VkQ2VydGlmaWNhdGVzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jcmxFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmxFeHRlbnNpb25zLnRvU2NoZW1hKClcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKGVuY29kZUZsYWcgPSBmYWxzZSkge1xuICAgICAgICBsZXQgdGJzU2NoZW1hO1xuICAgICAgICBpZiAoIWVuY29kZUZsYWcpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy50YnNWaWV3LmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5zY2hlbWEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuZnJvbUJFUih0aGlzLnRic1ZpZXcpO1xuICAgICAgICAgICAgQXNuRXJyb3IuYXNzZXJ0KGFzbjEsIFwiVEJTIENlcnRpZmljYXRlIFJldm9jYXRpb24gTGlzdFwiKTtcbiAgICAgICAgICAgIHRic1NjaGVtYSA9IGFzbjEucmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGJzU2NoZW1hID0gdGhpcy5lbmNvZGVUQlMoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICB0YnNTY2hlbWEsXG4gICAgICAgICAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB0YnM6IHB2dHN1dGlscy5Db252ZXJ0LlRvSGV4KHRoaXMudGJzVmlldyksXG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnZlcnNpb24sXG4gICAgICAgICAgICBzaWduYXR1cmU6IHRoaXMuc2lnbmF0dXJlLnRvSlNPTigpLFxuICAgICAgICAgICAgaXNzdWVyOiB0aGlzLmlzc3Vlci50b0pTT04oKSxcbiAgICAgICAgICAgIHRoaXNVcGRhdGU6IHRoaXMudGhpc1VwZGF0ZS50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobTogdGhpcy5zaWduYXR1cmVBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBzaWduYXR1cmVWYWx1ZTogdGhpcy5zaWduYXR1cmVWYWx1ZS50b0pTT04oKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy52ZXJzaW9uICE9PSBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRlKSlcbiAgICAgICAgICAgIHJlcy52ZXJzaW9uID0gdGhpcy52ZXJzaW9uO1xuICAgICAgICBpZiAodGhpcy5uZXh0VXBkYXRlKSB7XG4gICAgICAgICAgICByZXMubmV4dFVwZGF0ZSA9IHRoaXMubmV4dFVwZGF0ZS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZXZva2VkQ2VydGlmaWNhdGVzKSB7XG4gICAgICAgICAgICByZXMucmV2b2tlZENlcnRpZmljYXRlcyA9IEFycmF5LmZyb20odGhpcy5yZXZva2VkQ2VydGlmaWNhdGVzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNybEV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIHJlcy5jcmxFeHRlbnNpb25zID0gdGhpcy5jcmxFeHRlbnNpb25zLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuICAgIGlzQ2VydGlmaWNhdGVSZXZva2VkKGNlcnRpZmljYXRlKSB7XG4gICAgICAgIGlmICghdGhpcy5pc3N1ZXIuaXNFcXVhbChjZXJ0aWZpY2F0ZS5pc3N1ZXIpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnJldm9rZWRDZXJ0aWZpY2F0ZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHJldm9rZWRDZXJ0aWZpY2F0ZSBvZiB0aGlzLnJldm9rZWRDZXJ0aWZpY2F0ZXMpIHtcbiAgICAgICAgICAgIGlmIChyZXZva2VkQ2VydGlmaWNhdGUudXNlckNlcnRpZmljYXRlLmlzRXF1YWwoY2VydGlmaWNhdGUuc2VyaWFsTnVtYmVyKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgYXN5bmMgc2lnbihwcml2YXRlS2V5LCBoYXNoQWxnb3JpdGhtID0gXCJTSEEtMVwiLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgaWYgKCFwcml2YXRlS2V5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOZWVkIHRvIHByb3ZpZGUgYSBwcml2YXRlIGtleSBmb3Igc2lnbmluZ1wiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzaWduYXR1cmVQYXJhbWV0ZXJzID0gYXdhaXQgY3J5cHRvLmdldFNpZ25hdHVyZVBhcmFtZXRlcnMocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSk7XG4gICAgICAgIGNvbnN0IHsgcGFyYW1ldGVycyB9ID0gc2lnbmF0dXJlUGFyYW1ldGVycztcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBzaWduYXR1cmVQYXJhbWV0ZXJzLnNpZ25hdHVyZUFsZ29yaXRobTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBzaWduYXR1cmVQYXJhbWV0ZXJzLnNpZ25hdHVyZUFsZ29yaXRobTtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5lbmNvZGVUQlMoKS50b0JFUigpKTtcbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnNpZ25XaXRoUHJpdmF0ZUtleSh0aGlzLnRic1ZpZXcsIHByaXZhdGVLZXksIHBhcmFtZXRlcnMpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZVZhbHVlID0gbmV3IGFzbjFqcy5CaXRTdHJpbmcoeyB2YWx1ZUhleDogc2lnbmF0dXJlIH0pO1xuICAgIH1cbiAgICBhc3luYyB2ZXJpZnkocGFyYW1ldGVycyA9IHt9LCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgbGV0IHN1YmplY3RQdWJsaWNLZXlJbmZvO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5pc3N1ZXJDZXJ0aWZpY2F0ZSkge1xuICAgICAgICAgICAgc3ViamVjdFB1YmxpY0tleUluZm8gPSBwYXJhbWV0ZXJzLmlzc3VlckNlcnRpZmljYXRlLnN1YmplY3RQdWJsaWNLZXlJbmZvO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmlzc3Vlci5pc0VxdWFsKHBhcmFtZXRlcnMuaXNzdWVyQ2VydGlmaWNhdGUuc3ViamVjdCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMucHVibGljS2V5SW5mbykge1xuICAgICAgICAgICAgc3ViamVjdFB1YmxpY0tleUluZm8gPSBwYXJhbWV0ZXJzLnB1YmxpY0tleUluZm87XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzdWJqZWN0UHVibGljS2V5SW5mbykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSXNzdWVyJ3MgY2VydGlmaWNhdGUgbXVzdCBiZSBwcm92aWRlZCBhcyBhbiBpbnB1dCBwYXJhbWV0ZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3JsRXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBleHRlbnNpb24gb2YgdGhpcy5jcmxFeHRlbnNpb25zLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmNyaXRpY2FsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghV0VMTF9LTk9XTl9FWFRFTlNJT05TLmluY2x1ZGVzKGV4dGVuc2lvbi5leHRuSUQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3J5cHRvLnZlcmlmeVdpdGhQdWJsaWNLZXkodGhpcy50YnNWaWV3LCB0aGlzLnNpZ25hdHVyZVZhbHVlLCBzdWJqZWN0UHVibGljS2V5SW5mbywgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0pO1xuICAgIH1cbn1cbkNlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3QuQ0xBU1NfTkFNRSA9IFwiQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdFwiO1xuXG5jb25zdCBDUkxfSUQgPSBcImNybElkXCI7XG5jb25zdCBDUkxfVkFMVUUgPSBcImNybFZhbHVlXCI7XG5jb25zdCBQQVJTRURfVkFMVUUkMyA9IFwicGFyc2VkVmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJE0gPSBbXG4gICAgQ1JMX0lELFxuICAgIENSTF9WQUxVRSxcbl07XG5jbGFzcyBDUkxCYWcgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmNybElkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ1JMX0lELCBDUkxCYWcuZGVmYXVsdFZhbHVlcyhDUkxfSUQpKTtcbiAgICAgICAgdGhpcy5jcmxWYWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENSTF9WQUxVRSwgQ1JMQmFnLmRlZmF1bHRWYWx1ZXMoQ1JMX1ZBTFVFKSk7XG4gICAgICAgIGlmIChQQVJTRURfVkFMVUUkMyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnBhcnNlZFZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUEFSU0VEX1ZBTFVFJDMsIENSTEJhZy5kZWZhdWx0VmFsdWVzKFBBUlNFRF9WQUxVRSQzKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIENSTF9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBDUkxfVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLkFueSgpKTtcbiAgICAgICAgICAgIGNhc2UgUEFSU0VEX1ZBTFVFJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDUkxfSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgQ1JMX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBhc24xanMuQW55KTtcbiAgICAgICAgICAgIGNhc2UgUEFSU0VEX1ZBTFVFJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpICYmIChPYmplY3Qua2V5cyhtZW1iZXJWYWx1ZSkubGVuZ3RoID09PSAwKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5pZCB8fCBcImlkXCIpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuQW55KHsgbmFtZTogKG5hbWVzLnZhbHVlIHx8IFwidmFsdWVcIikgfSldXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRNKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBDUkxCYWcuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgaWQ6IENSTF9JRCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogQ1JMX1ZBTFVFXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jcmxJZCA9IGFzbjEucmVzdWx0LmNybElkLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5jcmxWYWx1ZSA9IGFzbjEucmVzdWx0LmNybFZhbHVlO1xuICAgICAgICBzd2l0Y2ggKHRoaXMuY3JsSWQpIHtcbiAgICAgICAgICAgIGNhc2UgaWRfQ1JMQmFnX1g1MDlDUkw6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlZFZhbHVlID0gQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5mcm9tQkVSKHRoaXMuY2VydFZhbHVlLnZhbHVlQmxvY2sudmFsdWVIZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgQ1JMX0lEIHZhbHVlIGluIENSTEJhZzogJHt0aGlzLmNybElkfWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJzZWRWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5jcmxJZCA9IGlkX0NSTEJhZ19YNTA5Q1JMO1xuICAgICAgICAgICAgdGhpcy5jcmxWYWx1ZSA9IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogdGhpcy5wYXJzZWRWYWx1ZS50b1NjaGVtYSgpLnRvQkVSKGZhbHNlKSB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5jcmxJZCB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFt0aGlzLmNybFZhbHVlLnRvU2NoZW1hKCldXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjcmxJZDogdGhpcy5jcmxJZCxcbiAgICAgICAgICAgIGNybFZhbHVlOiB0aGlzLmNybFZhbHVlLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgfVxufVxuQ1JMQmFnLkNMQVNTX05BTUUgPSBcIkNSTEJhZ1wiO1xuXG5jb25zdCBWRVJTSU9OJGQgPSBcInZlcnNpb25cIjtcbmNvbnN0IEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMSA9IFwiZW5jcnlwdGVkQ29udGVudEluZm9cIjtcbmNvbnN0IFVOUFJPVEVDVEVEX0FUVFJTJDEgPSBcInVucHJvdGVjdGVkQXR0cnNcIjtcbmNvbnN0IENMRUFSX1BST1BTJEwgPSBbXG4gICAgVkVSU0lPTiRkLFxuICAgIEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMSxcbiAgICBVTlBST1RFQ1RFRF9BVFRSUyQxLFxuXTtcbmNsYXNzIEVuY3J5cHRlZERhdGEgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWRVJTSU9OJGQsIEVuY3J5cHRlZERhdGEuZGVmYXVsdFZhbHVlcyhWRVJTSU9OJGQpKTtcbiAgICAgICAgdGhpcy5lbmNyeXB0ZWRDb250ZW50SW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMSwgRW5jcnlwdGVkRGF0YS5kZWZhdWx0VmFsdWVzKEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMSkpO1xuICAgICAgICBpZiAoVU5QUk9URUNURURfQVRUUlMkMSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnVucHJvdGVjdGVkQXR0cnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBVTlBST1RFQ1RFRF9BVFRSUyQxLCBFbmNyeXB0ZWREYXRhLmRlZmF1bHRWYWx1ZXMoVU5QUk9URUNURURfQVRUUlMkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEVuY3J5cHRlZENvbnRlbnRJbmZvKCk7XG4gICAgICAgICAgICBjYXNlIFVOUFJPVEVDVEVEX0FUVFJTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJGQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gMCk7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9DT05URU5UX0lORk8kMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChFbmNyeXB0ZWRDb250ZW50SW5mby5jb21wYXJlV2l0aERlZmF1bHQoXCJjb250ZW50VHlwZVwiLCBtZW1iZXJWYWx1ZS5jb250ZW50VHlwZSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChFbmNyeXB0ZWRDb250ZW50SW5mby5jb21wYXJlV2l0aERlZmF1bHQoXCJjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobVwiLCBtZW1iZXJWYWx1ZS5jb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChFbmNyeXB0ZWRDb250ZW50SW5mby5jb21wYXJlV2l0aERlZmF1bHQoXCJlbmNyeXB0ZWRDb250ZW50XCIsIG1lbWJlclZhbHVlLmVuY3J5cHRlZENvbnRlbnQpKSk7XG4gICAgICAgICAgICBjYXNlIFVOUFJPVEVDVEVEX0FUVFJTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudmVyc2lvbiB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIEVuY3J5cHRlZENvbnRlbnRJbmZvLnNjaGVtYShuYW1lcy5lbmNyeXB0ZWRDb250ZW50SW5mbyB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnVucHJvdGVjdGVkQXR0cnMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXR0cmlidXRlLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRMKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBFbmNyeXB0ZWREYXRhLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IFZFUlNJT04kZCxcbiAgICAgICAgICAgICAgICBlbmNyeXB0ZWRDb250ZW50SW5mbzoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBFTkNSWVBURURfQ09OVEVOVF9JTkZPJDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdW5wcm90ZWN0ZWRBdHRyczogVU5QUk9URUNURURfQVRUUlMkMVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgdGhpcy5lbmNyeXB0ZWRDb250ZW50SW5mbyA9IG5ldyBFbmNyeXB0ZWRDb250ZW50SW5mbyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuZW5jcnlwdGVkQ29udGVudEluZm8gfSk7XG4gICAgICAgIGlmIChVTlBST1RFQ1RFRF9BVFRSUyQxIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy51bnByb3RlY3RlZEF0dHJzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC51bnByb3RlY3RlZEF0dHJzLCBlbGVtZW50ID0+IG5ldyBBdHRyaWJ1dGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvLnRvU2NoZW1hKCkpO1xuICAgICAgICBpZiAodGhpcy51bnByb3RlY3RlZEF0dHJzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy51bnByb3RlY3RlZEF0dHJzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnZlcnNpb24sXG4gICAgICAgICAgICBlbmNyeXB0ZWRDb250ZW50SW5mbzogdGhpcy5lbmNyeXB0ZWRDb250ZW50SW5mby50b0pTT04oKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy51bnByb3RlY3RlZEF0dHJzKVxuICAgICAgICAgICAgcmVzLnVucHJvdGVjdGVkQXR0cnMgPSBBcnJheS5mcm9tKHRoaXMudW5wcm90ZWN0ZWRBdHRycywgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgYXN5bmMgZW5jcnlwdChwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQocGFyYW1ldGVycywgXCJwYXJhbWV0ZXJzXCIsIFwib2JqZWN0XCIpO1xuICAgICAgICBjb25zdCBlbmNyeXB0UGFyYW1zID0ge1xuICAgICAgICAgICAgLi4ucGFyYW1ldGVycyxcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBcIjEuMi44NDAuMTEzNTQ5LjEuNy4xXCIsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8gPSBhd2FpdCBjcnlwdG8uZW5jcnlwdEVuY3J5cHRlZENvbnRlbnRJbmZvKGVuY3J5cHRQYXJhbXMpO1xuICAgIH1cbiAgICBhc3luYyBkZWNyeXB0KHBhcmFtZXRlcnMsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBBcmd1bWVudEVycm9yLmFzc2VydChwYXJhbWV0ZXJzLCBcInBhcmFtZXRlcnNcIiwgXCJvYmplY3RcIik7XG4gICAgICAgIGNvbnN0IGRlY3J5cHRQYXJhbXMgPSB7XG4gICAgICAgICAgICAuLi5wYXJhbWV0ZXJzLFxuICAgICAgICAgICAgZW5jcnlwdGVkQ29udGVudEluZm86IHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8sXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjcnlwdG8uZGVjcnlwdEVuY3J5cHRlZENvbnRlbnRJbmZvKGRlY3J5cHRQYXJhbXMpO1xuICAgIH1cbn1cbkVuY3J5cHRlZERhdGEuQ0xBU1NfTkFNRSA9IFwiRW5jcnlwdGVkRGF0YVwiO1xuXG5jb25zdCBFTkNSWVBUSU9OX0FMR09SSVRITSA9IFwiZW5jcnlwdGlvbkFsZ29yaXRobVwiO1xuY29uc3QgRU5DUllQVEVEX0RBVEEgPSBcImVuY3J5cHRlZERhdGFcIjtcbmNvbnN0IFBBUlNFRF9WQUxVRSQyID0gXCJwYXJzZWRWYWx1ZVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkSyA9IFtcbiAgICBFTkNSWVBUSU9OX0FMR09SSVRITSxcbiAgICBFTkNSWVBURURfREFUQSxcbl07XG5jbGFzcyBQS0NTOFNocm91ZGVkS2V5QmFnIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5lbmNyeXB0aW9uQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRU5DUllQVElPTl9BTEdPUklUSE0sIFBLQ1M4U2hyb3VkZWRLZXlCYWcuZGVmYXVsdFZhbHVlcyhFTkNSWVBUSU9OX0FMR09SSVRITSkpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZERhdGEgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFTkNSWVBURURfREFUQSwgUEtDUzhTaHJvdWRlZEtleUJhZy5kZWZhdWx0VmFsdWVzKEVOQ1JZUFRFRF9EQVRBKSk7XG4gICAgICAgIGlmIChQQVJTRURfVkFMVUUkMiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnBhcnNlZFZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUEFSU0VEX1ZBTFVFJDIsIFBLQ1M4U2hyb3VkZWRLZXlCYWcuZGVmYXVsdFZhbHVlcyhQQVJTRURfVkFMVUUkMikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBFTkNSWVBUSU9OX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCkpO1xuICAgICAgICAgICAgY2FzZSBFTkNSWVBURURfREFUQTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKSk7XG4gICAgICAgICAgICBjYXNlIFBBUlNFRF9WQUxVRSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVElPTl9BTEdPUklUSE06XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoQWxnb3JpdGhtSWRlbnRpZmllci5jb21wYXJlV2l0aERlZmF1bHQoXCJhbGdvcml0aG1JZFwiLCBtZW1iZXJWYWx1ZS5hbGdvcml0aG1JZCkpICYmXG4gICAgICAgICAgICAgICAgICAgICgoXCJhbGdvcml0aG1QYXJhbXNcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9EQVRBOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChQS0NTOFNocm91ZGVkS2V5QmFnLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpKTtcbiAgICAgICAgICAgIGNhc2UgUEFSU0VEX1ZBTFVFJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpICYmIChPYmplY3Qua2V5cyhtZW1iZXJWYWx1ZSkubGVuZ3RoID09PSAwKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLmVuY3J5cHRpb25BbGdvcml0aG0gfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBFTkNSWVBUSU9OX0FMR09SSVRITVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5lbmNyeXB0ZWREYXRhIHx8IEVOQ1JZUFRFRF9EQVRBKSB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNDb25zdHJ1Y3RlZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmVuY3J5cHRlZERhdGEgfHwgRU5DUllQVEVEX0RBVEEpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRLKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQS0NTOFNocm91ZGVkS2V5QmFnLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGVuY3J5cHRpb25BbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogRU5DUllQVElPTl9BTEdPUklUSE1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZW5jcnlwdGVkRGF0YTogRU5DUllQVEVEX0RBVEFcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmVuY3J5cHRpb25BbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuZW5jcnlwdGlvbkFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5lbmNyeXB0ZWREYXRhID0gYXNuMS5yZXN1bHQuZW5jcnlwdGVkRGF0YTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMuZW5jcnlwdGlvbkFsZ29yaXRobS50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuZW5jcnlwdGVkRGF0YVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGVuY3J5cHRpb25BbGdvcml0aG06IHRoaXMuZW5jcnlwdGlvbkFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIGVuY3J5cHRlZERhdGE6IHRoaXMuZW5jcnlwdGVkRGF0YS50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgYXN5bmMgcGFyc2VJbnRlcm5hbFZhbHVlcyhwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgY29uc3QgY21zRW5jcnlwdGVkID0gbmV3IEVuY3J5cHRlZERhdGEoe1xuICAgICAgICAgICAgZW5jcnlwdGVkQ29udGVudEluZm86IG5ldyBFbmNyeXB0ZWRDb250ZW50SW5mbyh7XG4gICAgICAgICAgICAgICAgY29udGVudEVuY3J5cHRpb25BbGdvcml0aG06IHRoaXMuZW5jcnlwdGlvbkFsZ29yaXRobSxcbiAgICAgICAgICAgICAgICBlbmNyeXB0ZWRDb250ZW50OiB0aGlzLmVuY3J5cHRlZERhdGFcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBkZWNyeXB0ZWREYXRhID0gYXdhaXQgY21zRW5jcnlwdGVkLmRlY3J5cHQocGFyYW1ldGVycywgY3J5cHRvKTtcbiAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZSA9IFByaXZhdGVLZXlJbmZvLmZyb21CRVIoZGVjcnlwdGVkRGF0YSk7XG4gICAgfVxuICAgIGFzeW5jIG1ha2VJbnRlcm5hbFZhbHVlcyhwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcnNlZFZhbHVlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQbGVhc2UgaW5pdGlhbGl6ZSBcXFwicGFyc2VkVmFsdWVcXFwiIGZpcnN0XCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNtc0VuY3J5cHRlZCA9IG5ldyBFbmNyeXB0ZWREYXRhKCk7XG4gICAgICAgIGNvbnN0IGVuY3J5cHRQYXJhbXMgPSB7XG4gICAgICAgICAgICAuLi5wYXJhbWV0ZXJzLFxuICAgICAgICAgICAgY29udGVudFRvRW5jcnlwdDogdGhpcy5wYXJzZWRWYWx1ZS50b1NjaGVtYSgpLnRvQkVSKGZhbHNlKSxcbiAgICAgICAgfTtcbiAgICAgICAgYXdhaXQgY21zRW5jcnlwdGVkLmVuY3J5cHQoZW5jcnlwdFBhcmFtcywgY3J5cHRvKTtcbiAgICAgICAgaWYgKCFjbXNFbmNyeXB0ZWQuZW5jcnlwdGVkQ29udGVudEluZm8uZW5jcnlwdGVkQ29udGVudCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIGZpbGVkIGBlbmNyeXB0ZWRDb250ZW50YCBpbiBFbmNyeXB0ZWRDb250ZW50SW5mbyBpcyBlbXB0eVwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVuY3J5cHRpb25BbGdvcml0aG0gPSBjbXNFbmNyeXB0ZWQuZW5jcnlwdGVkQ29udGVudEluZm8uY29udGVudEVuY3J5cHRpb25BbGdvcml0aG07XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkRGF0YSA9IGNtc0VuY3J5cHRlZC5lbmNyeXB0ZWRDb250ZW50SW5mby5lbmNyeXB0ZWRDb250ZW50O1xuICAgIH1cbn1cblBLQ1M4U2hyb3VkZWRLZXlCYWcuQ0xBU1NfTkFNRSA9IFwiUEtDUzhTaHJvdWRlZEtleUJhZ1wiO1xuXG5jb25zdCBTRUNSRVRfVFlQRV9JRCA9IFwic2VjcmV0VHlwZUlkXCI7XG5jb25zdCBTRUNSRVRfVkFMVUUgPSBcInNlY3JldFZhbHVlXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRKID0gW1xuICAgIFNFQ1JFVF9UWVBFX0lELFxuICAgIFNFQ1JFVF9WQUxVRSxcbl07XG5jbGFzcyBTZWNyZXRCYWcgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnNlY3JldFR5cGVJZCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNFQ1JFVF9UWVBFX0lELCBTZWNyZXRCYWcuZGVmYXVsdFZhbHVlcyhTRUNSRVRfVFlQRV9JRCkpO1xuICAgICAgICB0aGlzLnNlY3JldFZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0VDUkVUX1ZBTFVFLCBTZWNyZXRCYWcuZGVmYXVsdFZhbHVlcyhTRUNSRVRfVkFMVUUpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFNFQ1JFVF9UWVBFX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIFNFQ1JFVF9WQUxVRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuQW55KCkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBTRUNSRVRfVFlQRV9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBFTVBUWV9TVFJJTkcpO1xuICAgICAgICAgICAgY2FzZSBTRUNSRVRfVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMuaWQgfHwgXCJpZFwiKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkFueSh7IG5hbWU6IChuYW1lcy52YWx1ZSB8fCBcInZhbHVlXCIpIH0pXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkSik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgU2VjcmV0QmFnLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGlkOiBTRUNSRVRfVFlQRV9JRCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogU0VDUkVUX1ZBTFVFXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5zZWNyZXRUeXBlSWQgPSBhc24xLnJlc3VsdC5zZWNyZXRUeXBlSWQudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnNlY3JldFZhbHVlID0gYXNuMS5yZXN1bHQuc2VjcmV0VmFsdWU7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5zZWNyZXRUeXBlSWQgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5zZWNyZXRWYWx1ZS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2VjcmV0VHlwZUlkOiB0aGlzLnNlY3JldFR5cGVJZCxcbiAgICAgICAgICAgIHNlY3JldFZhbHVlOiB0aGlzLnNlY3JldFZhbHVlLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgfVxufVxuU2VjcmV0QmFnLkNMQVNTX05BTUUgPSBcIlNlY3JldEJhZ1wiO1xuXG5jbGFzcyBTYWZlQmFnVmFsdWVGYWN0b3J5IHtcbiAgICBzdGF0aWMgZ2V0SXRlbXMoKSB7XG4gICAgICAgIGlmICghdGhpcy5pdGVtcykge1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHt9O1xuICAgICAgICAgICAgU2FmZUJhZ1ZhbHVlRmFjdG9yeS5yZWdpc3RlcihcIjEuMi44NDAuMTEzNTQ5LjEuMTIuMTAuMS4xXCIsIFByaXZhdGVLZXlJbmZvKTtcbiAgICAgICAgICAgIFNhZmVCYWdWYWx1ZUZhY3RvcnkucmVnaXN0ZXIoXCIxLjIuODQwLjExMzU0OS4xLjEyLjEwLjEuMlwiLCBQS0NTOFNocm91ZGVkS2V5QmFnKTtcbiAgICAgICAgICAgIFNhZmVCYWdWYWx1ZUZhY3RvcnkucmVnaXN0ZXIoXCIxLjIuODQwLjExMzU0OS4xLjEyLjEwLjEuM1wiLCBDZXJ0QmFnKTtcbiAgICAgICAgICAgIFNhZmVCYWdWYWx1ZUZhY3RvcnkucmVnaXN0ZXIoXCIxLjIuODQwLjExMzU0OS4xLjEyLjEwLjEuNFwiLCBDUkxCYWcpO1xuICAgICAgICAgICAgU2FmZUJhZ1ZhbHVlRmFjdG9yeS5yZWdpc3RlcihcIjEuMi44NDAuMTEzNTQ5LjEuMTIuMTAuMS41XCIsIFNlY3JldEJhZyk7XG4gICAgICAgICAgICBTYWZlQmFnVmFsdWVGYWN0b3J5LnJlZ2lzdGVyKFwiMS4yLjg0MC4xMTM1NDkuMS4xMi4xMC4xLjZcIiwgU2FmZUNvbnRlbnRzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5pdGVtcztcbiAgICB9XG4gICAgc3RhdGljIHJlZ2lzdGVyKGlkLCB0eXBlKSB7XG4gICAgICAgIHRoaXMuZ2V0SXRlbXMoKVtpZF0gPSB0eXBlO1xuICAgIH1cbiAgICBzdGF0aWMgZmluZChpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRJdGVtcygpW2lkXSB8fCBudWxsO1xuICAgIH1cbn1cblxuY29uc3QgQkFHX0lEID0gXCJiYWdJZFwiO1xuY29uc3QgQkFHX1ZBTFVFID0gXCJiYWdWYWx1ZVwiO1xuY29uc3QgQkFHX0FUVFJJQlVURVMgPSBcImJhZ0F0dHJpYnV0ZXNcIjtcbmNvbnN0IENMRUFSX1BST1BTJEkgPSBbXG4gICAgQkFHX0lELFxuICAgIEJBR19WQUxVRSxcbiAgICBCQUdfQVRUUklCVVRFU1xuXTtcbmNsYXNzIFNhZmVCYWcgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmJhZ0lkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQkFHX0lELCBTYWZlQmFnLmRlZmF1bHRWYWx1ZXMoQkFHX0lEKSk7XG4gICAgICAgIHRoaXMuYmFnVmFsdWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBCQUdfVkFMVUUsIFNhZmVCYWcuZGVmYXVsdFZhbHVlcyhCQUdfVkFMVUUpKTtcbiAgICAgICAgaWYgKEJBR19BVFRSSUJVVEVTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuYmFnQXR0cmlidXRlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEJBR19BVFRSSUJVVEVTLCBTYWZlQmFnLmRlZmF1bHRWYWx1ZXMoQkFHX0FUVFJJQlVURVMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQkFHX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIEJBR19WQUxVRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuQW55KCkpO1xuICAgICAgICAgICAgY2FzZSBCQUdfQVRUUklCVVRFUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEJBR19JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBFTVBUWV9TVFJJTkcpO1xuICAgICAgICAgICAgY2FzZSBCQUdfVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpO1xuICAgICAgICAgICAgY2FzZSBCQUdfQVRUUklCVVRFUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5iYWdJZCB8fCBCQUdfSUQpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuQW55KHsgbmFtZTogKG5hbWVzLmJhZ1ZhbHVlIHx8IEJBR19WQUxVRSkgfSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5iYWdBdHRyaWJ1dGVzIHx8IEJBR19BVFRSSUJVVEVTKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXR0cmlidXRlLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRJKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBTYWZlQmFnLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGJhZ0lkOiBCQUdfSUQsXG4gICAgICAgICAgICAgICAgYmFnVmFsdWU6IEJBR19WQUxVRSxcbiAgICAgICAgICAgICAgICBiYWdBdHRyaWJ1dGVzOiBCQUdfQVRUUklCVVRFU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuYmFnSWQgPSBhc24xLnJlc3VsdC5iYWdJZC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIGNvbnN0IGJhZ1R5cGUgPSBTYWZlQmFnVmFsdWVGYWN0b3J5LmZpbmQodGhpcy5iYWdJZCk7XG4gICAgICAgIGlmICghYmFnVHlwZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIEJBR19JRCBmb3IgU2FmZUJhZzogJHt0aGlzLmJhZ0lkfWApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYmFnVmFsdWUgPSBuZXcgYmFnVHlwZSh7IHNjaGVtYTogYXNuMS5yZXN1bHQuYmFnVmFsdWUgfSk7XG4gICAgICAgIGlmIChCQUdfQVRUUklCVVRFUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5iYWdBdHRyaWJ1dGVzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5iYWdBdHRyaWJ1dGVzLCBlbGVtZW50ID0+IG5ldyBBdHRyaWJ1dGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtcbiAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLmJhZ0lkIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMuYmFnVmFsdWUudG9TY2hlbWEoKV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIF07XG4gICAgICAgIGlmICh0aGlzLmJhZ0F0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuYmFnQXR0cmlidXRlcywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0ID0ge1xuICAgICAgICAgICAgYmFnSWQ6IHRoaXMuYmFnSWQsXG4gICAgICAgICAgICBiYWdWYWx1ZTogdGhpcy5iYWdWYWx1ZS50b0pTT04oKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5iYWdBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBvdXRwdXQuYmFnQXR0cmlidXRlcyA9IEFycmF5LmZyb20odGhpcy5iYWdBdHRyaWJ1dGVzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxufVxuU2FmZUJhZy5DTEFTU19OQU1FID0gXCJTYWZlQmFnXCI7XG5cbmNvbnN0IFNBRkVfQlVHUyA9IFwic2FmZUJhZ3NcIjtcbmNsYXNzIFNhZmVDb250ZW50cyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2FmZUJhZ3MgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTQUZFX0JVR1MsIFNhZmVDb250ZW50cy5kZWZhdWx0VmFsdWVzKFNBRkVfQlVHUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU0FGRV9CVUdTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU0FGRV9CVUdTOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5zYWZlQmFncyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogU2FmZUJhZy5zY2hlbWEoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgW1xuICAgICAgICAgICAgU0FGRV9CVUdTXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFNhZmVDb250ZW50cy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBzYWZlQmFnczogU0FGRV9CVUdTXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5zYWZlQmFncyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuc2FmZUJhZ3MsIGVsZW1lbnQgPT4gbmV3IFNhZmVCYWcoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuc2FmZUJhZ3MsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNhZmVCYWdzOiBBcnJheS5mcm9tKHRoaXMuc2FmZUJhZ3MsIG8gPT4gby50b0pTT04oKSlcbiAgICAgICAgfTtcbiAgICB9XG59XG5TYWZlQ29udGVudHMuQ0xBU1NfTkFNRSA9IFwiU2FmZUNvbnRlbnRzXCI7XG5cbmNvbnN0IE9USEVSX0NFUlRfRk9STUFUID0gXCJvdGhlckNlcnRGb3JtYXRcIjtcbmNvbnN0IE9USEVSX0NFUlQgPSBcIm90aGVyQ2VydFwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkSCA9IFtcbiAgICBPVEhFUl9DRVJUX0ZPUk1BVCxcbiAgICBPVEhFUl9DRVJUXG5dO1xuY2xhc3MgT3RoZXJDZXJ0aWZpY2F0ZUZvcm1hdCBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMub3RoZXJDZXJ0Rm9ybWF0ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT1RIRVJfQ0VSVF9GT1JNQVQsIE90aGVyQ2VydGlmaWNhdGVGb3JtYXQuZGVmYXVsdFZhbHVlcyhPVEhFUl9DRVJUX0ZPUk1BVCkpO1xuICAgICAgICB0aGlzLm90aGVyQ2VydCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9USEVSX0NFUlQsIE90aGVyQ2VydGlmaWNhdGVGb3JtYXQuZGVmYXVsdFZhbHVlcyhPVEhFUl9DRVJUKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBPVEhFUl9DRVJUX0ZPUk1BVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBPVEhFUl9DRVJUOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkFueSgpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMub3RoZXJDZXJ0Rm9ybWF0IHx8IE9USEVSX0NFUlRfRk9STUFUKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkFueSh7IG5hbWU6IChuYW1lcy5vdGhlckNlcnQgfHwgT1RIRVJfQ0VSVCkgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRIKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBPdGhlckNlcnRpZmljYXRlRm9ybWF0LnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5vdGhlckNlcnRGb3JtYXQgPSBhc24xLnJlc3VsdC5vdGhlckNlcnRGb3JtYXQudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLm90aGVyQ2VydCA9IGFzbjEucmVzdWx0Lm90aGVyQ2VydDtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLm90aGVyQ2VydEZvcm1hdCB9KSxcbiAgICAgICAgICAgICAgICB0aGlzLm90aGVyQ2VydFxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgb3RoZXJDZXJ0Rm9ybWF0OiB0aGlzLm90aGVyQ2VydEZvcm1hdFxuICAgICAgICB9O1xuICAgICAgICBpZiAoISh0aGlzLm90aGVyQ2VydCBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpKSB7XG4gICAgICAgICAgICByZXMub3RoZXJDZXJ0ID0gdGhpcy5vdGhlckNlcnQudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5cbmNvbnN0IENFUlRJRklDQVRFUyQxID0gXCJjZXJ0aWZpY2F0ZXNcIjtcbmNvbnN0IENMRUFSX1BST1BTJEcgPSBbXG4gICAgQ0VSVElGSUNBVEVTJDEsXG5dO1xuY2xhc3MgQ2VydGlmaWNhdGVTZXQgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmNlcnRpZmljYXRlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENFUlRJRklDQVRFUyQxLCBDZXJ0aWZpY2F0ZVNldC5kZWZhdWx0VmFsdWVzKENFUlRJRklDQVRFUyQxKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDRVJUSUZJQ0FURVMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNlcnRpZmljYXRlcyB8fCBDRVJUSUZJQ0FURVMkMSksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENlcnRpZmljYXRlLnNjaGVtYSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5BbnkoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEF0dHJpYnV0ZUNlcnRpZmljYXRlVjIuc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogM1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogT3RoZXJDZXJ0aWZpY2F0ZUZvcm1hdC5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJEcpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIENlcnRpZmljYXRlU2V0LnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jZXJ0aWZpY2F0ZXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LmNlcnRpZmljYXRlcyB8fCBbXSwgKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluaXRpYWxUYWdOdW1iZXIgPSBlbGVtZW50LmlkQmxvY2sudGFnTnVtYmVyO1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQuaWRCbG9jay50YWdDbGFzcyA9PT0gMSlcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENlcnRpZmljYXRlKHsgc2NoZW1hOiBlbGVtZW50IH0pO1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudFNlcXVlbmNlID0gbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGVsZW1lbnQudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzd2l0Y2ggKGluaXRpYWxUYWdOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50U2VxdWVuY2UudmFsdWVCbG9jay52YWx1ZVswXS52YWx1ZUJsb2NrLnZhbHVlWzBdLnZhbHVlQmxvY2sudmFsdWVEZWMgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXR0cmlidXRlQ2VydGlmaWNhdGVWMih7IHNjaGVtYTogZWxlbWVudFNlcXVlbmNlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYxKHsgc2NoZW1hOiBlbGVtZW50U2VxdWVuY2UgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXR0cmlidXRlQ2VydGlmaWNhdGVWMih7IHNjaGVtYTogZWxlbWVudFNlcXVlbmNlIH0pO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBPdGhlckNlcnRpZmljYXRlRm9ybWF0KHsgc2NoZW1hOiBlbGVtZW50U2VxdWVuY2UgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuY2VydGlmaWNhdGVzLCBlbGVtZW50ID0+IHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAoZWxlbWVudCBpbnN0YW5jZW9mIENlcnRpZmljYXRlKTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LnRvU2NoZW1hKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgKGVsZW1lbnQgaW5zdGFuY2VvZiBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYxKTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlbGVtZW50LnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgKGVsZW1lbnQgaW5zdGFuY2VvZiBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZVYyKTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlbGVtZW50LnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgKGVsZW1lbnQgaW5zdGFuY2VvZiBPdGhlckNlcnRpZmljYXRlRm9ybWF0KTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlbGVtZW50LnRvU2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LnRvU2NoZW1hKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNlcnRpZmljYXRlczogQXJyYXkuZnJvbSh0aGlzLmNlcnRpZmljYXRlcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cbkNlcnRpZmljYXRlU2V0LkNMQVNTX05BTUUgPSBcIkNlcnRpZmljYXRlU2V0XCI7XG5cbmNvbnN0IE9USEVSX1JFVl9JTkZPX0ZPUk1BVCA9IFwib3RoZXJSZXZJbmZvRm9ybWF0XCI7XG5jb25zdCBPVEhFUl9SRVZfSU5GTyA9IFwib3RoZXJSZXZJbmZvXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRGID0gW1xuICAgIE9USEVSX1JFVl9JTkZPX0ZPUk1BVCxcbiAgICBPVEhFUl9SRVZfSU5GT1xuXTtcbmNsYXNzIE90aGVyUmV2b2NhdGlvbkluZm9Gb3JtYXQgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm90aGVyUmV2SW5mb0Zvcm1hdCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9USEVSX1JFVl9JTkZPX0ZPUk1BVCwgT3RoZXJSZXZvY2F0aW9uSW5mb0Zvcm1hdC5kZWZhdWx0VmFsdWVzKE9USEVSX1JFVl9JTkZPX0ZPUk1BVCkpO1xuICAgICAgICB0aGlzLm90aGVyUmV2SW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9USEVSX1JFVl9JTkZPLCBPdGhlclJldm9jYXRpb25JbmZvRm9ybWF0LmRlZmF1bHRWYWx1ZXMoT1RIRVJfUkVWX0lORk8pKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIE9USEVSX1JFVl9JTkZPX0ZPUk1BVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBPVEhFUl9SRVZfSU5GTzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLm90aGVyUmV2SW5mb0Zvcm1hdCB8fCBPVEhFUl9SRVZfSU5GT19GT1JNQVQpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQW55KHsgbmFtZTogKG5hbWVzLm90aGVyUmV2SW5mbyB8fCBPVEhFUl9SRVZfSU5GTykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRGKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBPdGhlclJldm9jYXRpb25JbmZvRm9ybWF0LnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5vdGhlclJldkluZm9Gb3JtYXQgPSBhc24xLnJlc3VsdC5vdGhlclJldkluZm9Gb3JtYXQudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLm90aGVyUmV2SW5mbyA9IGFzbjEucmVzdWx0Lm90aGVyUmV2SW5mbztcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLm90aGVyUmV2SW5mb0Zvcm1hdCB9KSxcbiAgICAgICAgICAgICAgICB0aGlzLm90aGVyUmV2SW5mb1xuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgb3RoZXJSZXZJbmZvRm9ybWF0OiB0aGlzLm90aGVyUmV2SW5mb0Zvcm1hdFxuICAgICAgICB9O1xuICAgICAgICBpZiAoISh0aGlzLm90aGVyUmV2SW5mbyBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpKSB7XG4gICAgICAgICAgICByZXMub3RoZXJSZXZJbmZvID0gdGhpcy5vdGhlclJldkluZm8udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5PdGhlclJldm9jYXRpb25JbmZvRm9ybWF0LkNMQVNTX05BTUUgPSBcIk90aGVyUmV2b2NhdGlvbkluZm9Gb3JtYXRcIjtcblxuY29uc3QgQ1JMUyQzID0gXCJjcmxzXCI7XG5jb25zdCBPVEhFUl9SRVZPQ0FUSU9OX0lORk9TID0gXCJvdGhlclJldm9jYXRpb25JbmZvc1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkRSA9IFtcbiAgICBDUkxTJDNcbl07XG5jbGFzcyBSZXZvY2F0aW9uSW5mb0Nob2ljZXMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmNybHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDUkxTJDMsIFJldm9jYXRpb25JbmZvQ2hvaWNlcy5kZWZhdWx0VmFsdWVzKENSTFMkMykpO1xuICAgICAgICB0aGlzLm90aGVyUmV2b2NhdGlvbkluZm9zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT1RIRVJfUkVWT0NBVElPTl9JTkZPUywgUmV2b2NhdGlvbkluZm9DaG9pY2VzLmRlZmF1bHRWYWx1ZXMoT1RIRVJfUkVWT0NBVElPTl9JTkZPUykpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ1JMUyQzOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgT1RIRVJfUkVWT0NBVElPTl9JTkZPUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNybHMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdC5zY2hlbWEoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcigpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5BbnkoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJEUpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJldm9jYXRpb25JbmZvQ2hvaWNlcy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBjcmxzOiBDUkxTJDNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoYXNuMS5yZXN1bHQuY3Jscykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGFzbjEucmVzdWx0LmNybHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNybHMucHVzaChuZXcgQ2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdCh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLm90aGVyUmV2b2NhdGlvbkluZm9zLnB1c2gobmV3IE90aGVyUmV2b2NhdGlvbkluZm9Gb3JtYXQoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKC4uLkFycmF5LmZyb20odGhpcy5jcmxzLCBvID0+IG8udG9TY2hlbWEoKSkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKC4uLkFycmF5LmZyb20odGhpcy5vdGhlclJldm9jYXRpb25JbmZvcywgZWxlbWVudCA9PiB7XG4gICAgICAgICAgICBjb25zdCBzY2hlbWEgPSBlbGVtZW50LnRvU2NoZW1hKCk7XG4gICAgICAgICAgICBzY2hlbWEuaWRCbG9jay50YWdDbGFzcyA9IDM7XG4gICAgICAgICAgICBzY2hlbWEuaWRCbG9jay50YWdOdW1iZXIgPSAxO1xuICAgICAgICAgICAgcmV0dXJuIHNjaGVtYTtcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNybHM6IEFycmF5LmZyb20odGhpcy5jcmxzLCBvID0+IG8udG9KU09OKCkpLFxuICAgICAgICAgICAgb3RoZXJSZXZvY2F0aW9uSW5mb3M6IEFycmF5LmZyb20odGhpcy5vdGhlclJldm9jYXRpb25JbmZvcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cblJldm9jYXRpb25JbmZvQ2hvaWNlcy5DTEFTU19OQU1FID0gXCJSZXZvY2F0aW9uSW5mb0Nob2ljZXNcIjtcblxuY29uc3QgQ0VSVFMkMyA9IFwiY2VydHNcIjtcbmNvbnN0IENSTFMkMiA9IFwiY3Jsc1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkRCA9IFtcbiAgICBDRVJUUyQzLFxuICAgIENSTFMkMixcbl07XG5jbGFzcyBPcmlnaW5hdG9ySW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuY3JscyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENSTFMkMiwgT3JpZ2luYXRvckluZm8uZGVmYXVsdFZhbHVlcyhDUkxTJDIpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIENFUlRTJDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDZXJ0aWZpY2F0ZVNldCgpO1xuICAgICAgICAgICAgY2FzZSBDUkxTJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZXZvY2F0aW9uSW5mb0Nob2ljZXMoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQ0VSVFMkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmNlcnRpZmljYXRlcy5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBDUkxTJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUuY3Jscy5sZW5ndGggPT09IDApICYmIChtZW1iZXJWYWx1ZS5vdGhlclJldm9jYXRpb25JbmZvcy5sZW5ndGggPT09IDApKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5jZXJ0cyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IENlcnRpZmljYXRlU2V0LnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNybHMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBSZXZvY2F0aW9uSW5mb0Nob2ljZXMuc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkRCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgT3JpZ2luYXRvckluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgY2VydHM6IENFUlRTJDMsXG4gICAgICAgICAgICAgICAgY3JsczogQ1JMUyQyXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKENFUlRTJDMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuY2VydHMgPSBuZXcgQ2VydGlmaWNhdGVTZXQoe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYXNuMS5yZXN1bHQuY2VydHMudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQ1JMUyQyIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICB0aGlzLmNybHMgPSBuZXcgUmV2b2NhdGlvbkluZm9DaG9pY2VzKHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0LmNybHMudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgc2VxdWVuY2VWYWx1ZSA9IFtdO1xuICAgICAgICBpZiAodGhpcy5jZXJ0cykge1xuICAgICAgICAgICAgc2VxdWVuY2VWYWx1ZS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuY2VydHMudG9TY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3Jscykge1xuICAgICAgICAgICAgc2VxdWVuY2VWYWx1ZS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuY3Jscy50b1NjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IHNlcXVlbmNlVmFsdWVcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHt9O1xuICAgICAgICBpZiAodGhpcy5jZXJ0cykge1xuICAgICAgICAgICAgcmVzLmNlcnRzID0gdGhpcy5jZXJ0cy50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jcmxzKSB7XG4gICAgICAgICAgICByZXMuY3JscyA9IHRoaXMuY3Jscy50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cbk9yaWdpbmF0b3JJbmZvLkNMQVNTX05BTUUgPSBcIk9yaWdpbmF0b3JJbmZvXCI7XG5cbmNvbnN0IElTU1VFUiA9IFwiaXNzdWVyXCI7XG5jb25zdCBTRVJJQUxfTlVNQkVSJDIgPSBcInNlcmlhbE51bWJlclwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkQyA9IFtcbiAgICBJU1NVRVIsXG4gICAgU0VSSUFMX05VTUJFUiQyLFxuXTtcbmNsYXNzIElzc3VlckFuZFNlcmlhbE51bWJlciBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaXNzdWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSLCBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIuZGVmYXVsdFZhbHVlcyhJU1NVRVIpKTtcbiAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTRVJJQUxfTlVNQkVSJDIsIElzc3VlckFuZFNlcmlhbE51bWJlci5kZWZhdWx0VmFsdWVzKFNFUklBTF9OVU1CRVIkMikpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMoKTtcbiAgICAgICAgICAgIGNhc2UgU0VSSUFMX05VTUJFUiQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMuc2NoZW1hKG5hbWVzLmlzc3VlciB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnNlcmlhbE51bWJlciB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkQyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgSXNzdWVyQW5kU2VyaWFsTnVtYmVyLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGlzc3Vlcjoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBJU1NVRVJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiBTRVJJQUxfTlVNQkVSJDJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmlzc3VlciA9IG5ldyBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuaXNzdWVyIH0pO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IGFzbjEucmVzdWx0LnNlcmlhbE51bWJlcjtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMuaXNzdWVyLnRvU2NoZW1hKCksXG4gICAgICAgICAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXJcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpc3N1ZXI6IHRoaXMuaXNzdWVyLnRvSlNPTigpLFxuICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiB0aGlzLnNlcmlhbE51bWJlci50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5Jc3N1ZXJBbmRTZXJpYWxOdW1iZXIuQ0xBU1NfTkFNRSA9IFwiSXNzdWVyQW5kU2VyaWFsTnVtYmVyXCI7XG5cbmNvbnN0IFZBUklBTlQkMyA9IFwidmFyaWFudFwiO1xuY29uc3QgVkFMVUUkMyA9IFwidmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJEIgPSBbXG4gICAgXCJibG9ja05hbWVcIlxuXTtcbmNsYXNzIFJlY2lwaWVudElkZW50aWZpZXIgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZhcmlhbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWQVJJQU5UJDMsIFJlY2lwaWVudElkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhWQVJJQU5UJDMpKTtcbiAgICAgICAgaWYgKFZBTFVFJDMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZBTFVFJDMsIFJlY2lwaWVudElkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhWQUxVRSQzKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZBUklBTlQkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKC0xKTtcbiAgICAgICAgICAgIGNhc2UgVkFMVUUkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZBUklBTlQkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSAoLTEpKTtcbiAgICAgICAgICAgIGNhc2UgVkFMVUUkMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKE9iamVjdC5rZXlzKG1lbWJlclZhbHVlKS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgSXNzdWVyQW5kU2VyaWFsTnVtYmVyLnNjaGVtYSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJEIpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJlY2lwaWVudElkZW50aWZpZXIuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBcImJsb2NrTmFtZVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKGFzbjEucmVzdWx0LmJsb2NrTmFtZS5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAxO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmJsb2NrTmFtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudmFyaWFudCA9IDI7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBhc24xLnJlc3VsdC5ibG9ja05hbWUudmFsdWVCbG9jay52YWx1ZUhleCB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLnZhcmlhbnQpIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnZhbHVlIGluc3RhbmNlb2YgSXNzdWVyQW5kU2VyaWFsTnVtYmVyKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3QgdHlwZSBvZiBSZWNpcGllbnRJZGVudGlmaWVyLnZhbHVlLiBJdCBzaG91bGQgYmUgSXNzdWVyQW5kU2VyaWFsTnVtYmVyLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUudG9TY2hlbWEoKTtcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnZhbHVlIGluc3RhbmNlb2YgYXNuMWpzLk9jdGV0U3RyaW5nKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3QgdHlwZSBvZiBSZWNpcGllbnRJZGVudGlmaWVyLnZhbHVlLiBJdCBzaG91bGQgYmUgQVNOLjEgT2N0ZXRTdHJpbmcuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZUhleDogdGhpcy52YWx1ZS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlld1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZhcmlhbnQ6IHRoaXMudmFyaWFudFxuICAgICAgICB9O1xuICAgICAgICBpZiAoKHRoaXMudmFyaWFudCA9PT0gMSB8fCB0aGlzLnZhcmlhbnQgPT09IDIpICYmIHRoaXMudmFsdWUpIHtcbiAgICAgICAgICAgIHJlcy52YWx1ZSA9IHRoaXMudmFsdWUudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5SZWNpcGllbnRJZGVudGlmaWVyLkNMQVNTX05BTUUgPSBcIlJlY2lwaWVudElkZW50aWZpZXJcIjtcblxuY29uc3QgVkVSU0lPTiRjID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBSSUQkMSA9IFwicmlkXCI7XG5jb25zdCBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMyA9IFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiO1xuY29uc3QgRU5DUllQVEVEX0tFWSQzID0gXCJlbmNyeXB0ZWRLZXlcIjtcbmNvbnN0IFJFQ0lQSUVOVF9DRVJUSUZJQ0FURSQxID0gXCJyZWNpcGllbnRDZXJ0aWZpY2F0ZVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkQSA9IFtcbiAgICBWRVJTSU9OJGMsXG4gICAgUklEJDEsXG4gICAgS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNJDMsXG4gICAgRU5DUllQVEVEX0tFWSQzLFxuXTtcbmNsYXNzIEtleVRyYW5zUmVjaXBpZW50SW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kYywgS2V5VHJhbnNSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRjKSk7XG4gICAgICAgIHRoaXMucmlkID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUklEJDEsIEtleVRyYW5zUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKFJJRCQxKSk7XG4gICAgICAgIHRoaXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQzLCBLZXlUcmFuc1JlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMykpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZEtleSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9LRVkkMywgS2V5VHJhbnNSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0tFWSQzKSk7XG4gICAgICAgIHRoaXMucmVjaXBpZW50Q2VydGlmaWNhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRUNJUElFTlRfQ0VSVElGSUNBVEUkMSwgS2V5VHJhbnNSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoUkVDSVBJRU5UX0NFUlRJRklDQVRFJDEpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kYzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKC0xKTtcbiAgICAgICAgICAgIGNhc2UgUklEJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgY2FzZSBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWSQzOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIFJFQ0lQSUVOVF9DRVJUSUZJQ0FURSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2VydGlmaWNhdGUoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiRjOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IEtleVRyYW5zUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKFZFUlNJT04kYykpO1xuICAgICAgICAgICAgY2FzZSBSSUQkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKE9iamVjdC5rZXlzKG1lbWJlclZhbHVlKS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMzpcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWSQzOlxuICAgICAgICAgICAgICAgIHJldHVybiBtZW1iZXJWYWx1ZS5pc0VxdWFsKEtleVRyYW5zUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgUkVDSVBJRU5UX0NFUlRJRklDQVRFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudmVyc2lvbiB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIFJlY2lwaWVudElkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnJpZCB8fCB7fSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5lbmNyeXB0ZWRLZXkgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJEEpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEtleVRyYW5zUmVjaXBpZW50SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBWRVJTSU9OJGMsXG4gICAgICAgICAgICAgICAgcmlkOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFJJRCQxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNJDNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZW5jcnlwdGVkS2V5OiBFTkNSWVBURURfS0VZJDNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdC52ZXJzaW9uLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIGlmIChhc24xLnJlc3VsdC5yaWQuaWRCbG9jay50YWdDbGFzcyA9PT0gMykge1xuICAgICAgICAgICAgdGhpcy5yaWQgPSBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IGFzbjEucmVzdWx0LnJpZC52YWx1ZUJsb2NrLnZhbHVlSGV4IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yaWQgPSBuZXcgSXNzdWVyQW5kU2VyaWFsTnVtYmVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5yaWQgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmtleUVuY3J5cHRpb25BbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkS2V5ID0gYXNuMS5yZXN1bHQuZW5jcnlwdGVkS2V5O1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMucmlkIGluc3RhbmNlb2YgSXNzdWVyQW5kU2VyaWFsTnVtYmVyKSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSAwO1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5yaWQudG9TY2hlbWEoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSAyO1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWVIZXg6IHRoaXMucmlkLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0udG9TY2hlbWEoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5lbmNyeXB0ZWRLZXkpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy52ZXJzaW9uLFxuICAgICAgICAgICAgcmlkOiB0aGlzLnJpZC50b0pTT04oKSxcbiAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IHRoaXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIGVuY3J5cHRlZEtleTogdGhpcy5lbmNyeXB0ZWRLZXkudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgfVxufVxuS2V5VHJhbnNSZWNpcGllbnRJbmZvLkNMQVNTX05BTUUgPSBcIktleVRyYW5zUmVjaXBpZW50SW5mb1wiO1xuXG5jb25zdCBBTEdPUklUSE0gPSBcImFsZ29yaXRobVwiO1xuY29uc3QgUFVCTElDX0tFWSA9IFwicHVibGljS2V5XCI7XG5jb25zdCBDTEVBUl9QUk9QUyR6ID0gW1xuICAgIEFMR09SSVRITSxcbiAgICBQVUJMSUNfS0VZXG5dO1xuY2xhc3MgT3JpZ2luYXRvclB1YmxpY0tleSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuYWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQUxHT1JJVEhNLCBPcmlnaW5hdG9yUHVibGljS2V5LmRlZmF1bHRWYWx1ZXMoQUxHT1JJVEhNKSk7XG4gICAgICAgIHRoaXMucHVibGljS2V5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUFVCTElDX0tFWSwgT3JpZ2luYXRvclB1YmxpY0tleS5kZWZhdWx0VmFsdWVzKFBVQkxJQ19LRVkpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEFMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgUFVCTElDX0tFWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgQUxHT1JJVEhNOlxuICAgICAgICAgICAgY2FzZSBQVUJMSUNfS0VZOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChPcmlnaW5hdG9yUHVibGljS2V5LmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuYWxnb3JpdGhtIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5wdWJsaWNLZXkgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHopO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIE9yaWdpbmF0b3JQdWJsaWNLZXkuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEFMR09SSVRITVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBwdWJsaWNLZXk6IFBVQkxJQ19LRVlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5hbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMucHVibGljS2V5ID0gYXNuMS5yZXN1bHQucHVibGljS2V5O1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGhpcy5hbGdvcml0aG0udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLnB1YmxpY0tleVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFsZ29yaXRobTogdGhpcy5hbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBwdWJsaWNLZXk6IHRoaXMucHVibGljS2V5LnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgIH1cbn1cbk9yaWdpbmF0b3JQdWJsaWNLZXkuQ0xBU1NfTkFNRSA9IFwiT3JpZ2luYXRvclB1YmxpY0tleVwiO1xuXG5jb25zdCBWQVJJQU5UJDIgPSBcInZhcmlhbnRcIjtcbmNvbnN0IFZBTFVFJDIgPSBcInZhbHVlXCI7XG5jb25zdCBDTEVBUl9QUk9QUyR5ID0gW1xuICAgIFwiYmxvY2tOYW1lXCIsXG5dO1xuY2xhc3MgT3JpZ2luYXRvcklkZW50aWZpZXJPcktleSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmFyaWFudCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZBUklBTlQkMiwgT3JpZ2luYXRvcklkZW50aWZpZXJPcktleS5kZWZhdWx0VmFsdWVzKFZBUklBTlQkMikpO1xuICAgICAgICBpZiAoVkFMVUUkMiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkFMVUUkMiwgT3JpZ2luYXRvcklkZW50aWZpZXJPcktleS5kZWZhdWx0VmFsdWVzKFZBTFVFJDIpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkFSSUFOVCQyOlxuICAgICAgICAgICAgICAgIHJldHVybiAoLTEpO1xuICAgICAgICAgICAgY2FzZSBWQUxVRSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkFSSUFOVCQyOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09ICgtMSkpO1xuICAgICAgICAgICAgY2FzZSBWQUxVRSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIuc2NoZW1hKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBPcmlnaW5hdG9yUHVibGljS2V5LnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHkpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIE9yaWdpbmF0b3JJZGVudGlmaWVyT3JLZXkuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBcImJsb2NrTmFtZVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgaWYgKGFzbjEucmVzdWx0LmJsb2NrTmFtZS5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAxO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmJsb2NrTmFtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChhc24xLnJlc3VsdC5ibG9ja05hbWUuaWRCbG9jay50YWdOdW1iZXIgPT09IDApIHtcbiAgICAgICAgICAgICAgICBhc24xLnJlc3VsdC5ibG9ja05hbWUuaWRCbG9jay50YWdDbGFzcyA9IDE7XG4gICAgICAgICAgICAgICAgYXNuMS5yZXN1bHQuYmxvY2tOYW1lLmlkQmxvY2sudGFnTnVtYmVyID0gNDtcbiAgICAgICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAyO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBhc24xLnJlc3VsdC5ibG9ja05hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAzO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBuZXcgT3JpZ2luYXRvclB1YmxpY0tleSh7XG4gICAgICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYXNuMS5yZXN1bHQuYmxvY2tOYW1lLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLnZhcmlhbnQpIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS50b1NjaGVtYSgpO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUuaWRCbG9jay50YWdDbGFzcyA9IDM7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZS5pZEJsb2NrLnRhZ051bWJlciA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBfc2NoZW1hID0gdGhpcy52YWx1ZS50b1NjaGVtYSgpO1xuICAgICAgICAgICAgICAgICAgICBfc2NoZW1hLmlkQmxvY2sudGFnQ2xhc3MgPSAzO1xuICAgICAgICAgICAgICAgICAgICBfc2NoZW1hLmlkQmxvY2sudGFnTnVtYmVyID0gMTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9zY2hlbWE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZhcmlhbnQ6IHRoaXMudmFyaWFudFxuICAgICAgICB9O1xuICAgICAgICBpZiAoKHRoaXMudmFyaWFudCA9PT0gMSkgfHwgKHRoaXMudmFyaWFudCA9PT0gMikgfHwgKHRoaXMudmFyaWFudCA9PT0gMykpIHtcbiAgICAgICAgICAgIHJlcy52YWx1ZSA9IHRoaXMudmFsdWUudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5PcmlnaW5hdG9ySWRlbnRpZmllck9yS2V5LkNMQVNTX05BTUUgPSBcIk9yaWdpbmF0b3JJZGVudGlmaWVyT3JLZXlcIjtcblxuY29uc3QgS0VZX0FUVFJfSUQgPSBcImtleUF0dHJJZFwiO1xuY29uc3QgS0VZX0FUVFIgPSBcImtleUF0dHJcIjtcbmNvbnN0IENMRUFSX1BST1BTJHggPSBbXG4gICAgS0VZX0FUVFJfSUQsXG4gICAgS0VZX0FUVFIsXG5dO1xuY2xhc3MgT3RoZXJLZXlBdHRyaWJ1dGUgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmtleUF0dHJJZCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEtFWV9BVFRSX0lELCBPdGhlcktleUF0dHJpYnV0ZS5kZWZhdWx0VmFsdWVzKEtFWV9BVFRSX0lEKSk7XG4gICAgICAgIGlmIChLRVlfQVRUUiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmtleUF0dHIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBLRVlfQVRUUiwgT3RoZXJLZXlBdHRyaWJ1dGUuZGVmYXVsdFZhbHVlcyhLRVlfQVRUUikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBLRVlfQVRUUl9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBLRVlfQVRUUjpcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEtFWV9BVFRSX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiAodHlwZW9mIG1lbWJlclZhbHVlID09PSBcInN0cmluZ1wiICYmIG1lbWJlclZhbHVlID09PSBFTVBUWV9TVFJJTkcpO1xuICAgICAgICAgICAgY2FzZSBLRVlfQVRUUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKE9iamVjdC5rZXlzKG1lbWJlclZhbHVlKS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgb3B0aW9uYWw6IChuYW1lcy5vcHRpb25hbCB8fCB0cnVlKSxcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLmtleUF0dHJJZCB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQW55KHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5rZXlBdHRyIHx8IEVNUFRZX1NUUklORylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHgpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIE90aGVyS2V5QXR0cmlidXRlLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGtleUF0dHJJZDogS0VZX0FUVFJfSUQsXG4gICAgICAgICAgICAgICAga2V5QXR0cjogS0VZX0FUVFJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmtleUF0dHJJZCA9IGFzbjEucmVzdWx0LmtleUF0dHJJZC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmIChLRVlfQVRUUiBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5rZXlBdHRyID0gYXNuMS5yZXN1bHQua2V5QXR0cjtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5rZXlBdHRySWQgfSkpO1xuICAgICAgICBpZiAoS0VZX0FUVFIgaW4gdGhpcykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmtleUF0dHIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXksXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICBrZXlBdHRySWQ6IHRoaXMua2V5QXR0cklkXG4gICAgICAgIH07XG4gICAgICAgIGlmIChLRVlfQVRUUiBpbiB0aGlzKSB7XG4gICAgICAgICAgICByZXMua2V5QXR0ciA9IHRoaXMua2V5QXR0ci50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cbk90aGVyS2V5QXR0cmlidXRlLkNMQVNTX05BTUUgPSBcIk90aGVyS2V5QXR0cmlidXRlXCI7XG5cbmNvbnN0IFNVQkpFQ1RfS0VZX0lERU5USUZJRVIgPSBcInN1YmplY3RLZXlJZGVudGlmaWVyXCI7XG5jb25zdCBEQVRFJDEgPSBcImRhdGVcIjtcbmNvbnN0IE9USEVSJDEgPSBcIm90aGVyXCI7XG5jb25zdCBDTEVBUl9QUk9QUyR3ID0gW1xuICAgIFNVQkpFQ1RfS0VZX0lERU5USUZJRVIsXG4gICAgREFURSQxLFxuICAgIE9USEVSJDEsXG5dO1xuY2xhc3MgUmVjaXBpZW50S2V5SWRlbnRpZmllciBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc3ViamVjdEtleUlkZW50aWZpZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTVUJKRUNUX0tFWV9JREVOVElGSUVSLCBSZWNpcGllbnRLZXlJZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoU1VCSkVDVF9LRVlfSURFTlRJRklFUikpO1xuICAgICAgICBpZiAoREFURSQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIERBVEUkMSwgUmVjaXBpZW50S2V5SWRlbnRpZmllci5kZWZhdWx0VmFsdWVzKERBVEUkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChPVEhFUiQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMub3RoZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPVEhFUiQxLCBSZWNpcGllbnRLZXlJZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoT1RIRVIkMSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBTVUJKRUNUX0tFWV9JREVOVElGSUVSOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIERBVEUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoKTtcbiAgICAgICAgICAgIGNhc2UgT1RIRVIkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE90aGVyS2V5QXR0cmlidXRlKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFNVQkpFQ1RfS0VZX0lERU5USUZJRVI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKFJlY2lwaWVudEtleUlkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhTVUJKRUNUX0tFWV9JREVOVElGSUVSKSkpO1xuICAgICAgICAgICAgY2FzZSBEQVRFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUueWVhciA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1vbnRoID09PSAwKSAmJlxuICAgICAgICAgICAgICAgICAgICAobWVtYmVyVmFsdWUuZGF5ID09PSAwKSAmJlxuICAgICAgICAgICAgICAgICAgICAobWVtYmVyVmFsdWUuaG91ciA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1pbnV0ZSA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLnNlY29uZCA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1pbGxpc2Vjb25kID09PSAwKSk7XG4gICAgICAgICAgICBjYXNlIE9USEVSJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUua2V5QXR0cklkID09PSBFTVBUWV9TVFJJTkcpICYmICgoXCJrZXlBdHRyXCIgaW4gbWVtYmVyVmFsdWUpID09PSBmYWxzZSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgbmFtZTogKG5hbWVzLnN1YmplY3RLZXlJZGVudGlmaWVyIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRhdGUgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIE90aGVyS2V5QXR0cmlidXRlLnNjaGVtYShuYW1lcy5vdGhlciB8fCB7fSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyR3KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBSZWNpcGllbnRLZXlJZGVudGlmaWVyLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHN1YmplY3RLZXlJZGVudGlmaWVyOiBTVUJKRUNUX0tFWV9JREVOVElGSUVSLFxuICAgICAgICAgICAgICAgIGRhdGU6IERBVEUkMSxcbiAgICAgICAgICAgICAgICBvdGhlcjoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBPVEhFUiQxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5zdWJqZWN0S2V5SWRlbnRpZmllciA9IGFzbjEucmVzdWx0LnN1YmplY3RLZXlJZGVudGlmaWVyO1xuICAgICAgICBpZiAoREFURSQxIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5kYXRlID0gYXNuMS5yZXN1bHQuZGF0ZTtcbiAgICAgICAgaWYgKE9USEVSJDEgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLm90aGVyID0gbmV3IE90aGVyS2V5QXR0cmlidXRlKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5vdGhlciB9KTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5zdWJqZWN0S2V5SWRlbnRpZmllcik7XG4gICAgICAgIGlmICh0aGlzLmRhdGUpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5kYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vdGhlcikge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLm90aGVyLnRvU2NoZW1hKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHN1YmplY3RLZXlJZGVudGlmaWVyOiB0aGlzLnN1YmplY3RLZXlJZGVudGlmaWVyLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmRhdGUpIHtcbiAgICAgICAgICAgIHJlcy5kYXRlID0gdGhpcy5kYXRlLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm90aGVyKSB7XG4gICAgICAgICAgICByZXMub3RoZXIgPSB0aGlzLm90aGVyLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuUmVjaXBpZW50S2V5SWRlbnRpZmllci5DTEFTU19OQU1FID0gXCJSZWNpcGllbnRLZXlJZGVudGlmaWVyXCI7XG5cbmNvbnN0IFZBUklBTlQkMSA9IFwidmFyaWFudFwiO1xuY29uc3QgVkFMVUUkMSA9IFwidmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJHYgPSBbXG4gICAgXCJibG9ja05hbWVcIixcbl07XG5jbGFzcyBLZXlBZ3JlZVJlY2lwaWVudElkZW50aWZpZXIgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZhcmlhbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWQVJJQU5UJDEsIEtleUFncmVlUmVjaXBpZW50SWRlbnRpZmllci5kZWZhdWx0VmFsdWVzKFZBUklBTlQkMSkpO1xuICAgICAgICB0aGlzLnZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkFMVUUkMSwgS2V5QWdyZWVSZWNpcGllbnRJZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoVkFMVUUkMSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkFSSUFOVCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAoLTEpO1xuICAgICAgICAgICAgY2FzZSBWQUxVRSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkFSSUFOVCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09ICgtMSkpO1xuICAgICAgICAgICAgY2FzZSBWQUxVRSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIuc2NoZW1hKG5hbWVzLmlzc3VlckFuZFNlcmlhbE51bWJlciB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFJlY2lwaWVudEtleUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnJLZXlJZCB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHYpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEtleUFncmVlUmVjaXBpZW50SWRlbnRpZmllci5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBibG9ja05hbWU6IFwiYmxvY2tOYW1lXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICBpZiAoYXNuMS5yZXN1bHQuYmxvY2tOYW1lLmlkQmxvY2sudGFnQ2xhc3MgPT09IDEpIHtcbiAgICAgICAgICAgIHRoaXMudmFyaWFudCA9IDE7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gbmV3IElzc3VlckFuZFNlcmlhbE51bWJlcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuYmxvY2tOYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy52YXJpYW50ID0gMjtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBuZXcgUmVjaXBpZW50S2V5SWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0LmJsb2NrTmFtZS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMudmFyaWFudCkge1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLnRvU2NoZW1hKCk7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZS50b1NjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuQW55KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB2YXJpYW50OiB0aGlzLnZhcmlhbnQsXG4gICAgICAgIH07XG4gICAgICAgIGlmICgodGhpcy52YXJpYW50ID09PSAxKSB8fCAodGhpcy52YXJpYW50ID09PSAyKSkge1xuICAgICAgICAgICAgcmVzLnZhbHVlID0gdGhpcy52YWx1ZS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cbktleUFncmVlUmVjaXBpZW50SWRlbnRpZmllci5DTEFTU19OQU1FID0gXCJLZXlBZ3JlZVJlY2lwaWVudElkZW50aWZpZXJcIjtcblxuY29uc3QgUklEID0gXCJyaWRcIjtcbmNvbnN0IEVOQ1JZUFRFRF9LRVkkMiA9IFwiZW5jcnlwdGVkS2V5XCI7XG5jb25zdCBDTEVBUl9QUk9QUyR1ID0gW1xuICAgIFJJRCxcbiAgICBFTkNSWVBURURfS0VZJDIsXG5dO1xuY2xhc3MgUmVjaXBpZW50RW5jcnlwdGVkS2V5IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5yaWQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSSUQsIFJlY2lwaWVudEVuY3J5cHRlZEtleS5kZWZhdWx0VmFsdWVzKFJJRCkpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZEtleSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9LRVkkMiwgUmVjaXBpZW50RW5jcnlwdGVkS2V5LmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0tFWSQyKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBSSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBLZXlBZ3JlZVJlY2lwaWVudElkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFJJRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZS52YXJpYW50ID09PSAoLTEpKSAmJiAoKFwidmFsdWVcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9LRVkkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoUmVjaXBpZW50RW5jcnlwdGVkS2V5LmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0tFWSQyKSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBLZXlBZ3JlZVJlY2lwaWVudElkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnJpZCB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5lbmNyeXB0ZWRLZXkgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHUpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJlY2lwaWVudEVuY3J5cHRlZEtleS5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICByaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogUklEXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZEtleTogRU5DUllQVEVEX0tFWSQyXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5yaWQgPSBuZXcgS2V5QWdyZWVSZWNpcGllbnRJZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5yaWQgfSk7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkS2V5ID0gYXNuMS5yZXN1bHQuZW5jcnlwdGVkS2V5O1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgdGhpcy5yaWQudG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLmVuY3J5cHRlZEtleVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJpZDogdGhpcy5yaWQudG9KU09OKCksXG4gICAgICAgICAgICBlbmNyeXB0ZWRLZXk6IHRoaXMuZW5jcnlwdGVkS2V5LnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgIH1cbn1cblJlY2lwaWVudEVuY3J5cHRlZEtleS5DTEFTU19OQU1FID0gXCJSZWNpcGllbnRFbmNyeXB0ZWRLZXlcIjtcblxuY29uc3QgRU5DUllQVEVEX0tFWVMgPSBcImVuY3J5cHRlZEtleXNcIjtcbmNvbnN0IFJFQ0lQSUVOVF9FTkNSWVBURURfS0VZUyA9IFwiUmVjaXBpZW50RW5jcnlwdGVkS2V5c1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkdCA9IFtcbiAgICBSRUNJUElFTlRfRU5DUllQVEVEX0tFWVMsXG5dO1xuY2xhc3MgUmVjaXBpZW50RW5jcnlwdGVkS2V5cyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkS2V5cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9LRVlTLCBSZWNpcGllbnRFbmNyeXB0ZWRLZXlzLmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0tFWVMpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9LRVlTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLlJlY2lwaWVudEVuY3J5cHRlZEtleXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFJlY2lwaWVudEVuY3J5cHRlZEtleS5zY2hlbWEoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkdCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUmVjaXBpZW50RW5jcnlwdGVkS2V5cy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBSZWNpcGllbnRFbmNyeXB0ZWRLZXlzOiBSRUNJUElFTlRfRU5DUllQVEVEX0tFWVNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZEtleXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LlJlY2lwaWVudEVuY3J5cHRlZEtleXMsIGVsZW1lbnQgPT4gbmV3IFJlY2lwaWVudEVuY3J5cHRlZEtleSh7IHNjaGVtYTogZWxlbWVudCB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5lbmNyeXB0ZWRLZXlzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBlbmNyeXB0ZWRLZXlzOiBBcnJheS5mcm9tKHRoaXMuZW5jcnlwdGVkS2V5cywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cblJlY2lwaWVudEVuY3J5cHRlZEtleXMuQ0xBU1NfTkFNRSA9IFwiUmVjaXBpZW50RW5jcnlwdGVkS2V5c1wiO1xuXG5jb25zdCBWRVJTSU9OJGIgPSBcInZlcnNpb25cIjtcbmNvbnN0IE9SSUdJTkFUT1IgPSBcIm9yaWdpbmF0b3JcIjtcbmNvbnN0IFVLTSA9IFwidWttXCI7XG5jb25zdCBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMiA9IFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiO1xuY29uc3QgUkVDSVBJRU5UX0VOQ1JZUFRFRF9LRVkgPSBcInJlY2lwaWVudEVuY3J5cHRlZEtleXNcIjtcbmNvbnN0IFJFQ0lQSUVOVF9DRVJUSUZJQ0FURSA9IFwicmVjaXBpZW50Q2VydGlmaWNhdGVcIjtcbmNvbnN0IFJFQ0lQSUVOVF9QVUJMSUNfS0VZID0gXCJyZWNpcGllbnRQdWJsaWNLZXlcIjtcbmNvbnN0IENMRUFSX1BST1BTJHMgPSBbXG4gICAgVkVSU0lPTiRiLFxuICAgIE9SSUdJTkFUT1IsXG4gICAgVUtNLFxuICAgIEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQyLFxuICAgIFJFQ0lQSUVOVF9FTkNSWVBURURfS0VZLFxuXTtcbmNsYXNzIEtleUFncmVlUmVjaXBpZW50SW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kYiwgS2V5QWdyZWVSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRiKSk7XG4gICAgICAgIHRoaXMub3JpZ2luYXRvciA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9SSUdJTkFUT1IsIEtleUFncmVlUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKE9SSUdJTkFUT1IpKTtcbiAgICAgICAgaWYgKFVLTSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnVrbSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFVLTSwgS2V5QWdyZWVSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVUtNKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNJDIsIEtleUFncmVlUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQyKSk7XG4gICAgICAgIHRoaXMucmVjaXBpZW50RW5jcnlwdGVkS2V5cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFQ0lQSUVOVF9FTkNSWVBURURfS0VZLCBLZXlBZ3JlZVJlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhSRUNJUElFTlRfRU5DUllQVEVEX0tFWSkpO1xuICAgICAgICB0aGlzLnJlY2lwaWVudENlcnRpZmljYXRlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUkVDSVBJRU5UX0NFUlRJRklDQVRFLCBLZXlBZ3JlZVJlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhSRUNJUElFTlRfQ0VSVElGSUNBVEUpKTtcbiAgICAgICAgdGhpcy5yZWNpcGllbnRQdWJsaWNLZXkgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRUNJUElFTlRfUFVCTElDX0tFWSwgS2V5QWdyZWVSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoUkVDSVBJRU5UX1BVQkxJQ19LRVkpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kYjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgT1JJR0lOQVRPUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE9yaWdpbmF0b3JJZGVudGlmaWVyT3JLZXkoKTtcbiAgICAgICAgICAgIGNhc2UgVUtNOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBSRUNJUElFTlRfRU5DUllQVEVEX0tFWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlY2lwaWVudEVuY3J5cHRlZEtleXMoKTtcbiAgICAgICAgICAgIGNhc2UgUkVDSVBJRU5UX0NFUlRJRklDQVRFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2VydGlmaWNhdGUoKTtcbiAgICAgICAgICAgIGNhc2UgUkVDSVBJRU5UX1BVQkxJQ19LRVk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kYjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSAwKTtcbiAgICAgICAgICAgIGNhc2UgT1JJR0lOQVRPUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZS52YXJpYW50ID09PSAoLTEpKSAmJiAoKFwidmFsdWVcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIFVLTTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoS2V5QWdyZWVSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVUtNKSkpO1xuICAgICAgICAgICAgY2FzZSBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZS5hbGdvcml0aG1JZCA9PT0gRU1QVFlfU1RSSU5HKSAmJiAoKFwiYWxnb3JpdGhtUGFyYW1zXCIgaW4gbWVtYmVyVmFsdWUpID09PSBmYWxzZSkpO1xuICAgICAgICAgICAgY2FzZSBSRUNJUElFTlRfRU5DUllQVEVEX0tFWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmVuY3J5cHRlZEtleXMubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGNhc2UgUkVDSVBJRU5UX0NFUlRJRklDQVRFOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGNhc2UgUkVDSVBJRU5UX1BVQkxJQ19LRVk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogbmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogbmFtZXMudmVyc2lvbiB8fCBFTVBUWV9TVFJJTkcgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBPcmlnaW5hdG9ySWRlbnRpZmllck9yS2V5LnNjaGVtYShuYW1lcy5vcmlnaW5hdG9yIHx8IHt9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyBuYW1lOiBuYW1lcy51a20gfHwgRU1QVFlfU1RSSU5HIH0pXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLmtleUVuY3J5cHRpb25BbGdvcml0aG0gfHwge30pLFxuICAgICAgICAgICAgICAgIFJlY2lwaWVudEVuY3J5cHRlZEtleXMuc2NoZW1hKG5hbWVzLnJlY2lwaWVudEVuY3J5cHRlZEtleXMgfHwge30pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkcyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgS2V5QWdyZWVSZWNpcGllbnRJbmZvLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IFZFUlNJT04kYixcbiAgICAgICAgICAgICAgICBvcmlnaW5hdG9yOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IE9SSUdJTkFUT1JcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdWttOiBVS00sXG4gICAgICAgICAgICAgICAga2V5RW5jcnlwdGlvbkFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZWNpcGllbnRFbmNyeXB0ZWRLZXlzOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFJFQ0lQSUVOVF9FTkNSWVBURURfS0VZXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gYXNuMS5yZXN1bHQudmVyc2lvbi52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLm9yaWdpbmF0b3IgPSBuZXcgT3JpZ2luYXRvcklkZW50aWZpZXJPcktleSh7IHNjaGVtYTogYXNuMS5yZXN1bHQub3JpZ2luYXRvciB9KTtcbiAgICAgICAgaWYgKFVLTSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMudWttID0gYXNuMS5yZXN1bHQudWttO1xuICAgICAgICB0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQua2V5RW5jcnlwdGlvbkFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5yZWNpcGllbnRFbmNyeXB0ZWRLZXlzID0gbmV3IFJlY2lwaWVudEVuY3J5cHRlZEtleXMoeyBzY2hlbWE6IGFzbjEucmVzdWx0LnJlY2lwaWVudEVuY3J5cHRlZEtleXMgfSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5vcmlnaW5hdG9yLnRvU2NoZW1hKCldXG4gICAgICAgIH0pKTtcbiAgICAgICAgaWYgKHRoaXMudWttKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFt0aGlzLnVrbV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobS50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnJlY2lwaWVudEVuY3J5cHRlZEtleXMudG9TY2hlbWEoKSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIG9yaWdpbmF0b3I6IHRoaXMub3JpZ2luYXRvci50b0pTT04oKSxcbiAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IHRoaXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIHJlY2lwaWVudEVuY3J5cHRlZEtleXM6IHRoaXMucmVjaXBpZW50RW5jcnlwdGVkS2V5cy50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMudWttKSB7XG4gICAgICAgICAgICByZXMudWttID0gdGhpcy51a20udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5LZXlBZ3JlZVJlY2lwaWVudEluZm8uQ0xBU1NfTkFNRSA9IFwiS2V5QWdyZWVSZWNpcGllbnRJbmZvXCI7XG5cbmNvbnN0IEtFWV9JREVOVElGSUVSID0gXCJrZXlJZGVudGlmaWVyXCI7XG5jb25zdCBEQVRFID0gXCJkYXRlXCI7XG5jb25zdCBPVEhFUiA9IFwib3RoZXJcIjtcbmNvbnN0IENMRUFSX1BST1BTJHIgPSBbXG4gICAgS0VZX0lERU5USUZJRVIsXG4gICAgREFURSxcbiAgICBPVEhFUixcbl07XG5jbGFzcyBLRUtJZGVudGlmaWVyIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5rZXlJZGVudGlmaWVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX0lERU5USUZJRVIsIEtFS0lkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhLRVlfSURFTlRJRklFUikpO1xuICAgICAgICBpZiAoREFURSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmRhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBEQVRFLCBLRUtJZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoREFURSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChPVEhFUiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm90aGVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT1RIRVIsIEtFS0lkZW50aWZpZXIuZGVmYXVsdFZhbHVlcyhPVEhFUikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBLRVlfSURFTlRJRklFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBEQVRFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSgpO1xuICAgICAgICAgICAgY2FzZSBPVEhFUjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE90aGVyS2V5QXR0cmlidXRlKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEtFWV9JREVOVElGSUVSOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChLRUtJZGVudGlmaWVyLmRlZmF1bHRWYWx1ZXMoS0VZX0lERU5USUZJRVIpKSk7XG4gICAgICAgICAgICBjYXNlIERBVEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUueWVhciA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1vbnRoID09PSAwKSAmJlxuICAgICAgICAgICAgICAgICAgICAobWVtYmVyVmFsdWUuZGF5ID09PSAwKSAmJlxuICAgICAgICAgICAgICAgICAgICAobWVtYmVyVmFsdWUuaG91ciA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1pbnV0ZSA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLnNlY29uZCA9PT0gMCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLm1pbGxpc2Vjb25kID09PSAwKSk7XG4gICAgICAgICAgICBjYXNlIE9USEVSOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKG1lbWJlclZhbHVlLmNvbXBhcmVXaXRoRGVmYXVsdChcImtleUF0dHJJZFwiLCBtZW1iZXJWYWx1ZS5rZXlBdHRySWQpKSAmJlxuICAgICAgICAgICAgICAgICAgICAoKFwia2V5QXR0clwiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5rZXlJZGVudGlmaWVyIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRhdGUgfHwgRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIE90aGVyS2V5QXR0cmlidXRlLnNjaGVtYShuYW1lcy5vdGhlciB8fCB7fSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRyKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBLRUtJZGVudGlmaWVyLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGtleUlkZW50aWZpZXI6IEtFWV9JREVOVElGSUVSLFxuICAgICAgICAgICAgICAgIGRhdGU6IERBVEUsXG4gICAgICAgICAgICAgICAgb3RoZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogT1RIRVJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmtleUlkZW50aWZpZXIgPSBhc24xLnJlc3VsdC5rZXlJZGVudGlmaWVyO1xuICAgICAgICBpZiAoREFURSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuZGF0ZSA9IGFzbjEucmVzdWx0LmRhdGU7XG4gICAgICAgIGlmIChPVEhFUiBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMub3RoZXIgPSBuZXcgT3RoZXJLZXlBdHRyaWJ1dGUoeyBzY2hlbWE6IGFzbjEucmVzdWx0Lm90aGVyIH0pO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmtleUlkZW50aWZpZXIpO1xuICAgICAgICBpZiAodGhpcy5kYXRlKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuZGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub3RoZXIpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5vdGhlci50b1NjaGVtYSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICBrZXlJZGVudGlmaWVyOiB0aGlzLmtleUlkZW50aWZpZXIudG9KU09OKClcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuZGF0ZSkge1xuICAgICAgICAgICAgcmVzLmRhdGUgPSB0aGlzLmRhdGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub3RoZXIpIHtcbiAgICAgICAgICAgIHJlcy5vdGhlciA9IHRoaXMub3RoZXIudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5LRUtJZGVudGlmaWVyLkNMQVNTX05BTUUgPSBcIktFS0lkZW50aWZpZXJcIjtcblxuY29uc3QgVkVSU0lPTiRhID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBLRUtfSUQgPSBcImtla2lkXCI7XG5jb25zdCBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMSA9IFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiO1xuY29uc3QgRU5DUllQVEVEX0tFWSQxID0gXCJlbmNyeXB0ZWRLZXlcIjtcbmNvbnN0IFBFUl9ERUZJTkVEX0tFSyA9IFwicHJlRGVmaW5lZEtFS1wiO1xuY29uc3QgQ0xFQVJfUFJPUFMkcSA9IFtcbiAgICBWRVJTSU9OJGEsXG4gICAgS0VLX0lELFxuICAgIEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQxLFxuICAgIEVOQ1JZUFRFRF9LRVkkMSxcbl07XG5jbGFzcyBLRUtSZWNpcGllbnRJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiRhLCBLRUtSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRhKSk7XG4gICAgICAgIHRoaXMua2VraWQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBLRUtfSUQsIEtFS1JlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhLRUtfSUQpKTtcbiAgICAgICAgdGhpcy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNJDEsIEtFS1JlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMSkpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZEtleSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9LRVkkMSwgS0VLUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKEVOQ1JZUFRFRF9LRVkkMSkpO1xuICAgICAgICB0aGlzLnByZURlZmluZWRLRUsgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQRVJfREVGSU5FRF9LRUssIEtFS1JlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhQRVJfREVGSU5FRF9LRUspKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kYTpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgS0VLX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgS0VLSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0kMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIFBFUl9ERUZJTkVEX0tFSzpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfQlVGRkVSO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBcIktFS1JlY2lwaWVudEluZm9cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBLRUtSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiRhKSk7XG4gICAgICAgICAgICBjYXNlIEtFS19JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZS5jb21wYXJlV2l0aERlZmF1bHQoXCJrZXlJZGVudGlmaWVyXCIsIG1lbWJlclZhbHVlLmtleUlkZW50aWZpZXIpKSAmJlxuICAgICAgICAgICAgICAgICAgICAoKFwiZGF0ZVwiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpICYmXG4gICAgICAgICAgICAgICAgICAgICgoXCJvdGhlclwiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpKTtcbiAgICAgICAgICAgIGNhc2UgS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUuYWxnb3JpdGhtSWQgPT09IEVNUFRZX1NUUklORykgJiYgKChcImFsZ29yaXRobVBhcmFtc1wiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChLRUtSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0tFWSQxKSkpO1xuICAgICAgICAgICAgY2FzZSBQRVJfREVGSU5FRF9LRUs6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5ieXRlTGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnZlcnNpb24gfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBLRUtJZGVudGlmaWVyLnNjaGVtYShuYW1lcy5rZWtpZCB8fCB7fSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5lbmNyeXB0ZWRLZXkgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHEpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEtFS1JlY2lwaWVudEluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgdmVyc2lvbjogVkVSU0lPTiRhLFxuICAgICAgICAgICAgICAgIGtla2lkOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEtFS19JRFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBrZXlFbmNyeXB0aW9uQWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSQxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZEtleTogRU5DUllQVEVEX0tFWSQxXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gYXNuMS5yZXN1bHQudmVyc2lvbi52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLmtla2lkID0gbmV3IEtFS0lkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0Lmtla2lkIH0pO1xuICAgICAgICB0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQua2V5RW5jcnlwdGlvbkFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5lbmNyeXB0ZWRLZXkgPSBhc24xLnJlc3VsdC5lbmNyeXB0ZWRLZXk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pLFxuICAgICAgICAgICAgICAgIHRoaXMua2VraWQudG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLmVuY3J5cHRlZEtleVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIGtla2lkOiB0aGlzLmtla2lkLnRvSlNPTigpLFxuICAgICAgICAgICAga2V5RW5jcnlwdGlvbkFsZ29yaXRobTogdGhpcy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLnRvSlNPTigpLFxuICAgICAgICAgICAgZW5jcnlwdGVkS2V5OiB0aGlzLmVuY3J5cHRlZEtleS50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5LRUtSZWNpcGllbnRJbmZvLkNMQVNTX05BTUUgPSBcIktFS1JlY2lwaWVudEluZm9cIjtcblxuY29uc3QgVkVSU0lPTiQ5ID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBLRVlfREVSSVZBVElPTl9BTEdPUklUSE0gPSBcImtleURlcml2YXRpb25BbGdvcml0aG1cIjtcbmNvbnN0IEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSA9IFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiO1xuY29uc3QgRU5DUllQVEVEX0tFWSA9IFwiZW5jcnlwdGVkS2V5XCI7XG5jb25zdCBQQVNTV09SRCA9IFwicGFzc3dvcmRcIjtcbmNvbnN0IENMRUFSX1BST1BTJHAgPSBbXG4gICAgVkVSU0lPTiQ5LFxuICAgIEtFWV9ERVJJVkFUSU9OX0FMR09SSVRITSxcbiAgICBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0sXG4gICAgRU5DUllQVEVEX0tFWVxuXTtcbmNsYXNzIFBhc3N3b3JkUmVjaXBpZW50aW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kOSwgUGFzc3dvcmRSZWNpcGllbnRpbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiQ5KSk7XG4gICAgICAgIGlmIChLRVlfREVSSVZBVElPTl9BTEdPUklUSE0gaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgS0VZX0RFUklWQVRJT05fQUxHT1JJVEhNLCBQYXNzd29yZFJlY2lwaWVudGluZm8uZGVmYXVsdFZhbHVlcyhLRVlfREVSSVZBVElPTl9BTEdPUklUSE0pKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBLRVlfRU5DUllQVElPTl9BTEdPUklUSE0sIFBhc3N3b3JkUmVjaXBpZW50aW5mby5kZWZhdWx0VmFsdWVzKEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITSkpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZEtleSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOQ1JZUFRFRF9LRVksIFBhc3N3b3JkUmVjaXBpZW50aW5mby5kZWZhdWx0VmFsdWVzKEVOQ1JZUFRFRF9LRVkpKTtcbiAgICAgICAgdGhpcy5wYXNzd29yZCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBBU1NXT1JELCBQYXNzd29yZFJlY2lwaWVudGluZm8uZGVmYXVsdFZhbHVlcyhQQVNTV09SRCkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiQ5OlxuICAgICAgICAgICAgICAgIHJldHVybiAoLTEpO1xuICAgICAgICAgICAgY2FzZSBLRVlfREVSSVZBVElPTl9BTEdPUklUSE06XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIEtFWV9FTkNSWVBUSU9OX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5DUllQVEVEX0tFWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBQQVNTV09SRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfQlVGRkVSO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gKC0xKSk7XG4gICAgICAgICAgICBjYXNlIEtFWV9ERVJJVkFUSU9OX0FMR09SSVRITTpcbiAgICAgICAgICAgIGNhc2UgS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKG1lbWJlclZhbHVlLmFsZ29yaXRobUlkID09PSBFTVBUWV9TVFJJTkcpICYmICgoXCJhbGdvcml0aG1QYXJhbXNcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIEVOQ1JZUFRFRF9LRVk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKFBhc3N3b3JkUmVjaXBpZW50aW5mby5kZWZhdWx0VmFsdWVzKEVOQ1JZUFRFRF9LRVkpKSk7XG4gICAgICAgICAgICBjYXNlIFBBU1NXT1JEOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuYnl0ZUxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMua2V5RW5jcnlwdGlvbkFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5lbmNyeXB0ZWRLZXkgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJHApO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFBhc3N3b3JkUmVjaXBpZW50aW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBWRVJTSU9OJDksXG4gICAgICAgICAgICAgICAga2V5RGVyaXZhdGlvbkFsZ29yaXRobTogS0VZX0RFUklWQVRJT05fQUxHT1JJVEhNLFxuICAgICAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogS0VZX0VOQ1JZUFRJT05fQUxHT1JJVEhNXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZEtleTogRU5DUllQVEVEX0tFWVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgaWYgKEtFWV9ERVJJVkFUSU9OX0FMR09SSVRITSBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgIHNjaGVtYTogbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdC5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmtleUVuY3J5cHRpb25BbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkS2V5ID0gYXNuMS5yZXN1bHQuZW5jcnlwdGVkS2V5O1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgaWYgKHRoaXMua2V5RGVyaXZhdGlvbkFsZ29yaXRobSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLmtleURlcml2YXRpb25BbGdvcml0aG0udG9TY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0udG9TY2hlbWEoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5lbmNyeXB0ZWRLZXkpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLnZlcnNpb24sXG4gICAgICAgICAgICBrZXlFbmNyeXB0aW9uQWxnb3JpdGhtOiB0aGlzLmtleUVuY3J5cHRpb25BbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBlbmNyeXB0ZWRLZXk6IHRoaXMuZW5jcnlwdGVkS2V5LnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtKSB7XG4gICAgICAgICAgICByZXMua2V5RGVyaXZhdGlvbkFsZ29yaXRobSA9IHRoaXMua2V5RGVyaXZhdGlvbkFsZ29yaXRobS50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cblBhc3N3b3JkUmVjaXBpZW50aW5mby5DTEFTU19OQU1FID0gXCJQYXNzd29yZFJlY2lwaWVudEluZm9cIjtcblxuY29uc3QgT1JJX1RZUEUgPSBcIm9yaVR5cGVcIjtcbmNvbnN0IE9SSV9WQUxVRSA9IFwib3JpVmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJG8gPSBbXG4gICAgT1JJX1RZUEUsXG4gICAgT1JJX1ZBTFVFXG5dO1xuY2xhc3MgT3RoZXJSZWNpcGllbnRJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5vcmlUeXBlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT1JJX1RZUEUsIE90aGVyUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKE9SSV9UWVBFKSk7XG4gICAgICAgIHRoaXMub3JpVmFsdWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPUklfVkFMVUUsIE90aGVyUmVjaXBpZW50SW5mby5kZWZhdWx0VmFsdWVzKE9SSV9WQUxVRSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgT1JJX1RZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgT1JJX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgT1JJX1RZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgT1JJX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IG5hbWU6IChuYW1lcy5vcmlUeXBlIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5BbnkoeyBuYW1lOiAobmFtZXMub3JpVmFsdWUgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJG8pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIE90aGVyUmVjaXBpZW50SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBvcmlUeXBlOiBPUklfVFlQRSxcbiAgICAgICAgICAgICAgICBvcmlWYWx1ZTogT1JJX1ZBTFVFXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5vcmlUeXBlID0gYXNuMS5yZXN1bHQub3JpVHlwZS52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMub3JpVmFsdWUgPSBhc24xLnJlc3VsdC5vcmlWYWx1ZTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLm9yaVR5cGUgfSksXG4gICAgICAgICAgICAgICAgdGhpcy5vcmlWYWx1ZVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgb3JpVHlwZTogdGhpcy5vcmlUeXBlXG4gICAgICAgIH07XG4gICAgICAgIGlmICghT3RoZXJSZWNpcGllbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChPUklfVkFMVUUsIHRoaXMub3JpVmFsdWUpKSB7XG4gICAgICAgICAgICByZXMub3JpVmFsdWUgPSB0aGlzLm9yaVZhbHVlLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuT3RoZXJSZWNpcGllbnRJbmZvLkNMQVNTX05BTUUgPSBcIk90aGVyUmVjaXBpZW50SW5mb1wiO1xuXG5jb25zdCBWQVJJQU5UID0gXCJ2YXJpYW50XCI7XG5jb25zdCBWQUxVRSA9IFwidmFsdWVcIjtcbmNvbnN0IENMRUFSX1BST1BTJG4gPSBbXG4gICAgXCJibG9ja05hbWVcIlxuXTtcbmNsYXNzIFJlY2lwaWVudEluZm8gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZhcmlhbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWQVJJQU5ULCBSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkFSSUFOVCkpO1xuICAgICAgICBpZiAoVkFMVUUgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZBTFVFLCBSZWNpcGllbnRJbmZvLmRlZmF1bHRWYWx1ZXMoVkFMVUUpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkFSSUFOVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKC0xKTtcbiAgICAgICAgICAgIGNhc2UgVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWQVJJQU5UOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IFJlY2lwaWVudEluZm8uZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSk7XG4gICAgICAgICAgICBjYXNlIFZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5DaG9pY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBLZXlUcmFuc1JlY2lwaWVudEluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogS2V5QWdyZWVSZWNpcGllbnRJbmZvLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogS0VLUmVjaXBpZW50SW5mby5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDNcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFBhc3N3b3JkUmVjaXBpZW50aW5mby5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDRcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IE90aGVyUmVjaXBpZW50SW5mby5zY2hlbWEoKS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRuKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBSZWNpcGllbnRJbmZvLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogXCJibG9ja05hbWVcIlxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChhc24xLnJlc3VsdC5ibG9ja05hbWUuaWRCbG9jay50YWdDbGFzcyA9PT0gMSkge1xuICAgICAgICAgICAgdGhpcy52YXJpYW50ID0gMTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBuZXcgS2V5VHJhbnNSZWNpcGllbnRJbmZvKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5ibG9ja05hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBibG9ja1NlcXVlbmNlID0gbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0LmJsb2NrTmFtZS52YWx1ZUJsb2NrLnZhbHVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHN3aXRjaCAoYXNuMS5yZXN1bHQuYmxvY2tOYW1lLmlkQmxvY2sudGFnTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAyO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gbmV3IEtleUFncmVlUmVjaXBpZW50SW5mbyh7IHNjaGVtYTogYmxvY2tTZXF1ZW5jZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcmlhbnQgPSAzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gbmV3IEtFS1JlY2lwaWVudEluZm8oeyBzY2hlbWE6IGJsb2NrU2VxdWVuY2UgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJpYW50ID0gNDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBQYXNzd29yZFJlY2lwaWVudGluZm8oeyBzY2hlbWE6IGJsb2NrU2VxdWVuY2UgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJpYW50ID0gNTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBPdGhlclJlY2lwaWVudEluZm8oeyBzY2hlbWE6IGJsb2NrU2VxdWVuY2UgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdCBzdHJ1Y3R1cmUgb2YgUmVjaXBpZW50SW5mbyBibG9ja1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0RW1wdHkodGhpcy52YWx1ZSwgXCJ2YWx1ZVwiLCBcIlJlY2lwaWVudEluZm9cIik7XG4gICAgICAgIGNvbnN0IF9zY2hlbWEgPSB0aGlzLnZhbHVlLnRvU2NoZW1hKCk7XG4gICAgICAgIHN3aXRjaCAodGhpcy52YXJpYW50KSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9zY2hlbWE7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgX3NjaGVtYS5pZEJsb2NrLnRhZ0NsYXNzID0gMztcbiAgICAgICAgICAgICAgICBfc2NoZW1hLmlkQmxvY2sudGFnTnVtYmVyID0gKHRoaXMudmFyaWFudCAtIDEpO1xuICAgICAgICAgICAgICAgIHJldHVybiBfc2NoZW1hO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5BbnkoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZhcmlhbnQ6IHRoaXMudmFyaWFudFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy52YWx1ZSAmJiAodGhpcy52YXJpYW50ID49IDEpICYmICh0aGlzLnZhcmlhbnQgPD0gNCkpIHtcbiAgICAgICAgICAgIHJlcy52YWx1ZSA9IHRoaXMudmFsdWUudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5SZWNpcGllbnRJbmZvLkNMQVNTX05BTUUgPSBcIlJlY2lwaWVudEluZm9cIjtcblxuY29uc3QgSEFTSF9BTEdPUklUSE0kMiA9IFwiaGFzaEFsZ29yaXRobVwiO1xuY29uc3QgTUFTS19HRU5fQUxHT1JJVEhNID0gXCJtYXNrR2VuQWxnb3JpdGhtXCI7XG5jb25zdCBQX1NPVVJDRV9BTEdPUklUSE0gPSBcInBTb3VyY2VBbGdvcml0aG1cIjtcbmNvbnN0IENMRUFSX1BST1BTJG0gPSBbXG4gICAgSEFTSF9BTEdPUklUSE0kMixcbiAgICBNQVNLX0dFTl9BTEdPUklUSE0sXG4gICAgUF9TT1VSQ0VfQUxHT1JJVEhNXG5dO1xuY2xhc3MgUlNBRVNPQUVQUGFyYW1zIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSEFTSF9BTEdPUklUSE0kMiwgUlNBRVNPQUVQUGFyYW1zLmRlZmF1bHRWYWx1ZXMoSEFTSF9BTEdPUklUSE0kMikpO1xuICAgICAgICB0aGlzLm1hc2tHZW5BbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBNQVNLX0dFTl9BTEdPUklUSE0sIFJTQUVTT0FFUFBhcmFtcy5kZWZhdWx0VmFsdWVzKE1BU0tfR0VOX0FMR09SSVRITSkpO1xuICAgICAgICB0aGlzLnBTb3VyY2VBbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQX1NPVVJDRV9BTEdPUklUSE0sIFJTQUVTT0FFUFBhcmFtcy5kZWZhdWx0VmFsdWVzKFBfU09VUkNFX0FMR09SSVRITSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSEFTSF9BTEdPUklUSE0kMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogXCIxLjMuMTQuMy4yLjI2XCIsXG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNhc2UgTUFTS19HRU5fQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMi44NDAuMTEzNTQ5LjEuMS44XCIsXG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogKG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMy4xNC4zLjIuMjZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgICAgICAgICAgfSkpLnRvU2NoZW1hKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNhc2UgUF9TT1VSQ0VfQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMi44NDAuMTEzNTQ5LjEuMS45XCIsXG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiAobmV3IFVpbnQ4QXJyYXkoWzB4ZGEsIDB4MzksIDB4YTMsIDB4ZWUsIDB4NWUsIDB4NmIsIDB4NGIsIDB4MGQsIDB4MzIsIDB4NTUsIDB4YmYsIDB4ZWYsIDB4OTUsIDB4NjAsIDB4MTgsIDB4OTAsIDB4YWYsIDB4ZDgsIDB4MDcsIDB4MDldKSkuYnVmZmVyIH0pXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYShuYW1lcy5oYXNoQWxnb3JpdGhtIHx8IHt9KV1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMubWFza0dlbkFsZ29yaXRobSB8fCB7fSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW0FsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLnBTb3VyY2VBbGdvcml0aG0gfHwge30pXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkbSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUlNBRVNPQUVQUGFyYW1zLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGhhc2hBbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogSEFTSF9BTEdPUklUSE0kMlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBtYXNrR2VuQWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IE1BU0tfR0VOX0FMR09SSVRITVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBwU291cmNlQWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFBfU09VUkNFX0FMR09SSVRITVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGlmIChIQVNIX0FMR09SSVRITSQyIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0Lmhhc2hBbGdvcml0aG0gfSk7XG4gICAgICAgIGlmIChNQVNLX0dFTl9BTEdPUklUSE0gaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLm1hc2tHZW5BbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQubWFza0dlbkFsZ29yaXRobSB9KTtcbiAgICAgICAgaWYgKFBfU09VUkNFX0FMR09SSVRITSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMucFNvdXJjZUFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5wU291cmNlQWxnb3JpdGhtIH0pO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKCF0aGlzLmhhc2hBbGdvcml0aG0uaXNFcXVhbChSU0FFU09BRVBQYXJhbXMuZGVmYXVsdFZhbHVlcyhIQVNIX0FMR09SSVRITSQyKSkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMuaGFzaEFsZ29yaXRobS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5tYXNrR2VuQWxnb3JpdGhtLmlzRXF1YWwoUlNBRVNPQUVQUGFyYW1zLmRlZmF1bHRWYWx1ZXMoTUFTS19HRU5fQUxHT1JJVEhNKSkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMubWFza0dlbkFsZ29yaXRobS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5wU291cmNlQWxnb3JpdGhtLmlzRXF1YWwoUlNBRVNPQUVQUGFyYW1zLmRlZmF1bHRWYWx1ZXMoUF9TT1VSQ0VfQUxHT1JJVEhNKSkpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMucFNvdXJjZUFsZ29yaXRobS50b1NjaGVtYSgpXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHt9O1xuICAgICAgICBpZiAoIXRoaXMuaGFzaEFsZ29yaXRobS5pc0VxdWFsKFJTQUVTT0FFUFBhcmFtcy5kZWZhdWx0VmFsdWVzKEhBU0hfQUxHT1JJVEhNJDIpKSkge1xuICAgICAgICAgICAgcmVzLmhhc2hBbGdvcml0aG0gPSB0aGlzLmhhc2hBbGdvcml0aG0udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLm1hc2tHZW5BbGdvcml0aG0uaXNFcXVhbChSU0FFU09BRVBQYXJhbXMuZGVmYXVsdFZhbHVlcyhNQVNLX0dFTl9BTEdPUklUSE0pKSkge1xuICAgICAgICAgICAgcmVzLm1hc2tHZW5BbGdvcml0aG0gPSB0aGlzLm1hc2tHZW5BbGdvcml0aG0udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnBTb3VyY2VBbGdvcml0aG0uaXNFcXVhbChSU0FFU09BRVBQYXJhbXMuZGVmYXVsdFZhbHVlcyhQX1NPVVJDRV9BTEdPUklUSE0pKSkge1xuICAgICAgICAgICAgcmVzLnBTb3VyY2VBbGdvcml0aG0gPSB0aGlzLnBTb3VyY2VBbGdvcml0aG0udG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5SU0FFU09BRVBQYXJhbXMuQ0xBU1NfTkFNRSA9IFwiUlNBRVNPQUVQUGFyYW1zXCI7XG5cbmNvbnN0IEtFWV9JTkZPID0gXCJrZXlJbmZvXCI7XG5jb25zdCBFTlRJVFlfVV9JTkZPID0gXCJlbnRpdHlVSW5mb1wiO1xuY29uc3QgU1VQUF9QVUJfSU5GTyA9IFwic3VwcFB1YkluZm9cIjtcbmNvbnN0IENMRUFSX1BST1BTJGwgPSBbXG4gICAgS0VZX0lORk8sXG4gICAgRU5USVRZX1VfSU5GTyxcbiAgICBTVVBQX1BVQl9JTkZPXG5dO1xuY2xhc3MgRUNDQ01TU2hhcmVkSW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMua2V5SW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEtFWV9JTkZPLCBFQ0NDTVNTaGFyZWRJbmZvLmRlZmF1bHRWYWx1ZXMoS0VZX0lORk8pKTtcbiAgICAgICAgaWYgKEVOVElUWV9VX0lORk8gaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5lbnRpdHlVSW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVOVElUWV9VX0lORk8sIEVDQ0NNU1NoYXJlZEluZm8uZGVmYXVsdFZhbHVlcyhFTlRJVFlfVV9JTkZPKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdXBwUHViSW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNVUFBfUFVCX0lORk8sIEVDQ0NNU1NoYXJlZEluZm8uZGVmYXVsdFZhbHVlcyhTVVBQX1BVQl9JTkZPKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBLRVlfSU5GTzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgRU5USVRZX1VfSU5GTzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBTVVBQX1BVQl9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEtFWV9JTkZPOlxuICAgICAgICAgICAgY2FzZSBFTlRJVFlfVV9JTkZPOlxuICAgICAgICAgICAgY2FzZSBTVVBQX1BVQl9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChFQ0NDTVNTaGFyZWRJbmZvLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMua2V5SW5mbyB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5lbnRpdHlVSW5mbyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5zdXBwUHViSW5mbyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuT2N0ZXRTdHJpbmcoKV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJGwpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEVDQ0NNU1NoYXJlZEluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAga2V5SW5mbzoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBLRVlfSU5GT1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbnRpdHlVSW5mbzogRU5USVRZX1VfSU5GTyxcbiAgICAgICAgICAgICAgICBzdXBwUHViSW5mbzogU1VQUF9QVUJfSU5GT1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMua2V5SW5mbyA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5rZXlJbmZvIH0pO1xuICAgICAgICBpZiAoRU5USVRZX1VfSU5GTyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuZW50aXR5VUluZm8gPSBhc24xLnJlc3VsdC5lbnRpdHlVSW5mby52YWx1ZUJsb2NrLnZhbHVlWzBdO1xuICAgICAgICB0aGlzLnN1cHBQdWJJbmZvID0gYXNuMS5yZXN1bHQuc3VwcFB1YkluZm8udmFsdWVCbG9jay52YWx1ZVswXTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5rZXlJbmZvLnRvU2NoZW1hKCkpO1xuICAgICAgICBpZiAodGhpcy5lbnRpdHlVSW5mbykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5lbnRpdHlVSW5mb11cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5zdXBwUHViSW5mb11cbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAga2V5SW5mbzogdGhpcy5rZXlJbmZvLnRvSlNPTigpLFxuICAgICAgICAgICAgc3VwcFB1YkluZm86IHRoaXMuc3VwcFB1YkluZm8udG9KU09OKCksXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmVudGl0eVVJbmZvKSB7XG4gICAgICAgICAgICByZXMuZW50aXR5VUluZm8gPSB0aGlzLmVudGl0eVVJbmZvLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuRUNDQ01TU2hhcmVkSW5mby5DTEFTU19OQU1FID0gXCJFQ0NDTVNTaGFyZWRJbmZvXCI7XG5cbmNvbnN0IFZFUlNJT04kOCA9IFwidmVyc2lvblwiO1xuY29uc3QgT1JJR0lOQVRPUl9JTkZPID0gXCJvcmlnaW5hdG9ySW5mb1wiO1xuY29uc3QgUkVDSVBJRU5UX0lORk9TID0gXCJyZWNpcGllbnRJbmZvc1wiO1xuY29uc3QgRU5DUllQVEVEX0NPTlRFTlRfSU5GTyA9IFwiZW5jcnlwdGVkQ29udGVudEluZm9cIjtcbmNvbnN0IFVOUFJPVEVDVEVEX0FUVFJTID0gXCJ1bnByb3RlY3RlZEF0dHJzXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRrID0gW1xuICAgIFZFUlNJT04kOCxcbiAgICBPUklHSU5BVE9SX0lORk8sXG4gICAgUkVDSVBJRU5UX0lORk9TLFxuICAgIEVOQ1JZUFRFRF9DT05URU5UX0lORk8sXG4gICAgVU5QUk9URUNURURfQVRUUlNcbl07XG5jb25zdCBkZWZhdWx0RW5jcnlwdGlvblBhcmFtcyA9IHtcbiAgICBrZGZBbGdvcml0aG06IFwiU0hBLTUxMlwiLFxuICAgIGtla0VuY3J5cHRpb25MZW5ndGg6IDI1NlxufTtcbmNvbnN0IGN1cnZlTGVuZ3RoQnlOYW1lID0ge1xuICAgIFwiUC0yNTZcIjogMjU2LFxuICAgIFwiUC0zODRcIjogMzg0LFxuICAgIFwiUC01MjFcIjogNTI4XG59O1xuY2xhc3MgRW52ZWxvcGVkRGF0YSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kOCwgRW52ZWxvcGVkRGF0YS5kZWZhdWx0VmFsdWVzKFZFUlNJT04kOCkpO1xuICAgICAgICBpZiAoT1JJR0lOQVRPUl9JTkZPIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYXRvckluZm8gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBPUklHSU5BVE9SX0lORk8sIEVudmVsb3BlZERhdGEuZGVmYXVsdFZhbHVlcyhPUklHSU5BVE9SX0lORk8pKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlY2lwaWVudEluZm9zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUkVDSVBJRU5UX0lORk9TLCBFbnZlbG9wZWREYXRhLmRlZmF1bHRWYWx1ZXMoUkVDSVBJRU5UX0lORk9TKSk7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFTkNSWVBURURfQ09OVEVOVF9JTkZPLCBFbnZlbG9wZWREYXRhLmRlZmF1bHRWYWx1ZXMoRU5DUllQVEVEX0NPTlRFTlRfSU5GTykpO1xuICAgICAgICBpZiAoVU5QUk9URUNURURfQVRUUlMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy51bnByb3RlY3RlZEF0dHJzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVU5QUk9URUNURURfQVRUUlMsIEVudmVsb3BlZERhdGEuZGVmYXVsdFZhbHVlcyhVTlBST1RFQ1RFRF9BVFRSUykpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucG9saWN5ID0ge1xuICAgICAgICAgICAgZGlzYWJsZVNwbGl0OiAhIXBhcmFtZXRlcnMuZGlzYWJsZVNwbGl0LFxuICAgICAgICB9O1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiQ4OlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSBPUklHSU5BVE9SX0lORk86XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBPcmlnaW5hdG9ySW5mbygpO1xuICAgICAgICAgICAgY2FzZSBSRUNJUElFTlRfSU5GT1M6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBFTkNSWVBURURfQ09OVEVOVF9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRW5jcnlwdGVkQ29udGVudEluZm8oKTtcbiAgICAgICAgICAgIGNhc2UgVU5QUk9URUNURURfQVRUUlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDg6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRW52ZWxvcGVkRGF0YS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgT1JJR0lOQVRPUl9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKG1lbWJlclZhbHVlLmNlcnRzLmNlcnRpZmljYXRlcy5sZW5ndGggPT09IDApICYmIChtZW1iZXJWYWx1ZS5jcmxzLmNybHMubGVuZ3RoID09PSAwKSk7XG4gICAgICAgICAgICBjYXNlIFJFQ0lQSUVOVF9JTkZPUzpcbiAgICAgICAgICAgIGNhc2UgVU5QUk9URUNURURfQVRUUlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBFTkNSWVBURURfQ09OVEVOVF9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKEVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImNvbnRlbnRUeXBlXCIsIG1lbWJlclZhbHVlLmNvbnRlbnRUeXBlKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKEVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtXCIsIG1lbWJlclZhbHVlLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKEVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImVuY3J5cHRlZENvbnRlbnRcIiwgbWVtYmVyVmFsdWUuZW5jcnlwdGVkQ29udGVudCkpKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5vcmlnaW5hdG9ySW5mbyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IE9yaWdpbmF0b3JJbmZvLnNjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNldCh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMucmVjaXBpZW50SW5mb3MgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogUmVjaXBpZW50SW5mby5zY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIEVuY3J5cHRlZENvbnRlbnRJbmZvLnNjaGVtYShuYW1lcy5lbmNyeXB0ZWRDb250ZW50SW5mbyB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnVucHJvdGVjdGVkQXR0cnMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXR0cmlidXRlLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRrKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBFbnZlbG9wZWREYXRhLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IFZFUlNJT04kOCxcbiAgICAgICAgICAgICAgICBvcmlnaW5hdG9ySW5mbzogT1JJR0lOQVRPUl9JTkZPLFxuICAgICAgICAgICAgICAgIHJlY2lwaWVudEluZm9zOiBSRUNJUElFTlRfSU5GT1MsXG4gICAgICAgICAgICAgICAgZW5jcnlwdGVkQ29udGVudEluZm86IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogRU5DUllQVEVEX0NPTlRFTlRfSU5GT1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB1bnByb3RlY3RlZEF0dHJzOiBVTlBST1RFQ1RFRF9BVFRSU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgaWYgKE9SSUdJTkFUT1JfSU5GTyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5vcmlnaW5hdG9ySW5mbyA9IG5ldyBPcmlnaW5hdG9ySW5mbyh7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFzbjEucmVzdWx0Lm9yaWdpbmF0b3JJbmZvLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZWNpcGllbnRJbmZvcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQucmVjaXBpZW50SW5mb3MsIG8gPT4gbmV3IFJlY2lwaWVudEluZm8oeyBzY2hlbWE6IG8gfSkpO1xuICAgICAgICB0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvID0gbmV3IEVuY3J5cHRlZENvbnRlbnRJbmZvKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5lbmNyeXB0ZWRDb250ZW50SW5mbyB9KTtcbiAgICAgICAgaWYgKFVOUFJPVEVDVEVEX0FUVFJTIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy51bnByb3RlY3RlZEF0dHJzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC51bnByb3RlY3RlZEF0dHJzLCBvID0+IG5ldyBBdHRyaWJ1dGUoeyBzY2hlbWE6IG8gfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pKTtcbiAgICAgICAgaWYgKHRoaXMub3JpZ2luYXRvckluZm8pIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5vcmlnaW5hdG9ySW5mby50b1NjaGVtYSgpLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMucmVjaXBpZW50SW5mb3MsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5lbmNyeXB0ZWRDb250ZW50SW5mby50b1NjaGVtYSgpKTtcbiAgICAgICAgaWYgKHRoaXMudW5wcm90ZWN0ZWRBdHRycykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMudW5wcm90ZWN0ZWRBdHRycywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy52ZXJzaW9uLFxuICAgICAgICAgICAgcmVjaXBpZW50SW5mb3M6IEFycmF5LmZyb20odGhpcy5yZWNpcGllbnRJbmZvcywgbyA9PiBvLnRvSlNPTigpKSxcbiAgICAgICAgICAgIGVuY3J5cHRlZENvbnRlbnRJbmZvOiB0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvLnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5vcmlnaW5hdG9ySW5mbylcbiAgICAgICAgICAgIHJlcy5vcmlnaW5hdG9ySW5mbyA9IHRoaXMub3JpZ2luYXRvckluZm8udG9KU09OKCk7XG4gICAgICAgIGlmICh0aGlzLnVucHJvdGVjdGVkQXR0cnMpXG4gICAgICAgICAgICByZXMudW5wcm90ZWN0ZWRBdHRycyA9IEFycmF5LmZyb20odGhpcy51bnByb3RlY3RlZEF0dHJzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICBhZGRSZWNpcGllbnRCeUNlcnRpZmljYXRlKGNlcnRpZmljYXRlLCBwYXJhbWV0ZXJzLCB2YXJpYW50LCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgY29uc3QgZW5jcnlwdGlvblBhcmFtZXRlcnMgPSBPYmplY3QuYXNzaWduKHsgdXNlT0FFUDogdHJ1ZSwgb2FlcEhhc2hBbGdvcml0aG06IFwiU0hBLTUxMlwiIH0sIGRlZmF1bHRFbmNyeXB0aW9uUGFyYW1zLCBwYXJhbWV0ZXJzIHx8IHt9KTtcbiAgICAgICAgaWYgKGNlcnRpZmljYXRlLnN1YmplY3RQdWJsaWNLZXlJbmZvLmFsZ29yaXRobS5hbGdvcml0aG1JZC5pbmRleE9mKFwiMS4yLjg0MC4xMTM1NDlcIikgIT09ICgtMSkpXG4gICAgICAgICAgICB2YXJpYW50ID0gMTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoY2VydGlmaWNhdGUuc3ViamVjdFB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobUlkLmluZGV4T2YoXCIxLjIuODQwLjEwMDQ1XCIpICE9PSAoLTEpKVxuICAgICAgICAgICAgICAgIHZhcmlhbnQgPSAyO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biB0eXBlIG9mIGNlcnRpZmljYXRlJ3MgcHVibGljIGtleTogJHtjZXJ0aWZpY2F0ZS5zdWJqZWN0UHVibGljS2V5SW5mby5hbGdvcml0aG0uYWxnb3JpdGhtSWR9YCk7XG4gICAgICAgIH1cbiAgICAgICAgc3dpdGNoICh2YXJpYW50KSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBsZXQgYWxnb3JpdGhtSWQ7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhbGdvcml0aG1QYXJhbXM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbmNyeXB0aW9uUGFyYW1ldGVycy51c2VPQUVQID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZCA9IGNyeXB0by5nZXRPSURCeUFsZ29yaXRobSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJSU0EtT0FFUFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB0cnVlLCBcImtleUVuY3J5cHRpb25BbGdvcml0aG1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoYXNoT0lEID0gY3J5cHRvLmdldE9JREJ5QWxnb3JpdGhtKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBlbmNyeXB0aW9uUGFyYW1ldGVycy5vYWVwSGFzaEFsZ29yaXRobVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSwgXCJSU0FFUy1PQUVQLXBhcmFtc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhhc2hBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IGhhc2hPSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk51bGwoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByc2FPQUVQUGFyYW1zID0gbmV3IFJTQUVTT0FFUFBhcmFtcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaEFsZ29yaXRobSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXNrR2VuQWxnb3JpdGhtOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBcIjEuMi44NDAuMTEzNTQ5LjEuMS44XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogaGFzaEFsZ29yaXRobS50b1NjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zID0gcnNhT0FFUFBhcmFtcy50b1NjaGVtYSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQgPSBjcnlwdG8uZ2V0T0lEQnlBbGdvcml0aG0oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUlNBRVMtUEtDUzEtdjFfNVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbGdvcml0aG1JZCA9PT0gRU1QVFlfU1RSSU5HKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbiBub3QgZmluZCBPSUQgZm9yIFJTQUVTLVBLQ1MxLXYxXzVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbXMgPSBuZXcgYXNuMWpzLk51bGwoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXlJbmZvID0gbmV3IEtleVRyYW5zUmVjaXBpZW50SW5mbyh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmlkOiBuZXcgSXNzdWVyQW5kU2VyaWFsTnVtYmVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc3N1ZXI6IGNlcnRpZmljYXRlLmlzc3VlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJpYWxOdW1iZXI6IGNlcnRpZmljYXRlLnNlcmlhbE51bWJlclxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlFbmNyeXB0aW9uQWxnb3JpdGhtOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudENlcnRpZmljYXRlOiBjZXJ0aWZpY2F0ZSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVjaXBpZW50SW5mb3MucHVzaChuZXcgUmVjaXBpZW50SW5mbyh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50OiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGtleUluZm9cbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY2lwaWVudElkZW50aWZpZXIgPSBuZXcgS2V5QWdyZWVSZWNpcGllbnRJZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbmV3IElzc3VlckFuZFNlcmlhbE51bWJlcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNzdWVyOiBjZXJ0aWZpY2F0ZS5pc3N1ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiBjZXJ0aWZpY2F0ZS5zZXJpYWxOdW1iZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRLZXlBZ3JlZVJlY2lwaWVudEluZm8ocmVjaXBpZW50SWRlbnRpZmllciwgZW5jcnlwdGlvblBhcmFtZXRlcnMsIHsgcmVjaXBpZW50Q2VydGlmaWNhdGU6IGNlcnRpZmljYXRlIH0sIGNyeXB0byk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gXCJ2YXJpYW50XCIgdmFsdWU6ICR7dmFyaWFudH1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgYWRkUmVjaXBpZW50QnlQcmVEZWZpbmVkRGF0YShwcmVEZWZpbmVkRGF0YSwgcGFyYW1ldGVycyA9IHt9LCB2YXJpYW50LCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQocHJlRGVmaW5lZERhdGEsIFwicHJlRGVmaW5lZERhdGFcIiwgXCJBcnJheUJ1ZmZlclwiKTtcbiAgICAgICAgaWYgKCFwcmVEZWZpbmVkRGF0YS5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcmUtZGVmaW5lZCBkYXRhIGNvdWxkIGhhdmUgemVybyBsZW5ndGhcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwYXJhbWV0ZXJzLmtleUlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGtleUlkZW50aWZpZXJCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoMTYpO1xuICAgICAgICAgICAgY29uc3Qga2V5SWRlbnRpZmllclZpZXcgPSBuZXcgVWludDhBcnJheShrZXlJZGVudGlmaWVyQnVmZmVyKTtcbiAgICAgICAgICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMoa2V5SWRlbnRpZmllclZpZXcpO1xuICAgICAgICAgICAgcGFyYW1ldGVycy5rZXlJZGVudGlmaWVyID0ga2V5SWRlbnRpZmllckJ1ZmZlcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXBhcmFtZXRlcnMuaG1hY0hhc2hBbGdvcml0aG0pXG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmhtYWNIYXNoQWxnb3JpdGhtID0gXCJTSEEtNTEyXCI7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLml0ZXJhdGlvbkNvdW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhcmFtZXRlcnMuaXRlcmF0aW9uQ291bnQgPSAyMDQ4O1xuICAgICAgICB9XG4gICAgICAgIGlmICghcGFyYW1ldGVycy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtKSB7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmtleUVuY3J5cHRpb25BbGdvcml0aG0gPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJBRVMtS1dcIixcbiAgICAgICAgICAgICAgICBsZW5ndGg6IDI1NlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXBhcmFtZXRlcnMua2V5RW5jcnlwdGlvbkFsZ29yaXRobVBhcmFtcylcbiAgICAgICAgICAgIHBhcmFtZXRlcnMua2V5RW5jcnlwdGlvbkFsZ29yaXRobVBhcmFtcyA9IG5ldyBhc24xanMuTnVsbCgpO1xuICAgICAgICBzd2l0Y2ggKHZhcmlhbnQpIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtla09JRCA9IGNyeXB0by5nZXRPSURCeUFsZ29yaXRobShwYXJhbWV0ZXJzLmtleUVuY3J5cHRpb25BbGdvcml0aG0sIHRydWUsIFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5SW5mbyA9IG5ldyBLRUtSZWNpcGllbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246IDQsXG4gICAgICAgICAgICAgICAgICAgICAgICBrZWtpZDogbmV3IEtFS0lkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleUlkZW50aWZpZXI6IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogcGFyYW1ldGVycy5rZXlJZGVudGlmaWVyIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDoga2VrT0lELFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogcGFyYW1ldGVycy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtUGFyYW1zXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZURlZmluZWRLRUs6IHByZURlZmluZWREYXRhXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY2lwaWVudEluZm9zLnB1c2gobmV3IFJlY2lwaWVudEluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudDogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBrZXlJbmZvXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYmtkZjJPSUQgPSBjcnlwdG8uZ2V0T0lEQnlBbGdvcml0aG0oeyBuYW1lOiBcIlBCS0RGMlwiIH0sIHRydWUsIFwia2V5RGVyaXZhdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2FsdEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcig2NCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNhbHRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoc2FsdEJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMoc2FsdFZpZXcpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBobWFjT0lEID0gY3J5cHRvLmdldE9JREJ5QWxnb3JpdGhtKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiSE1BQ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHBhcmFtZXRlcnMuaG1hY0hhc2hBbGdvcml0aG1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSwgXCJobWFjSGFzaEFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGJrZGYyUGFyYW1zID0gbmV3IFBCS0RGMlBhcmFtcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYWx0OiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IHNhbHRCdWZmZXIgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25Db3VudDogcGFyYW1ldGVycy5pdGVyYXRpb25Db3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZjogbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBobWFjT0lELFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBrZWtPSUQgPSBjcnlwdG8uZ2V0T0lEQnlBbGdvcml0aG0ocGFyYW1ldGVycy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLCB0cnVlLCBcImtleUVuY3J5cHRpb25BbGdvcml0aG1cIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleUluZm8gPSBuZXcgUGFzc3dvcmRSZWNpcGllbnRpbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlEZXJpdmF0aW9uQWxnb3JpdGhtOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IHBia2RmMk9JRCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbXM6IHBia2RmMlBhcmFtcy50b1NjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleUVuY3J5cHRpb25BbGdvcml0aG06IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDoga2VrT0lELFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogcGFyYW1ldGVycy5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtUGFyYW1zXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwcmVEZWZpbmVkRGF0YVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNpcGllbnRJbmZvcy5wdXNoKG5ldyBSZWNpcGllbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6IDQsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZToga2V5SW5mb1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdmFsdWUgZm9yIFwidmFyaWFudFwiOiAke3ZhcmlhbnR9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkUmVjaXBpZW50QnlLZXlJZGVudGlmaWVyKGtleSwga2V5SWQsIHBhcmFtZXRlcnMsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCBlbmNyeXB0aW9uUGFyYW1ldGVycyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRFbmNyeXB0aW9uUGFyYW1zLCBwYXJhbWV0ZXJzIHx8IHt9KTtcbiAgICAgICAgY29uc3QgcmVjaXBpZW50SWRlbnRpZmllciA9IG5ldyBLZXlBZ3JlZVJlY2lwaWVudElkZW50aWZpZXIoe1xuICAgICAgICAgICAgdmFyaWFudDogMixcbiAgICAgICAgICAgIHZhbHVlOiBuZXcgUmVjaXBpZW50S2V5SWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgc3ViamVjdEtleUlkZW50aWZpZXI6IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDoga2V5SWQgfSksXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYWRkS2V5QWdyZWVSZWNpcGllbnRJbmZvKHJlY2lwaWVudElkZW50aWZpZXIsIGVuY3J5cHRpb25QYXJhbWV0ZXJzLCB7IHJlY2lwaWVudFB1YmxpY0tleToga2V5IH0sIGNyeXB0byk7XG4gICAgfVxuICAgIF9hZGRLZXlBZ3JlZVJlY2lwaWVudEluZm8ocmVjaXBpZW50SWRlbnRpZmllciwgZW5jcnlwdGlvblBhcmFtZXRlcnMsIGV4dHJhUmVjaXBpZW50SW5mb1BhcmFtcywgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIGNvbnN0IGVuY3J5cHRlZEtleSA9IG5ldyBSZWNpcGllbnRFbmNyeXB0ZWRLZXkoe1xuICAgICAgICAgICAgcmlkOiByZWNpcGllbnRJZGVudGlmaWVyXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBhZXNLV29pZCA9IGNyeXB0by5nZXRPSURCeUFsZ29yaXRobSh7XG4gICAgICAgICAgICBuYW1lOiBcIkFFUy1LV1wiLFxuICAgICAgICAgICAgbGVuZ3RoOiBlbmNyeXB0aW9uUGFyYW1ldGVycy5rZWtFbmNyeXB0aW9uTGVuZ3RoXG4gICAgICAgIH0sIHRydWUsIFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgY29uc3QgYWVzS1cgPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICBhbGdvcml0aG1JZDogYWVzS1dvaWQsXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBlY2RoT0lEID0gY3J5cHRvLmdldE9JREJ5QWxnb3JpdGhtKHtcbiAgICAgICAgICAgIG5hbWU6IFwiRUNESFwiLFxuICAgICAgICAgICAga2RmOiBlbmNyeXB0aW9uUGFyYW1ldGVycy5rZGZBbGdvcml0aG1cbiAgICAgICAgfSwgdHJ1ZSwgXCJLZXlBZ3JlZVJlY2lwaWVudEluZm9cIik7XG4gICAgICAgIGNvbnN0IHVrbUJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcig2NCk7XG4gICAgICAgIGNvbnN0IHVrbVZpZXcgPSBuZXcgVWludDhBcnJheSh1a21CdWZmZXIpO1xuICAgICAgICBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHVrbVZpZXcpO1xuICAgICAgICBjb25zdCByZWNpcGllbnRJbmZvUGFyYW1zID0ge1xuICAgICAgICAgICAgdmVyc2lvbjogMyxcbiAgICAgICAgICAgIHVrbTogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiB1a21CdWZmZXIgfSksXG4gICAgICAgICAgICBrZXlFbmNyeXB0aW9uQWxnb3JpdGhtOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtSWQ6IGVjZGhPSUQsXG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBhZXNLVy50b1NjaGVtYSgpXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHJlY2lwaWVudEVuY3J5cHRlZEtleXM6IG5ldyBSZWNpcGllbnRFbmNyeXB0ZWRLZXlzKHtcbiAgICAgICAgICAgICAgICBlbmNyeXB0ZWRLZXlzOiBbZW5jcnlwdGVkS2V5XVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qga2V5SW5mbyA9IG5ldyBLZXlBZ3JlZVJlY2lwaWVudEluZm8oT2JqZWN0LmFzc2lnbihyZWNpcGllbnRJbmZvUGFyYW1zLCBleHRyYVJlY2lwaWVudEluZm9QYXJhbXMpKTtcbiAgICAgICAgdGhpcy5yZWNpcGllbnRJbmZvcy5wdXNoKG5ldyBSZWNpcGllbnRJbmZvKHtcbiAgICAgICAgICAgIHZhcmlhbnQ6IDIsXG4gICAgICAgICAgICB2YWx1ZToga2V5SW5mb1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGFzeW5jIGVuY3J5cHQoY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0sIGNvbnRlbnRUb0VuY3J5cHQsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCBpdkJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcigxNik7XG4gICAgICAgIGNvbnN0IGl2VmlldyA9IG5ldyBVaW50OEFycmF5KGl2QnVmZmVyKTtcbiAgICAgICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhpdlZpZXcpO1xuICAgICAgICBjb25zdCBjb250ZW50VmlldyA9IG5ldyBVaW50OEFycmF5KGNvbnRlbnRUb0VuY3J5cHQpO1xuICAgICAgICBjb25zdCBjb250ZW50RW5jcnlwdGlvbk9JRCA9IGNyeXB0by5nZXRPSURCeUFsZ29yaXRobShjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSwgdHJ1ZSwgXCJjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbktleSA9IGF3YWl0IGNyeXB0by5nZW5lcmF0ZUtleShjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSwgdHJ1ZSwgW1wiZW5jcnlwdFwiXSk7XG4gICAgICAgIGNvbnN0IGVuY3J5cHRlZENvbnRlbnQgPSBhd2FpdCBjcnlwdG8uZW5jcnlwdCh7XG4gICAgICAgICAgICBuYW1lOiBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobS5uYW1lLFxuICAgICAgICAgICAgaXY6IGl2Vmlld1xuICAgICAgICB9LCBzZXNzaW9uS2V5LCBjb250ZW50Vmlldyk7XG4gICAgICAgIGNvbnN0IGV4cG9ydGVkU2Vzc2lvbktleSA9IGF3YWl0IGNyeXB0by5leHBvcnRLZXkoXCJyYXdcIiwgc2Vzc2lvbktleSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IDI7XG4gICAgICAgIHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8gPSBuZXcgRW5jcnlwdGVkQ29udGVudEluZm8oe1xuICAgICAgICAgICAgZGlzYWJsZVNwbGl0OiB0aGlzLnBvbGljeS5kaXNhYmxlU3BsaXQsXG4gICAgICAgICAgICBjb250ZW50VHlwZTogXCIxLjIuODQwLjExMzU0OS4xLjcuMVwiLFxuICAgICAgICAgICAgY29udGVudEVuY3J5cHRpb25BbGdvcml0aG06IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogY29udGVudEVuY3J5cHRpb25PSUQsXG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IGl2QnVmZmVyIH0pXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGVuY3J5cHRlZENvbnRlbnQ6IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogZW5jcnlwdGVkQ29udGVudCB9KVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgU3ViS2V5QWdyZWVSZWNpcGllbnRJbmZvID0gYXN5bmMgKGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZWNpcGllbnRJbmZvID0gdGhpcy5yZWNpcGllbnRJbmZvc1tpbmRleF0udmFsdWU7XG4gICAgICAgICAgICBsZXQgcmVjaXBpZW50Q3VydmU7XG4gICAgICAgICAgICBsZXQgcmVjaXBpZW50UHVibGljS2V5O1xuICAgICAgICAgICAgaWYgKHJlY2lwaWVudEluZm8ucmVjaXBpZW50UHVibGljS2V5KSB7XG4gICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmUgPSByZWNpcGllbnRJbmZvLnJlY2lwaWVudFB1YmxpY0tleS5hbGdvcml0aG0ubmFtZWRDdXJ2ZTtcbiAgICAgICAgICAgICAgICByZWNpcGllbnRQdWJsaWNLZXkgPSByZWNpcGllbnRJbmZvLnJlY2lwaWVudFB1YmxpY0tleTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHJlY2lwaWVudEluZm8ucmVjaXBpZW50Q2VydGlmaWNhdGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJ2ZU9iamVjdCA9IHJlY2lwaWVudEluZm8ucmVjaXBpZW50Q2VydGlmaWNhdGUuc3ViamVjdFB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcztcbiAgICAgICAgICAgICAgICBpZiAoY3VydmVPYmplY3QuY29uc3RydWN0b3IuYmxvY2tOYW1lKCkgIT09IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyLmJsb2NrTmFtZSgpKVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBcInJlY2lwaWVudENlcnRpZmljYXRlXCIgZm9yIGluZGV4ICR7aW5kZXh9YCk7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VydmVPSUQgPSBjdXJ2ZU9iamVjdC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChjdXJ2ZU9JRCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS4zLjEuN1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmUgPSBcIlAtMjU2XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIjEuMy4xMzIuMC4zNFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmUgPSBcIlAtMzg0XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIjEuMy4xMzIuMC4zNVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmUgPSBcIlAtNTIxXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGN1cnZlIE9JRCBmb3IgaW5kZXggJHtpbmRleH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVjaXBpZW50UHVibGljS2V5ID0gYXdhaXQgcmVjaXBpZW50SW5mby5yZWNpcGllbnRDZXJ0aWZpY2F0ZS5nZXRQdWJsaWNLZXkoe1xuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNESFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVkQ3VydmU6IHJlY2lwaWVudEN1cnZlXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdXNhZ2VzOiBbXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgY3J5cHRvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuc3VwcG9ydGVkIFJlY2lwaWVudEluZm9cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCByZWNpcGllbnRDdXJ2ZUxlbmd0aCA9IGN1cnZlTGVuZ3RoQnlOYW1lW3JlY2lwaWVudEN1cnZlXTtcbiAgICAgICAgICAgIGNvbnN0IGVjZGhLZXlzID0gYXdhaXQgY3J5cHRvLmdlbmVyYXRlS2V5KHsgbmFtZTogXCJFQ0RIXCIsIG5hbWVkQ3VydmU6IHJlY2lwaWVudEN1cnZlIH0sIHRydWUsIFtcImRlcml2ZUJpdHNcIl0pO1xuICAgICAgICAgICAgY29uc3QgZXhwb3J0ZWRFQ0RIUHVibGljS2V5ID0gYXdhaXQgY3J5cHRvLmV4cG9ydEtleShcInNwa2lcIiwgZWNkaEtleXMucHVibGljS2V5KTtcbiAgICAgICAgICAgIGNvbnN0IGRlcml2ZWRCaXRzID0gYXdhaXQgY3J5cHRvLmRlcml2ZUJpdHMoe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNESFwiLFxuICAgICAgICAgICAgICAgIHB1YmxpYzogcmVjaXBpZW50UHVibGljS2V5XG4gICAgICAgICAgICB9LCBlY2RoS2V5cy5wcml2YXRlS2V5LCByZWNpcGllbnRDdXJ2ZUxlbmd0aCk7XG4gICAgICAgICAgICBjb25zdCBhZXNLV0FsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiByZWNpcGllbnRJbmZvLmtleUVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zIH0pO1xuICAgICAgICAgICAgY29uc3Qga3dBbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQoYWVzS1dBbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwiYWVzS1dBbGdvcml0aG1cIik7XG4gICAgICAgICAgICBsZXQga3dMZW5ndGggPSBrd0FsZ29yaXRobS5sZW5ndGg7XG4gICAgICAgICAgICBjb25zdCBrd0xlbmd0aEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcig0KTtcbiAgICAgICAgICAgIGNvbnN0IGt3TGVuZ3RoVmlldyA9IG5ldyBVaW50OEFycmF5KGt3TGVuZ3RoQnVmZmVyKTtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAzOyBqID49IDA7IGotLSkge1xuICAgICAgICAgICAgICAgIGt3TGVuZ3RoVmlld1tqXSA9IGt3TGVuZ3RoO1xuICAgICAgICAgICAgICAgIGt3TGVuZ3RoID4+PSA4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZWNjSW5mbyA9IG5ldyBFQ0NDTVNTaGFyZWRJbmZvKHtcbiAgICAgICAgICAgICAgICBrZXlJbmZvOiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBhZXNLV0FsZ29yaXRobS5hbGdvcml0aG1JZFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGVudGl0eVVJbmZvOiByZWNpcGllbnRJbmZvLnVrbSxcbiAgICAgICAgICAgICAgICBzdXBwUHViSW5mbzogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBrd0xlbmd0aEJ1ZmZlciB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBlbmNvZGVkSW5mbyA9IGVjY0luZm8udG9TY2hlbWEoKS50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICBjb25zdCBlY2RoQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHJlY2lwaWVudEluZm8ua2V5RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1JZCwgdHJ1ZSwgXCJlY2RoQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgY29uc3QgZGVyaXZlZEtleVJhdyA9IGF3YWl0IGtkZihlY2RoQWxnb3JpdGhtLmtkZiwgZGVyaXZlZEJpdHMsIGt3QWxnb3JpdGhtLmxlbmd0aCwgZW5jb2RlZEluZm8sIGNyeXB0byk7XG4gICAgICAgICAgICBjb25zdCBhd3NLVyA9IGF3YWl0IGNyeXB0by5pbXBvcnRLZXkoXCJyYXdcIiwgZGVyaXZlZEtleVJhdywgeyBuYW1lOiBcIkFFUy1LV1wiIH0sIHRydWUsIFtcIndyYXBLZXlcIl0pO1xuICAgICAgICAgICAgY29uc3Qgd3JhcHBlZEtleSA9IGF3YWl0IGNyeXB0by53cmFwS2V5KFwicmF3XCIsIHNlc3Npb25LZXksIGF3c0tXLCB7IG5hbWU6IFwiQUVTLUtXXCIgfSk7XG4gICAgICAgICAgICBjb25zdCBvcmlnaW5hdG9yID0gbmV3IE9yaWdpbmF0b3JJZGVudGlmaWVyT3JLZXkoKTtcbiAgICAgICAgICAgIG9yaWdpbmF0b3IudmFyaWFudCA9IDM7XG4gICAgICAgICAgICBvcmlnaW5hdG9yLnZhbHVlID0gT3JpZ2luYXRvclB1YmxpY0tleS5mcm9tQkVSKGV4cG9ydGVkRUNESFB1YmxpY0tleSk7XG4gICAgICAgICAgICByZWNpcGllbnRJbmZvLm9yaWdpbmF0b3IgPSBvcmlnaW5hdG9yO1xuICAgICAgICAgICAgcmVjaXBpZW50SW5mby5yZWNpcGllbnRFbmNyeXB0ZWRLZXlzLmVuY3J5cHRlZEtleXNbMF0uZW5jcnlwdGVkS2V5ID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiB3cmFwcGVkS2V5IH0pO1xuICAgICAgICAgICAgcmV0dXJuIHsgZWNkaFByaXZhdGVLZXk6IGVjZGhLZXlzLnByaXZhdGVLZXkgfTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgU3ViS2V5VHJhbnNSZWNpcGllbnRJbmZvID0gYXN5bmMgKGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZWNpcGllbnRJbmZvID0gdGhpcy5yZWNpcGllbnRJbmZvc1tpbmRleF0udmFsdWU7XG4gICAgICAgICAgICBjb25zdCBhbGdvcml0aG1QYXJhbWV0ZXJzID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHJlY2lwaWVudEluZm8ua2V5RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1JZCwgdHJ1ZSwgXCJrZXlFbmNyeXB0aW9uQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgaWYgKGFsZ29yaXRobVBhcmFtZXRlcnMubmFtZSA9PT0gXCJSU0EtT0FFUFwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2NoZW1hID0gcmVjaXBpZW50SW5mby5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcztcbiAgICAgICAgICAgICAgICBjb25zdCByc2FPQUVQUGFyYW1zID0gbmV3IFJTQUVTT0FFUFBhcmFtcyh7IHNjaGVtYSB9KTtcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1QYXJhbWV0ZXJzLmhhc2ggPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQocnNhT0FFUFBhcmFtcy5oYXNoQWxnb3JpdGhtLmFsZ29yaXRobUlkKTtcbiAgICAgICAgICAgICAgICBpZiAoKFwibmFtZVwiIGluIGFsZ29yaXRobVBhcmFtZXRlcnMuaGFzaCkgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBPSUQgZm9yIGhhc2ggYWxnb3JpdGhtOiAke3JzYU9BRVBQYXJhbXMuaGFzaEFsZ29yaXRobS5hbGdvcml0aG1JZH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHVibGljS2V5ID0gYXdhaXQgcmVjaXBpZW50SW5mby5yZWNpcGllbnRDZXJ0aWZpY2F0ZS5nZXRQdWJsaWNLZXkoe1xuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobTogYWxnb3JpdGhtUGFyYW1ldGVycyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzYWdlczogW1wiZW5jcnlwdFwiLCBcIndyYXBLZXlcIl1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGNyeXB0byk7XG4gICAgICAgICAgICAgICAgY29uc3QgZW5jcnlwdGVkS2V5ID0gYXdhaXQgY3J5cHRvLmVuY3J5cHQocHVibGljS2V5LmFsZ29yaXRobSwgcHVibGljS2V5LCBleHBvcnRlZFNlc3Npb25LZXkpO1xuICAgICAgICAgICAgICAgIHJlY2lwaWVudEluZm8uZW5jcnlwdGVkS2V5ID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBlbmNyeXB0ZWRLZXkgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IFN1YktFS1JlY2lwaWVudEluZm8gPSBhc3luYyAoaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2lwaWVudEluZm8gPSB0aGlzLnJlY2lwaWVudEluZm9zW2luZGV4XS52YWx1ZTtcbiAgICAgICAgICAgIGNvbnN0IGtla0FsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChyZWNpcGllbnRJbmZvLmtleUVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwia2VrQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgY29uc3Qga2VrS2V5ID0gYXdhaXQgY3J5cHRvLmltcG9ydEtleShcInJhd1wiLCBuZXcgVWludDhBcnJheShyZWNpcGllbnRJbmZvLnByZURlZmluZWRLRUspLCBrZWtBbGdvcml0aG0sIHRydWUsIFtcIndyYXBLZXlcIl0pO1xuICAgICAgICAgICAgY29uc3Qgd3JhcHBlZEtleSA9IGF3YWl0IGNyeXB0by53cmFwS2V5KFwicmF3XCIsIHNlc3Npb25LZXksIGtla0tleSwga2VrQWxnb3JpdGhtKTtcbiAgICAgICAgICAgIHJlY2lwaWVudEluZm8uZW5jcnlwdGVkS2V5ID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiB3cmFwcGVkS2V5IH0pO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBTdWJQYXNzd29yZFJlY2lwaWVudGluZm8gPSBhc3luYyAoaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2lwaWVudEluZm8gPSB0aGlzLnJlY2lwaWVudEluZm9zW2luZGV4XS52YWx1ZTtcbiAgICAgICAgICAgIGxldCBwYmtkZjJQYXJhbXM7XG4gICAgICAgICAgICBpZiAoIXJlY2lwaWVudEluZm8ua2V5RGVyaXZhdGlvbkFsZ29yaXRobSlcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQbGVhc2UgYXBwZW5kIGVuY29kZWQgXFxcImtleURlcml2YXRpb25BbGdvcml0aG1cXFwiXCIpO1xuICAgICAgICAgICAgaWYgKCFyZWNpcGllbnRJbmZvLmtleURlcml2YXRpb25BbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdGx5IGVuY29kZWQgXFxcImtleURlcml2YXRpb25BbGdvcml0aG1cXFwiXCIpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBwYmtkZjJQYXJhbXMgPSBuZXcgUEJLREYyUGFyYW1zKHsgc2NoZW1hOiByZWNpcGllbnRJbmZvLmtleURlcml2YXRpb25BbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0bHkgZW5jb2RlZCBcXFwia2V5RGVyaXZhdGlvbkFsZ29yaXRobVxcXCJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwYXNzd29yZFZpZXcgPSBuZXcgVWludDhBcnJheShyZWNpcGllbnRJbmZvLnBhc3N3b3JkKTtcbiAgICAgICAgICAgIGNvbnN0IGRlcml2YXRpb25LZXkgPSBhd2FpdCBjcnlwdG8uaW1wb3J0S2V5KFwicmF3XCIsIHBhc3N3b3JkVmlldywgXCJQQktERjJcIiwgZmFsc2UsIFtcImRlcml2ZUtleVwiXSk7XG4gICAgICAgICAgICBjb25zdCBrZWtBbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQocmVjaXBpZW50SW5mby5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobUlkLCB0cnVlLCBcImtla0FsZ29yaXRobVwiKTtcbiAgICAgICAgICAgIGxldCBobWFjSGFzaEFsZ29yaXRobSA9IFwiU0hBLTFcIjtcbiAgICAgICAgICAgIGlmIChwYmtkZjJQYXJhbXMucHJmKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJmQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHBia2RmMlBhcmFtcy5wcmYuYWxnb3JpdGhtSWQsIHRydWUsIFwicHJmQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgICAgIGhtYWNIYXNoQWxnb3JpdGhtID0gcHJmQWxnb3JpdGhtLmhhc2gubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNhbHRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkocGJrZGYyUGFyYW1zLnNhbHQudmFsdWVCbG9jay52YWx1ZUhleCk7XG4gICAgICAgICAgICBjb25zdCBpdGVyYXRpb25zID0gcGJrZGYyUGFyYW1zLml0ZXJhdGlvbkNvdW50O1xuICAgICAgICAgICAgY29uc3QgZGVyaXZlZEtleSA9IGF3YWl0IGNyeXB0by5kZXJpdmVLZXkoe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwiUEJLREYyXCIsXG4gICAgICAgICAgICAgICAgaGFzaDoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBobWFjSGFzaEFsZ29yaXRobVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2FsdDogc2FsdFZpZXcsXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uc1xuICAgICAgICAgICAgfSwgZGVyaXZhdGlvbktleSwga2VrQWxnb3JpdGhtLCB0cnVlLCBbXCJ3cmFwS2V5XCJdKTtcbiAgICAgICAgICAgIGNvbnN0IHdyYXBwZWRLZXkgPSBhd2FpdCBjcnlwdG8ud3JhcEtleShcInJhd1wiLCBzZXNzaW9uS2V5LCBkZXJpdmVkS2V5LCBrZWtBbGdvcml0aG0pO1xuICAgICAgICAgICAgcmVjaXBpZW50SW5mby5lbmNyeXB0ZWRLZXkgPSBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IHdyYXBwZWRLZXkgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHJlcyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucmVjaXBpZW50SW5mb3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5yZWNpcGllbnRJbmZvc1tpXS52YXJpYW50KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICByZXMucHVzaChhd2FpdCBTdWJLZXlUcmFuc1JlY2lwaWVudEluZm8oaSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKGF3YWl0IFN1YktleUFncmVlUmVjaXBpZW50SW5mbyhpKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2goYXdhaXQgU3ViS0VLUmVjaXBpZW50SW5mbyhpKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2goYXdhaXQgU3ViUGFzc3dvcmRSZWNpcGllbnRpbmZvKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHJlY2lwaWVudCB0eXBlIGluIGFycmF5IHdpdGggaW5kZXggJHtpfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuICAgIGFzeW5jIGRlY3J5cHQocmVjaXBpZW50SW5kZXgsIHBhcmFtZXRlcnMsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCBkZWNyeXB0aW9uUGFyYW1ldGVycyA9IHBhcmFtZXRlcnMgfHwge307XG4gICAgICAgIGlmICgocmVjaXBpZW50SW5kZXggKyAxKSA+IHRoaXMucmVjaXBpZW50SW5mb3MubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1heGltdW0gdmFsdWUgZm9yIFwiaW5kZXhcIiBpczogJHt0aGlzLnJlY2lwaWVudEluZm9zLmxlbmd0aCAtIDF9YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgU3ViS2V5QWdyZWVSZWNpcGllbnRJbmZvID0gYXN5bmMgKGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZWNpcGllbnRJbmZvID0gdGhpcy5yZWNpcGllbnRJbmZvc1tpbmRleF0udmFsdWU7XG4gICAgICAgICAgICBsZXQgY3VydmVPSUQ7XG4gICAgICAgICAgICBsZXQgcmVjaXBpZW50Q3VydmU7XG4gICAgICAgICAgICBsZXQgcmVjaXBpZW50Q3VydmVMZW5ndGg7XG4gICAgICAgICAgICBjb25zdCBvcmlnaW5hdG9yID0gcmVjaXBpZW50SW5mby5vcmlnaW5hdG9yO1xuICAgICAgICAgICAgaWYgKGRlY3J5cHRpb25QYXJhbWV0ZXJzLnJlY2lwaWVudENlcnRpZmljYXRlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VydmVPYmplY3QgPSBkZWNyeXB0aW9uUGFyYW1ldGVycy5yZWNpcGllbnRDZXJ0aWZpY2F0ZS5zdWJqZWN0UHVibGljS2V5SW5mby5hbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zO1xuICAgICAgICAgICAgICAgIGlmIChjdXJ2ZU9iamVjdC5jb25zdHJ1Y3Rvci5ibG9ja05hbWUoKSAhPT0gYXNuMWpzLk9iamVjdElkZW50aWZpZXIuYmxvY2tOYW1lKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgXCJyZWNpcGllbnRDZXJ0aWZpY2F0ZVwiIGZvciBpbmRleCAke2luZGV4fWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdXJ2ZU9JRCA9IGN1cnZlT2JqZWN0LnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG9yaWdpbmF0b3IudmFsdWUuYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnZlT2JqZWN0ID0gb3JpZ2luYXRvci52YWx1ZS5hbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zO1xuICAgICAgICAgICAgICAgIGlmIChjdXJ2ZU9iamVjdC5jb25zdHJ1Y3Rvci5ibG9ja05hbWUoKSAhPT0gYXNuMWpzLk9iamVjdElkZW50aWZpZXIuYmxvY2tOYW1lKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3Qgb3JpZ2luYXRvciBmb3IgaW5kZXggJHtpbmRleH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY3VydmVPSUQgPSBjdXJ2ZU9iamVjdC52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJhbWV0ZXIgXFxcInJlY2lwaWVudENlcnRpZmljYXRlXFxcIiBpcyBtYW5kYXRvcnkgZm9yIFxcXCJLZXlBZ3JlZVJlY2lwaWVudEluZm9cXFwiIGlmIGFsZ29yaXRobSBwYXJhbXMgYXJlIG1pc3NpbmcgZnJvbSBvcmlnaW5hdG9yXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFkZWNyeXB0aW9uUGFyYW1ldGVycy5yZWNpcGllbnRQcml2YXRlS2V5KVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBhcmFtZXRlciBcXFwicmVjaXBpZW50UHJpdmF0ZUtleVxcXCIgaXMgbWFuZGF0b3J5IGZvciBcXFwiS2V5QWdyZWVSZWNpcGllbnRJbmZvXFxcIlwiKTtcbiAgICAgICAgICAgIHN3aXRjaCAoY3VydmVPSUQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiMS4yLjg0MC4xMDA0NS4zLjEuN1wiOlxuICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRDdXJ2ZSA9IFwiUC0yNTZcIjtcbiAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmVMZW5ndGggPSAyNTY7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCIxLjMuMTMyLjAuMzRcIjpcbiAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50Q3VydmUgPSBcIlAtMzg0XCI7XG4gICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudEN1cnZlTGVuZ3RoID0gMzg0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiMS4zLjEzMi4wLjM1XCI6XG4gICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudEN1cnZlID0gXCJQLTUyMVwiO1xuICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRDdXJ2ZUxlbmd0aCA9IDUyODtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgY3VydmUgT0lEIGZvciBpbmRleCAke2luZGV4fWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IGVjZGhQcml2YXRlS2V5O1xuICAgICAgICAgICAgbGV0IGtleUNyeXB0byA9IGNyeXB0bztcbiAgICAgICAgICAgIGlmIChCdWZmZXJTb3VyY2VDb252ZXJ0ZXIuaXNCdWZmZXJTb3VyY2UoZGVjcnlwdGlvblBhcmFtZXRlcnMucmVjaXBpZW50UHJpdmF0ZUtleSkpIHtcbiAgICAgICAgICAgICAgICBlY2RoUHJpdmF0ZUtleSA9IGF3YWl0IGNyeXB0by5pbXBvcnRLZXkoXCJwa2NzOFwiLCBkZWNyeXB0aW9uUGFyYW1ldGVycy5yZWNpcGllbnRQcml2YXRlS2V5LCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiRUNESFwiLFxuICAgICAgICAgICAgICAgICAgICBuYW1lZEN1cnZlOiByZWNpcGllbnRDdXJ2ZVxuICAgICAgICAgICAgICAgIH0sIHRydWUsIFtcImRlcml2ZUJpdHNcIl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZWNkaFByaXZhdGVLZXkgPSBkZWNyeXB0aW9uUGFyYW1ldGVycy5yZWNpcGllbnRQcml2YXRlS2V5O1xuICAgICAgICAgICAgICAgIGlmIChcImNyeXB0b1wiIGluIGRlY3J5cHRpb25QYXJhbWV0ZXJzICYmIGRlY3J5cHRpb25QYXJhbWV0ZXJzLmNyeXB0bykge1xuICAgICAgICAgICAgICAgICAgICBrZXlDcnlwdG8gPSBkZWNyeXB0aW9uUGFyYW1ldGVycy5jcnlwdG8uc3VidGxlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoXCJhbGdvcml0aG1QYXJhbXNcIiBpbiBvcmlnaW5hdG9yLnZhbHVlLmFsZ29yaXRobSkgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgIG9yaWdpbmF0b3IudmFsdWUuYWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcyA9IG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiBjdXJ2ZU9JRCB9KTtcbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IG9yaWdpbmF0b3IudmFsdWUudG9TY2hlbWEoKS50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICBjb25zdCBlY2RoUHVibGljS2V5ID0gYXdhaXQgY3J5cHRvLmltcG9ydEtleShcInNwa2lcIiwgYnVmZmVyLCB7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJFQ0RIXCIsXG4gICAgICAgICAgICAgICAgbmFtZWRDdXJ2ZTogcmVjaXBpZW50Q3VydmVcbiAgICAgICAgICAgIH0sIHRydWUsIFtdKTtcbiAgICAgICAgICAgIGNvbnN0IHNoYXJlZFNlY3JldCA9IGF3YWl0IGtleUNyeXB0by5kZXJpdmVCaXRzKHtcbiAgICAgICAgICAgICAgICBuYW1lOiBcIkVDREhcIixcbiAgICAgICAgICAgICAgICBwdWJsaWM6IGVjZGhQdWJsaWNLZXlcbiAgICAgICAgICAgIH0sIGVjZGhQcml2YXRlS2V5LCByZWNpcGllbnRDdXJ2ZUxlbmd0aCk7XG4gICAgICAgICAgICBhc3luYyBmdW5jdGlvbiBhcHBseUtERihpbmNsdWRlQWxnb3JpdGhtUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgaW5jbHVkZUFsZ29yaXRobVBhcmFtcyA9IGluY2x1ZGVBbGdvcml0aG1QYXJhbXMgfHwgZmFsc2U7XG4gICAgICAgICAgICAgICAgY29uc3QgYWVzS1dBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogcmVjaXBpZW50SW5mby5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcyB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCBrd0FsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChhZXNLV0FsZ29yaXRobS5hbGdvcml0aG1JZCwgdHJ1ZSwgXCJrd0FsZ29yaXRobVwiKTtcbiAgICAgICAgICAgICAgICBsZXQga3dMZW5ndGggPSBrd0FsZ29yaXRobS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgY29uc3Qga3dMZW5ndGhCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoNCk7XG4gICAgICAgICAgICAgICAgY29uc3Qga3dMZW5ndGhWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoa3dMZW5ndGhCdWZmZXIpO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAzOyBqID49IDA7IGotLSkge1xuICAgICAgICAgICAgICAgICAgICBrd0xlbmd0aFZpZXdbal0gPSBrd0xlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAga3dMZW5ndGggPj49IDg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGtleUluZm9BbGdvcml0aG0gPSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBhZXNLV0FsZ29yaXRobS5hbGdvcml0aG1JZFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKGluY2x1ZGVBbGdvcml0aG1QYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAga2V5SW5mb0FsZ29yaXRobS5hbGdvcml0aG1QYXJhbXMgPSBuZXcgYXNuMWpzLk51bGwoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgZWNjSW5mbyA9IG5ldyBFQ0NDTVNTaGFyZWRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAga2V5SW5mbzogbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoa2V5SW5mb0FsZ29yaXRobSksXG4gICAgICAgICAgICAgICAgICAgIGVudGl0eVVJbmZvOiByZWNpcGllbnRJbmZvLnVrbSxcbiAgICAgICAgICAgICAgICAgICAgc3VwcFB1YkluZm86IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDoga3dMZW5ndGhCdWZmZXIgfSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlbmNvZGVkSW5mbyA9IGVjY0luZm8udG9TY2hlbWEoKS50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgZWNkaEFsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChyZWNpcGllbnRJbmZvLmtleUVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwiZWNkaEFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgICAgICBpZiAoIWVjZGhBbGdvcml0aG0ubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBPSUQgZm9yIGtleSBlbmNyeXB0aW9uIGFsZ29yaXRobTogJHtyZWNpcGllbnRJbmZvLmtleUVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtSWR9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBrZGYoZWNkaEFsZ29yaXRobS5rZGYsIHNoYXJlZFNlY3JldCwga3dBbGdvcml0aG0ubGVuZ3RoLCBlbmNvZGVkSW5mbywgY3J5cHRvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGtkZlJlc3VsdCA9IGF3YWl0IGFwcGx5S0RGKCk7XG4gICAgICAgICAgICBjb25zdCBpbXBvcnRBZXNLd0tleSA9IGFzeW5jIChrZGZSZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3J5cHRvLmltcG9ydEtleShcInJhd1wiLCBrZGZSZXN1bHQsIHsgbmFtZTogXCJBRVMtS1dcIiB9LCB0cnVlLCBbXCJ1bndyYXBLZXlcIl0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IGFlc0t3S2V5ID0gYXdhaXQgaW1wb3J0QWVzS3dLZXkoa2RmUmVzdWx0KTtcbiAgICAgICAgICAgIGNvbnN0IHVud3JhcFNlc3Npb25LZXkgPSBhc3luYyAoYWVzS3dLZXkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBhbGdvcml0aG1JZCA9IHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8uY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtSWQ7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQoYWxnb3JpdGhtSWQsIHRydWUsIFwiY29udGVudEVuY3J5cHRpb25BbGdvcml0aG1cIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyeXB0by51bndyYXBLZXkoXCJyYXdcIiwgcmVjaXBpZW50SW5mby5yZWNpcGllbnRFbmNyeXB0ZWRLZXlzLmVuY3J5cHRlZEtleXNbMF0uZW5jcnlwdGVkS2V5LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3LCBhZXNLd0tleSwgeyBuYW1lOiBcIkFFUy1LV1wiIH0sIGNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLCB0cnVlLCBbXCJkZWNyeXB0XCJdKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB1bndyYXBTZXNzaW9uS2V5KGFlc0t3S2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgICAgICBjb25zdCBrZGZSZXN1bHQgPSBhd2FpdCBhcHBseUtERih0cnVlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBhZXNLd0tleSA9IGF3YWl0IGltcG9ydEFlc0t3S2V5KGtkZlJlc3VsdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVud3JhcFNlc3Npb25LZXkoYWVzS3dLZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBTdWJLZXlUcmFuc1JlY2lwaWVudEluZm8gPSBhc3luYyAoaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2lwaWVudEluZm8gPSB0aGlzLnJlY2lwaWVudEluZm9zW2luZGV4XS52YWx1ZTtcbiAgICAgICAgICAgIGlmICghZGVjcnlwdGlvblBhcmFtZXRlcnMucmVjaXBpZW50UHJpdmF0ZUtleSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBhcmFtZXRlciBcXFwicmVjaXBpZW50UHJpdmF0ZUtleVxcXCIgaXMgbWFuZGF0b3J5IGZvciBcXFwiS2V5VHJhbnNSZWNpcGllbnRJbmZvXFxcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGFsZ29yaXRobVBhcmFtZXRlcnMgPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQocmVjaXBpZW50SW5mby5rZXlFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobUlkLCB0cnVlLCBcImtleUVuY3J5cHRpb25BbGdvcml0aG1cIik7XG4gICAgICAgICAgICBpZiAoYWxnb3JpdGhtUGFyYW1ldGVycy5uYW1lID09PSBcIlJTQS1PQUVQXCIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzY2hlbWEgPSByZWNpcGllbnRJbmZvLmtleUVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJzYU9BRVBQYXJhbXMgPSBuZXcgUlNBRVNPQUVQUGFyYW1zKHsgc2NoZW1hIH0pO1xuICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtZXRlcnMuaGFzaCA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChyc2FPQUVQUGFyYW1zLmhhc2hBbGdvcml0aG0uYWxnb3JpdGhtSWQpO1xuICAgICAgICAgICAgICAgIGlmICgoXCJuYW1lXCIgaW4gYWxnb3JpdGhtUGFyYW1ldGVycy5oYXNoKSA9PT0gZmFsc2UpXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IE9JRCBmb3IgaGFzaCBhbGdvcml0aG06ICR7cnNhT0FFUFBhcmFtcy5oYXNoQWxnb3JpdGhtLmFsZ29yaXRobUlkfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHByaXZhdGVLZXk7XG4gICAgICAgICAgICBsZXQga2V5Q3J5cHRvID0gY3J5cHRvO1xuICAgICAgICAgICAgaWYgKEJ1ZmZlclNvdXJjZUNvbnZlcnRlci5pc0J1ZmZlclNvdXJjZShkZWNyeXB0aW9uUGFyYW1ldGVycy5yZWNpcGllbnRQcml2YXRlS2V5KSkge1xuICAgICAgICAgICAgICAgIHByaXZhdGVLZXkgPSBhd2FpdCBjcnlwdG8uaW1wb3J0S2V5KFwicGtjczhcIiwgZGVjcnlwdGlvblBhcmFtZXRlcnMucmVjaXBpZW50UHJpdmF0ZUtleSwgYWxnb3JpdGhtUGFyYW1ldGVycywgdHJ1ZSwgW1wiZGVjcnlwdFwiXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcml2YXRlS2V5ID0gZGVjcnlwdGlvblBhcmFtZXRlcnMucmVjaXBpZW50UHJpdmF0ZUtleTtcbiAgICAgICAgICAgICAgICBpZiAoXCJjcnlwdG9cIiBpbiBkZWNyeXB0aW9uUGFyYW1ldGVycyAmJiBkZWNyeXB0aW9uUGFyYW1ldGVycy5jcnlwdG8pIHtcbiAgICAgICAgICAgICAgICAgICAga2V5Q3J5cHRvID0gZGVjcnlwdGlvblBhcmFtZXRlcnMuY3J5cHRvLnN1YnRsZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uS2V5ID0gYXdhaXQga2V5Q3J5cHRvLmRlY3J5cHQocHJpdmF0ZUtleS5hbGdvcml0aG0sIHByaXZhdGVLZXksIHJlY2lwaWVudEluZm8uZW5jcnlwdGVkS2V5LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KTtcbiAgICAgICAgICAgIGNvbnN0IGFsZ29yaXRobUlkID0gdGhpcy5lbmNyeXB0ZWRDb250ZW50SW5mby5jb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobS5hbGdvcml0aG1JZDtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKGFsZ29yaXRobUlkLCB0cnVlLCBcImNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgaWYgKChcIm5hbWVcIiBpbiBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSkgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IFwiY29udGVudEVuY3J5cHRpb25BbGdvcml0aG1cIjogJHthbGdvcml0aG1JZH1gKTtcbiAgICAgICAgICAgIHJldHVybiBjcnlwdG8uaW1wb3J0S2V5KFwicmF3XCIsIHNlc3Npb25LZXksIGNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLCB0cnVlLCBbXCJkZWNyeXB0XCJdKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgU3ViS0VLUmVjaXBpZW50SW5mbyA9IGFzeW5jIChpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVjaXBpZW50SW5mbyA9IHRoaXMucmVjaXBpZW50SW5mb3NbaW5kZXhdLnZhbHVlO1xuICAgICAgICAgICAgaWYgKCFkZWNyeXB0aW9uUGFyYW1ldGVycy5wcmVEZWZpbmVkRGF0YSlcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJhbWV0ZXIgXFxcInByZURlZmluZWREYXRhXFxcIiBpcyBtYW5kYXRvcnkgZm9yIFxcXCJLRUtSZWNpcGllbnRJbmZvXFxcIlwiKTtcbiAgICAgICAgICAgIGNvbnN0IGtla0FsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChyZWNpcGllbnRJbmZvLmtleUVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwia2VrQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgY29uc3QgaW1wb3J0ZWRLZXkgPSBhd2FpdCBjcnlwdG8uaW1wb3J0S2V5KFwicmF3XCIsIGRlY3J5cHRpb25QYXJhbWV0ZXJzLnByZURlZmluZWREYXRhLCBrZWtBbGdvcml0aG0sIHRydWUsIFtcInVud3JhcEtleVwiXSk7XG4gICAgICAgICAgICBjb25zdCBhbGdvcml0aG1JZCA9IHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8uY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtSWQ7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChhbGdvcml0aG1JZCwgdHJ1ZSwgXCJjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgIGlmICghY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0ubmFtZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IFwiY29udGVudEVuY3J5cHRpb25BbGdvcml0aG1cIjogJHthbGdvcml0aG1JZH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjcnlwdG8udW53cmFwS2V5KFwicmF3XCIsIHJlY2lwaWVudEluZm8uZW5jcnlwdGVkS2V5LnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3LCBpbXBvcnRlZEtleSwga2VrQWxnb3JpdGhtLCBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSwgdHJ1ZSwgW1wiZGVjcnlwdFwiXSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IFN1YlBhc3N3b3JkUmVjaXBpZW50aW5mbyA9IGFzeW5jIChpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVjaXBpZW50SW5mbyA9IHRoaXMucmVjaXBpZW50SW5mb3NbaW5kZXhdLnZhbHVlO1xuICAgICAgICAgICAgbGV0IHBia2RmMlBhcmFtcztcbiAgICAgICAgICAgIGlmICghZGVjcnlwdGlvblBhcmFtZXRlcnMucHJlRGVmaW5lZERhdGEpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJhbWV0ZXIgXFxcInByZURlZmluZWREYXRhXFxcIiBpcyBtYW5kYXRvcnkgZm9yIFxcXCJLRUtSZWNpcGllbnRJbmZvXFxcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghcmVjaXBpZW50SW5mby5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGxlYXNlIGFwcGVuZCBlbmNvZGVkIFxcXCJrZXlEZXJpdmF0aW9uQWxnb3JpdGhtXFxcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghcmVjaXBpZW50SW5mby5rZXlEZXJpdmF0aW9uQWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdGx5IGVuY29kZWQgXFxcImtleURlcml2YXRpb25BbGdvcml0aG1cXFwiXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBwYmtkZjJQYXJhbXMgPSBuZXcgUEJLREYyUGFyYW1zKHsgc2NoZW1hOiByZWNpcGllbnRJbmZvLmtleURlcml2YXRpb25BbGdvcml0aG0uYWxnb3JpdGhtUGFyYW1zIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0bHkgZW5jb2RlZCBcXFwia2V5RGVyaXZhdGlvbkFsZ29yaXRobVxcXCJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwYmtkZjJLZXkgPSBhd2FpdCBjcnlwdG8uaW1wb3J0S2V5KFwicmF3XCIsIGRlY3J5cHRpb25QYXJhbWV0ZXJzLnByZURlZmluZWREYXRhLCBcIlBCS0RGMlwiLCBmYWxzZSwgW1wiZGVyaXZlS2V5XCJdKTtcbiAgICAgICAgICAgIGNvbnN0IGtla0FsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChyZWNpcGllbnRJbmZvLmtleUVuY3J5cHRpb25BbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwia2V5RW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgIGNvbnN0IGhtYWNIYXNoQWxnb3JpdGhtID0gcGJrZGYyUGFyYW1zLnByZlxuICAgICAgICAgICAgICAgID8gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHBia2RmMlBhcmFtcy5wcmYuYWxnb3JpdGhtSWQsIHRydWUsIFwicHJmQWxnb3JpdGhtXCIpLmhhc2gubmFtZVxuICAgICAgICAgICAgICAgIDogXCJTSEEtMVwiO1xuICAgICAgICAgICAgY29uc3Qgc2FsdFZpZXcgPSBuZXcgVWludDhBcnJheShwYmtkZjJQYXJhbXMuc2FsdC52YWx1ZUJsb2NrLnZhbHVlSGV4KTtcbiAgICAgICAgICAgIGNvbnN0IGl0ZXJhdGlvbnMgPSBwYmtkZjJQYXJhbXMuaXRlcmF0aW9uQ291bnQ7XG4gICAgICAgICAgICBjb25zdCBrZWtLZXkgPSBhd2FpdCBjcnlwdG8uZGVyaXZlS2V5KHtcbiAgICAgICAgICAgICAgICBuYW1lOiBcIlBCS0RGMlwiLFxuICAgICAgICAgICAgICAgIGhhc2g6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogaG1hY0hhc2hBbGdvcml0aG1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNhbHQ6IHNhbHRWaWV3LFxuICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnNcbiAgICAgICAgICAgIH0sIHBia2RmMktleSwga2VrQWxnb3JpdGhtLCB0cnVlLCBbXCJ1bndyYXBLZXlcIl0pO1xuICAgICAgICAgICAgY29uc3QgYWxnb3JpdGhtSWQgPSB0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobUlkO1xuICAgICAgICAgICAgY29uc3QgY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQoYWxnb3JpdGhtSWQsIHRydWUsIFwiY29udGVudEVuY3J5cHRpb25BbGdvcml0aG1cIik7XG4gICAgICAgICAgICByZXR1cm4gY3J5cHRvLnVud3JhcEtleShcInJhd1wiLCByZWNpcGllbnRJbmZvLmVuY3J5cHRlZEtleS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldywga2VrS2V5LCBrZWtBbGdvcml0aG0sIGNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLCB0cnVlLCBbXCJkZWNyeXB0XCJdKTtcbiAgICAgICAgfTtcbiAgICAgICAgbGV0IHVud3JhcHBlZEtleTtcbiAgICAgICAgc3dpdGNoICh0aGlzLnJlY2lwaWVudEluZm9zW3JlY2lwaWVudEluZGV4XS52YXJpYW50KSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgdW53cmFwcGVkS2V5ID0gYXdhaXQgU3ViS2V5VHJhbnNSZWNpcGllbnRJbmZvKHJlY2lwaWVudEluZGV4KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICB1bndyYXBwZWRLZXkgPSBhd2FpdCBTdWJLZXlBZ3JlZVJlY2lwaWVudEluZm8ocmVjaXBpZW50SW5kZXgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHVud3JhcHBlZEtleSA9IGF3YWl0IFN1YktFS1JlY2lwaWVudEluZm8ocmVjaXBpZW50SW5kZXgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIHVud3JhcHBlZEtleSA9IGF3YWl0IFN1YlBhc3N3b3JkUmVjaXBpZW50aW5mbyhyZWNpcGllbnRJbmRleCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biByZWNpcGllbnQgdHlwZSBpbiBhcnJheSB3aXRoIGluZGV4ICR7cmVjaXBpZW50SW5kZXh9YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYWxnb3JpdGhtSWQgPSB0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobUlkO1xuICAgICAgICBjb25zdCBjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobSA9IGNyeXB0by5nZXRBbGdvcml0aG1CeU9JRChhbGdvcml0aG1JZCwgdHJ1ZSwgXCJjb250ZW50RW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgY29uc3QgaXZCdWZmZXIgPSB0aGlzLmVuY3J5cHRlZENvbnRlbnRJbmZvLmNvbnRlbnRFbmNyeXB0aW9uQWxnb3JpdGhtLmFsZ29yaXRobVBhcmFtcy52YWx1ZUJsb2NrLnZhbHVlSGV4O1xuICAgICAgICBjb25zdCBpdlZpZXcgPSBuZXcgVWludDhBcnJheShpdkJ1ZmZlcik7XG4gICAgICAgIGlmICghdGhpcy5lbmNyeXB0ZWRDb250ZW50SW5mby5lbmNyeXB0ZWRDb250ZW50KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSZXF1aXJlZCBwcm9wZXJ0eSBgZW5jcnlwdGVkQ29udGVudGAgaXMgZW1wdHlcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGF0YUJ1ZmZlciA9IHRoaXMuZW5jcnlwdGVkQ29udGVudEluZm8uZ2V0RW5jcnlwdGVkQ29udGVudCgpO1xuICAgICAgICByZXR1cm4gY3J5cHRvLmRlY3J5cHQoe1xuICAgICAgICAgICAgbmFtZTogY29udGVudEVuY3J5cHRpb25BbGdvcml0aG0ubmFtZSxcbiAgICAgICAgICAgIGl2OiBpdlZpZXdcbiAgICAgICAgfSwgdW53cmFwcGVkS2V5LCBkYXRhQnVmZmVyKTtcbiAgICB9XG59XG5FbnZlbG9wZWREYXRhLkNMQVNTX05BTUUgPSBcIkVudmVsb3BlZERhdGFcIjtcblxuY29uc3QgU0FGRV9DT05URU5UUyA9IFwic2FmZUNvbnRlbnRzXCI7XG5jb25zdCBQQVJTRURfVkFMVUUkMSA9IFwicGFyc2VkVmFsdWVcIjtcbmNvbnN0IENPTlRFTlRfSU5GT1MgPSBcImNvbnRlbnRJbmZvc1wiO1xuY2xhc3MgQXV0aGVudGljYXRlZFNhZmUgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnNhZmVDb250ZW50cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNBRkVfQ09OVEVOVFMsIEF1dGhlbnRpY2F0ZWRTYWZlLmRlZmF1bHRWYWx1ZXMoU0FGRV9DT05URU5UUykpO1xuICAgICAgICBpZiAoUEFSU0VEX1ZBTFVFJDEgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFBBUlNFRF9WQUxVRSQxLCBBdXRoZW50aWNhdGVkU2FmZS5kZWZhdWx0VmFsdWVzKFBBUlNFRF9WQUxVRSQxKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFNBRkVfQ09OVEVOVFM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBQQVJTRURfVkFMVUUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFNBRkVfQ09OVEVOVFM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBQQVJTRURfVkFMVUUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZSBpbnN0YW5jZW9mIE9iamVjdCkgJiYgKE9iamVjdC5rZXlzKG1lbWJlclZhbHVlKS5sZW5ndGggPT09IDApKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5jb250ZW50SW5mb3MgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IENvbnRlbnRJbmZvLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBbXG4gICAgICAgICAgICBDT05URU5UX0lORk9TXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIEF1dGhlbnRpY2F0ZWRTYWZlLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIGNvbnRlbnRJbmZvczogQ09OVEVOVF9JTkZPU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuc2FmZUNvbnRlbnRzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5jb250ZW50SW5mb3MsIGVsZW1lbnQgPT4gbmV3IENvbnRlbnRJbmZvKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLnNhZmVDb250ZW50cywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2FmZUNvbnRlbnRzOiBBcnJheS5mcm9tKHRoaXMuc2FmZUNvbnRlbnRzLCBvID0+IG8udG9KU09OKCkpXG4gICAgICAgIH07XG4gICAgfVxuICAgIGFzeW5jIHBhcnNlSW50ZXJuYWxWYWx1ZXMocGFyYW1ldGVycywgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChwYXJhbWV0ZXJzLCBTQUZFX0NPTlRFTlRTKTtcbiAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQocGFyYW1ldGVycy5zYWZlQ29udGVudHMsIFNBRkVfQ09OVEVOVFMsIFwiQXJyYXlcIik7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNhZmVDb250ZW50cy5sZW5ndGggIT09IHRoaXMuc2FmZUNvbnRlbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXJyb3IoXCJMZW5ndGggb2YgXFxcInBhcmFtZXRlcnMuc2FmZUNvbnRlbnRzXFxcIiBtdXN0IGJlIGVxdWFsIHRvIFxcXCJ0aGlzLnNhZmVDb250ZW50cy5sZW5ndGhcXFwiXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyc2VkVmFsdWUgPSB7XG4gICAgICAgICAgICBzYWZlQ29udGVudHM6IFtdLFxuICAgICAgICB9O1xuICAgICAgICBmb3IgKGNvbnN0IFtpbmRleCwgY29udGVudF0gb2YgdGhpcy5zYWZlQ29udGVudHMuZW50cmllcygpKSB7XG4gICAgICAgICAgICBjb25zdCBzYWZlQ29udGVudCA9IHBhcmFtZXRlcnMuc2FmZUNvbnRlbnRzW2luZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yVGFyZ2V0ID0gYHBhcmFtZXRlcnMuc2FmZUNvbnRlbnRzWyR7aW5kZXh9XWA7XG4gICAgICAgICAgICBzd2l0Y2ggKGNvbnRlbnQuY29udGVudFR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIGlkX0NvbnRlbnRUeXBlX0RhdGE6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEFyZ3VtZW50RXJyb3IuYXNzZXJ0KGNvbnRlbnQuY29udGVudCwgXCJ0aGlzLnNhZmVDb250ZW50c1tqXS5jb250ZW50XCIsIGFzbjFqcy5PY3RldFN0cmluZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdXRoU2FmZUNvbnRlbnQgPSBjb250ZW50LmNvbnRlbnQuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VkVmFsdWUuc2FmZUNvbnRlbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaXZhY3lNb2RlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBTYWZlQ29udGVudHMuZnJvbUJFUihhdXRoU2FmZUNvbnRlbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGlkX0NvbnRlbnRUeXBlX0VudmVsb3BlZERhdGE6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNtc0VudmVsb3BlZCA9IG5ldyBFbnZlbG9wZWREYXRhKHsgc2NoZW1hOiBjb250ZW50LmNvbnRlbnQgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQoZXJyb3JUYXJnZXQsIHNhZmVDb250ZW50LCBcInJlY2lwaWVudENlcnRpZmljYXRlXCIsIFwicmVjaXBpZW50S2V5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW52ZWxvcGVkRGF0YSA9IHNhZmVDb250ZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVjaXBpZW50Q2VydGlmaWNhdGUgPSBlbnZlbG9wZWREYXRhLnJlY2lwaWVudENlcnRpZmljYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVjaXBpZW50S2V5ID0gZW52ZWxvcGVkRGF0YS5yZWNpcGllbnRLZXk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZWNyeXB0ZWQgPSBhd2FpdCBjbXNFbnZlbG9wZWQuZGVjcnlwdCgwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50Q2VydGlmaWNhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50UHJpdmF0ZUtleTogcmVjaXBpZW50S2V5XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZS5zYWZlQ29udGVudHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpdmFjeU1vZGU6IDIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFNhZmVDb250ZW50cy5mcm9tQkVSKGRlY3J5cHRlZCksXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGlkX0NvbnRlbnRUeXBlX0VuY3J5cHRlZERhdGE6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNtc0VuY3J5cHRlZCA9IG5ldyBFbmNyeXB0ZWREYXRhKHsgc2NoZW1hOiBjb250ZW50LmNvbnRlbnQgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQoZXJyb3JUYXJnZXQsIHNhZmVDb250ZW50LCBcInBhc3N3b3JkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFzc3dvcmQgPSBzYWZlQ29udGVudC5wYXNzd29yZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlY3J5cHRlZCA9IGF3YWl0IGNtc0VuY3J5cHRlZC5kZWNyeXB0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgY3J5cHRvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VkVmFsdWUuc2FmZUNvbnRlbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaXZhY3lNb2RlOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBTYWZlQ29udGVudHMuZnJvbUJFUihkZWNyeXB0ZWQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIFwiY29udGVudFR5cGVcIiBmb3IgQXV0aGVudGljYXRlZFNhZmU6IFwiICR7Y29udGVudC5jb250ZW50VHlwZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBtYWtlSW50ZXJuYWxWYWx1ZXMocGFyYW1ldGVycywgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIGlmICghKHRoaXMucGFyc2VkVmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQbGVhc2UgcnVuIFxcXCJwYXJzZVZhbHVlc1xcXCIgZmlyc3Qgb3IgYWRkIFxcXCJwYXJzZWRWYWx1ZVxcXCIgbWFudWFsbHlcIik7XG4gICAgICAgIH1cbiAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQodGhpcy5wYXJzZWRWYWx1ZSwgXCJ0aGlzLnBhcnNlZFZhbHVlXCIsIFwib2JqZWN0XCIpO1xuICAgICAgICBBcmd1bWVudEVycm9yLmFzc2VydCh0aGlzLnBhcnNlZFZhbHVlLnNhZmVDb250ZW50cywgXCJ0aGlzLnBhcnNlZFZhbHVlLnNhZmVDb250ZW50c1wiLCBcIkFycmF5XCIpO1xuICAgICAgICBBcmd1bWVudEVycm9yLmFzc2VydChwYXJhbWV0ZXJzLCBcInBhcmFtZXRlcnNcIiwgXCJvYmplY3RcIik7XG4gICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChwYXJhbWV0ZXJzLCBcInNhZmVDb250ZW50c1wiKTtcbiAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQocGFyYW1ldGVycy5zYWZlQ29udGVudHMsIFwicGFyYW1ldGVycy5zYWZlQ29udGVudHNcIiwgXCJBcnJheVwiKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2FmZUNvbnRlbnRzLmxlbmd0aCAhPT0gdGhpcy5wYXJzZWRWYWx1ZS5zYWZlQ29udGVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFcnJvcihcIkxlbmd0aCBvZiBcXFwicGFyYW1ldGVycy5zYWZlQ29udGVudHNcXFwiIG11c3QgYmUgZXF1YWwgdG8gXFxcInRoaXMucGFyc2VkVmFsdWUuc2FmZUNvbnRlbnRzXFxcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNhZmVDb250ZW50cyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IFtpbmRleCwgY29udGVudF0gb2YgdGhpcy5wYXJzZWRWYWx1ZS5zYWZlQ29udGVudHMuZW50cmllcygpKSB7XG4gICAgICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnQoXCJjb250ZW50XCIsIGNvbnRlbnQsIFwicHJpdmFjeU1vZGVcIiwgXCJ2YWx1ZVwiKTtcbiAgICAgICAgICAgIEFyZ3VtZW50RXJyb3IuYXNzZXJ0KGNvbnRlbnQudmFsdWUsIFwiY29udGVudC52YWx1ZVwiLCBTYWZlQ29udGVudHMpO1xuICAgICAgICAgICAgc3dpdGNoIChjb250ZW50LnByaXZhY3lNb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50QnVmZmVyID0gY29udGVudC52YWx1ZS50b1NjaGVtYSgpLnRvQkVSKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2FmZUNvbnRlbnRzLnB1c2gobmV3IENvbnRlbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogXCIxLjIuODQwLjExMzU0OS4xLjcuMVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogY29udGVudEJ1ZmZlciB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY21zRW5jcnlwdGVkID0gbmV3IEVuY3J5cHRlZERhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQYXJhbWV0ZXJzID0gcGFyYW1ldGVycy5zYWZlQ29udGVudHNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBhcmFtZXRlcnMuY29udGVudFRvRW5jcnlwdCA9IGNvbnRlbnQudmFsdWUudG9TY2hlbWEoKS50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbXNFbmNyeXB0ZWQuZW5jcnlwdChjdXJyZW50UGFyYW1ldGVycywgY3J5cHRvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2FmZUNvbnRlbnRzLnB1c2gobmV3IENvbnRlbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogXCIxLjIuODQwLjExMzU0OS4xLjcuNlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNtc0VuY3J5cHRlZC50b1NjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbXNFbnZlbG9wZWQgPSBuZXcgRW52ZWxvcGVkRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudFRvRW5jcnlwdCA9IGNvbnRlbnQudmFsdWUudG9TY2hlbWEoKS50b0JFUihmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzYWZlQ29udGVudCA9IHBhcmFtZXRlcnMuc2FmZUNvbnRlbnRzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydChgcGFyYW1ldGVycy5zYWZlQ29udGVudHNbJHtpbmRleH1dYCwgc2FmZUNvbnRlbnQsIFwiZW5jcnlwdGluZ0NlcnRpZmljYXRlXCIsIFwiZW5jcnlwdGlvbkFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgKHNhZmVDb250ZW50LmVuY3J5cHRpb25BbGdvcml0aG0ubmFtZS50b0xvd2VyQ2FzZSgpID09PSBcImFlcy1jYmNcIik6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAoc2FmZUNvbnRlbnQuZW5jcnlwdGlvbkFsZ29yaXRobS5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IFwiYWVzLWdjbVwiKTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgcGFyYW1ldGVyIFwiZW5jcnlwdGlvbkFsZ29yaXRobVwiIGluIFwicGFyYW1ldGVycy5zYWZlQ29udGVudHNbaV1cIjogJHtzYWZlQ29udGVudC5lbmNyeXB0aW9uQWxnb3JpdGhtfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAoc2FmZUNvbnRlbnQuZW5jcnlwdGlvbkFsZ29yaXRobS5sZW5ndGggPT09IDEyOCk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAoc2FmZUNvbnRlbnQuZW5jcnlwdGlvbkFsZ29yaXRobS5sZW5ndGggPT09IDE5Mik6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAoc2FmZUNvbnRlbnQuZW5jcnlwdGlvbkFsZ29yaXRobS5sZW5ndGggPT09IDI1Nik6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IHBhcmFtZXRlciBcImVuY3J5cHRpb25BbGdvcml0aG0ubGVuZ3RoXCIgaW4gXCJwYXJhbWV0ZXJzLnNhZmVDb250ZW50c1tpXVwiOiAke3NhZmVDb250ZW50LmVuY3J5cHRpb25BbGdvcml0aG0ubGVuZ3RofWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5jcnlwdGlvbkFsZ29yaXRobSA9IHNhZmVDb250ZW50LmVuY3J5cHRpb25BbGdvcml0aG07XG4gICAgICAgICAgICAgICAgICAgICAgICBjbXNFbnZlbG9wZWQuYWRkUmVjaXBpZW50QnlDZXJ0aWZpY2F0ZShzYWZlQ29udGVudC5lbmNyeXB0aW5nQ2VydGlmaWNhdGUsIHt9LCB1bmRlZmluZWQsIGNyeXB0byk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbXNFbnZlbG9wZWQuZW5jcnlwdChlbmNyeXB0aW9uQWxnb3JpdGhtLCBjb250ZW50VG9FbmNyeXB0LCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYWZlQ29udGVudHMucHVzaChuZXcgQ29udGVudEluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBcIjEuMi44NDAuMTEzNTQ5LjEuNy4zXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogY21zRW52ZWxvcGVkLnRvU2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCB2YWx1ZSBmb3IgXCJjb250ZW50LnByaXZhY3lNb2RlXCI6ICR7Y29udGVudC5wcml2YWN5TW9kZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG59XG5BdXRoZW50aWNhdGVkU2FmZS5DTEFTU19OQU1FID0gXCJBdXRoZW50aWNhdGVkU2FmZVwiO1xuXG5jb25zdCBIQVNIX0FMR09SSVRITSQxID0gXCJoYXNoQWxnb3JpdGhtXCI7XG5jb25zdCBJU1NVRVJfTkFNRV9IQVNIID0gXCJpc3N1ZXJOYW1lSGFzaFwiO1xuY29uc3QgSVNTVUVSX0tFWV9IQVNIID0gXCJpc3N1ZXJLZXlIYXNoXCI7XG5jb25zdCBTRVJJQUxfTlVNQkVSJDEgPSBcInNlcmlhbE51bWJlclwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkaiA9IFtcbiAgICBIQVNIX0FMR09SSVRITSQxLFxuICAgIElTU1VFUl9OQU1FX0hBU0gsXG4gICAgSVNTVUVSX0tFWV9IQVNILFxuICAgIFNFUklBTF9OVU1CRVIkMSxcbl07XG5jbGFzcyBDZXJ0SUQgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIHN0YXRpYyBhc3luYyBjcmVhdGUoY2VydGlmaWNhdGUsIHBhcmFtZXRlcnMsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCBjZXJ0SUQgPSBuZXcgQ2VydElEKCk7XG4gICAgICAgIGF3YWl0IGNlcnRJRC5jcmVhdGVGb3JDZXJ0aWZpY2F0ZShjZXJ0aWZpY2F0ZSwgcGFyYW1ldGVycywgY3J5cHRvKTtcbiAgICAgICAgcmV0dXJuIGNlcnRJRDtcbiAgICB9XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEhBU0hfQUxHT1JJVEhNJDEsIENlcnRJRC5kZWZhdWx0VmFsdWVzKEhBU0hfQUxHT1JJVEhNJDEpKTtcbiAgICAgICAgdGhpcy5pc3N1ZXJOYW1lSGFzaCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIElTU1VFUl9OQU1FX0hBU0gsIENlcnRJRC5kZWZhdWx0VmFsdWVzKElTU1VFUl9OQU1FX0hBU0gpKTtcbiAgICAgICAgdGhpcy5pc3N1ZXJLZXlIYXNoID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVNTVUVSX0tFWV9IQVNILCBDZXJ0SUQuZGVmYXVsdFZhbHVlcyhJU1NVRVJfS0VZX0hBU0gpKTtcbiAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTRVJJQUxfTlVNQkVSJDEsIENlcnRJRC5kZWZhdWx0VmFsdWVzKFNFUklBTF9OVU1CRVIkMSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSEFTSF9BTEdPUklUSE0kMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSX05BTUVfSEFTSDpcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSX0tFWV9IQVNIOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBjYXNlIFNFUklBTF9OVU1CRVIkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIEhBU0hfQUxHT1JJVEhNJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUuYWxnb3JpdGhtSWQgPT09IEVNUFRZX1NUUklORykgJiYgKChcImFsZ29yaXRobVBhcmFtc1wiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpKTtcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSX05BTUVfSEFTSDpcbiAgICAgICAgICAgIGNhc2UgSVNTVUVSX0tFWV9IQVNIOlxuICAgICAgICAgICAgY2FzZSBTRVJJQUxfTlVNQkVSJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKENlcnRJRC5kZWZhdWx0VmFsdWVzKFNFUklBTF9OVU1CRVIkMSkpKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuaGFzaEFsZ29yaXRobU9iamVjdCB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IChuYW1lcy5oYXNoQWxnb3JpdGhtIHx8IEVNUFRZX1NUUklORylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyBuYW1lOiAobmFtZXMuaXNzdWVyTmFtZUhhc2ggfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgbmFtZTogKG5hbWVzLmlzc3VlcktleUhhc2ggfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuc2VyaWFsTnVtYmVyIHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRqKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBDZXJ0SUQuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgaGFzaEFsZ29yaXRobTogSEFTSF9BTEdPUklUSE0kMSxcbiAgICAgICAgICAgICAgICBpc3N1ZXJOYW1lSGFzaDogSVNTVUVSX05BTUVfSEFTSCxcbiAgICAgICAgICAgICAgICBpc3N1ZXJLZXlIYXNoOiBJU1NVRVJfS0VZX0hBU0gsXG4gICAgICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiBTRVJJQUxfTlVNQkVSJDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmhhc2hBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHQuaGFzaEFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5pc3N1ZXJOYW1lSGFzaCA9IGFzbjEucmVzdWx0Lmlzc3Vlck5hbWVIYXNoO1xuICAgICAgICB0aGlzLmlzc3VlcktleUhhc2ggPSBhc24xLnJlc3VsdC5pc3N1ZXJLZXlIYXNoO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IGFzbjEucmVzdWx0LnNlcmlhbE51bWJlcjtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobS50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuaXNzdWVyTmFtZUhhc2gsXG4gICAgICAgICAgICAgICAgdGhpcy5pc3N1ZXJLZXlIYXNoLFxuICAgICAgICAgICAgICAgIHRoaXMuc2VyaWFsTnVtYmVyXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaGFzaEFsZ29yaXRobTogdGhpcy5oYXNoQWxnb3JpdGhtLnRvSlNPTigpLFxuICAgICAgICAgICAgaXNzdWVyTmFtZUhhc2g6IHRoaXMuaXNzdWVyTmFtZUhhc2gudG9KU09OKCksXG4gICAgICAgICAgICBpc3N1ZXJLZXlIYXNoOiB0aGlzLmlzc3VlcktleUhhc2gudG9KU09OKCksXG4gICAgICAgICAgICBzZXJpYWxOdW1iZXI6IHRoaXMuc2VyaWFsTnVtYmVyLnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBpc0VxdWFsKGNlcnRpZmljYXRlSUQpIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzaEFsZ29yaXRobS5hbGdvcml0aG1JZCAhPT0gY2VydGlmaWNhdGVJRC5oYXNoQWxnb3JpdGhtLmFsZ29yaXRobUlkKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLmlzRXF1YWwodGhpcy5pc3N1ZXJOYW1lSGFzaC52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldywgY2VydGlmaWNhdGVJRC5pc3N1ZXJOYW1lSGFzaC52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXB2dHN1dGlscy5CdWZmZXJTb3VyY2VDb252ZXJ0ZXIuaXNFcXVhbCh0aGlzLmlzc3VlcktleUhhc2gudmFsdWVCbG9jay52YWx1ZUhleFZpZXcsIGNlcnRpZmljYXRlSUQuaXNzdWVyS2V5SGFzaC52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuc2VyaWFsTnVtYmVyLmlzRXF1YWwoY2VydGlmaWNhdGVJRC5zZXJpYWxOdW1iZXIpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGFzeW5jIGNyZWF0ZUZvckNlcnRpZmljYXRlKGNlcnRpZmljYXRlLCBwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0KHBhcmFtZXRlcnMsIEhBU0hfQUxHT1JJVEhNJDEsIFwiaXNzdWVyQ2VydGlmaWNhdGVcIik7XG4gICAgICAgIGNvbnN0IGhhc2hPSUQgPSBjcnlwdG8uZ2V0T0lEQnlBbGdvcml0aG0oeyBuYW1lOiBwYXJhbWV0ZXJzLmhhc2hBbGdvcml0aG0gfSwgdHJ1ZSwgXCJoYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICB0aGlzLmhhc2hBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7XG4gICAgICAgICAgICBhbGdvcml0aG1JZDogaGFzaE9JRCxcbiAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGlzc3VlckNlcnRpZmljYXRlID0gcGFyYW1ldGVycy5pc3N1ZXJDZXJ0aWZpY2F0ZTtcbiAgICAgICAgdGhpcy5zZXJpYWxOdW1iZXIgPSBjZXJ0aWZpY2F0ZS5zZXJpYWxOdW1iZXI7XG4gICAgICAgIGNvbnN0IGhhc2hJc3N1ZXJOYW1lID0gYXdhaXQgY3J5cHRvLmRpZ2VzdCh7IG5hbWU6IHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobSB9LCBpc3N1ZXJDZXJ0aWZpY2F0ZS5zdWJqZWN0LnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpKTtcbiAgICAgICAgdGhpcy5pc3N1ZXJOYW1lSGFzaCA9IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogaGFzaElzc3Vlck5hbWUgfSk7XG4gICAgICAgIGNvbnN0IGlzc3VlcktleUJ1ZmZlciA9IGlzc3VlckNlcnRpZmljYXRlLnN1YmplY3RQdWJsaWNLZXlJbmZvLnN1YmplY3RQdWJsaWNLZXkudmFsdWVCbG9jay52YWx1ZUhleFZpZXc7XG4gICAgICAgIGNvbnN0IGhhc2hJc3N1ZXJLZXkgPSBhd2FpdCBjcnlwdG8uZGlnZXN0KHsgbmFtZTogcGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtIH0sIGlzc3VlcktleUJ1ZmZlcik7XG4gICAgICAgIHRoaXMuaXNzdWVyS2V5SGFzaCA9IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogaGFzaElzc3VlcktleSB9KTtcbiAgICB9XG59XG5DZXJ0SUQuQ0xBU1NfTkFNRSA9IFwiQ2VydElEXCI7XG5cbmNvbnN0IENFUlRfSUQgPSBcImNlcnRJRFwiO1xuY29uc3QgQ0VSVF9TVEFUVVMgPSBcImNlcnRTdGF0dXNcIjtcbmNvbnN0IFRISVNfVVBEQVRFID0gXCJ0aGlzVXBkYXRlXCI7XG5jb25zdCBORVhUX1VQREFURSA9IFwibmV4dFVwZGF0ZVwiO1xuY29uc3QgU0lOR0xFX0VYVEVOU0lPTlMgPSBcInNpbmdsZUV4dGVuc2lvbnNcIjtcbmNvbnN0IENMRUFSX1BST1BTJGkgPSBbXG4gICAgQ0VSVF9JRCxcbiAgICBDRVJUX1NUQVRVUyxcbiAgICBUSElTX1VQREFURSxcbiAgICBORVhUX1VQREFURSxcbiAgICBTSU5HTEVfRVhURU5TSU9OUyxcbl07XG5jbGFzcyBTaW5nbGVSZXNwb25zZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuY2VydElEID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ0VSVF9JRCwgU2luZ2xlUmVzcG9uc2UuZGVmYXVsdFZhbHVlcyhDRVJUX0lEKSk7XG4gICAgICAgIHRoaXMuY2VydFN0YXR1cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENFUlRfU1RBVFVTLCBTaW5nbGVSZXNwb25zZS5kZWZhdWx0VmFsdWVzKENFUlRfU1RBVFVTKSk7XG4gICAgICAgIHRoaXMudGhpc1VwZGF0ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRISVNfVVBEQVRFLCBTaW5nbGVSZXNwb25zZS5kZWZhdWx0VmFsdWVzKFRISVNfVVBEQVRFKSk7XG4gICAgICAgIGlmIChORVhUX1VQREFURSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm5leHRVcGRhdGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBORVhUX1VQREFURSwgU2luZ2xlUmVzcG9uc2UuZGVmYXVsdFZhbHVlcyhORVhUX1VQREFURSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChTSU5HTEVfRVhURU5TSU9OUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnNpbmdsZUV4dGVuc2lvbnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSU5HTEVfRVhURU5TSU9OUywgU2luZ2xlUmVzcG9uc2UuZGVmYXVsdFZhbHVlcyhTSU5HTEVfRVhURU5TSU9OUykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDRVJUX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2VydElEKCk7XG4gICAgICAgICAgICBjYXNlIENFUlRfU1RBVFVTOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGNhc2UgVEhJU19VUERBVEU6XG4gICAgICAgICAgICBjYXNlIE5FWFRfVVBEQVRFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSgwLCAwLCAwKTtcbiAgICAgICAgICAgIGNhc2UgU0lOR0xFX0VYVEVOU0lPTlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBDRVJUX0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKENlcnRJRC5jb21wYXJlV2l0aERlZmF1bHQoXCJoYXNoQWxnb3JpdGhtXCIsIG1lbWJlclZhbHVlLmhhc2hBbGdvcml0aG0pKSAmJlxuICAgICAgICAgICAgICAgICAgICAoQ2VydElELmNvbXBhcmVXaXRoRGVmYXVsdChcImlzc3Vlck5hbWVIYXNoXCIsIG1lbWJlclZhbHVlLmlzc3Vlck5hbWVIYXNoKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKENlcnRJRC5jb21wYXJlV2l0aERlZmF1bHQoXCJpc3N1ZXJLZXlIYXNoXCIsIG1lbWJlclZhbHVlLmlzc3VlcktleUhhc2gpKSAmJlxuICAgICAgICAgICAgICAgICAgICAoQ2VydElELmNvbXBhcmVXaXRoRGVmYXVsdChcInNlcmlhbE51bWJlclwiLCBtZW1iZXJWYWx1ZS5zZXJpYWxOdW1iZXIpKSk7XG4gICAgICAgICAgICBjYXNlIENFUlRfU1RBVFVTOlxuICAgICAgICAgICAgICAgIHJldHVybiAoT2JqZWN0LmtleXMobWVtYmVyVmFsdWUpLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBjYXNlIFRISVNfVVBEQVRFOlxuICAgICAgICAgICAgY2FzZSBORVhUX1VQREFURTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBTaW5nbGVSZXNwb25zZS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQ2VydElELnNjaGVtYShuYW1lcy5jZXJ0SUQgfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUHJpbWl0aXZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuY2VydFN0YXR1cyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5jZXJ0U3RhdHVzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5FbnVtZXJhdGVkKCldXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlByaW1pdGl2ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNlcnRTdGF0dXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbkJsb2NrOiB7IGxlbmd0aDogMSB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoeyBuYW1lOiAobmFtZXMudGhpc1VwZGF0ZSB8fCBFTVBUWV9TVFJJTkcpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IG5hbWU6IChuYW1lcy5uZXh0VXBkYXRlIHx8IEVNUFRZX1NUUklORykgfSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW0V4dGVuc2lvbnMuc2NoZW1hKG5hbWVzLnNpbmdsZUV4dGVuc2lvbnMgfHwge30pXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkaSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgU2luZ2xlUmVzcG9uc2Uuc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgY2VydElEOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IENFUlRfSURcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY2VydFN0YXR1czogQ0VSVF9TVEFUVVMsXG4gICAgICAgICAgICAgICAgdGhpc1VwZGF0ZTogVEhJU19VUERBVEUsXG4gICAgICAgICAgICAgICAgbmV4dFVwZGF0ZTogTkVYVF9VUERBVEUsXG4gICAgICAgICAgICAgICAgc2luZ2xlRXh0ZW5zaW9uczoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBTSU5HTEVfRVhURU5TSU9OU1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuY2VydElEID0gbmV3IENlcnRJRCh7IHNjaGVtYTogYXNuMS5yZXN1bHQuY2VydElEIH0pO1xuICAgICAgICB0aGlzLmNlcnRTdGF0dXMgPSBhc24xLnJlc3VsdC5jZXJ0U3RhdHVzO1xuICAgICAgICB0aGlzLnRoaXNVcGRhdGUgPSBhc24xLnJlc3VsdC50aGlzVXBkYXRlLnRvRGF0ZSgpO1xuICAgICAgICBpZiAoTkVYVF9VUERBVEUgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLm5leHRVcGRhdGUgPSBhc24xLnJlc3VsdC5uZXh0VXBkYXRlLnRvRGF0ZSgpO1xuICAgICAgICBpZiAoU0lOR0xFX0VYVEVOU0lPTlMgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnNpbmdsZUV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0LnNpbmdsZUV4dGVuc2lvbnMudmFsdWVCbG9jay52YWx1ZSwgZWxlbWVudCA9PiBuZXcgRXh0ZW5zaW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5jZXJ0SUQudG9TY2hlbWEoKSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5jZXJ0U3RhdHVzKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IHZhbHVlRGF0ZTogdGhpcy50aGlzVXBkYXRlIH0pKTtcbiAgICAgICAgaWYgKHRoaXMubmV4dFVwZGF0ZSkge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5HZW5lcmFsaXplZFRpbWUoeyB2YWx1ZURhdGU6IHRoaXMubmV4dFVwZGF0ZSB9KV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zaW5nbGVFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuc2luZ2xlRXh0ZW5zaW9ucywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgY2VydElEOiB0aGlzLmNlcnRJRC50b0pTT04oKSxcbiAgICAgICAgICAgIGNlcnRTdGF0dXM6IHRoaXMuY2VydFN0YXR1cy50b0pTT04oKSxcbiAgICAgICAgICAgIHRoaXNVcGRhdGU6IHRoaXMudGhpc1VwZGF0ZVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5uZXh0VXBkYXRlKSB7XG4gICAgICAgICAgICByZXMubmV4dFVwZGF0ZSA9IHRoaXMubmV4dFVwZGF0ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zaW5nbGVFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICByZXMuc2luZ2xlRXh0ZW5zaW9ucyA9IEFycmF5LmZyb20odGhpcy5zaW5nbGVFeHRlbnNpb25zLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuU2luZ2xlUmVzcG9uc2UuQ0xBU1NfTkFNRSA9IFwiU2luZ2xlUmVzcG9uc2VcIjtcblxuY29uc3QgVEJTJDIgPSBcInRic1wiO1xuY29uc3QgVkVSU0lPTiQ3ID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBSRVNQT05ERVJfSUQgPSBcInJlc3BvbmRlcklEXCI7XG5jb25zdCBQUk9EVUNFRF9BVCA9IFwicHJvZHVjZWRBdFwiO1xuY29uc3QgUkVTUE9OU0VTID0gXCJyZXNwb25zZXNcIjtcbmNvbnN0IFJFU1BPTlNFX0VYVEVOU0lPTlMgPSBcInJlc3BvbnNlRXh0ZW5zaW9uc1wiO1xuY29uc3QgUkVTUE9OU0VfREFUQSA9IFwiUmVzcG9uc2VEYXRhXCI7XG5jb25zdCBSRVNQT05TRV9EQVRBX1ZFUlNJT04gPSBgJHtSRVNQT05TRV9EQVRBfS4ke1ZFUlNJT04kN31gO1xuY29uc3QgUkVTUE9OU0VfREFUQV9SRVNQT05ERVJfSUQgPSBgJHtSRVNQT05TRV9EQVRBfS4ke1JFU1BPTkRFUl9JRH1gO1xuY29uc3QgUkVTUE9OU0VfREFUQV9QUk9EVUNFRF9BVCA9IGAke1JFU1BPTlNFX0RBVEF9LiR7UFJPRFVDRURfQVR9YDtcbmNvbnN0IFJFU1BPTlNFX0RBVEFfUkVTUE9OU0VTID0gYCR7UkVTUE9OU0VfREFUQX0uJHtSRVNQT05TRVN9YDtcbmNvbnN0IFJFU1BPTlNFX0RBVEFfUkVTUE9OU0VfRVhURU5TSU9OUyA9IGAke1JFU1BPTlNFX0RBVEF9LiR7UkVTUE9OU0VfRVhURU5TSU9OU31gO1xuY29uc3QgQ0xFQVJfUFJPUFMkaCA9IFtcbiAgICBSRVNQT05TRV9EQVRBLFxuICAgIFJFU1BPTlNFX0RBVEFfVkVSU0lPTixcbiAgICBSRVNQT05TRV9EQVRBX1JFU1BPTkRFUl9JRCxcbiAgICBSRVNQT05TRV9EQVRBX1BST0RVQ0VEX0FULFxuICAgIFJFU1BPTlNFX0RBVEFfUkVTUE9OU0VTLFxuICAgIFJFU1BPTlNFX0RBVEFfUkVTUE9OU0VfRVhURU5TSU9OU1xuXTtcbmNsYXNzIFJlc3BvbnNlRGF0YSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgZ2V0IHRicygpIHtcbiAgICAgICAgcmV0dXJuIHB2dHN1dGlscy5CdWZmZXJTb3VyY2VDb252ZXJ0ZXIudG9BcnJheUJ1ZmZlcih0aGlzLnRic1ZpZXcpO1xuICAgIH1cbiAgICBzZXQgdGJzKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudGJzVmlldyA9IG5ldyBVaW50OEFycmF5KHZhbHVlKTtcbiAgICB9XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudGJzVmlldyA9IG5ldyBVaW50OEFycmF5KHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRCUyQyLCBSZXNwb25zZURhdGEuZGVmYXVsdFZhbHVlcyhUQlMkMikpKTtcbiAgICAgICAgaWYgKFZFUlNJT04kNyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWRVJTSU9OJDcsIFJlc3BvbnNlRGF0YS5kZWZhdWx0VmFsdWVzKFZFUlNJT04kNykpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVzcG9uZGVySUQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVNQT05ERVJfSUQsIFJlc3BvbnNlRGF0YS5kZWZhdWx0VmFsdWVzKFJFU1BPTkRFUl9JRCkpO1xuICAgICAgICB0aGlzLnByb2R1Y2VkQXQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQUk9EVUNFRF9BVCwgUmVzcG9uc2VEYXRhLmRlZmF1bHRWYWx1ZXMoUFJPRFVDRURfQVQpKTtcbiAgICAgICAgdGhpcy5yZXNwb25zZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVNQT05TRVMsIFJlc3BvbnNlRGF0YS5kZWZhdWx0VmFsdWVzKFJFU1BPTlNFUykpO1xuICAgICAgICBpZiAoUkVTUE9OU0VfRVhURU5TSU9OUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3BvbnNlRXh0ZW5zaW9ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFU1BPTlNFX0VYVEVOU0lPTlMsIFJlc3BvbnNlRGF0YS5kZWZhdWx0VmFsdWVzKFJFU1BPTlNFX0VYVEVOU0lPTlMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiQ3OlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSBUQlMkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfQlVGRkVSO1xuICAgICAgICAgICAgY2FzZSBSRVNQT05ERVJfSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgY2FzZSBQUk9EVUNFRF9BVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoMCwgMCwgMCk7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFUzpcbiAgICAgICAgICAgIGNhc2UgUkVTUE9OU0VfRVhURU5TSU9OUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRCUyQyOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuYnl0ZUxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTkRFUl9JRDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKE9iamVjdC5rZXlzKG1lbWJlclZhbHVlKS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBQUk9EVUNFRF9BVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBSZXNwb25zZURhdGEuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSk7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFUzpcbiAgICAgICAgICAgIGNhc2UgUkVTUE9OU0VfRVhURU5TSU9OUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IFJFU1BPTlNFX0RBVEEpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnZlcnNpb24gfHwgUkVTUE9OU0VfREFUQV9WRVJTSU9OKSB9KV1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMucmVzcG9uZGVySUQgfHwgUkVTUE9OU0VfREFUQV9SRVNQT05ERVJfSUQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcy5zY2hlbWEobmFtZXMuUmVzcG9uc2VEYXRhQnlOYW1lIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBcIlJlc3BvbnNlRGF0YS5ieU5hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnJlc3BvbmRlcklEIHx8IFJFU1BPTlNFX0RBVEFfUkVTUE9OREVSX0lEKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5SZXNwb25zZURhdGFCeUtleSB8fCBcIlJlc3BvbnNlRGF0YS5ieUtleVwiKSB9KV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IG5hbWU6IChuYW1lcy5wcm9kdWNlZEF0IHx8IFJFU1BPTlNFX0RBVEFfUFJPRFVDRURfQVQpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogUkVTUE9OU0VfREFUQV9SRVNQT05TRVMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFNpbmdsZVJlc3BvbnNlLnNjaGVtYShuYW1lcy5yZXNwb25zZSB8fCB7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbRXh0ZW5zaW9ucy5zY2hlbWEobmFtZXMuZXh0ZW5zaW9ucyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBSRVNQT05TRV9EQVRBX1JFU1BPTlNFX0VYVEVOU0lPTlNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJGgpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJlc3BvbnNlRGF0YS5zY2hlbWEoKSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudGJzVmlldyA9IGFzbjEucmVzdWx0LlJlc3BvbnNlRGF0YS52YWx1ZUJlZm9yZURlY29kZVZpZXc7XG4gICAgICAgIGlmIChSRVNQT05TRV9EQVRBX1ZFUlNJT04gaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdFtSRVNQT05TRV9EQVRBX1ZFUlNJT05dLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIGlmIChhc24xLnJlc3VsdFtSRVNQT05TRV9EQVRBX1JFU1BPTkRFUl9JRF0uaWRCbG9jay50YWdOdW1iZXIgPT09IDEpXG4gICAgICAgICAgICB0aGlzLnJlc3BvbmRlcklEID0gbmV3IFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzKHsgc2NoZW1hOiBhc24xLnJlc3VsdFtSRVNQT05TRV9EQVRBX1JFU1BPTkRFUl9JRF0udmFsdWVCbG9jay52YWx1ZVswXSB9KTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdGhpcy5yZXNwb25kZXJJRCA9IGFzbjEucmVzdWx0W1JFU1BPTlNFX0RBVEFfUkVTUE9OREVSX0lEXS52YWx1ZUJsb2NrLnZhbHVlWzBdO1xuICAgICAgICB0aGlzLnByb2R1Y2VkQXQgPSBhc24xLnJlc3VsdFtSRVNQT05TRV9EQVRBX1BST0RVQ0VEX0FUXS50b0RhdGUoKTtcbiAgICAgICAgdGhpcy5yZXNwb25zZXMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0W1JFU1BPTlNFX0RBVEFfUkVTUE9OU0VTXSwgZWxlbWVudCA9PiBuZXcgU2luZ2xlUmVzcG9uc2UoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICBpZiAoUkVTUE9OU0VfREFUQV9SRVNQT05TRV9FWFRFTlNJT05TIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5yZXNwb25zZUV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0W1JFU1BPTlNFX0RBVEFfUkVTUE9OU0VfRVhURU5TSU9OU10udmFsdWVCbG9jay52YWx1ZSwgZWxlbWVudCA9PiBuZXcgRXh0ZW5zaW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoZW5jb2RlRmxhZyA9IGZhbHNlKSB7XG4gICAgICAgIGxldCB0YnNTY2hlbWE7XG4gICAgICAgIGlmIChlbmNvZGVGbGFnID09PSBmYWxzZSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnRic1ZpZXcuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBSZXNwb25zZURhdGEuc2NoZW1hKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmZyb21CRVIodGhpcy50YnNWaWV3KTtcbiAgICAgICAgICAgIEFzbkVycm9yLmFzc2VydChhc24xLCBcIlRCUyBSZXNwb25zZSBEYXRhXCIpO1xuICAgICAgICAgICAgdGJzU2NoZW1hID0gYXNuMS5yZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICAgICAgaWYgKFZFUlNJT04kNyBpbiB0aGlzKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pXVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnJlc3BvbmRlcklEIGluc3RhbmNlb2YgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMucmVzcG9uZGVySUQudG9TY2hlbWEoKV1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMucmVzcG9uZGVySURdXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IHZhbHVlRGF0ZTogdGhpcy5wcm9kdWNlZEF0IH0pKTtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5yZXNwb25zZXMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgaWYgKHRoaXMucmVzcG9uc2VFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLnJlc3BvbnNlRXh0ZW5zaW9ucywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YnNTY2hlbWEgPSBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YnNTY2hlbWE7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge307XG4gICAgICAgIGlmIChWRVJTSU9OJDcgaW4gdGhpcykge1xuICAgICAgICAgICAgcmVzLnZlcnNpb24gPSB0aGlzLnZlcnNpb247XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVzcG9uZGVySUQpIHtcbiAgICAgICAgICAgIHJlcy5yZXNwb25kZXJJRCA9IHRoaXMucmVzcG9uZGVySUQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJvZHVjZWRBdCkge1xuICAgICAgICAgICAgcmVzLnByb2R1Y2VkQXQgPSB0aGlzLnByb2R1Y2VkQXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVzcG9uc2VzKSB7XG4gICAgICAgICAgICByZXMucmVzcG9uc2VzID0gQXJyYXkuZnJvbSh0aGlzLnJlc3BvbnNlcywgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZXNwb25zZUV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIHJlcy5yZXNwb25zZUV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKHRoaXMucmVzcG9uc2VFeHRlbnNpb25zLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuUmVzcG9uc2VEYXRhLkNMQVNTX05BTUUgPSBcIlJlc3BvbnNlRGF0YVwiO1xuXG5jb25zdCBUUlVTVEVEX0NFUlRTID0gXCJ0cnVzdGVkQ2VydHNcIjtcbmNvbnN0IENFUlRTJDIgPSBcImNlcnRzXCI7XG5jb25zdCBDUkxTJDEgPSBcImNybHNcIjtcbmNvbnN0IE9DU1BTJDEgPSBcIm9jc3BzXCI7XG5jb25zdCBDSEVDS19EQVRFID0gXCJjaGVja0RhdGVcIjtcbmNvbnN0IEZJTkRfT1JJR0lOID0gXCJmaW5kT3JpZ2luXCI7XG5jb25zdCBGSU5EX0lTU1VFUiA9IFwiZmluZElzc3VlclwiO1xudmFyIENoYWluVmFsaWRhdGlvbkNvZGU7XG4oZnVuY3Rpb24gKENoYWluVmFsaWRhdGlvbkNvZGUpIHtcbiAgICBDaGFpblZhbGlkYXRpb25Db2RlW0NoYWluVmFsaWRhdGlvbkNvZGVbXCJ1bmtub3duXCJdID0gLTFdID0gXCJ1bmtub3duXCI7XG4gICAgQ2hhaW5WYWxpZGF0aW9uQ29kZVtDaGFpblZhbGlkYXRpb25Db2RlW1wic3VjY2Vzc1wiXSA9IDBdID0gXCJzdWNjZXNzXCI7XG4gICAgQ2hhaW5WYWxpZGF0aW9uQ29kZVtDaGFpblZhbGlkYXRpb25Db2RlW1wibm9SZXZvY2F0aW9uXCJdID0gMTFdID0gXCJub1Jldm9jYXRpb25cIjtcbiAgICBDaGFpblZhbGlkYXRpb25Db2RlW0NoYWluVmFsaWRhdGlvbkNvZGVbXCJub1BhdGhcIl0gPSA2MF0gPSBcIm5vUGF0aFwiO1xuICAgIENoYWluVmFsaWRhdGlvbkNvZGVbQ2hhaW5WYWxpZGF0aW9uQ29kZVtcIm5vVmFsaWRQYXRoXCJdID0gOTddID0gXCJub1ZhbGlkUGF0aFwiO1xufSkoQ2hhaW5WYWxpZGF0aW9uQ29kZSB8fCAoQ2hhaW5WYWxpZGF0aW9uQ29kZSA9IHt9KSk7XG5jbGFzcyBDaGFpblZhbGlkYXRpb25FcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3Rvcihjb2RlLCBtZXNzYWdlKSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgICAgICB0aGlzLm5hbWUgPSBDaGFpblZhbGlkYXRpb25FcnJvci5OQU1FO1xuICAgICAgICB0aGlzLmNvZGUgPSBjb2RlO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIH1cbn1cbkNoYWluVmFsaWRhdGlvbkVycm9yLk5BTUUgPSBcIkNoYWluVmFsaWRhdGlvbkVycm9yXCI7XG5mdW5jdGlvbiBpc1RydXN0ZWQoY2VydCwgdHJ1c3RlZExpc3QpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRydXN0ZWRMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLmlzRXF1YWwoY2VydC50YnNWaWV3LCB0cnVzdGVkTGlzdFtpXS50YnNWaWV3KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuY2xhc3MgQ2VydGlmaWNhdGVDaGFpblZhbGlkYXRpb25FbmdpbmUge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICB0aGlzLnRydXN0ZWRDZXJ0cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRSVVNURURfQ0VSVFMsIHRoaXMuZGVmYXVsdFZhbHVlcyhUUlVTVEVEX0NFUlRTKSk7XG4gICAgICAgIHRoaXMuY2VydHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDRVJUUyQyLCB0aGlzLmRlZmF1bHRWYWx1ZXMoQ0VSVFMkMikpO1xuICAgICAgICB0aGlzLmNybHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDUkxTJDEsIHRoaXMuZGVmYXVsdFZhbHVlcyhDUkxTJDEpKTtcbiAgICAgICAgdGhpcy5vY3NwcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9DU1BTJDEsIHRoaXMuZGVmYXVsdFZhbHVlcyhPQ1NQUyQxKSk7XG4gICAgICAgIHRoaXMuY2hlY2tEYXRlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgQ0hFQ0tfREFURSwgdGhpcy5kZWZhdWx0VmFsdWVzKENIRUNLX0RBVEUpKTtcbiAgICAgICAgdGhpcy5maW5kT3JpZ2luID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRklORF9PUklHSU4sIHRoaXMuZGVmYXVsdFZhbHVlcyhGSU5EX09SSUdJTikpO1xuICAgICAgICB0aGlzLmZpbmRJc3N1ZXIgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBGSU5EX0lTU1VFUiwgdGhpcy5kZWZhdWx0VmFsdWVzKEZJTkRfSVNTVUVSKSk7XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0RmluZE9yaWdpbihjZXJ0aWZpY2F0ZSwgdmFsaWRhdGlvbkVuZ2luZSkge1xuICAgICAgICBpZiAoY2VydGlmaWNhdGUudGJzVmlldy5ieXRlTGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjZXJ0aWZpY2F0ZS50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoY2VydGlmaWNhdGUuZW5jb2RlVEJTKCkudG9CRVIoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBsb2NhbENlcnQgb2YgdmFsaWRhdGlvbkVuZ2luZS5jZXJ0cykge1xuICAgICAgICAgICAgaWYgKGxvY2FsQ2VydC50YnNWaWV3LmJ5dGVMZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBsb2NhbENlcnQudGJzVmlldyA9IG5ldyBVaW50OEFycmF5KGxvY2FsQ2VydC5lbmNvZGVUQlMoKS50b0JFUigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLmlzRXF1YWwoY2VydGlmaWNhdGUudGJzVmlldywgbG9jYWxDZXJ0LnRic1ZpZXcpKVxuICAgICAgICAgICAgICAgIHJldHVybiBcIkludGVybWVkaWF0ZSBDZXJ0aWZpY2F0ZXNcIjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHRydXN0ZWRDZXJ0IG9mIHZhbGlkYXRpb25FbmdpbmUudHJ1c3RlZENlcnRzKSB7XG4gICAgICAgICAgICBpZiAodHJ1c3RlZENlcnQudGJzVmlldy5ieXRlTGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgICAgIHRydXN0ZWRDZXJ0LnRic1ZpZXcgPSBuZXcgVWludDhBcnJheSh0cnVzdGVkQ2VydC5lbmNvZGVUQlMoKS50b0JFUigpKTtcbiAgICAgICAgICAgIGlmIChwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLmlzRXF1YWwoY2VydGlmaWNhdGUudGJzVmlldywgdHJ1c3RlZENlcnQudGJzVmlldykpXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiVHJ1c3RlZCBDZXJ0aWZpY2F0ZXNcIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJVbmtub3duXCI7XG4gICAgfVxuICAgIGFzeW5jIGRlZmF1bHRGaW5kSXNzdWVyKGNlcnRpZmljYXRlLCB2YWxpZGF0aW9uRW5naW5lLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgICAgIGxldCBrZXlJZGVudGlmaWVyID0gbnVsbDtcbiAgICAgICAgbGV0IGF1dGhvcml0eUNlcnRJc3N1ZXIgPSBudWxsO1xuICAgICAgICBsZXQgYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlciA9IG51bGw7XG4gICAgICAgIGlmIChjZXJ0aWZpY2F0ZS5zdWJqZWN0LmlzRXF1YWwoY2VydGlmaWNhdGUuaXNzdWVyKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCB2ZXJpZmljYXRpb25SZXN1bHQgPSBhd2FpdCBjZXJ0aWZpY2F0ZS52ZXJpZnkodW5kZWZpbmVkLCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgIGlmICh2ZXJpZmljYXRpb25SZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtjZXJ0aWZpY2F0ZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNlcnRpZmljYXRlLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZXh0ZW5zaW9uIG9mIGNlcnRpZmljYXRlLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmV4dG5JRCA9PT0gaWRfQXV0aG9yaXR5S2V5SWRlbnRpZmllciAmJiBleHRlbnNpb24ucGFyc2VkVmFsdWUgaW5zdGFuY2VvZiBBdXRob3JpdHlLZXlJZGVudGlmaWVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb24ucGFyc2VkVmFsdWUua2V5SWRlbnRpZmllcikge1xuICAgICAgICAgICAgICAgICAgICAgICAga2V5SWRlbnRpZmllciA9IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5rZXlJZGVudGlmaWVyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5hdXRob3JpdHlDZXJ0SXNzdWVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXR5Q2VydElzc3VlciA9IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5hdXRob3JpdHlDZXJ0SXNzdWVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5hdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlciA9IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5hdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjaGVja0NlcnRpZmljYXRlKHBvc3NpYmxlSXNzdWVyKSB7XG4gICAgICAgICAgICBpZiAoa2V5SWRlbnRpZmllciAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmIChwb3NzaWJsZUlzc3Vlci5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBleHRlbnNpb25Gb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGV4dGVuc2lvbiBvZiBwb3NzaWJsZUlzc3Vlci5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmV4dG5JRCA9PT0gaWRfU3ViamVjdEtleUlkZW50aWZpZXIgJiYgZXh0ZW5zaW9uLnBhcnNlZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uRm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLmlzRXF1YWwoZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLnZhbHVlQmxvY2sudmFsdWVIZXgsIGtleUlkZW50aWZpZXIudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHBvc3NpYmxlSXNzdWVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbkZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlckVxdWFsID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlciAhPT0gbnVsbClcbiAgICAgICAgICAgICAgICBhdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyRXF1YWwgPSBwb3NzaWJsZUlzc3Vlci5zZXJpYWxOdW1iZXIuaXNFcXVhbChhdXRob3JpdHlDZXJ0U2VyaWFsTnVtYmVyKTtcbiAgICAgICAgICAgIGlmIChhdXRob3JpdHlDZXJ0SXNzdWVyICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBvc3NpYmxlSXNzdWVyLnN1YmplY3QuaXNFcXVhbChhdXRob3JpdHlDZXJ0SXNzdWVyKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXV0aG9yaXR5Q2VydFNlcmlhbE51bWJlckVxdWFsKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocG9zc2libGVJc3N1ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjZXJ0aWZpY2F0ZS5pc3N1ZXIuaXNFcXVhbChwb3NzaWJsZUlzc3Vlci5zdWJqZWN0KSlcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocG9zc2libGVJc3N1ZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgdHJ1c3RlZENlcnQgb2YgdmFsaWRhdGlvbkVuZ2luZS50cnVzdGVkQ2VydHMpIHtcbiAgICAgICAgICAgIGNoZWNrQ2VydGlmaWNhdGUodHJ1c3RlZENlcnQpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgaW50ZXJtZWRpYXRlQ2VydCBvZiB2YWxpZGF0aW9uRW5naW5lLmNlcnRzKSB7XG4gICAgICAgICAgICBjaGVja0NlcnRpZmljYXRlKGludGVybWVkaWF0ZUNlcnQpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSByZXN1bHQubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmVyaWZpY2F0aW9uUmVzdWx0ID0gYXdhaXQgY2VydGlmaWNhdGUudmVyaWZ5KHJlc3VsdFtpXSwgY3J5cHRvKTtcbiAgICAgICAgICAgICAgICBpZiAodmVyaWZpY2F0aW9uUmVzdWx0ID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUUlVTVEVEX0NFUlRTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgQ0VSVFMkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIENSTFMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIE9DU1BTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBDSEVDS19EQVRFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgY2FzZSBGSU5EX09SSUdJTjpcbiAgICAgICAgICAgICAgICByZXR1cm4gQ2VydGlmaWNhdGVDaGFpblZhbGlkYXRpb25FbmdpbmUuZGVmYXVsdEZpbmRPcmlnaW47XG4gICAgICAgICAgICBjYXNlIEZJTkRfSVNTVUVSOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRGaW5kSXNzdWVyO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgbWVtYmVyIG5hbWUgZm9yIENlcnRpZmljYXRlQ2hhaW5WYWxpZGF0aW9uRW5naW5lIGNsYXNzOiAke21lbWJlck5hbWV9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgc29ydChwYXNzZWRXaGVuTm90UmV2VmFsdWVzID0gZmFsc2UsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCBsb2NhbENlcnRzID0gW107XG4gICAgICAgIGNvbnN0IGJ1aWxkUGF0aCA9IGFzeW5jIChjZXJ0aWZpY2F0ZSwgY3J5cHRvKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrVW5pcXVlKGFycmF5KSB7XG4gICAgICAgICAgICAgICAgbGV0IHVuaXF1ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGFycmF5Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaiA9PT0gaSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcnJheVtpXSA9PT0gYXJyYXlbal0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmlxdWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXVuaXF1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdW5pcXVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzVHJ1c3RlZChjZXJ0aWZpY2F0ZSwgdGhpcy50cnVzdGVkQ2VydHMpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtbY2VydGlmaWNhdGVdXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGZpbmRJc3N1ZXJSZXN1bHQgPSBhd2FpdCB0aGlzLmZpbmRJc3N1ZXIoY2VydGlmaWNhdGUsIHRoaXMsIGNyeXB0byk7XG4gICAgICAgICAgICBpZiAoZmluZElzc3VlclJlc3VsdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyB2YWxpZCBjZXJ0aWZpY2F0ZSBwYXRocyBmb3VuZFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmluZElzc3VlclJlc3VsdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLmlzRXF1YWwoZmluZElzc3VlclJlc3VsdFtpXS50YnNWaWV3LCBjZXJ0aWZpY2F0ZS50YnNWaWV3KSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChbZmluZElzc3VlclJlc3VsdFtpXV0pO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgYnVpbGRQYXRoUmVzdWx0ID0gYXdhaXQgYnVpbGRQYXRoKGZpbmRJc3N1ZXJSZXN1bHRbaV0sIGNyeXB0byk7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBidWlsZFBhdGhSZXN1bHQubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29weSA9IGJ1aWxkUGF0aFJlc3VsdFtqXS5zbGljZSgpO1xuICAgICAgICAgICAgICAgICAgICBjb3B5LnNwbGljZSgwLCAwLCBmaW5kSXNzdWVyUmVzdWx0W2ldKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrVW5pcXVlKGNvcHkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goY29weSk7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGJ1aWxkUGF0aFJlc3VsdFtqXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZmluZENSTCA9IGFzeW5jIChjZXJ0aWZpY2F0ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXNzdWVyQ2VydGlmaWNhdGVzID0gW107XG4gICAgICAgICAgICBjb25zdCBjcmxzID0gW107XG4gICAgICAgICAgICBjb25zdCBjcmxzQW5kQ2VydGlmaWNhdGVzID0gW107XG4gICAgICAgICAgICBpc3N1ZXJDZXJ0aWZpY2F0ZXMucHVzaCguLi5sb2NhbENlcnRzLmZpbHRlcihlbGVtZW50ID0+IGNlcnRpZmljYXRlLmlzc3Vlci5pc0VxdWFsKGVsZW1lbnQuc3ViamVjdCkpKTtcbiAgICAgICAgICAgIGlmIChpc3N1ZXJDZXJ0aWZpY2F0ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAxLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNNZXNzYWdlOiBcIk5vIGNlcnRpZmljYXRlJ3MgaXNzdWVyc1wiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNybHMucHVzaCguLi50aGlzLmNybHMuZmlsdGVyKG8gPT4gby5pc3N1ZXIuaXNFcXVhbChjZXJ0aWZpY2F0ZS5pc3N1ZXIpKSk7XG4gICAgICAgICAgICBpZiAoY3Jscy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IDIsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1c01lc3NhZ2U6IFwiTm8gQ1JMcyBmb3Igc3BlY2lmaWMgY2VydGlmaWNhdGUgaXNzdWVyXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjcmxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3JsID0gY3Jsc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoY3JsLm5leHRVcGRhdGUgJiYgY3JsLm5leHRVcGRhdGUudmFsdWUgPCB0aGlzLmNoZWNrRGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpc3N1ZXJDZXJ0aWZpY2F0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNybHNbaV0udmVyaWZ5KHsgaXNzdWVyQ2VydGlmaWNhdGU6IGlzc3VlckNlcnRpZmljYXRlc1tqXSB9LCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNybHNBbmRDZXJ0aWZpY2F0ZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNybDogY3Jsc1tpXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWNhdGU6IGlzc3VlckNlcnRpZmljYXRlc1tqXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNybHNBbmRDZXJ0aWZpY2F0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAwLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNNZXNzYWdlOiBFTVBUWV9TVFJJTkcsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdDogY3Jsc0FuZENlcnRpZmljYXRlc1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN0YXR1czogMyxcbiAgICAgICAgICAgICAgICBzdGF0dXNNZXNzYWdlOiBcIk5vIHZhbGlkIENSTHMgZm91bmRcIlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZmluZE9DU1AgPSBhc3luYyAoY2VydGlmaWNhdGUsIGlzc3VlckNlcnRpZmljYXRlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBoYXNoQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKGNlcnRpZmljYXRlLnNpZ25hdHVyZUFsZ29yaXRobS5hbGdvcml0aG1JZCk7XG4gICAgICAgICAgICBpZiAoIWhhc2hBbGdvcml0aG0ubmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFoYXNoQWxnb3JpdGhtLmhhc2gpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5vY3Nwcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9jc3AgPSB0aGlzLm9jc3BzW2ldO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG9jc3AuZ2V0Q2VydGlmaWNhdGVTdGF0dXMoY2VydGlmaWNhdGUsIGlzc3VlckNlcnRpZmljYXRlLCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuaXNGb3JDZXJ0aWZpY2F0ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMjtcbiAgICAgICAgfTtcbiAgICAgICAgYXN5bmMgZnVuY3Rpb24gY2hlY2tGb3JDQShjZXJ0aWZpY2F0ZSwgbmVlZFRvQ2hlY2tDUkwgPSBmYWxzZSkge1xuICAgICAgICAgICAgbGV0IGlzQ0EgPSBmYWxzZTtcbiAgICAgICAgICAgIGxldCBtdXN0QmVDQSA9IGZhbHNlO1xuICAgICAgICAgICAgbGV0IGtleVVzYWdlUHJlc2VudCA9IGZhbHNlO1xuICAgICAgICAgICAgbGV0IGNSTFNpZ24gPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChjZXJ0aWZpY2F0ZS5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjZXJ0aWZpY2F0ZS5leHRlbnNpb25zLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4dGVuc2lvbiA9IGNlcnRpZmljYXRlLmV4dGVuc2lvbnNbal07XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb24uY3JpdGljYWwgJiYgIWV4dGVuc2lvbi5wYXJzZWRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IDYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogYFVuYWJsZSB0byBwYXJzZSBjcml0aWNhbCBjZXJ0aWZpY2F0ZSBleHRlbnNpb246ICR7ZXh0ZW5zaW9uLmV4dG5JRH1gXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb24uZXh0bklEID09PSBpZF9LZXlVc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAga2V5VXNhZ2VQcmVzZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgVWludDhBcnJheShleHRlbnNpb24ucGFyc2VkVmFsdWUudmFsdWVCbG9jay52YWx1ZUhleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHZpZXdbMF0gJiAweDA0KSA9PT0gMHgwNClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtdXN0QmVDQSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHZpZXdbMF0gJiAweDAyKSA9PT0gMHgwMilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjUkxTaWduID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmV4dG5JRCA9PT0gaWRfQmFzaWNDb25zdHJhaW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwiY0FcIiBpbiBleHRlbnNpb24ucGFyc2VkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLmNBID09PSB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0NBID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoKG11c3RCZUNBID09PSB0cnVlKSAmJiAoaXNDQSA9PT0gZmFsc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiVW5hYmxlIHRvIGJ1aWxkIGNlcnRpZmljYXRlIGNoYWluIC0gdXNpbmcgXFxcImtleUNlcnRTaWduXFxcIiBmbGFnIHNldCB3aXRob3V0IEJhc2ljQ29uc3RyYWludHNcIlxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoKGtleVVzYWdlUHJlc2VudCA9PT0gdHJ1ZSkgJiYgKGlzQ0EgPT09IHRydWUpICYmIChtdXN0QmVDQSA9PT0gZmFsc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogNCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiVW5hYmxlIHRvIGJ1aWxkIGNlcnRpZmljYXRlIGNoYWluIC0gXFxcImtleUNlcnRTaWduXFxcIiBmbGFnIHdhcyBub3Qgc2V0XCJcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKChpc0NBID09PSB0cnVlKSAmJiAoa2V5VXNhZ2VQcmVzZW50ID09PSB0cnVlKSAmJiAoKG5lZWRUb0NoZWNrQ1JMKSAmJiAoY1JMU2lnbiA9PT0gZmFsc2UpKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IDUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRNZXNzYWdlOiBcIlVuYWJsZSB0byBidWlsZCBjZXJ0aWZpY2F0ZSBjaGFpbiAtIGludGVybWVkaWF0ZSBjZXJ0aWZpY2F0ZSBtdXN0IGhhdmUgXFxcImNSTFNpZ25cXFwiIGtleSB1c2FnZSBmbGFnXCJcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNDQSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiA3LFxuICAgICAgICAgICAgICAgICAgICByZXN1bHRNZXNzYWdlOiBcIlVuYWJsZSB0byBidWlsZCBjZXJ0aWZpY2F0ZSBjaGFpbiAtIG1vcmUgdGhhbiBvbmUgcG9zc2libGUgZW5kLXVzZXIgY2VydGlmaWNhdGVcIlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHJlc3VsdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiAwLFxuICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IEVNUFRZX1NUUklOR1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBiYXNpY0NoZWNrID0gYXN5bmMgKHBhdGgsIGNoZWNrRGF0ZSkgPT4ge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXRoLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKChwYXRoW2ldLm5vdEJlZm9yZS52YWx1ZSA+IGNoZWNrRGF0ZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgKHBhdGhbaV0ubm90QWZ0ZXIudmFsdWUgPCBjaGVja0RhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogOCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiVGhlIGNlcnRpZmljYXRlIGlzIGVpdGhlciBub3QgeWV0IHZhbGlkIG9yIGV4cGlyZWRcIlxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYXRoLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiA5LFxuICAgICAgICAgICAgICAgICAgICByZXN1bHRNZXNzYWdlOiBcIlRvbyBzaG9ydCBjZXJ0aWZpY2F0ZSBwYXRoXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IChwYXRoLmxlbmd0aCAtIDIpOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICAgIGlmIChwYXRoW2ldLmlzc3Vlci5pc0VxdWFsKHBhdGhbaV0uc3ViamVjdCkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXRoW2ldLmlzc3Vlci5pc0VxdWFsKHBhdGhbaSArIDFdLnN1YmplY3QpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IDEwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiSW5jb3JyZWN0IG5hbWUgY2hhaW5pbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgodGhpcy5jcmxzLmxlbmd0aCAhPT0gMCkgfHwgKHRoaXMub2NzcHMubGVuZ3RoICE9PSAwKSkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgKHBhdGgubGVuZ3RoIC0gMSk7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBsZXQgb2NzcFJlc3VsdCA9IDI7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjcmxSZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNNZXNzYWdlOiBFTVBUWV9TVFJJTkdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub2NzcHMubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvY3NwUmVzdWx0ID0gYXdhaXQgZmluZE9DU1AocGF0aFtpXSwgcGF0aFtpICsgMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChvY3NwUmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogMTIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRNZXNzYWdlOiBcIk9uZSBvZiBjZXJ0aWZpY2F0ZXMgd2FzIHJldm9rZWQgdmlhIE9DU1AgcmVzcG9uc2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNybHMubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcmxSZXN1bHQgPSBhd2FpdCBmaW5kQ1JMKHBhdGhbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNybFJlc3VsdC5zdGF0dXMgPT09IDAgJiYgY3JsUmVzdWx0LnJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY3JsUmVzdWx0LnJlc3VsdC5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NlcnRpZmljYXRlUmV2b2tlZCA9IGNybFJlc3VsdC5yZXN1bHRbal0uY3JsLmlzQ2VydGlmaWNhdGVSZXZva2VkKHBhdGhbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDZXJ0aWZpY2F0ZVJldm9rZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiAxMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRNZXNzYWdlOiBcIk9uZSBvZiBjZXJ0aWZpY2F0ZXMgaGFkIGJlZW4gcmV2b2tlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ2VydGlmaWNhdGVDQSA9IGF3YWl0IGNoZWNrRm9yQ0EoY3JsUmVzdWx0LnJlc3VsdFtqXS5jZXJ0aWZpY2F0ZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NlcnRpZmljYXRlQ0EucmVzdWx0ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IDEzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiQ1JMIGlzc3VlciBjZXJ0aWZpY2F0ZSBpcyBub3QgYSBDQSBjZXJ0aWZpY2F0ZSBvciBkb2VzIG5vdCBoYXZlIGNybFNpZ24gZmxhZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhc3NlZFdoZW5Ob3RSZXZWYWx1ZXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBDaGFpblZhbGlkYXRpb25FcnJvcihDaGFpblZhbGlkYXRpb25Db2RlLm5vUmV2b2NhdGlvbiwgYE5vIHJldm9jYXRpb24gdmFsdWVzIGZvdW5kIGZvciBvbmUgb2YgY2VydGlmaWNhdGVzOiAke2NybFJlc3VsdC5zdGF0dXNNZXNzYWdlfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvY3NwUmVzdWx0ID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogMTEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IFwiTm8gcmV2b2NhdGlvbiB2YWx1ZXMgZm91bmQgZm9yIG9uZSBvZiBjZXJ0aWZpY2F0ZXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKChvY3NwUmVzdWx0ID09PSAyKSAmJiAoY3JsUmVzdWx0LnN0YXR1cyA9PT0gMikgJiYgcGFzc2VkV2hlbk5vdFJldlZhbHVlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNzdWVyQ2VydGlmaWNhdGUgPSBwYXRoW2kgKyAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBleHRlbnNpb25Gb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzc3VlckNlcnRpZmljYXRlLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGV4dGVuc2lvbiBvZiBpc3N1ZXJDZXJ0aWZpY2F0ZS5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZXh0ZW5zaW9uLmV4dG5JRCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBpZF9DUkxEaXN0cmlidXRpb25Qb2ludHM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGlkX0ZyZXNoZXN0Q1JMOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBpZF9BdXRob3JpdHlJbmZvQWNjZXNzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvbkZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb25Gb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBDaGFpblZhbGlkYXRpb25FcnJvcihDaGFpblZhbGlkYXRpb25Db2RlLm5vUmV2b2NhdGlvbiwgYE5vIHJldm9jYXRpb24gdmFsdWVzIGZvdW5kIGZvciBvbmUgb2YgY2VydGlmaWNhdGVzOiAke2NybFJlc3VsdC5zdGF0dXNNZXNzYWdlfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBbaSwgY2VydF0gb2YgcGF0aC5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNoZWNrRm9yQ0EoY2VydCk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogMTQsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRNZXNzYWdlOiBcIk9uZSBvZiBpbnRlcm1lZGlhdGUgY2VydGlmaWNhdGVzIGlzIG5vdCBhIENBIGNlcnRpZmljYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHJlc3VsdDogdHJ1ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgbG9jYWxDZXJ0cy5wdXNoKC4uLnRoaXMudHJ1c3RlZENlcnRzKTtcbiAgICAgICAgbG9jYWxDZXJ0cy5wdXNoKC4uLnRoaXMuY2VydHMpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxvY2FsQ2VydHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbG9jYWxDZXJ0cy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGlmIChpID09PSBqKVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBpZiAocHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci5pc0VxdWFsKGxvY2FsQ2VydHNbaV0udGJzVmlldywgbG9jYWxDZXJ0c1tqXS50YnNWaWV3KSkge1xuICAgICAgICAgICAgICAgICAgICBsb2NhbENlcnRzLnNwbGljZShqLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgaSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBsZWFmQ2VydCA9IGxvY2FsQ2VydHNbbG9jYWxDZXJ0cy5sZW5ndGggLSAxXTtcbiAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgY29uc3QgY2VydGlmaWNhdGVQYXRoID0gW2xlYWZDZXJ0XTtcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgYnVpbGRQYXRoKGxlYWZDZXJ0LCBjcnlwdG8pO1xuICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IENoYWluVmFsaWRhdGlvbkVycm9yKENoYWluVmFsaWRhdGlvbkNvZGUubm9QYXRoLCBcIlVuYWJsZSB0byBmaW5kIGNlcnRpZmljYXRlIHBhdGhcIik7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IHJlc3VsdC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgbGV0IGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IChyZXN1bHRbaV0pLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2VydGlmaWNhdGUgPSAocmVzdWx0W2ldKVtqXTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHRoaXMudHJ1c3RlZENlcnRzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLmlzRXF1YWwoY2VydGlmaWNhdGUudGJzVmlldywgdGhpcy50cnVzdGVkQ2VydHNba10udGJzVmlldykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmb3VuZClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWZvdW5kKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IENoYWluVmFsaWRhdGlvbkVycm9yKENoYWluVmFsaWRhdGlvbkNvZGUubm9WYWxpZFBhdGgsIFwiTm8gdmFsaWQgY2VydGlmaWNhdGUgcGF0aHMgZm91bmRcIik7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHNob3J0ZXN0TGVuZ3RoID0gcmVzdWx0WzBdLmxlbmd0aDtcbiAgICAgICAgbGV0IHNob3J0ZXN0SW5kZXggPSAwO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHJlc3VsdFtpXS5sZW5ndGggPCBzaG9ydGVzdExlbmd0aCkge1xuICAgICAgICAgICAgICAgIHNob3J0ZXN0TGVuZ3RoID0gcmVzdWx0W2ldLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBzaG9ydGVzdEluZGV4ID0gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdFtzaG9ydGVzdEluZGV4XS5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIGNlcnRpZmljYXRlUGF0aC5wdXNoKChyZXN1bHRbc2hvcnRlc3RJbmRleF0pW2ldKTtcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgYmFzaWNDaGVjayhjZXJ0aWZpY2F0ZVBhdGgsIHRoaXMuY2hlY2tEYXRlKTtcbiAgICAgICAgaWYgKHJlc3VsdC5yZXN1bHQgPT09IGZhbHNlKVxuICAgICAgICAgICAgdGhyb3cgcmVzdWx0O1xuICAgICAgICByZXR1cm4gY2VydGlmaWNhdGVQYXRoO1xuICAgIH1cbiAgICBhc3luYyB2ZXJpZnkocGFyYW1ldGVycyA9IHt9LCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgZnVuY3Rpb24gY29tcGFyZUROU05hbWUobmFtZSwgY29uc3RyYWludCkge1xuICAgICAgICAgICAgY29uc3QgbmFtZVByZXBhcmVkID0gc3RyaW5nUHJlcChuYW1lKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbnN0cmFpbnRQcmVwYXJlZCA9IHN0cmluZ1ByZXAoY29uc3RyYWludCk7XG4gICAgICAgICAgICBjb25zdCBuYW1lU3BsaXR0ZWQgPSBuYW1lUHJlcGFyZWQuc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgY29uc3QgY29uc3RyYWludFNwbGl0dGVkID0gY29uc3RyYWludFByZXBhcmVkLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICAgIGNvbnN0IG5hbWVMZW4gPSBuYW1lU3BsaXR0ZWQubGVuZ3RoO1xuICAgICAgICAgICAgY29uc3QgY29uc3RyTGVuID0gY29uc3RyYWludFNwbGl0dGVkLmxlbmd0aDtcbiAgICAgICAgICAgIGlmICgobmFtZUxlbiA9PT0gMCkgfHwgKGNvbnN0ckxlbiA9PT0gMCkgfHwgKG5hbWVMZW4gPCBjb25zdHJMZW4pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuYW1lTGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAobmFtZVNwbGl0dGVkW2ldLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb25zdHJMZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChjb25zdHJhaW50U3BsaXR0ZWRbaV0ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29uc3RyTGVuID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29uc3RyTGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoY29uc3RyYWludFNwbGl0dGVkW2NvbnN0ckxlbiAtIDEgLSBpXS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChuYW1lU3BsaXR0ZWRbbmFtZUxlbiAtIDEgLSBpXS5sb2NhbGVDb21wYXJlKGNvbnN0cmFpbnRTcGxpdHRlZFtjb25zdHJMZW4gLSAxIC0gaV0pICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjb21wYXJlUkZDODIyTmFtZShuYW1lLCBjb25zdHJhaW50KSB7XG4gICAgICAgICAgICBjb25zdCBuYW1lUHJlcGFyZWQgPSBzdHJpbmdQcmVwKG5hbWUpO1xuICAgICAgICAgICAgY29uc3QgY29uc3RyYWludFByZXBhcmVkID0gc3RyaW5nUHJlcChjb25zdHJhaW50KTtcbiAgICAgICAgICAgIGNvbnN0IG5hbWVTcGxpdHRlZCA9IG5hbWVQcmVwYXJlZC5zcGxpdChcIkBcIik7XG4gICAgICAgICAgICBjb25zdCBjb25zdHJhaW50U3BsaXR0ZWQgPSBjb25zdHJhaW50UHJlcGFyZWQuc3BsaXQoXCJAXCIpO1xuICAgICAgICAgICAgaWYgKChuYW1lU3BsaXR0ZWQubGVuZ3RoID09PSAwKSB8fCAoY29uc3RyYWludFNwbGl0dGVkLmxlbmd0aCA9PT0gMCkgfHwgKG5hbWVTcGxpdHRlZC5sZW5ndGggPCBjb25zdHJhaW50U3BsaXR0ZWQubGVuZ3RoKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBpZiAoY29uc3RyYWludFNwbGl0dGVkLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGNvbXBhcmVETlNOYW1lKG5hbWVTcGxpdHRlZFsxXSwgY29uc3RyYWludFNwbGl0dGVkWzBdKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5zID0gbmFtZVNwbGl0dGVkWzFdLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3MgPSBjb25zdHJhaW50U3BsaXR0ZWRbMF0uc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3NbMF0ubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBucy5sZW5ndGggPT09IGNzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIChuYW1lUHJlcGFyZWQubG9jYWxlQ29tcGFyZShjb25zdHJhaW50UHJlcGFyZWQpID09PSAwKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjb21wYXJlVW5pZm9ybVJlc291cmNlSWRlbnRpZmllcihuYW1lLCBjb25zdHJhaW50KSB7XG4gICAgICAgICAgICBsZXQgbmFtZVByZXBhcmVkID0gc3RyaW5nUHJlcChuYW1lKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbnN0cmFpbnRQcmVwYXJlZCA9IHN0cmluZ1ByZXAoY29uc3RyYWludCk7XG4gICAgICAgICAgICBjb25zdCBucyA9IG5hbWVQcmVwYXJlZC5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICBjb25zdCBjcyA9IGNvbnN0cmFpbnRQcmVwYXJlZC5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICBpZiAoY3MubGVuZ3RoID4gMSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBpZiAobnMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChuc1tpXS5sZW5ndGggPiAwKSAmJiAobnNbaV0uY2hhckF0KG5zW2ldLmxlbmd0aCAtIDEpICE9PSBcIjpcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5zUG9ydCA9IG5zW2ldLnNwbGl0KFwiOlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVQcmVwYXJlZCA9IG5zUG9ydFswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gY29tcGFyZUROU05hbWUobmFtZVByZXBhcmVkLCBjb25zdHJhaW50UHJlcGFyZWQpO1xuICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVTcGxpdHRlZCA9IG5hbWVQcmVwYXJlZC5zcGxpdChcIi5cIik7XG4gICAgICAgICAgICAgICAgY29uc3QgY29uc3RyYWludFNwbGl0dGVkID0gY29uc3RyYWludFByZXBhcmVkLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICAgICAgICBpZiAoY29uc3RyYWludFNwbGl0dGVkWzBdLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5hbWVTcGxpdHRlZC5sZW5ndGggPT09IGNvbnN0cmFpbnRTcGxpdHRlZC5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY29tcGFyZUlQQWRkcmVzcyhuYW1lLCBjb25zdHJhaW50KSB7XG4gICAgICAgICAgICBjb25zdCBuYW1lVmlldyA9IG5hbWUudmFsdWVCbG9jay52YWx1ZUhleFZpZXc7XG4gICAgICAgICAgICBjb25zdCBjb25zdHJhaW50VmlldyA9IGNvbnN0cmFpbnQudmFsdWVCbG9jay52YWx1ZUhleFZpZXc7XG4gICAgICAgICAgICBpZiAoKG5hbWVWaWV3Lmxlbmd0aCA9PT0gNCkgJiYgKGNvbnN0cmFpbnRWaWV3Lmxlbmd0aCA9PT0gOCkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKG5hbWVWaWV3W2ldIF4gY29uc3RyYWludFZpZXdbaV0pICYgY29uc3RyYWludFZpZXdbaSArIDRdKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgobmFtZVZpZXcubGVuZ3RoID09PSAxNikgJiYgKGNvbnN0cmFpbnRWaWV3Lmxlbmd0aCA9PT0gMzIpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgobmFtZVZpZXdbaV0gXiBjb25zdHJhaW50Vmlld1tpXSkgJiBjb25zdHJhaW50Vmlld1tpICsgMTZdKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjb21wYXJlRGlyZWN0b3J5TmFtZShuYW1lLCBjb25zdHJhaW50KSB7XG4gICAgICAgICAgICBpZiAoKG5hbWUudHlwZXNBbmRWYWx1ZXMubGVuZ3RoID09PSAwKSB8fCAoY29uc3RyYWludC50eXBlc0FuZFZhbHVlcy5sZW5ndGggPT09IDApKVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgaWYgKG5hbWUudHlwZXNBbmRWYWx1ZXMubGVuZ3RoIDwgY29uc3RyYWludC50eXBlc0FuZFZhbHVlcy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHRydWU7XG4gICAgICAgICAgICBsZXQgbmFtZVN0YXJ0ID0gMDtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29uc3RyYWludC50eXBlc0FuZFZhbHVlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGxldCBsb2NhbFJlc3VsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSBuYW1lU3RhcnQ7IGogPCBuYW1lLnR5cGVzQW5kVmFsdWVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsUmVzdWx0ID0gbmFtZS50eXBlc0FuZFZhbHVlc1tqXS5pc0VxdWFsKGNvbnN0cmFpbnQudHlwZXNBbmRWYWx1ZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmFtZS50eXBlc0FuZFZhbHVlc1tqXS50eXBlID09PSBjb25zdHJhaW50LnR5cGVzQW5kVmFsdWVzW2ldLnR5cGUpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgJiYgbG9jYWxSZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2NhbFJlc3VsdCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChuYW1lU3RhcnQgPT09IDApIHx8IChuYW1lU3RhcnQgPT09IGopKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVN0YXJ0ID0gaiArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChsb2NhbFJlc3VsdCA9PT0gZmFsc2UpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAobmFtZVN0YXJ0ID09PSAwKSA/IGZhbHNlIDogcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jZXJ0cy5sZW5ndGggPT09IDApXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRW1wdHkgY2VydGlmaWNhdGUgYXJyYXlcIik7XG4gICAgICAgICAgICBjb25zdCBwYXNzZWRXaGVuTm90UmV2VmFsdWVzID0gcGFyYW1ldGVycy5wYXNzZWRXaGVuTm90UmV2VmFsdWVzIHx8IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgaW5pdGlhbFBvbGljeVNldCA9IHBhcmFtZXRlcnMuaW5pdGlhbFBvbGljeVNldCB8fCBbaWRfQW55UG9saWN5XTtcbiAgICAgICAgICAgIGNvbnN0IGluaXRpYWxFeHBsaWNpdFBvbGljeSA9IHBhcmFtZXRlcnMuaW5pdGlhbEV4cGxpY2l0UG9saWN5IHx8IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgaW5pdGlhbFBvbGljeU1hcHBpbmdJbmhpYml0ID0gcGFyYW1ldGVycy5pbml0aWFsUG9saWN5TWFwcGluZ0luaGliaXQgfHwgZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBpbml0aWFsSW5oaWJpdFBvbGljeSA9IHBhcmFtZXRlcnMuaW5pdGlhbEluaGliaXRQb2xpY3kgfHwgZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBpbml0aWFsUGVybWl0dGVkU3VidHJlZXNTZXQgPSBwYXJhbWV0ZXJzLmluaXRpYWxQZXJtaXR0ZWRTdWJ0cmVlc1NldCB8fCBbXTtcbiAgICAgICAgICAgIGNvbnN0IGluaXRpYWxFeGNsdWRlZFN1YnRyZWVzU2V0ID0gcGFyYW1ldGVycy5pbml0aWFsRXhjbHVkZWRTdWJ0cmVlc1NldCB8fCBbXTtcbiAgICAgICAgICAgIGNvbnN0IGluaXRpYWxSZXF1aXJlZE5hbWVGb3JtcyA9IHBhcmFtZXRlcnMuaW5pdGlhbFJlcXVpcmVkTmFtZUZvcm1zIHx8IFtdO1xuICAgICAgICAgICAgbGV0IGV4cGxpY2l0UG9saWN5SW5kaWNhdG9yID0gaW5pdGlhbEV4cGxpY2l0UG9saWN5O1xuICAgICAgICAgICAgbGV0IHBvbGljeU1hcHBpbmdJbmhpYml0SW5kaWNhdG9yID0gaW5pdGlhbFBvbGljeU1hcHBpbmdJbmhpYml0O1xuICAgICAgICAgICAgbGV0IGluaGliaXRBbnlQb2xpY3lJbmRpY2F0b3IgPSBpbml0aWFsSW5oaWJpdFBvbGljeTtcbiAgICAgICAgICAgIGNvbnN0IHBlbmRpbmdDb25zdHJhaW50cyA9IFtcbiAgICAgICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBsZXQgZXhwbGljaXRQb2xpY3lQZW5kaW5nID0gMDtcbiAgICAgICAgICAgIGxldCBwb2xpY3lNYXBwaW5nSW5oaWJpdFBlbmRpbmcgPSAwO1xuICAgICAgICAgICAgbGV0IGluaGliaXRBbnlQb2xpY3lQZW5kaW5nID0gMDtcbiAgICAgICAgICAgIGxldCBwZXJtaXR0ZWRTdWJ0cmVlcyA9IGluaXRpYWxQZXJtaXR0ZWRTdWJ0cmVlc1NldDtcbiAgICAgICAgICAgIGxldCBleGNsdWRlZFN1YnRyZWVzID0gaW5pdGlhbEV4Y2x1ZGVkU3VidHJlZXNTZXQ7XG4gICAgICAgICAgICBjb25zdCByZXF1aXJlZE5hbWVGb3JtcyA9IGluaXRpYWxSZXF1aXJlZE5hbWVGb3JtcztcbiAgICAgICAgICAgIGxldCBwYXRoRGVwdGggPSAxO1xuICAgICAgICAgICAgdGhpcy5jZXJ0cyA9IGF3YWl0IHRoaXMuc29ydChwYXNzZWRXaGVuTm90UmV2VmFsdWVzLCBjcnlwdG8pO1xuICAgICAgICAgICAgY29uc3QgYWxsUG9saWNpZXMgPSBbXTtcbiAgICAgICAgICAgIGFsbFBvbGljaWVzLnB1c2goaWRfQW55UG9saWN5KTtcbiAgICAgICAgICAgIGNvbnN0IHBvbGljaWVzQW5kQ2VydHMgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IGFueVBvbGljeUFycmF5ID0gbmV3IEFycmF5KHRoaXMuY2VydHMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICBmb3IgKGxldCBpaSA9IDA7IGlpIDwgKHRoaXMuY2VydHMubGVuZ3RoIC0gMSk7IGlpKyspXG4gICAgICAgICAgICAgICAgYW55UG9saWN5QXJyYXlbaWldID0gdHJ1ZTtcbiAgICAgICAgICAgIHBvbGljaWVzQW5kQ2VydHMucHVzaChhbnlQb2xpY3lBcnJheSk7XG4gICAgICAgICAgICBjb25zdCBwb2xpY3lNYXBwaW5ncyA9IG5ldyBBcnJheSh0aGlzLmNlcnRzLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgY29uc3QgY2VydFBvbGljaWVzID0gbmV3IEFycmF5KHRoaXMuY2VydHMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICBsZXQgZXhwbGljaXRQb2xpY3lTdGFydCA9IChleHBsaWNpdFBvbGljeUluZGljYXRvcikgPyAodGhpcy5jZXJ0cy5sZW5ndGggLSAxKSA6ICgtMSk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gKHRoaXMuY2VydHMubGVuZ3RoIC0gMik7IGkgPj0gMDsgaS0tLCBwYXRoRGVwdGgrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNlcnQgPSB0aGlzLmNlcnRzW2ldO1xuICAgICAgICAgICAgICAgIGlmIChjZXJ0LmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjZXJ0LmV4dGVuc2lvbnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4dGVuc2lvbiA9IGNlcnQuZXh0ZW5zaW9uc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb24uZXh0bklEID09PSBpZF9DZXJ0aWZpY2F0ZVBvbGljaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VydFBvbGljaWVzW2ldID0gZXh0ZW5zaW9uLnBhcnNlZFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHMgPSAwOyBzIDwgYWxsUG9saWNpZXMubGVuZ3RoOyBzKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFsbFBvbGljaWVzW3NdID09PSBpZF9BbnlQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSAocG9saWNpZXNBbmRDZXJ0c1tzXSlbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5jZXJ0aWZpY2F0ZVBvbGljaWVzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwb2xpY3lJbmRleCA9ICgtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvbGljeUlkID0gZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLmNlcnRpZmljYXRlUG9saWNpZXNba10ucG9saWN5SWRlbnRpZmllcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgcyA9IDA7IHMgPCBhbGxQb2xpY2llcy5sZW5ndGg7IHMrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeUlkID09PSBhbGxQb2xpY2llc1tzXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeUluZGV4ID0gcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5SW5kZXggPT09ICgtMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbFBvbGljaWVzLnB1c2gocG9saWN5SWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2VydEFycmF5ID0gbmV3IEFycmF5KHRoaXMuY2VydHMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZXJ0QXJyYXlbaV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9saWNpZXNBbmRDZXJ0cy5wdXNoKGNlcnRBcnJheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHBvbGljaWVzQW5kQ2VydHNbcG9saWN5SW5kZXhdKVtpXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5leHRuSUQgPT09IGlkX1BvbGljeU1hcHBpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeU1hcHBpbmdJbmhpYml0SW5kaWNhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogOTgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRNZXNzYWdlOiBcIlBvbGljeSBtYXBwaW5nIHByb2hpYml0ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3lNYXBwaW5nc1tpXSA9IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHRlbnNpb24uZXh0bklEID09PSBpZF9Qb2xpY3lDb25zdHJhaW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBsaWNpdFBvbGljeUluZGljYXRvciA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5yZXF1aXJlRXhwbGljaXRQb2xpY3kgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGxpY2l0UG9saWN5SW5kaWNhdG9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGxpY2l0UG9saWN5U3RhcnQgPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdDb25zdHJhaW50c1swXSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nQ29uc3RyYWludHNbMF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGxpY2l0UG9saWN5UGVuZGluZyA9IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5yZXF1aXJlRXhwbGljaXRQb2xpY3k7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwbGljaXRQb2xpY3lQZW5kaW5nID0gKGV4cGxpY2l0UG9saWN5UGVuZGluZyA+IGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5yZXF1aXJlRXhwbGljaXRQb2xpY3kpID8gZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLnJlcXVpcmVFeHBsaWNpdFBvbGljeSA6IGV4cGxpY2l0UG9saWN5UGVuZGluZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLmluaGliaXRQb2xpY3lNYXBwaW5nID09PSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5TWFwcGluZ0luaGliaXRJbmRpY2F0b3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nQ29uc3RyYWludHNbMV0gPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0NvbnN0cmFpbnRzWzFdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3lNYXBwaW5nSW5oaWJpdFBlbmRpbmcgPSBleHRlbnNpb24ucGFyc2VkVmFsdWUuaW5oaWJpdFBvbGljeU1hcHBpbmcgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeU1hcHBpbmdJbmhpYml0UGVuZGluZyA9IChwb2xpY3lNYXBwaW5nSW5oaWJpdFBlbmRpbmcgPiAoZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLmluaGliaXRQb2xpY3lNYXBwaW5nICsgMSkpID8gKGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS5pbmhpYml0UG9saWN5TWFwcGluZyArIDEpIDogcG9saWN5TWFwcGluZ0luaGliaXRQZW5kaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5leHRuSUQgPT09IGlkX0luaGliaXRBbnlQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5oaWJpdEFueVBvbGljeUluZGljYXRvciA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVuc2lvbi5wYXJzZWRWYWx1ZS52YWx1ZUJsb2NrLnZhbHVlRGVjID09PSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5oaWJpdEFueVBvbGljeUluZGljYXRvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdDb25zdHJhaW50c1syXSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nQ29uc3RyYWludHNbMl0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaGliaXRBbnlQb2xpY3lQZW5kaW5nID0gZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5oaWJpdEFueVBvbGljeVBlbmRpbmcgPSAoaW5oaWJpdEFueVBvbGljeVBlbmRpbmcgPiBleHRlbnNpb24ucGFyc2VkVmFsdWUudmFsdWVCbG9jay52YWx1ZURlYykgPyBleHRlbnNpb24ucGFyc2VkVmFsdWUudmFsdWVCbG9jay52YWx1ZURlYyA6IGluaGliaXRBbnlQb2xpY3lQZW5kaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmhpYml0QW55UG9saWN5SW5kaWNhdG9yID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcG9saWN5SW5kZXggPSAoLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgc2VhcmNoQW55UG9saWN5ID0gMDsgc2VhcmNoQW55UG9saWN5IDwgYWxsUG9saWNpZXMubGVuZ3RoOyBzZWFyY2hBbnlQb2xpY3krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbGxQb2xpY2llc1tzZWFyY2hBbnlQb2xpY3ldID09PSBpZF9BbnlQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5SW5kZXggPSBzZWFyY2hBbnlQb2xpY3k7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb2xpY3lJbmRleCAhPT0gKC0xKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgKHBvbGljaWVzQW5kQ2VydHNbMF0pW2ldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHBsaWNpdFBvbGljeUluZGljYXRvciA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nQ29uc3RyYWludHNbMF0gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBsaWNpdFBvbGljeVBlbmRpbmctLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhwbGljaXRQb2xpY3lQZW5kaW5nID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGxpY2l0UG9saWN5SW5kaWNhdG9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwbGljaXRQb2xpY3lTdGFydCA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmdDb25zdHJhaW50c1swXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5TWFwcGluZ0luaGliaXRJbmRpY2F0b3IgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ0NvbnN0cmFpbnRzWzFdID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5TWFwcGluZ0luaGliaXRQZW5kaW5nLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvbGljeU1hcHBpbmdJbmhpYml0UGVuZGluZyA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3lNYXBwaW5nSW5oaWJpdEluZGljYXRvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmdDb25zdHJhaW50c1sxXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5oaWJpdEFueVBvbGljeUluZGljYXRvciA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nQ29uc3RyYWludHNbMl0gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmhpYml0QW55UG9saWN5UGVuZGluZy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmhpYml0QW55UG9saWN5UGVuZGluZyA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmhpYml0QW55UG9saWN5SW5kaWNhdG9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0NvbnN0cmFpbnRzWzJdID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAodGhpcy5jZXJ0cy5sZW5ndGggLSAxKTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKChpIDwgKHRoaXMuY2VydHMubGVuZ3RoIC0gMikpICYmICh0eXBlb2YgcG9saWN5TWFwcGluZ3NbaSArIDFdICE9PSBcInVuZGVmaW5lZFwiKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHBvbGljeU1hcHBpbmdzW2kgKyAxXS5tYXBwaW5ncy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChwb2xpY3lNYXBwaW5nc1tpICsgMV0ubWFwcGluZ3Nba10uaXNzdWVyRG9tYWluUG9saWN5ID09PSBpZF9BbnlQb2xpY3kpIHx8IChwb2xpY3lNYXBwaW5nc1tpICsgMV0ubWFwcGluZ3Nba10uc3ViamVjdERvbWFpblBvbGljeSA9PT0gaWRfQW55UG9saWN5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IDk5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRNZXNzYWdlOiBcIlRoZSBcXFwiYW55UG9saWN5XFxcIiBzaG91bGQgbm90IGJlIGEgcGFydCBvZiBwb2xpY3kgbWFwcGluZyBzY2hlbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaXNzdWVyRG9tYWluUG9saWN5SW5kZXggPSAoLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN1YmplY3REb21haW5Qb2xpY3lJbmRleCA9ICgtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IGFsbFBvbGljaWVzLmxlbmd0aDsgbisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFsbFBvbGljaWVzW25dID09PSBwb2xpY3lNYXBwaW5nc1tpICsgMV0ubWFwcGluZ3Nba10uaXNzdWVyRG9tYWluUG9saWN5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc3N1ZXJEb21haW5Qb2xpY3lJbmRleCA9IG47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFsbFBvbGljaWVzW25dID09PSBwb2xpY3lNYXBwaW5nc1tpICsgMV0ubWFwcGluZ3Nba10uc3ViamVjdERvbWFpblBvbGljeSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdERvbWFpblBvbGljeUluZGV4ID0gbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKHBvbGljaWVzQW5kQ2VydHNbaXNzdWVyRG9tYWluUG9saWN5SW5kZXhdKVtpXSAhPT0gXCJ1bmRlZmluZWRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgKHBvbGljaWVzQW5kQ2VydHNbaXNzdWVyRG9tYWluUG9saWN5SW5kZXhdKVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY2VydFBvbGljaWVzW2ldLmNlcnRpZmljYXRlUG9saWNpZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9saWN5TWFwcGluZ3NbaSArIDFdLm1hcHBpbmdzW2tdLnN1YmplY3REb21haW5Qb2xpY3kgPT09IGNlcnRQb2xpY2llc1tpXS5jZXJ0aWZpY2F0ZVBvbGljaWVzW2pdLnBvbGljeUlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChpc3N1ZXJEb21haW5Qb2xpY3lJbmRleCAhPT0gKC0xKSkgJiYgKHN1YmplY3REb21haW5Qb2xpY3lJbmRleCAhPT0gKC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG0gPSAwOyBtIDw9IGk7IG0rKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKHBvbGljaWVzQW5kQ2VydHNbc3ViamVjdERvbWFpblBvbGljeUluZGV4XSlbbV0gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHBvbGljaWVzQW5kQ2VydHNbaXNzdWVyRG9tYWluUG9saWN5SW5kZXhdKVttXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSAocG9saWNpZXNBbmRDZXJ0c1tzdWJqZWN0RG9tYWluUG9saWN5SW5kZXhdKVttXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbFBvbGljaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFsbFBvbGljaWVzW2ldID09PSBpZF9BbnlQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBleHBsaWNpdFBvbGljeVN0YXJ0OyBqKyspXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgKHBvbGljaWVzQW5kQ2VydHNbaV0pW2pdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGF1dGhDb25zdHJQb2xpY2llcyA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2xpY2llc0FuZENlcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8ICh0aGlzLmNlcnRzLmxlbmd0aCAtIDEpOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFueVBvbGljeUZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoaiA8IGV4cGxpY2l0UG9saWN5U3RhcnQpICYmIChhbGxQb2xpY2llc1tpXSA9PT0gaWRfQW55UG9saWN5KSAmJiAoYWxsUG9saWNpZXMubGVuZ3RoID4gMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIChwb2xpY2llc0FuZENlcnRzW2ldKVtqXSA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGogPj0gZXhwbGljaXRQb2xpY3lTdGFydCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgYWxsUG9saWNpZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFsbFBvbGljaWVzW2tdID09PSBpZF9BbnlQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgocG9saWNpZXNBbmRDZXJ0c1trXSlbal0gPT09IHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW55UG9saWN5Rm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFueVBvbGljeUZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZm91bmQgPT09IHRydWUpXG4gICAgICAgICAgICAgICAgICAgIGF1dGhDb25zdHJQb2xpY2llcy5wdXNoKGFsbFBvbGljaWVzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCB1c2VyQ29uc3RyUG9saWNpZXMgPSBbXTtcbiAgICAgICAgICAgIGlmICgoaW5pdGlhbFBvbGljeVNldC5sZW5ndGggPT09IDEpICYmIChpbml0aWFsUG9saWN5U2V0WzBdID09PSBpZF9BbnlQb2xpY3kpICYmIChleHBsaWNpdFBvbGljeUluZGljYXRvciA9PT0gZmFsc2UpKVxuICAgICAgICAgICAgICAgIHVzZXJDb25zdHJQb2xpY2llcyA9IGluaXRpYWxQb2xpY3lTZXQ7XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoKGF1dGhDb25zdHJQb2xpY2llcy5sZW5ndGggPT09IDEpICYmIChhdXRoQ29uc3RyUG9saWNpZXNbMF0gPT09IGlkX0FueVBvbGljeSkpXG4gICAgICAgICAgICAgICAgICAgIHVzZXJDb25zdHJQb2xpY2llcyA9IGluaXRpYWxQb2xpY3lTZXQ7XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXV0aENvbnN0clBvbGljaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGluaXRpYWxQb2xpY3lTZXQubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGluaXRpYWxQb2xpY3lTZXRbal0gPT09IGF1dGhDb25zdHJQb2xpY2llc1tpXSkgfHwgKGluaXRpYWxQb2xpY3lTZXRbal0gPT09IGlkX0FueVBvbGljeSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlckNvbnN0clBvbGljaWVzLnB1c2goYXV0aENvbnN0clBvbGljaWVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcG9saWN5UmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgIHJlc3VsdDogKHVzZXJDb25zdHJQb2xpY2llcy5sZW5ndGggPiAwKSxcbiAgICAgICAgICAgICAgICByZXN1bHRDb2RlOiAwLFxuICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6ICh1c2VyQ29uc3RyUG9saWNpZXMubGVuZ3RoID4gMCkgPyBFTVBUWV9TVFJJTkcgOiBcIlplcm8gXFxcInVzZXJDb25zdHJQb2xpY2llc1xcXCIgYXJyYXksIG5vIGludGVyc2VjdGlvbnMgd2l0aCBcXFwiYXV0aENvbnN0clBvbGljaWVzXFxcIlwiLFxuICAgICAgICAgICAgICAgIGF1dGhDb25zdHJQb2xpY2llcyxcbiAgICAgICAgICAgICAgICB1c2VyQ29uc3RyUG9saWNpZXMsXG4gICAgICAgICAgICAgICAgZXhwbGljaXRQb2xpY3lJbmRpY2F0b3IsXG4gICAgICAgICAgICAgICAgcG9saWN5TWFwcGluZ3MsXG4gICAgICAgICAgICAgICAgY2VydGlmaWNhdGVQYXRoOiB0aGlzLmNlcnRzXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHVzZXJDb25zdHJQb2xpY2llcy5sZW5ndGggPT09IDApXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBvbGljeVJlc3VsdDtcbiAgICAgICAgICAgIGlmIChwb2xpY3lSZXN1bHQucmVzdWx0ID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9saWN5UmVzdWx0O1xuICAgICAgICAgICAgcGF0aERlcHRoID0gMTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAodGhpcy5jZXJ0cy5sZW5ndGggLSAyKTsgaSA+PSAwOyBpLS0sIHBhdGhEZXB0aCsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2VydCA9IHRoaXMuY2VydHNbaV07XG4gICAgICAgICAgICAgICAgbGV0IHN1YmplY3RBbHROYW1lcyA9IFtdO1xuICAgICAgICAgICAgICAgIGxldCBjZXJ0UGVybWl0dGVkU3VidHJlZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBsZXQgY2VydEV4Y2x1ZGVkU3VidHJlZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAoY2VydC5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY2VydC5leHRlbnNpb25zLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleHRlbnNpb24gPSBjZXJ0LmV4dGVuc2lvbnNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmV4dG5JRCA9PT0gaWRfTmFtZUNvbnN0cmFpbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwicGVybWl0dGVkU3VidHJlZXNcIiBpbiBleHRlbnNpb24ucGFyc2VkVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRQZXJtaXR0ZWRTdWJ0cmVlcyA9IGNlcnRQZXJtaXR0ZWRTdWJ0cmVlcy5jb25jYXQoZXh0ZW5zaW9uLnBhcnNlZFZhbHVlLnBlcm1pdHRlZFN1YnRyZWVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXCJleGNsdWRlZFN1YnRyZWVzXCIgaW4gZXh0ZW5zaW9uLnBhcnNlZFZhbHVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZXJ0RXhjbHVkZWRTdWJ0cmVlcyA9IGNlcnRFeGNsdWRlZFN1YnRyZWVzLmNvbmNhdChleHRlbnNpb24ucGFyc2VkVmFsdWUuZXhjbHVkZWRTdWJ0cmVlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ZW5zaW9uLmV4dG5JRCA9PT0gaWRfU3ViamVjdEFsdE5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdEFsdE5hbWVzID0gc3ViamVjdEFsdE5hbWVzLmNvbmNhdChleHRlbnNpb24ucGFyc2VkVmFsdWUuYWx0TmFtZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBmb3JtRm91bmQgPSAocmVxdWlyZWROYW1lRm9ybXMubGVuZ3RoIDw9IDApO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgcmVxdWlyZWROYW1lRm9ybXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChyZXF1aXJlZE5hbWVGb3Jtc1tqXS5iYXNlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXF1aXJlZE5hbWVGb3Jtc1tqXS5iYXNlLnZhbHVlLnR5cGVzQW5kVmFsdWVzLmxlbmd0aCAhPT0gY2VydC5zdWJqZWN0LnR5cGVzQW5kVmFsdWVzLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtRm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IGNlcnQuc3ViamVjdC50eXBlc0FuZFZhbHVlcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNlcnQuc3ViamVjdC50eXBlc0FuZFZhbHVlc1trXS50eXBlICE9PSByZXF1aXJlZE5hbWVGb3Jtc1tqXS5iYXNlLnZhbHVlLnR5cGVzQW5kVmFsdWVzW2tdLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtRm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybUZvdW5kID09PSB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZm9ybUZvdW5kID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICBwb2xpY3lSZXN1bHQucmVzdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlc3VsdC5yZXN1bHRDb2RlID0gMjE7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlc3VsdC5yZXN1bHRNZXNzYWdlID0gXCJObyBuZWNlc3NhcnkgbmFtZSBmb3JtIGZvdW5kXCI7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IHBvbGljeVJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgY29uc3RyR3JvdXBzID0gW1xuICAgICAgICAgICAgICAgICAgICBbXSxcbiAgICAgICAgICAgICAgICAgICAgW10sXG4gICAgICAgICAgICAgICAgICAgIFtdLFxuICAgICAgICAgICAgICAgICAgICBbXSxcbiAgICAgICAgICAgICAgICAgICAgW10sXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHBlcm1pdHRlZFN1YnRyZWVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocGVybWl0dGVkU3VidHJlZXNbal0uYmFzZS50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RyR3JvdXBzWzBdLnB1c2gocGVybWl0dGVkU3VidHJlZXNbal0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0ckdyb3Vwc1sxXS5wdXNoKHBlcm1pdHRlZFN1YnRyZWVzW2pdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdHJHcm91cHNbMl0ucHVzaChwZXJtaXR0ZWRTdWJ0cmVlc1tqXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RyR3JvdXBzWzNdLnB1c2gocGVybWl0dGVkU3VidHJlZXNbal0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0ckdyb3Vwc1s0XS5wdXNoKHBlcm1pdHRlZFN1YnRyZWVzW2pdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgcCA9IDA7IHAgPCA1OyBwKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGdyb3VwUGVybWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZUV4aXN0cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBncm91cCA9IGNvbnN0ckdyb3Vwc1twXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBncm91cC5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViamVjdEFsdE5hbWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgc3ViamVjdEFsdE5hbWVzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YmplY3RBbHROYW1lc1trXS50eXBlID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlRXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBQZXJtaXR0ZWQgPSBncm91cFBlcm1pdHRlZCB8fCBjb21wYXJlUkZDODIyTmFtZShzdWJqZWN0QWx0TmFtZXNba10udmFsdWUsIGdyb3VwW2pdLmJhc2UudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgY2VydC5zdWJqZWN0LnR5cGVzQW5kVmFsdWVzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChjZXJ0LnN1YmplY3QudHlwZXNBbmRWYWx1ZXNba10udHlwZSA9PT0gXCIxLjIuODQwLjExMzU0OS4xLjkuMVwiKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY2VydC5zdWJqZWN0LnR5cGVzQW5kVmFsdWVzW2tdLnR5cGUgPT09IFwiMC45LjIzNDIuMTkyMDAzMDAuMTAwLjEuM1wiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUV4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwUGVybWl0dGVkID0gZ3JvdXBQZXJtaXR0ZWQgfHwgY29tcGFyZVJGQzgyMk5hbWUoY2VydC5zdWJqZWN0LnR5cGVzQW5kVmFsdWVzW2tdLnZhbHVlLnZhbHVlQmxvY2sudmFsdWUsIGdyb3VwW2pdLmJhc2UudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzdWJqZWN0QWx0TmFtZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViamVjdEFsdE5hbWVzW2tdLnR5cGUgPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVFeGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cFBlcm1pdHRlZCA9IGdyb3VwUGVybWl0dGVkIHx8IGNvbXBhcmVETlNOYW1lKHN1YmplY3RBbHROYW1lc1trXS52YWx1ZSwgZ3JvdXBbal0uYmFzZS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVFeGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cFBlcm1pdHRlZCA9IGNvbXBhcmVEaXJlY3RvcnlOYW1lKGNlcnQuc3ViamVjdCwgZ3JvdXBbal0uYmFzZS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YmplY3RBbHROYW1lcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHN1YmplY3RBbHROYW1lcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXNba10udHlwZSA9PT0gNikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUV4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwUGVybWl0dGVkID0gZ3JvdXBQZXJtaXR0ZWQgfHwgY29tcGFyZVVuaWZvcm1SZXNvdXJjZUlkZW50aWZpZXIoc3ViamVjdEFsdE5hbWVzW2tdLnZhbHVlLCBncm91cFtqXS5iYXNlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViamVjdEFsdE5hbWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgc3ViamVjdEFsdE5hbWVzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YmplY3RBbHROYW1lc1trXS50eXBlID09PSA3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlRXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBQZXJtaXR0ZWQgPSBncm91cFBlcm1pdHRlZCB8fCBjb21wYXJlSVBBZGRyZXNzKHN1YmplY3RBbHROYW1lc1trXS52YWx1ZSwgZ3JvdXBbal0uYmFzZS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXBQZXJtaXR0ZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKChncm91cFBlcm1pdHRlZCA9PT0gZmFsc2UpICYmIChncm91cC5sZW5ndGggPiAwKSAmJiB2YWx1ZUV4aXN0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVzdWx0LnJlc3VsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVzdWx0LnJlc3VsdENvZGUgPSA0MTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvbGljeVJlc3VsdC5yZXN1bHRNZXNzYWdlID0gXCJGYWlsZWQgdG8gbWVldCBcXFwicGVybWl0dGVkIHN1Yi10cmVlc1xcXCIgbmFtZSBjb25zdHJhaW50XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBwb2xpY3lSZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IGV4Y2x1ZGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBleGNsdWRlZFN1YnRyZWVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZXhjbHVkZWRTdWJ0cmVlc1tqXS5iYXNlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViamVjdEFsdE5hbWVzLmxlbmd0aCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgc3ViamVjdEFsdE5hbWVzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViamVjdEFsdE5hbWVzW2tdLnR5cGUgPT09IDEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZWQgPSBleGNsdWRlZCB8fCBjb21wYXJlUkZDODIyTmFtZShzdWJqZWN0QWx0TmFtZXNba10udmFsdWUsIGV4Y2x1ZGVkU3VidHJlZXNbal0uYmFzZS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgY2VydC5zdWJqZWN0LnR5cGVzQW5kVmFsdWVzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGNlcnQuc3ViamVjdC50eXBlc0FuZFZhbHVlc1trXS50eXBlID09PSBcIjEuMi44NDAuMTEzNTQ5LjEuOS4xXCIpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNlcnQuc3ViamVjdC50eXBlc0FuZFZhbHVlc1trXS50eXBlID09PSBcIjAuOS4yMzQyLjE5MjAwMzAwLjEwMC4xLjNcIikpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZWQgPSBleGNsdWRlZCB8fCBjb21wYXJlUkZDODIyTmFtZShjZXJ0LnN1YmplY3QudHlwZXNBbmRWYWx1ZXNba10udmFsdWUudmFsdWVCbG9jay52YWx1ZSwgZXhjbHVkZWRTdWJ0cmVlc1tqXS5iYXNlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViamVjdEFsdE5hbWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzdWJqZWN0QWx0TmFtZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXNba10udHlwZSA9PT0gMilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlZCA9IGV4Y2x1ZGVkIHx8IGNvbXBhcmVETlNOYW1lKHN1YmplY3RBbHROYW1lc1trXS52YWx1ZSwgZXhjbHVkZWRTdWJ0cmVlc1tqXS5iYXNlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlZCA9IGV4Y2x1ZGVkIHx8IGNvbXBhcmVEaXJlY3RvcnlOYW1lKGNlcnQuc3ViamVjdCwgZXhjbHVkZWRTdWJ0cmVlc1tqXS5iYXNlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViamVjdEFsdE5hbWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzdWJqZWN0QWx0TmFtZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXNba10udHlwZSA9PT0gNilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlZCA9IGV4Y2x1ZGVkIHx8IGNvbXBhcmVVbmlmb3JtUmVzb3VyY2VJZGVudGlmaWVyKHN1YmplY3RBbHROYW1lc1trXS52YWx1ZSwgZXhjbHVkZWRTdWJ0cmVlc1tqXS5iYXNlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViamVjdEFsdE5hbWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBzdWJqZWN0QWx0TmFtZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0QWx0TmFtZXNba10udHlwZSA9PT0gNylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlZCA9IGV4Y2x1ZGVkIHx8IGNvbXBhcmVJUEFkZHJlc3Moc3ViamVjdEFsdE5hbWVzW2tdLnZhbHVlLCBleGNsdWRlZFN1YnRyZWVzW2pdLmJhc2UudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGV4Y2x1ZGVkID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbGljeVJlc3VsdC5yZXN1bHQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVzdWx0LnJlc3VsdENvZGUgPSA0MjtcbiAgICAgICAgICAgICAgICAgICAgcG9saWN5UmVzdWx0LnJlc3VsdE1lc3NhZ2UgPSBcIkZhaWxlZCB0byBtZWV0IFxcXCJleGNsdWRlZCBzdWItdHJlZXNcXFwiIG5hbWUgY29uc3RyYWludFwiO1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBwb2xpY3lSZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBlcm1pdHRlZFN1YnRyZWVzID0gcGVybWl0dGVkU3VidHJlZXMuY29uY2F0KGNlcnRQZXJtaXR0ZWRTdWJ0cmVlcyk7XG4gICAgICAgICAgICAgICAgZXhjbHVkZWRTdWJ0cmVlcyA9IGV4Y2x1ZGVkU3VidHJlZXMuY29uY2F0KGNlcnRFeGNsdWRlZFN1YnRyZWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwb2xpY3lSZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIENoYWluVmFsaWRhdGlvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q29kZTogZXJyb3IuY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IENoYWluVmFsaWRhdGlvbkNvZGUudW5rbm93bixcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0TWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXJyb3IgJiYgdHlwZW9mIGVycm9yID09PSBcIm9iamVjdFwiICYmIFwicmVzdWx0TWVzc2FnZVwiIGluIGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHJlc3VsdENvZGU6IC0xLFxuICAgICAgICAgICAgICAgIHJlc3VsdE1lc3NhZ2U6IGAke2Vycm9yfWAsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxufVxuXG5jb25zdCBUQlNfUkVTUE9OU0VfREFUQSA9IFwidGJzUmVzcG9uc2VEYXRhXCI7XG5jb25zdCBTSUdOQVRVUkVfQUxHT1JJVEhNJDMgPSBcInNpZ25hdHVyZUFsZ29yaXRobVwiO1xuY29uc3QgU0lHTkFUVVJFJDIgPSBcInNpZ25hdHVyZVwiO1xuY29uc3QgQ0VSVFMkMSA9IFwiY2VydHNcIjtcbmNvbnN0IEJBU0lDX09DU1BfUkVTUE9OU0UgPSBcIkJhc2ljT0NTUFJlc3BvbnNlXCI7XG5jb25zdCBCQVNJQ19PQ1NQX1JFU1BPTlNFX1RCU19SRVNQT05TRV9EQVRBID0gYCR7QkFTSUNfT0NTUF9SRVNQT05TRX0uJHtUQlNfUkVTUE9OU0VfREFUQX1gO1xuY29uc3QgQkFTSUNfT0NTUF9SRVNQT05TRV9TSUdOQVRVUkVfQUxHT1JJVEhNID0gYCR7QkFTSUNfT0NTUF9SRVNQT05TRX0uJHtTSUdOQVRVUkVfQUxHT1JJVEhNJDN9YDtcbmNvbnN0IEJBU0lDX09DU1BfUkVTUE9OU0VfU0lHTkFUVVJFID0gYCR7QkFTSUNfT0NTUF9SRVNQT05TRX0uJHtTSUdOQVRVUkUkMn1gO1xuY29uc3QgQkFTSUNfT0NTUF9SRVNQT05TRV9DRVJUUyA9IGAke0JBU0lDX09DU1BfUkVTUE9OU0V9LiR7Q0VSVFMkMX1gO1xuY29uc3QgQ0xFQVJfUFJPUFMkZyA9IFtcbiAgICBCQVNJQ19PQ1NQX1JFU1BPTlNFX1RCU19SRVNQT05TRV9EQVRBLFxuICAgIEJBU0lDX09DU1BfUkVTUE9OU0VfU0lHTkFUVVJFX0FMR09SSVRITSxcbiAgICBCQVNJQ19PQ1NQX1JFU1BPTlNFX1NJR05BVFVSRSxcbiAgICBCQVNJQ19PQ1NQX1JFU1BPTlNFX0NFUlRTXG5dO1xuY2xhc3MgQmFzaWNPQ1NQUmVzcG9uc2UgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnRic1Jlc3BvbnNlRGF0YSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFRCU19SRVNQT05TRV9EQVRBLCBCYXNpY09DU1BSZXNwb25zZS5kZWZhdWx0VmFsdWVzKFRCU19SRVNQT05TRV9EQVRBKSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFX0FMR09SSVRITSQzLCBCYXNpY09DU1BSZXNwb25zZS5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRV9BTEdPUklUSE0kMykpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRSQyLCBCYXNpY09DU1BSZXNwb25zZS5kZWZhdWx0VmFsdWVzKFNJR05BVFVSRSQyKSk7XG4gICAgICAgIGlmIChDRVJUUyQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuY2VydHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDRVJUUyQxLCBCYXNpY09DU1BSZXNwb25zZS5kZWZhdWx0VmFsdWVzKENFUlRTJDEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVEJTX1JFU1BPTlNFX0RBVEE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZURhdGEoKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX0FMR09SSVRITSQzOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkUkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgQ0VSVFMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFwidHlwZVwiOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbXBhcmlzb25SZXN1bHQgPSAoKFJlc3BvbnNlRGF0YS5jb21wYXJlV2l0aERlZmF1bHQoXCJ0YnNcIiwgbWVtYmVyVmFsdWUudGJzKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIChSZXNwb25zZURhdGEuY29tcGFyZVdpdGhEZWZhdWx0KFwicmVzcG9uZGVySURcIiwgbWVtYmVyVmFsdWUucmVzcG9uZGVySUQpKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKFJlc3BvbnNlRGF0YS5jb21wYXJlV2l0aERlZmF1bHQoXCJwcm9kdWNlZEF0XCIsIG1lbWJlclZhbHVlLnByb2R1Y2VkQXQpKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKFJlc3BvbnNlRGF0YS5jb21wYXJlV2l0aERlZmF1bHQoXCJyZXNwb25zZXNcIiwgbWVtYmVyVmFsdWUucmVzcG9uc2VzKSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoXCJyZXNwb25zZUV4dGVuc2lvbnNcIiBpbiBtZW1iZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhcmlzb25SZXN1bHQgPSBjb21wYXJpc29uUmVzdWx0ICYmIChSZXNwb25zZURhdGEuY29tcGFyZVdpdGhEZWZhdWx0KFwicmVzcG9uc2VFeHRlbnNpb25zXCIsIG1lbWJlclZhbHVlLnJlc3BvbnNlRXh0ZW5zaW9ucykpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyaXNvblJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRV9BTEdPUklUSE0kMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChtZW1iZXJWYWx1ZS5hbGdvcml0aG1JZCA9PT0gRU1QVFlfU1RSSU5HKSAmJiAoKFwiYWxnb3JpdGhtUGFyYW1zXCIgaW4gbWVtYmVyVmFsdWUpID09PSBmYWxzZSkpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkUkMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoQmFzaWNPQ1NQUmVzcG9uc2UuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSkpO1xuICAgICAgICAgICAgY2FzZSBDRVJUUyQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgQkFTSUNfT0NTUF9SRVNQT05TRSksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIFJlc3BvbnNlRGF0YS5zY2hlbWEobmFtZXMudGJzUmVzcG9uc2VEYXRhIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQkFTSUNfT0NTUF9SRVNQT05TRV9UQlNfUkVTUE9OU0VfREFUQVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2lnbmF0dXJlQWxnb3JpdGhtIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQkFTSUNfT0NTUF9SRVNQT05TRV9TSUdOQVRVUkVfQUxHT1JJVEhNXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5zaWduYXR1cmUgfHwgQkFTSUNfT0NTUF9SRVNQT05TRV9TSUdOQVRVUkUpIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBCQVNJQ19PQ1NQX1JFU1BPTlNFX0NFUlRTLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IENlcnRpZmljYXRlLnNjaGVtYShuYW1lcy5jZXJ0cyB8fCB7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSldXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRnKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBCYXNpY09DU1BSZXNwb25zZS5zY2hlbWEoKSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudGJzUmVzcG9uc2VEYXRhID0gbmV3IFJlc3BvbnNlRGF0YSh7IHNjaGVtYTogYXNuMS5yZXN1bHRbQkFTSUNfT0NTUF9SRVNQT05TRV9UQlNfUkVTUE9OU0VfREFUQV0gfSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0W0JBU0lDX09DU1BfUkVTUE9OU0VfU0lHTkFUVVJFX0FMR09SSVRITV0gfSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlID0gYXNuMS5yZXN1bHRbQkFTSUNfT0NTUF9SRVNQT05TRV9TSUdOQVRVUkVdO1xuICAgICAgICBpZiAoQkFTSUNfT0NTUF9SRVNQT05TRV9DRVJUUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5jZXJ0cyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbQkFTSUNfT0NTUF9SRVNQT05TRV9DRVJUU10sIGVsZW1lbnQgPT4gbmV3IENlcnRpZmljYXRlKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnRic1Jlc3BvbnNlRGF0YS50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25hdHVyZSk7XG4gICAgICAgIGlmICh0aGlzLmNlcnRzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmNlcnRzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgdGJzUmVzcG9uc2VEYXRhOiB0aGlzLnRic1Jlc3BvbnNlRGF0YS50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobTogdGhpcy5zaWduYXR1cmVBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBzaWduYXR1cmU6IHRoaXMuc2lnbmF0dXJlLnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5jZXJ0cykge1xuICAgICAgICAgICAgcmVzLmNlcnRzID0gQXJyYXkuZnJvbSh0aGlzLmNlcnRzLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuICAgIGFzeW5jIGdldENlcnRpZmljYXRlU3RhdHVzKGNlcnRpZmljYXRlLCBpc3N1ZXJDZXJ0aWZpY2F0ZSwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgIGlzRm9yQ2VydGlmaWNhdGU6IGZhbHNlLFxuICAgICAgICAgICAgc3RhdHVzOiAyXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGhhc2hlc09iamVjdCA9IHt9O1xuICAgICAgICBjb25zdCBjZXJ0SURzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgcmVzcG9uc2Ugb2YgdGhpcy50YnNSZXNwb25zZURhdGEucmVzcG9uc2VzKSB7XG4gICAgICAgICAgICBjb25zdCBoYXNoQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHJlc3BvbnNlLmNlcnRJRC5oYXNoQWxnb3JpdGhtLmFsZ29yaXRobUlkLCB0cnVlLCBcIkNlcnRJRC5oYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgaWYgKCFoYXNoZXNPYmplY3RbaGFzaEFsZ29yaXRobS5uYW1lXSkge1xuICAgICAgICAgICAgICAgIGhhc2hlc09iamVjdFtoYXNoQWxnb3JpdGhtLm5hbWVdID0gMTtcbiAgICAgICAgICAgICAgICBjb25zdCBjZXJ0SUQgPSBuZXcgQ2VydElEKCk7XG4gICAgICAgICAgICAgICAgY2VydElEcy5wdXNoKGNlcnRJRCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgY2VydElELmNyZWF0ZUZvckNlcnRpZmljYXRlKGNlcnRpZmljYXRlLCB7XG4gICAgICAgICAgICAgICAgICAgIGhhc2hBbGdvcml0aG06IGhhc2hBbGdvcml0aG0ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgaXNzdWVyQ2VydGlmaWNhdGVcbiAgICAgICAgICAgICAgICB9LCBjcnlwdG8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgcmVzcG9uc2Ugb2YgdGhpcy50YnNSZXNwb25zZURhdGEucmVzcG9uc2VzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIGNlcnRJRHMpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuY2VydElELmlzRXF1YWwoaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5pc0ZvckNlcnRpZmljYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocmVzcG9uc2UuY2VydFN0YXR1cy5pZEJsb2NrLmlzQ29uc3RydWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIHRydWU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5jZXJ0U3RhdHVzLmlkQmxvY2sudGFnTnVtYmVyID09PSAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnN0YXR1cyA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgZmFsc2U6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocmVzcG9uc2UuY2VydFN0YXR1cy5pZEJsb2NrLnRhZ051bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zdGF0dXMgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zdGF0dXMgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGFzeW5jIHNpZ24ocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSA9IFwiU0hBLTFcIiwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIGlmICghcHJpdmF0ZUtleSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTmVlZCB0byBwcm92aWRlIGEgcHJpdmF0ZSBrZXkgZm9yIHNpZ25pbmdcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlUGFyYW1zID0gYXdhaXQgY3J5cHRvLmdldFNpZ25hdHVyZVBhcmFtZXRlcnMocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSk7XG4gICAgICAgIGNvbnN0IGFsZ29yaXRobSA9IHNpZ25hdHVyZVBhcmFtcy5wYXJhbWV0ZXJzLmFsZ29yaXRobTtcbiAgICAgICAgaWYgKCEoXCJuYW1lXCIgaW4gYWxnb3JpdGhtKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRW1wdHkgYWxnb3JpdGhtXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gc2lnbmF0dXJlUGFyYW1zLnNpZ25hdHVyZUFsZ29yaXRobTtcbiAgICAgICAgdGhpcy50YnNSZXNwb25zZURhdGEudGJzVmlldyA9IG5ldyBVaW50OEFycmF5KHRoaXMudGJzUmVzcG9uc2VEYXRhLnRvU2NoZW1hKHRydWUpLnRvQkVSKCkpO1xuICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBjcnlwdG8uc2lnbldpdGhQcml2YXRlS2V5KHRoaXMudGJzUmVzcG9uc2VEYXRhLnRic1ZpZXcsIHByaXZhdGVLZXksIHsgYWxnb3JpdGhtIH0pO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZSA9IG5ldyBhc24xanMuQml0U3RyaW5nKHsgdmFsdWVIZXg6IHNpZ25hdHVyZSB9KTtcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5KHBhcmFtcyA9IHt9LCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgbGV0IHNpZ25lckNlcnQgPSBudWxsO1xuICAgICAgICBsZXQgY2VydEluZGV4ID0gLTE7XG4gICAgICAgIGNvbnN0IHRydXN0ZWRDZXJ0cyA9IHBhcmFtcy50cnVzdGVkQ2VydHMgfHwgW107XG4gICAgICAgIGlmICghdGhpcy5jZXJ0cykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gY2VydGlmaWNhdGVzIGF0dGFjaGVkIHRvIHRoZSBCYXNpY09DU1BSZXNwb25zZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgICAgICAgIGNhc2UgKHRoaXMudGJzUmVzcG9uc2VEYXRhLnJlc3BvbmRlcklEIGluc3RhbmNlb2YgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMpOlxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2luZGV4LCBjZXJ0aWZpY2F0ZV0gb2YgdGhpcy5jZXJ0cy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNlcnRpZmljYXRlLnN1YmplY3QuaXNFcXVhbCh0aGlzLnRic1Jlc3BvbnNlRGF0YS5yZXNwb25kZXJJRCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICh0aGlzLnRic1Jlc3BvbnNlRGF0YS5yZXNwb25kZXJJRCBpbnN0YW5jZW9mIGFzbjFqcy5PY3RldFN0cmluZyk6XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBbaW5kZXgsIGNlcnRdIG9mIHRoaXMuY2VydHMuZW50cmllcygpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGhhc2ggPSBhd2FpdCBjcnlwdG8uZGlnZXN0KHsgbmFtZTogXCJzaGEtMVwiIH0sIGNlcnQuc3ViamVjdFB1YmxpY0tleUluZm8uc3ViamVjdFB1YmxpY0tleS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwdnV0aWxzLmlzRXF1YWxCdWZmZXIoaGFzaCwgdGhpcy50YnNSZXNwb25zZURhdGEucmVzcG9uZGVySUQudmFsdWVCbG9jay52YWx1ZUhleCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIldyb25nIHZhbHVlIGZvciByZXNwb25kZXJJRFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2VydEluZGV4ID09PSAoLTEpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ29ycmVjdCBjZXJ0aWZpY2F0ZSB3YXMgbm90IGZvdW5kIGluIE9DU1AgcmVzcG9uc2VcIik7XG4gICAgICAgIHNpZ25lckNlcnQgPSB0aGlzLmNlcnRzW2NlcnRJbmRleF07XG4gICAgICAgIGNvbnN0IGFkZGl0aW9uYWxDZXJ0cyA9IFtzaWduZXJDZXJ0XTtcbiAgICAgICAgZm9yIChjb25zdCBjZXJ0IG9mIHRoaXMuY2VydHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGNhQ2VydCA9IGF3YWl0IGNoZWNrQ0EoY2VydCwgc2lnbmVyQ2VydCk7XG4gICAgICAgICAgICBpZiAoY2FDZXJ0KSB7XG4gICAgICAgICAgICAgICAgYWRkaXRpb25hbENlcnRzLnB1c2goY2FDZXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjZXJ0Q2hhaW4gPSBuZXcgQ2VydGlmaWNhdGVDaGFpblZhbGlkYXRpb25FbmdpbmUoe1xuICAgICAgICAgICAgY2VydHM6IGFkZGl0aW9uYWxDZXJ0cyxcbiAgICAgICAgICAgIHRydXN0ZWRDZXJ0cyxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvblJlc3VsdCA9IGF3YWl0IGNlcnRDaGFpbi52ZXJpZnkoe30sIGNyeXB0byk7XG4gICAgICAgIGlmICghdmVyaWZpY2F0aW9uUmVzdWx0LnJlc3VsdCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsaWRhdGlvbiBvZiBzaWduZXIncyBjZXJ0aWZpY2F0ZSBmYWlsZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyeXB0by52ZXJpZnlXaXRoUHVibGljS2V5KHRoaXMudGJzUmVzcG9uc2VEYXRhLnRic1ZpZXcsIHRoaXMuc2lnbmF0dXJlLCB0aGlzLmNlcnRzW2NlcnRJbmRleF0uc3ViamVjdFB1YmxpY0tleUluZm8sIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtKTtcbiAgICB9XG59XG5CYXNpY09DU1BSZXNwb25zZS5DTEFTU19OQU1FID0gXCJCYXNpY09DU1BSZXNwb25zZVwiO1xuXG5jb25zdCBUQlMkMSA9IFwidGJzXCI7XG5jb25zdCBWRVJTSU9OJDYgPSBcInZlcnNpb25cIjtcbmNvbnN0IFNVQkpFQ1QgPSBcInN1YmplY3RcIjtcbmNvbnN0IFNQS0kgPSBcInN1YmplY3RQdWJsaWNLZXlJbmZvXCI7XG5jb25zdCBBVFRSSUJVVEVTJDEgPSBcImF0dHJpYnV0ZXNcIjtcbmNvbnN0IFNJR05BVFVSRV9BTEdPUklUSE0kMiA9IFwic2lnbmF0dXJlQWxnb3JpdGhtXCI7XG5jb25zdCBTSUdOQVRVUkVfVkFMVUUgPSBcInNpZ25hdHVyZVZhbHVlXCI7XG5jb25zdCBDU1JfSU5GTyA9IFwiQ2VydGlmaWNhdGlvblJlcXVlc3RJbmZvXCI7XG5jb25zdCBDU1JfSU5GT19WRVJTSU9OID0gYCR7Q1NSX0lORk99LnZlcnNpb25gO1xuY29uc3QgQ1NSX0lORk9fU1VCSkVDVCA9IGAke0NTUl9JTkZPfS5zdWJqZWN0YDtcbmNvbnN0IENTUl9JTkZPX1NQS0kgPSBgJHtDU1JfSU5GT30uc3ViamVjdFB1YmxpY0tleUluZm9gO1xuY29uc3QgQ1NSX0lORk9fQVRUUlMgPSBgJHtDU1JfSU5GT30uYXR0cmlidXRlc2A7XG5jb25zdCBDTEVBUl9QUk9QUyRmID0gW1xuICAgIENTUl9JTkZPLFxuICAgIENTUl9JTkZPX1ZFUlNJT04sXG4gICAgQ1NSX0lORk9fU1VCSkVDVCxcbiAgICBDU1JfSU5GT19TUEtJLFxuICAgIENTUl9JTkZPX0FUVFJTLFxuICAgIFNJR05BVFVSRV9BTEdPUklUSE0kMixcbiAgICBTSUdOQVRVUkVfVkFMVUVcbl07XG5mdW5jdGlvbiBDZXJ0aWZpY2F0aW9uUmVxdWVzdEluZm8ocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICBuYW1lOiAobmFtZXMuQ2VydGlmaWNhdGlvblJlcXVlc3RJbmZvIHx8IENTUl9JTkZPKSxcbiAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5DZXJ0aWZpY2F0aW9uUmVxdWVzdEluZm9WZXJzaW9uIHx8IENTUl9JTkZPX1ZFUlNJT04pIH0pLFxuICAgICAgICAgICAgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMuc2NoZW1hKG5hbWVzLnN1YmplY3QgfHwge1xuICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQ1NSX0lORk9fU1VCSkVDVFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgUHVibGljS2V5SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQ1NSX0lORk9fU1BLSVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLkNlcnRpZmljYXRpb25SZXF1ZXN0SW5mb0F0dHJpYnV0ZXMgfHwgQ1NSX0lORk9fQVRUUlMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEF0dHJpYnV0ZS5zY2hlbWEobmFtZXMuYXR0cmlidXRlcyB8fCB7fSlcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KVxuICAgICAgICBdXG4gICAgfSkpO1xufVxuY2xhc3MgQ2VydGlmaWNhdGlvblJlcXVlc3QgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGdldCB0YnMoKSB7XG4gICAgICAgIHJldHVybiBwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLnRvQXJyYXlCdWZmZXIodGhpcy50YnNWaWV3KTtcbiAgICB9XG4gICAgc2V0IHRicyh2YWx1ZSkge1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBuZXcgVWludDhBcnJheSh2YWx1ZSk7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBuZXcgVWludDhBcnJheShwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBUQlMkMSwgQ2VydGlmaWNhdGlvblJlcXVlc3QuZGVmYXVsdFZhbHVlcyhUQlMkMSkpKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiQ2LCBDZXJ0aWZpY2F0aW9uUmVxdWVzdC5kZWZhdWx0VmFsdWVzKFZFUlNJT04kNikpO1xuICAgICAgICB0aGlzLnN1YmplY3QgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTVUJKRUNULCBDZXJ0aWZpY2F0aW9uUmVxdWVzdC5kZWZhdWx0VmFsdWVzKFNVQkpFQ1QpKTtcbiAgICAgICAgdGhpcy5zdWJqZWN0UHVibGljS2V5SW5mbyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNQS0ksIENlcnRpZmljYXRpb25SZXF1ZXN0LmRlZmF1bHRWYWx1ZXMoU1BLSSkpO1xuICAgICAgICBpZiAoQVRUUklCVVRFUyQxIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFUVFJJQlVURVMkMSwgQ2VydGlmaWNhdGlvblJlcXVlc3QuZGVmYXVsdFZhbHVlcyhBVFRSSUJVVEVTJDEpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9BTEdPUklUSE0kMiwgQ2VydGlmaWNhdGlvblJlcXVlc3QuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfQUxHT1JJVEhNJDIpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVWYWx1ZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9WQUxVRSwgQ2VydGlmaWNhdGlvblJlcXVlc3QuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfVkFMVUUpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRCUyQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9CVUZGRVI7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kNjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgU1VCSkVDVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWVzKCk7XG4gICAgICAgICAgICBjYXNlIFNQS0k6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQdWJsaWNLZXlJbmZvKCk7XG4gICAgICAgICAgICBjYXNlIEFUVFJJQlVURVMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIFNJR05BVFVSRV9BTEdPUklUSE0kMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBDZXJ0aWZpY2F0aW9uUmVxdWVzdEluZm8obmFtZXMuY2VydGlmaWNhdGlvblJlcXVlc3RJbmZvIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnNpZ25hdHVyZUFsZ29yaXRobSB8fCBTSUdOQVRVUkVfQUxHT1JJVEhNJDIpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkFueSh7IG9wdGlvbmFsOiB0cnVlIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5zaWduYXR1cmVWYWx1ZSB8fCBTSUdOQVRVUkVfVkFMVUUpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkZik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgQ2VydGlmaWNhdGlvblJlcXVlc3Quc2NoZW1hKCkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBhc24xLnJlc3VsdC5DZXJ0aWZpY2F0aW9uUmVxdWVzdEluZm8udmFsdWVCZWZvcmVEZWNvZGVWaWV3O1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdFtDU1JfSU5GT19WRVJTSU9OXS52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLnN1YmplY3QgPSBuZXcgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZXMoeyBzY2hlbWE6IGFzbjEucmVzdWx0W0NTUl9JTkZPX1NVQkpFQ1RdIH0pO1xuICAgICAgICB0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvID0gbmV3IFB1YmxpY0tleUluZm8oeyBzY2hlbWE6IGFzbjEucmVzdWx0W0NTUl9JTkZPX1NQS0ldIH0pO1xuICAgICAgICBpZiAoQ1NSX0lORk9fQVRUUlMgaW4gYXNuMS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbQ1NSX0lORk9fQVRUUlNdLCBlbGVtZW50ID0+IG5ldyBBdHRyaWJ1dGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LnNpZ25hdHVyZUFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVWYWx1ZSA9IGFzbjEucmVzdWx0LnNpZ25hdHVyZVZhbHVlO1xuICAgIH1cbiAgICBlbmNvZGVUQlMoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW1xuICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KSxcbiAgICAgICAgICAgIHRoaXMuc3ViamVjdC50b1NjaGVtYSgpLFxuICAgICAgICAgICAgdGhpcy5zdWJqZWN0UHVibGljS2V5SW5mby50b1NjaGVtYSgpXG4gICAgICAgIF07XG4gICAgICAgIGlmIChBVFRSSUJVVEVTJDEgaW4gdGhpcykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuYXR0cmlidXRlcyB8fCBbXSwgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKGVuY29kZUZsYWcgPSBmYWxzZSkge1xuICAgICAgICBsZXQgdGJzU2NoZW1hO1xuICAgICAgICBpZiAoZW5jb2RlRmxhZyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRic1ZpZXcuYnl0ZUxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBDZXJ0aWZpY2F0aW9uUmVxdWVzdC5zY2hlbWEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuZnJvbUJFUih0aGlzLnRic1ZpZXcpO1xuICAgICAgICAgICAgQXNuRXJyb3IuYXNzZXJ0KGFzbjEsIFwiUEtDUyMxMCBDZXJ0aWZpY2F0ZSBSZXF1ZXN0XCIpO1xuICAgICAgICAgICAgdGJzU2NoZW1hID0gYXNuMS5yZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0YnNTY2hlbWEgPSB0aGlzLmVuY29kZVRCUygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIHRic1NjaGVtYSxcbiAgICAgICAgICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuc2lnbmF0dXJlVmFsdWVcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IHtcbiAgICAgICAgICAgIHRiczogcHZ0c3V0aWxzLkNvbnZlcnQuVG9IZXgodGhpcy50YnNWaWV3KSxcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIHN1YmplY3Q6IHRoaXMuc3ViamVjdC50b0pTT04oKSxcbiAgICAgICAgICAgIHN1YmplY3RQdWJsaWNLZXlJbmZvOiB0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvLnRvSlNPTigpLFxuICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtOiB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZVZhbHVlOiB0aGlzLnNpZ25hdHVyZVZhbHVlLnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAoQVRUUklCVVRFUyQxIGluIHRoaXMpIHtcbiAgICAgICAgICAgIG9iamVjdC5hdHRyaWJ1dGVzID0gQXJyYXkuZnJvbSh0aGlzLmF0dHJpYnV0ZXMgfHwgW10sIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9XG4gICAgYXN5bmMgc2lnbihwcml2YXRlS2V5LCBoYXNoQWxnb3JpdGhtID0gXCJTSEEtMVwiLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgaWYgKCFwcml2YXRlS2V5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOZWVkIHRvIHByb3ZpZGUgYSBwcml2YXRlIGtleSBmb3Igc2lnbmluZ1wiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzaWduYXR1cmVQYXJhbXMgPSBhd2FpdCBjcnlwdG8uZ2V0U2lnbmF0dXJlUGFyYW1ldGVycyhwcml2YXRlS2V5LCBoYXNoQWxnb3JpdGhtKTtcbiAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHNpZ25hdHVyZVBhcmFtcy5wYXJhbWV0ZXJzO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHNpZ25hdHVyZVBhcmFtcy5zaWduYXR1cmVBbGdvcml0aG07XG4gICAgICAgIHRoaXMudGJzVmlldyA9IG5ldyBVaW50OEFycmF5KHRoaXMuZW5jb2RlVEJTKCkudG9CRVIoKSk7XG4gICAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IGNyeXB0by5zaWduV2l0aFByaXZhdGVLZXkodGhpcy50YnNWaWV3LCBwcml2YXRlS2V5LCBwYXJhbWV0ZXJzKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVWYWx1ZSA9IG5ldyBhc24xanMuQml0U3RyaW5nKHsgdmFsdWVIZXg6IHNpZ25hdHVyZSB9KTtcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5KGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICByZXR1cm4gY3J5cHRvLnZlcmlmeVdpdGhQdWJsaWNLZXkodGhpcy50YnNWaWV3LCB0aGlzLnNpZ25hdHVyZVZhbHVlLCB0aGlzLnN1YmplY3RQdWJsaWNLZXlJbmZvLCB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSk7XG4gICAgfVxuICAgIGFzeW5jIGdldFB1YmxpY0tleShwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGNyeXB0by5nZXRQdWJsaWNLZXkodGhpcy5zdWJqZWN0UHVibGljS2V5SW5mbywgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0sIHBhcmFtZXRlcnMpO1xuICAgIH1cbn1cbkNlcnRpZmljYXRpb25SZXF1ZXN0LkNMQVNTX05BTUUgPSBcIkNlcnRpZmljYXRpb25SZXF1ZXN0XCI7XG5cbmNvbnN0IERJR0VTVF9BTEdPUklUSE0kMSA9IFwiZGlnZXN0QWxnb3JpdGhtXCI7XG5jb25zdCBESUdFU1QgPSBcImRpZ2VzdFwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkZSA9IFtcbiAgICBESUdFU1RfQUxHT1JJVEhNJDEsXG4gICAgRElHRVNUXG5dO1xuY2xhc3MgRGlnZXN0SW5mbyBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZGlnZXN0QWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRElHRVNUX0FMR09SSVRITSQxLCBEaWdlc3RJbmZvLmRlZmF1bHRWYWx1ZXMoRElHRVNUX0FMR09SSVRITSQxKSk7XG4gICAgICAgIHRoaXMuZGlnZXN0ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRElHRVNULCBEaWdlc3RJbmZvLmRlZmF1bHRWYWx1ZXMoRElHRVNUKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBESUdFU1RfQUxHT1JJVEhNJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKCk7XG4gICAgICAgICAgICBjYXNlIERJR0VTVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBESUdFU1RfQUxHT1JJVEhNJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoQWxnb3JpdGhtSWRlbnRpZmllci5jb21wYXJlV2l0aERlZmF1bHQoXCJhbGdvcml0aG1JZFwiLCBtZW1iZXJWYWx1ZS5hbGdvcml0aG1JZCkpICYmXG4gICAgICAgICAgICAgICAgICAgICgoXCJhbGdvcml0aG1QYXJhbXNcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIERJR0VTVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoRGlnZXN0SW5mby5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIEFsZ29yaXRobUlkZW50aWZpZXIuc2NoZW1hKG5hbWVzLmRpZ2VzdEFsZ29yaXRobSB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IERJR0VTVF9BTEdPUklUSE0kMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5kaWdlc3QgfHwgRElHRVNUKSB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJGUpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIERpZ2VzdEluZm8uc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgZGlnZXN0QWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IERJR0VTVF9BTEdPUklUSE0kMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkaWdlc3Q6IERJR0VTVFxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuZGlnZXN0QWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0LmRpZ2VzdEFsZ29yaXRobSB9KTtcbiAgICAgICAgdGhpcy5kaWdlc3QgPSBhc24xLnJlc3VsdC5kaWdlc3Q7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICB0aGlzLmRpZ2VzdEFsZ29yaXRobS50b1NjaGVtYSgpLFxuICAgICAgICAgICAgICAgIHRoaXMuZGlnZXN0XG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGlnZXN0QWxnb3JpdGhtOiB0aGlzLmRpZ2VzdEFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIGRpZ2VzdDogdGhpcy5kaWdlc3QudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgfVxufVxuRGlnZXN0SW5mby5DTEFTU19OQU1FID0gXCJEaWdlc3RJbmZvXCI7XG5cbmNvbnN0IEVfQ09OVEVOVF9UWVBFID0gXCJlQ29udGVudFR5cGVcIjtcbmNvbnN0IEVfQ09OVEVOVCA9IFwiZUNvbnRlbnRcIjtcbmNvbnN0IENMRUFSX1BST1BTJGQgPSBbXG4gICAgRV9DT05URU5UX1RZUEUsXG4gICAgRV9DT05URU5ULFxuXTtcbmNsYXNzIEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5lQ29udGVudFR5cGUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFX0NPTlRFTlRfVFlQRSwgRW5jYXBzdWxhdGVkQ29udGVudEluZm8uZGVmYXVsdFZhbHVlcyhFX0NPTlRFTlRfVFlQRSkpO1xuICAgICAgICBpZiAoRV9DT05URU5UIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZUNvbnRlbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFX0NPTlRFTlQsIEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvLmRlZmF1bHRWYWx1ZXMoRV9DT05URU5UKSk7XG4gICAgICAgICAgICBpZiAoKHRoaXMuZUNvbnRlbnQuaWRCbG9jay50YWdDbGFzcyA9PT0gMSkgJiZcbiAgICAgICAgICAgICAgICAodGhpcy5lQ29udGVudC5pZEJsb2NrLnRhZ051bWJlciA9PT0gNCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5lQ29udGVudC5pZEJsb2NrLmlzQ29uc3RydWN0ZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnN0clN0cmluZyA9IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazogeyBpc0NvbnN0cnVjdGVkOiB0cnVlIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0NvbnN0cnVjdGVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBsZXQgb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgdmlld0hleCA9IHRoaXMuZUNvbnRlbnQudmFsdWVCbG9jay52YWx1ZUhleFZpZXcuc2xpY2UoKS5idWZmZXI7XG4gICAgICAgICAgICAgICAgICAgIGxldCBsZW5ndGggPSB2aWV3SGV4LmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChsZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwaWVjZVZpZXcgPSBuZXcgVWludDhBcnJheSh2aWV3SGV4LCBvZmZzZXQsICgob2Zmc2V0ICsgNjU1MzYpID4gdmlld0hleC5ieXRlTGVuZ3RoKSA/ICh2aWV3SGV4LmJ5dGVMZW5ndGggLSBvZmZzZXQpIDogNjU1MzYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgX2FycmF5ID0gbmV3IEFycmF5QnVmZmVyKHBpZWNlVmlldy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgX3ZpZXcgPSBuZXcgVWludDhBcnJheShfYXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBfdmlldy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92aWV3W2ldID0gcGllY2VWaWV3W2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RyU3RyaW5nLnZhbHVlQmxvY2sudmFsdWUucHVzaChuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKHsgdmFsdWVIZXg6IF9hcnJheSB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGggLT0gcGllY2VWaWV3Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSBwaWVjZVZpZXcubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZUNvbnRlbnQgPSBjb25zdHJTdHJpbmc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBFX0NPTlRFTlRfVFlQRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBFX0NPTlRFTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgRV9DT05URU5UX1RZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgRV9DT05URU5UOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChtZW1iZXJWYWx1ZS5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSAmJiAobWVtYmVyVmFsdWUuaWRCbG9jay50YWdOdW1iZXIgPT09IDQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvLmRlZmF1bHRWYWx1ZXMoRV9DT05URU5UKSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMuZUNvbnRlbnRUeXBlIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5BbnkoeyBuYW1lOiAobmFtZXMuZUNvbnRlbnQgfHwgRU1QVFlfU1RSSU5HKSB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRkKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBFbmNhcHN1bGF0ZWRDb250ZW50SW5mby5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBlQ29udGVudFR5cGU6IEVfQ09OVEVOVF9UWVBFLFxuICAgICAgICAgICAgICAgIGVDb250ZW50OiBFX0NPTlRFTlRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLmVDb250ZW50VHlwZSA9IGFzbjEucmVzdWx0LmVDb250ZW50VHlwZS52YWx1ZUJsb2NrLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmIChFX0NPTlRFTlQgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmVDb250ZW50ID0gYXNuMS5yZXN1bHQuZUNvbnRlbnQ7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7IHZhbHVlOiB0aGlzLmVDb250ZW50VHlwZSB9KSk7XG4gICAgICAgIGlmICh0aGlzLmVDb250ZW50KSB7XG4gICAgICAgICAgICBpZiAoRW5jYXBzdWxhdGVkQ29udGVudEluZm8uY29tcGFyZVdpdGhEZWZhdWx0KEVfQ09OVEVOVCwgdGhpcy5lQ29udGVudCkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5lQ29udGVudF1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgZUNvbnRlbnRUeXBlOiB0aGlzLmVDb250ZW50VHlwZVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5lQ29udGVudCAmJiBFbmNhcHN1bGF0ZWRDb250ZW50SW5mby5jb21wYXJlV2l0aERlZmF1bHQoRV9DT05URU5ULCB0aGlzLmVDb250ZW50KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJlcy5lQ29udGVudCA9IHRoaXMuZUNvbnRlbnQudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5FbmNhcHN1bGF0ZWRDb250ZW50SW5mby5DTEFTU19OQU1FID0gXCJFbmNhcHN1bGF0ZWRDb250ZW50SW5mb1wiO1xuXG5jbGFzcyBLZXlCYWcgZXh0ZW5kcyBQcml2YXRlS2V5SW5mbyB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKHBhcmFtZXRlcnMpO1xuICAgIH1cbn1cblxuY29uc3QgTUFDID0gXCJtYWNcIjtcbmNvbnN0IE1BQ19TQUxUID0gXCJtYWNTYWx0XCI7XG5jb25zdCBJVEVSQVRJT05TID0gXCJpdGVyYXRpb25zXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRjID0gW1xuICAgIE1BQyxcbiAgICBNQUNfU0FMVCxcbiAgICBJVEVSQVRJT05TXG5dO1xuY2xhc3MgTWFjRGF0YSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMubWFjID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTUFDLCBNYWNEYXRhLmRlZmF1bHRWYWx1ZXMoTUFDKSk7XG4gICAgICAgIHRoaXMubWFjU2FsdCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE1BQ19TQUxULCBNYWNEYXRhLmRlZmF1bHRWYWx1ZXMoTUFDX1NBTFQpKTtcbiAgICAgICAgaWYgKElURVJBVElPTlMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5pdGVyYXRpb25zID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgSVRFUkFUSU9OUywgTWFjRGF0YS5kZWZhdWx0VmFsdWVzKElURVJBVElPTlMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgTUFDOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGlnZXN0SW5mbygpO1xuICAgICAgICAgICAgY2FzZSBNQUNfU0FMVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5PY3RldFN0cmluZygpO1xuICAgICAgICAgICAgY2FzZSBJVEVSQVRJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBNQUM6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoRGlnZXN0SW5mby5jb21wYXJlV2l0aERlZmF1bHQoXCJkaWdlc3RBbGdvcml0aG1cIiwgbWVtYmVyVmFsdWUuZGlnZXN0QWxnb3JpdGhtKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKERpZ2VzdEluZm8uY29tcGFyZVdpdGhEZWZhdWx0KFwiZGlnZXN0XCIsIG1lbWJlclZhbHVlLmRpZ2VzdCkpKTtcbiAgICAgICAgICAgIGNhc2UgTUFDX1NBTFQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKE1hY0RhdGEuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSkpO1xuICAgICAgICAgICAgY2FzZSBJVEVSQVRJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IE1hY0RhdGEuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICBvcHRpb25hbDogKG5hbWVzLm9wdGlvbmFsIHx8IHRydWUpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBEaWdlc3RJbmZvLnNjaGVtYShuYW1lcy5tYWMgfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBNQUNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyBuYW1lOiAobmFtZXMubWFjU2FsdCB8fCBNQUNfU0FMVCkgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5pdGVyYXRpb25zIHx8IElURVJBVElPTlMpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRjKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBNYWNEYXRhLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIG1hYzoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBNQUNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWFjU2FsdDogTUFDX1NBTFQsXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogSVRFUkFUSU9OU1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMubWFjID0gbmV3IERpZ2VzdEluZm8oeyBzY2hlbWE6IGFzbjEucmVzdWx0Lm1hYyB9KTtcbiAgICAgICAgdGhpcy5tYWNTYWx0ID0gYXNuMS5yZXN1bHQubWFjU2FsdDtcbiAgICAgICAgaWYgKElURVJBVElPTlMgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLml0ZXJhdGlvbnMgPSBhc24xLnJlc3VsdC5pdGVyYXRpb25zLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtcbiAgICAgICAgICAgIHRoaXMubWFjLnRvU2NoZW1hKCksXG4gICAgICAgICAgICB0aGlzLm1hY1NhbHRcbiAgICAgICAgXTtcbiAgICAgICAgaWYgKHRoaXMuaXRlcmF0aW9ucyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLml0ZXJhdGlvbnMgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIG1hYzogdGhpcy5tYWMudG9KU09OKCksXG4gICAgICAgICAgICBtYWNTYWx0OiB0aGlzLm1hY1NhbHQudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLml0ZXJhdGlvbnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVzLml0ZXJhdGlvbnMgPSB0aGlzLml0ZXJhdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5NYWNEYXRhLkNMQVNTX05BTUUgPSBcIk1hY0RhdGFcIjtcblxuY29uc3QgSEFTSF9BTEdPUklUSE0gPSBcImhhc2hBbGdvcml0aG1cIjtcbmNvbnN0IEhBU0hFRF9NRVNTQUdFID0gXCJoYXNoZWRNZXNzYWdlXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRiID0gW1xuICAgIEhBU0hfQUxHT1JJVEhNLFxuICAgIEhBU0hFRF9NRVNTQUdFLFxuXTtcbmNsYXNzIE1lc3NhZ2VJbXByaW50IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBzdGF0aWMgYXN5bmMgY3JlYXRlKGhhc2hBbGdvcml0aG0sIG1lc3NhZ2UsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCBoYXNoQWxnb3JpdGhtT0lEID0gY3J5cHRvLmdldE9JREJ5QWxnb3JpdGhtKHsgbmFtZTogaGFzaEFsZ29yaXRobSB9LCB0cnVlLCBcImhhc2hBbGdvcml0aG1cIik7XG4gICAgICAgIGNvbnN0IGhhc2hlZE1lc3NhZ2UgPSBhd2FpdCBjcnlwdG8uZGlnZXN0KGhhc2hBbGdvcml0aG0sIG1lc3NhZ2UpO1xuICAgICAgICBjb25zdCByZXMgPSBuZXcgTWVzc2FnZUltcHJpbnQoe1xuICAgICAgICAgICAgaGFzaEFsZ29yaXRobTogbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBoYXNoQWxnb3JpdGhtT0lELFxuICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKCksXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGhhc2hlZE1lc3NhZ2U6IG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogaGFzaGVkTWVzc2FnZSB9KVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaGFzaEFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEhBU0hfQUxHT1JJVEhNLCBNZXNzYWdlSW1wcmludC5kZWZhdWx0VmFsdWVzKEhBU0hfQUxHT1JJVEhNKSk7XG4gICAgICAgIHRoaXMuaGFzaGVkTWVzc2FnZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEhBU0hFRF9NRVNTQUdFLCBNZXNzYWdlSW1wcmludC5kZWZhdWx0VmFsdWVzKEhBU0hFRF9NRVNTQUdFKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBIQVNIX0FMR09SSVRITTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoKTtcbiAgICAgICAgICAgIGNhc2UgSEFTSEVEX01FU1NBR0U6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgSEFTSF9BTEdPUklUSE06XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUuYWxnb3JpdGhtSWQgPT09IEVNUFRZX1NUUklORykgJiYgKChcImFsZ29yaXRobVBhcmFtc1wiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpKTtcbiAgICAgICAgICAgIGNhc2UgSEFTSEVEX01FU1NBR0U6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKE1lc3NhZ2VJbXByaW50LmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuaGFzaEFsZ29yaXRobSB8fCB7fSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5oYXNoZWRNZXNzYWdlIHx8IEVNUFRZX1NUUklORykgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyRiKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBNZXNzYWdlSW1wcmludC5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICBoYXNoQWxnb3JpdGhtOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IEhBU0hfQUxHT1JJVEhNXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGhhc2hlZE1lc3NhZ2U6IEhBU0hFRF9NRVNTQUdFXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5oYXNoQWxnb3JpdGhtID0gbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoeyBzY2hlbWE6IGFzbjEucmVzdWx0Lmhhc2hBbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMuaGFzaGVkTWVzc2FnZSA9IGFzbjEucmVzdWx0Lmhhc2hlZE1lc3NhZ2U7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICB0aGlzLmhhc2hBbGdvcml0aG0udG9TY2hlbWEoKSxcbiAgICAgICAgICAgICAgICB0aGlzLmhhc2hlZE1lc3NhZ2VcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoYXNoQWxnb3JpdGhtOiB0aGlzLmhhc2hBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBoYXNoZWRNZXNzYWdlOiB0aGlzLmhhc2hlZE1lc3NhZ2UudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgfVxufVxuTWVzc2FnZUltcHJpbnQuQ0xBU1NfTkFNRSA9IFwiTWVzc2FnZUltcHJpbnRcIjtcblxuY29uc3QgUkVRX0NFUlQgPSBcInJlcUNlcnRcIjtcbmNvbnN0IFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlMgPSBcInNpbmdsZVJlcXVlc3RFeHRlbnNpb25zXCI7XG5jb25zdCBDTEVBUl9QUk9QUyRhID0gW1xuICAgIFJFUV9DRVJULFxuICAgIFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlMsXG5dO1xuY2xhc3MgUmVxdWVzdCBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucmVxQ2VydCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFUV9DRVJULCBSZXF1ZXN0LmRlZmF1bHRWYWx1ZXMoUkVRX0NFUlQpKTtcbiAgICAgICAgaWYgKFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5zaW5nbGVSZXF1ZXN0RXh0ZW5zaW9ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlMsIFJlcXVlc3QuZGVmYXVsdFZhbHVlcyhTSU5HTEVfUkVRVUVTVF9FWFRFTlNJT05TKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFJFUV9DRVJUOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2VydElEKCk7XG4gICAgICAgICAgICBjYXNlIFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBSRVFfQ0VSVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoUmVxdWVzdC5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBjYXNlIFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBDZXJ0SUQuc2NoZW1hKG5hbWVzLnJlcUNlcnQgfHwge30pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtFeHRlbnNpb24uc2NoZW1hKG5hbWVzLmV4dGVuc2lvbnMgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLnNpbmdsZVJlcXVlc3RFeHRlbnNpb25zIHx8IEVNUFRZX1NUUklORylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJGEpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFJlcXVlc3Quc2NoZW1hKHtcbiAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgcmVxQ2VydDoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBSRVFfQ0VSVFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBleHRlbnNpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFNJTkdMRV9SRVFVRVNUX0VYVEVOU0lPTlNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnJlcUNlcnQgPSBuZXcgQ2VydElEKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5yZXFDZXJ0IH0pO1xuICAgICAgICBpZiAoU0lOR0xFX1JFUVVFU1RfRVhURU5TSU9OUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5zaW5nbGVSZXF1ZXN0RXh0ZW5zaW9ucyA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHQuc2luZ2xlUmVxdWVzdEV4dGVuc2lvbnMudmFsdWVCbG9jay52YWx1ZSwgZWxlbWVudCA9PiBuZXcgRXh0ZW5zaW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnJlcUNlcnQudG9TY2hlbWEoKSk7XG4gICAgICAgIGlmICh0aGlzLnNpbmdsZVJlcXVlc3RFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLnNpbmdsZVJlcXVlc3RFeHRlbnNpb25zLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgcmVxQ2VydDogdGhpcy5yZXFDZXJ0LnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnNpbmdsZVJlcXVlc3RFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICByZXMuc2luZ2xlUmVxdWVzdEV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKHRoaXMuc2luZ2xlUmVxdWVzdEV4dGVuc2lvbnMsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5SZXF1ZXN0LkNMQVNTX05BTUUgPSBcIlJlcXVlc3RcIjtcblxuY29uc3QgVEJTID0gXCJ0YnNcIjtcbmNvbnN0IFZFUlNJT04kNSA9IFwidmVyc2lvblwiO1xuY29uc3QgUkVRVUVTVE9SX05BTUUgPSBcInJlcXVlc3Rvck5hbWVcIjtcbmNvbnN0IFJFUVVFU1RfTElTVCA9IFwicmVxdWVzdExpc3RcIjtcbmNvbnN0IFJFUVVFU1RfRVhURU5TSU9OUyA9IFwicmVxdWVzdEV4dGVuc2lvbnNcIjtcbmNvbnN0IFRCU19SRVFVRVNUJDEgPSBcIlRCU1JlcXVlc3RcIjtcbmNvbnN0IFRCU19SRVFVRVNUX1ZFUlNJT04gPSBgJHtUQlNfUkVRVUVTVCQxfS4ke1ZFUlNJT04kNX1gO1xuY29uc3QgVEJTX1JFUVVFU1RfUkVRVUVTVE9SX05BTUUgPSBgJHtUQlNfUkVRVUVTVCQxfS4ke1JFUVVFU1RPUl9OQU1FfWA7XG5jb25zdCBUQlNfUkVRVUVTVF9SRVFVRVNUUyA9IGAke1RCU19SRVFVRVNUJDF9LnJlcXVlc3RzYDtcbmNvbnN0IFRCU19SRVFVRVNUX1JFUVVFU1RfRVhURU5TSU9OUyA9IGAke1RCU19SRVFVRVNUJDF9LiR7UkVRVUVTVF9FWFRFTlNJT05TfWA7XG5jb25zdCBDTEVBUl9QUk9QUyQ5ID0gW1xuICAgIFRCU19SRVFVRVNUJDEsXG4gICAgVEJTX1JFUVVFU1RfVkVSU0lPTixcbiAgICBUQlNfUkVRVUVTVF9SRVFVRVNUT1JfTkFNRSxcbiAgICBUQlNfUkVRVUVTVF9SRVFVRVNUUyxcbiAgICBUQlNfUkVRVUVTVF9SRVFVRVNUX0VYVEVOU0lPTlNcbl07XG5jbGFzcyBUQlNSZXF1ZXN0IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBnZXQgdGJzKCkge1xuICAgICAgICByZXR1cm4gcHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci50b0FycmF5QnVmZmVyKHRoaXMudGJzVmlldyk7XG4gICAgfVxuICAgIHNldCB0YnModmFsdWUpIHtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodmFsdWUpO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50YnNWaWV3ID0gbmV3IFVpbnQ4QXJyYXkocHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVEJTLCBUQlNSZXF1ZXN0LmRlZmF1bHRWYWx1ZXMoVEJTKSkpO1xuICAgICAgICBpZiAoVkVSU0lPTiQ1IGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04kNSwgVEJTUmVxdWVzdC5kZWZhdWx0VmFsdWVzKFZFUlNJT04kNSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChSRVFVRVNUT1JfTkFNRSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnJlcXVlc3Rvck5hbWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVFVRVNUT1JfTkFNRSwgVEJTUmVxdWVzdC5kZWZhdWx0VmFsdWVzKFJFUVVFU1RPUl9OQU1FKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXF1ZXN0TGlzdCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFUVVFU1RfTElTVCwgVEJTUmVxdWVzdC5kZWZhdWx0VmFsdWVzKFJFUVVFU1RfTElTVCkpO1xuICAgICAgICBpZiAoUkVRVUVTVF9FWFRFTlNJT05TIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdEV4dGVuc2lvbnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVFVRVNUX0VYVEVOU0lPTlMsIFRCU1JlcXVlc3QuZGVmYXVsdFZhbHVlcyhSRVFVRVNUX0VYVEVOU0lPTlMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVEJTOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9CVUZGRVI7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kNTpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgUkVRVUVTVE9SX05BTUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmFsTmFtZSgpO1xuICAgICAgICAgICAgY2FzZSBSRVFVRVNUX0xJU1Q6XG4gICAgICAgICAgICBjYXNlIFJFUVVFU1RfRVhURU5TSU9OUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRCUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmJ5dGVMZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gVEJTUmVxdWVzdC5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgUkVRVUVTVE9SX05BTUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUudHlwZSA9PT0gR2VuZXJhbE5hbWUuZGVmYXVsdFZhbHVlcyhcInR5cGVcIikpICYmIChPYmplY3Qua2V5cyhtZW1iZXJWYWx1ZS52YWx1ZSkubGVuZ3RoID09PSAwKSk7XG4gICAgICAgICAgICBjYXNlIFJFUVVFU1RfTElTVDpcbiAgICAgICAgICAgIGNhc2UgUkVRVUVTVF9FWFRFTlNJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgVEJTX1JFUVVFU1QkMSksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMuVEJTUmVxdWVzdFZlcnNpb24gfHwgVEJTX1JFUVVFU1RfVkVSU0lPTikgfSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW0dlbmVyYWxOYW1lLnNjaGVtYShuYW1lcy5yZXF1ZXN0b3JOYW1lIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRCU19SRVFVRVNUX1JFUVVFU1RPUl9OQU1FXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSldXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5yZXF1ZXN0TGlzdCB8fCBcIlRCU1JlcXVlc3QucmVxdWVzdExpc3RcIiksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMucmVxdWVzdHMgfHwgVEJTX1JFUVVFU1RfUkVRVUVTVFMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBSZXF1ZXN0LnNjaGVtYShuYW1lcy5yZXF1ZXN0TmFtZXMgfHwge30pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW0V4dGVuc2lvbnMuc2NoZW1hKG5hbWVzLmV4dGVuc2lvbnMgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogKG5hbWVzLnJlcXVlc3RFeHRlbnNpb25zIHx8IFRCU19SRVFVRVNUX1JFUVVFU1RfRVhURU5TSU9OUylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDkpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFRCU1JlcXVlc3Quc2NoZW1hKCkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnRic1ZpZXcgPSBhc24xLnJlc3VsdC5UQlNSZXF1ZXN0LnZhbHVlQmVmb3JlRGVjb2RlVmlldztcbiAgICAgICAgaWYgKFRCU19SRVFVRVNUX1ZFUlNJT04gaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdFtUQlNfUkVRVUVTVF9WRVJTSU9OXS52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICBpZiAoVEJTX1JFUVVFU1RfUkVRVUVTVE9SX05BTUUgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnJlcXVlc3Rvck5hbWUgPSBuZXcgR2VuZXJhbE5hbWUoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1RCU19SRVFVRVNUX1JFUVVFU1RPUl9OQU1FXSB9KTtcbiAgICAgICAgdGhpcy5yZXF1ZXN0TGlzdCA9IEFycmF5LmZyb20oYXNuMS5yZXN1bHRbVEJTX1JFUVVFU1RfUkVRVUVTVFNdLCBlbGVtZW50ID0+IG5ldyBSZXF1ZXN0KHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICAgICAgaWYgKFRCU19SRVFVRVNUX1JFUVVFU1RfRVhURU5TSU9OUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdEV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0W1RCU19SRVFVRVNUX1JFUVVFU1RfRVhURU5TSU9OU10udmFsdWVCbG9jay52YWx1ZSwgZWxlbWVudCA9PiBuZXcgRXh0ZW5zaW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoZW5jb2RlRmxhZyA9IGZhbHNlKSB7XG4gICAgICAgIGxldCB0YnNTY2hlbWE7XG4gICAgICAgIGlmIChlbmNvZGVGbGFnID09PSBmYWxzZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMudGJzVmlldy5ieXRlTGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgICAgIHJldHVybiBUQlNSZXF1ZXN0LnNjaGVtYSgpO1xuICAgICAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5mcm9tQkVSKHRoaXMudGJzVmlldyk7XG4gICAgICAgICAgICBBc25FcnJvci5hc3NlcnQoYXNuMSwgXCJUQlMgUmVxdWVzdFwiKTtcbiAgICAgICAgICAgIGlmICghKGFzbjEucmVzdWx0IGluc3RhbmNlb2YgYXNuMWpzLlNlcXVlbmNlKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFTTi4xIHJlc3VsdCBzaG91bGQgYmUgU0VRVUVOQ0VcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YnNTY2hlbWEgPSBhc24xLnJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy52ZXJzaW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSldXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucmVxdWVzdG9yTmFtZSkge1xuICAgICAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbdGhpcy5yZXF1ZXN0b3JOYW1lLnRvU2NoZW1hKCldXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLnJlcXVlc3RMaXN0LCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlcXVlc3RFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMucmVxdWVzdEV4dGVuc2lvbnMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRic1NjaGVtYSA9IG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRic1NjaGVtYTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMudmVyc2lvbiAhPSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXMudmVyc2lvbiA9IHRoaXMudmVyc2lvbjtcbiAgICAgICAgaWYgKHRoaXMucmVxdWVzdG9yTmFtZSkge1xuICAgICAgICAgICAgcmVzLnJlcXVlc3Rvck5hbWUgPSB0aGlzLnJlcXVlc3Rvck5hbWUudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzLnJlcXVlc3RMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLnJlcXVlc3RMaXN0LCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICBpZiAodGhpcy5yZXF1ZXN0RXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgcmVzLnJlcXVlc3RFeHRlbnNpb25zID0gQXJyYXkuZnJvbSh0aGlzLnJlcXVlc3RFeHRlbnNpb25zLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuVEJTUmVxdWVzdC5DTEFTU19OQU1FID0gXCJUQlNSZXF1ZXN0XCI7XG5cbmNvbnN0IFNJR05BVFVSRV9BTEdPUklUSE0kMSA9IFwic2lnbmF0dXJlQWxnb3JpdGhtXCI7XG5jb25zdCBTSUdOQVRVUkUkMSA9IFwic2lnbmF0dXJlXCI7XG5jb25zdCBDRVJUUyA9IFwiY2VydHNcIjtcbmNsYXNzIFNpZ25hdHVyZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlQWxnb3JpdGhtID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFX0FMR09SSVRITSQxLCBTaWduYXR1cmUuZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfQUxHT1JJVEhNJDEpKTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdOQVRVUkUkMSwgU2lnbmF0dXJlLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFJDEpKTtcbiAgICAgICAgaWYgKENFUlRTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuY2VydHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDRVJUUywgU2lnbmF0dXJlLmRlZmF1bHRWYWx1ZXMoQ0VSVFMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFX0FMR09SSVRITSQxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkUkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5CaXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgQ0VSVFM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfQUxHT1JJVEhNJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUuYWxnb3JpdGhtSWQgPT09IEVNUFRZX1NUUklORykgJiYgKChcImFsZ29yaXRobVBhcmFtc1wiIGluIG1lbWJlclZhbHVlKSA9PT0gZmFsc2UpKTtcbiAgICAgICAgICAgIGNhc2UgU0lHTkFUVVJFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKFNpZ25hdHVyZS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBjYXNlIENFUlRTOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2lnbmF0dXJlQWxnb3JpdGhtIHx8IHt9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkJpdFN0cmluZyh7IG5hbWU6IChuYW1lcy5zaWduYXR1cmUgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW25ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmNlcnRzIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQ2VydGlmaWNhdGUuc2NoZW1hKHt9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIFtcbiAgICAgICAgICAgIFNJR05BVFVSRV9BTEdPUklUSE0kMSxcbiAgICAgICAgICAgIFNJR05BVFVSRSQxLFxuICAgICAgICAgICAgQ0VSVFNcbiAgICAgICAgXSk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgU2lnbmF0dXJlLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBTSUdOQVRVUkVfQUxHT1JJVEhNJDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2lnbmF0dXJlOiBTSUdOQVRVUkUkMSxcbiAgICAgICAgICAgICAgICBjZXJ0czogQ0VSVFNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5zaWduYXR1cmVBbGdvcml0aG0gfSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlID0gYXNuMS5yZXN1bHQuc2lnbmF0dXJlO1xuICAgICAgICBpZiAoQ0VSVFMgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmNlcnRzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5jZXJ0cywgZWxlbWVudCA9PiBuZXcgQ2VydGlmaWNhdGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25hdHVyZSk7XG4gICAgICAgIGlmICh0aGlzLmNlcnRzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmNlcnRzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgc2lnbmF0dXJlQWxnb3JpdGhtOiB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZTogdGhpcy5zaWduYXR1cmUudG9KU09OKCksXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmNlcnRzKSB7XG4gICAgICAgICAgICByZXMuY2VydHMgPSBBcnJheS5mcm9tKHRoaXMuY2VydHMsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5TaWduYXR1cmUuQ0xBU1NfTkFNRSA9IFwiU2lnbmF0dXJlXCI7XG5cbmNvbnN0IFRCU19SRVFVRVNUID0gXCJ0YnNSZXF1ZXN0XCI7XG5jb25zdCBPUFRJT05BTF9TSUdOQVRVUkUgPSBcIm9wdGlvbmFsU2lnbmF0dXJlXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQ4ID0gW1xuICAgIFRCU19SRVFVRVNULFxuICAgIE9QVElPTkFMX1NJR05BVFVSRVxuXTtcbmNsYXNzIE9DU1BSZXF1ZXN0IGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50YnNSZXF1ZXN0ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVEJTX1JFUVVFU1QsIE9DU1BSZXF1ZXN0LmRlZmF1bHRWYWx1ZXMoVEJTX1JFUVVFU1QpKTtcbiAgICAgICAgaWYgKE9QVElPTkFMX1NJR05BVFVSRSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbmFsU2lnbmF0dXJlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT1BUSU9OQUxfU0lHTkFUVVJFLCBPQ1NQUmVxdWVzdC5kZWZhdWx0VmFsdWVzKE9QVElPTkFMX1NJR05BVFVSRSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBUQlNfUkVRVUVTVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRCU1JlcXVlc3QoKTtcbiAgICAgICAgICAgIGNhc2UgT1BUSU9OQUxfU0lHTkFUVVJFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2lnbmF0dXJlKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFRCU19SRVFVRVNUOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKFRCU1JlcXVlc3QuY29tcGFyZVdpdGhEZWZhdWx0KFwidGJzXCIsIG1lbWJlclZhbHVlLnRicykpICYmXG4gICAgICAgICAgICAgICAgICAgIChUQlNSZXF1ZXN0LmNvbXBhcmVXaXRoRGVmYXVsdChcInZlcnNpb25cIiwgbWVtYmVyVmFsdWUudmVyc2lvbikpICYmXG4gICAgICAgICAgICAgICAgICAgIChUQlNSZXF1ZXN0LmNvbXBhcmVXaXRoRGVmYXVsdChcInJlcXVlc3Rvck5hbWVcIiwgbWVtYmVyVmFsdWUucmVxdWVzdG9yTmFtZSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChUQlNSZXF1ZXN0LmNvbXBhcmVXaXRoRGVmYXVsdChcInJlcXVlc3RMaXN0XCIsIG1lbWJlclZhbHVlLnJlcXVlc3RMaXN0KSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKFRCU1JlcXVlc3QuY29tcGFyZVdpdGhEZWZhdWx0KFwicmVxdWVzdEV4dGVuc2lvbnNcIiwgbWVtYmVyVmFsdWUucmVxdWVzdEV4dGVuc2lvbnMpKSk7XG4gICAgICAgICAgICBjYXNlIE9QVElPTkFMX1NJR05BVFVSRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChTaWduYXR1cmUuY29tcGFyZVdpdGhEZWZhdWx0KFwic2lnbmF0dXJlQWxnb3JpdGhtXCIsIG1lbWJlclZhbHVlLnNpZ25hdHVyZUFsZ29yaXRobSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChTaWduYXR1cmUuY29tcGFyZVdpdGhEZWZhdWx0KFwic2lnbmF0dXJlXCIsIG1lbWJlclZhbHVlLnNpZ25hdHVyZSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChTaWduYXR1cmUuY29tcGFyZVdpdGhEZWZhdWx0KFwiY2VydHNcIiwgbWVtYmVyVmFsdWUuY2VydHMpKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiBuYW1lcy5ibG9ja05hbWUgfHwgXCJPQ1NQUmVxdWVzdFwiLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBUQlNSZXF1ZXN0LnNjaGVtYShuYW1lcy50YnNSZXF1ZXN0IHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogVEJTX1JFUVVFU1RcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFNpZ25hdHVyZS5zY2hlbWEobmFtZXMub3B0aW9uYWxTaWduYXR1cmUgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogT1BUSU9OQUxfU0lHTkFUVVJFXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkOCk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgT0NTUFJlcXVlc3Quc2NoZW1hKCkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnRic1JlcXVlc3QgPSBuZXcgVEJTUmVxdWVzdCh7IHNjaGVtYTogYXNuMS5yZXN1bHQudGJzUmVxdWVzdCB9KTtcbiAgICAgICAgaWYgKE9QVElPTkFMX1NJR05BVFVSRSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMub3B0aW9uYWxTaWduYXR1cmUgPSBuZXcgU2lnbmF0dXJlKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5vcHRpb25hbFNpZ25hdHVyZSB9KTtcbiAgICB9XG4gICAgdG9TY2hlbWEoZW5jb2RlRmxhZyA9IGZhbHNlKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy50YnNSZXF1ZXN0LnRvU2NoZW1hKGVuY29kZUZsYWcpKTtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9uYWxTaWduYXR1cmUpXG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25hbFNpZ25hdHVyZS50b1NjaGVtYSgpXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB0YnNSZXF1ZXN0OiB0aGlzLnRic1JlcXVlc3QudG9KU09OKClcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9uYWxTaWduYXR1cmUpIHtcbiAgICAgICAgICAgIHJlcy5vcHRpb25hbFNpZ25hdHVyZSA9IHRoaXMub3B0aW9uYWxTaWduYXR1cmUudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgYXN5bmMgY3JlYXRlRm9yQ2VydGlmaWNhdGUoY2VydGlmaWNhdGUsIHBhcmFtZXRlcnMsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBjb25zdCBjZXJ0SUQgPSBuZXcgQ2VydElEKCk7XG4gICAgICAgIGF3YWl0IGNlcnRJRC5jcmVhdGVGb3JDZXJ0aWZpY2F0ZShjZXJ0aWZpY2F0ZSwgcGFyYW1ldGVycywgY3J5cHRvKTtcbiAgICAgICAgdGhpcy50YnNSZXF1ZXN0LnJlcXVlc3RMaXN0LnB1c2gobmV3IFJlcXVlc3Qoe1xuICAgICAgICAgICAgcmVxQ2VydDogY2VydElELFxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGFzeW5jIHNpZ24ocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSA9IFwiU0hBLTFcIiwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydEVtcHR5KHByaXZhdGVLZXksIFwicHJpdmF0ZUtleVwiLCBcIk9DU1BSZXF1ZXN0LnNpZ24gbWV0aG9kXCIpO1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9uYWxTaWduYXR1cmUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5lZWQgdG8gY3JlYXRlIFxcXCJvcHRpb25hbFNpZ25hdHVyZVxcXCIgZmllbGQgYmVmb3JlIHNpZ25pbmdcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlUGFyYW1zID0gYXdhaXQgY3J5cHRvLmdldFNpZ25hdHVyZVBhcmFtZXRlcnMocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSk7XG4gICAgICAgIGNvbnN0IHBhcmFtZXRlcnMgPSBzaWduYXR1cmVQYXJhbXMucGFyYW1ldGVycztcbiAgICAgICAgdGhpcy5vcHRpb25hbFNpZ25hdHVyZS5zaWduYXR1cmVBbGdvcml0aG0gPSBzaWduYXR1cmVQYXJhbXMuc2lnbmF0dXJlQWxnb3JpdGhtO1xuICAgICAgICBjb25zdCB0YnMgPSB0aGlzLnRic1JlcXVlc3QudG9TY2hlbWEodHJ1ZSkudG9CRVIoZmFsc2UpO1xuICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBjcnlwdG8uc2lnbldpdGhQcml2YXRlS2V5KHRicywgcHJpdmF0ZUtleSwgcGFyYW1ldGVycyk7XG4gICAgICAgIHRoaXMub3B0aW9uYWxTaWduYXR1cmUuc2lnbmF0dXJlID0gbmV3IGFzbjFqcy5CaXRTdHJpbmcoeyB2YWx1ZUhleDogc2lnbmF0dXJlIH0pO1xuICAgIH1cbiAgICB2ZXJpZnkoKSB7XG4gICAgfVxufVxuT0NTUFJlcXVlc3QuQ0xBU1NfTkFNRSA9IFwiT0NTUFJlcXVlc3RcIjtcblxuY29uc3QgUkVTUE9OU0VfVFlQRSA9IFwicmVzcG9uc2VUeXBlXCI7XG5jb25zdCBSRVNQT05TRSA9IFwicmVzcG9uc2VcIjtcbmNvbnN0IENMRUFSX1BST1BTJDcgPSBbXG4gICAgUkVTUE9OU0VfVFlQRSxcbiAgICBSRVNQT05TRVxuXTtcbmNsYXNzIFJlc3BvbnNlQnl0ZXMgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnJlc3BvbnNlVHlwZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFJFU1BPTlNFX1RZUEUsIFJlc3BvbnNlQnl0ZXMuZGVmYXVsdFZhbHVlcyhSRVNQT05TRV9UWVBFKSk7XG4gICAgICAgIHRoaXMucmVzcG9uc2UgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVNQT05TRSwgUmVzcG9uc2VCeXRlcy5kZWZhdWx0VmFsdWVzKFJFU1BPTlNFKSk7XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBSRVNQT05TRV9UWVBFOlxuICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWV9TVFJJTkc7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLk9jdGV0U3RyaW5nKCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFX1RZUEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIGNhc2UgUkVTUE9OU0U6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKFJlc3BvbnNlQnl0ZXMuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyBuYW1lOiAobmFtZXMucmVzcG9uc2VUeXBlIHx8IEVNUFRZX1NUUklORykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5yZXNwb25zZSB8fCBFTVBUWV9TVFJJTkcpIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkNyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUmVzcG9uc2VCeXRlcy5zY2hlbWEoe1xuICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICByZXNwb25zZVR5cGU6IFJFU1BPTlNFX1RZUEUsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2U6IFJFU1BPTlNFXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5yZXNwb25zZVR5cGUgPSBhc24xLnJlc3VsdC5yZXNwb25zZVR5cGUudmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnJlc3BvbnNlID0gYXNuMS5yZXN1bHQucmVzcG9uc2U7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5yZXNwb25zZVR5cGUgfSksXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNwb25zZVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogdGhpcy5yZXNwb25zZVR5cGUsXG4gICAgICAgICAgICByZXNwb25zZTogdGhpcy5yZXNwb25zZS50b0pTT04oKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5SZXNwb25zZUJ5dGVzLkNMQVNTX05BTUUgPSBcIlJlc3BvbnNlQnl0ZXNcIjtcblxuY29uc3QgUkVTUE9OU0VfU1RBVFVTID0gXCJyZXNwb25zZVN0YXR1c1wiO1xuY29uc3QgUkVTUE9OU0VfQllURVMgPSBcInJlc3BvbnNlQnl0ZXNcIjtcbmNsYXNzIE9DU1BSZXNwb25zZSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucmVzcG9uc2VTdGF0dXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBSRVNQT05TRV9TVEFUVVMsIE9DU1BSZXNwb25zZS5kZWZhdWx0VmFsdWVzKFJFU1BPTlNFX1NUQVRVUykpO1xuICAgICAgICBpZiAoUkVTUE9OU0VfQllURVMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5yZXNwb25zZUJ5dGVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUkVTUE9OU0VfQllURVMsIE9DU1BSZXNwb25zZS5kZWZhdWx0VmFsdWVzKFJFU1BPTlNFX0JZVEVTKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFX1NUQVRVUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5FbnVtZXJhdGVkKCk7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFX0JZVEVTOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2VCeXRlcygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBSRVNQT05TRV9TVEFUVVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKE9DU1BSZXNwb25zZS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBjYXNlIFJFU1BPTlNFX0JZVEVTOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKFJlc3BvbnNlQnl0ZXMuY29tcGFyZVdpdGhEZWZhdWx0KFwicmVzcG9uc2VUeXBlXCIsIG1lbWJlclZhbHVlLnJlc3BvbnNlVHlwZSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChSZXNwb25zZUJ5dGVzLmNvbXBhcmVXaXRoRGVmYXVsdChcInJlc3BvbnNlXCIsIG1lbWJlclZhbHVlLnJlc3BvbnNlKSkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgc2NoZW1hKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBjb25zdCBuYW1lcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFwibmFtZXNcIiwge30pO1xuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgbmFtZTogKG5hbWVzLmJsb2NrTmFtZSB8fCBcIk9DU1BSZXNwb25zZVwiKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5FbnVtZXJhdGVkKHsgbmFtZTogKG5hbWVzLnJlc3BvbnNlU3RhdHVzIHx8IFJFU1BPTlNFX1NUQVRVUykgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2VCeXRlcy5zY2hlbWEobmFtZXMucmVzcG9uc2VCeXRlcyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBSRVNQT05TRV9CWVRFU1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIFtcbiAgICAgICAgICAgIFJFU1BPTlNFX1NUQVRVUyxcbiAgICAgICAgICAgIFJFU1BPTlNFX0JZVEVTXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIE9DU1BSZXNwb25zZS5zY2hlbWEoKSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMucmVzcG9uc2VTdGF0dXMgPSBhc24xLnJlc3VsdC5yZXNwb25zZVN0YXR1cztcbiAgICAgICAgaWYgKFJFU1BPTlNFX0JZVEVTIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5yZXNwb25zZUJ5dGVzID0gbmV3IFJlc3BvbnNlQnl0ZXMoeyBzY2hlbWE6IGFzbjEucmVzdWx0LnJlc3BvbnNlQnl0ZXMgfSk7XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMucmVzcG9uc2VTdGF0dXMpO1xuICAgICAgICBpZiAodGhpcy5yZXNwb25zZUJ5dGVzKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IFt0aGlzLnJlc3BvbnNlQnl0ZXMudG9TY2hlbWEoKV1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICByZXNwb25zZVN0YXR1czogdGhpcy5yZXNwb25zZVN0YXR1cy50b0pTT04oKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5yZXNwb25zZUJ5dGVzKSB7XG4gICAgICAgICAgICByZXMucmVzcG9uc2VCeXRlcyA9IHRoaXMucmVzcG9uc2VCeXRlcy50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICBhc3luYyBnZXRDZXJ0aWZpY2F0ZVN0YXR1cyhjZXJ0aWZpY2F0ZSwgaXNzdWVyQ2VydGlmaWNhdGUsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBsZXQgYmFzaWNSZXNwb25zZTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgaXNGb3JDZXJ0aWZpY2F0ZTogZmFsc2UsXG4gICAgICAgICAgICBzdGF0dXM6IDJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCF0aGlzLnJlc3BvbnNlQnl0ZXMpXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICBpZiAodGhpcy5yZXNwb25zZUJ5dGVzLnJlc3BvbnNlVHlwZSAhPT0gaWRfUEtJWF9PQ1NQX0Jhc2ljKVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGFzbjFCYXNpYyA9IGFzbjFqcy5mcm9tQkVSKHRoaXMucmVzcG9uc2VCeXRlcy5yZXNwb25zZS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgICAgICAgICBBc25FcnJvci5hc3NlcnQoYXNuMUJhc2ljLCBcIkJhc2ljIE9DU1AgcmVzcG9uc2VcIik7XG4gICAgICAgICAgICBiYXNpY1Jlc3BvbnNlID0gbmV3IEJhc2ljT0NTUFJlc3BvbnNlKHsgc2NoZW1hOiBhc24xQmFzaWMucmVzdWx0IH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYmFzaWNSZXNwb25zZS5nZXRDZXJ0aWZpY2F0ZVN0YXR1cyhjZXJ0aWZpY2F0ZSwgaXNzdWVyQ2VydGlmaWNhdGUsIGNyeXB0byk7XG4gICAgfVxuICAgIGFzeW5jIHNpZ24ocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKHRoaXMucmVzcG9uc2VCeXRlcyAmJiB0aGlzLnJlc3BvbnNlQnl0ZXMucmVzcG9uc2VUeXBlID09PSBpZF9QS0lYX09DU1BfQmFzaWMpIHtcbiAgICAgICAgICAgIGNvbnN0IGJhc2ljUmVzcG9uc2UgPSBCYXNpY09DU1BSZXNwb25zZS5mcm9tQkVSKHRoaXMucmVzcG9uc2VCeXRlcy5yZXNwb25zZS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgICAgICAgICByZXR1cm4gYmFzaWNSZXNwb25zZS5zaWduKHByaXZhdGVLZXksIGhhc2hBbGdvcml0aG0sIGNyeXB0byk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIFJlc3BvbnNlQnl0ZXMgdHlwZTogJHsoKF9hID0gdGhpcy5yZXNwb25zZUJ5dGVzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucmVzcG9uc2VUeXBlKSB8fCBcIlVua25vd25cIn1gKTtcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5KGlzc3VlckNlcnRpZmljYXRlID0gbnVsbCwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKChSRVNQT05TRV9CWVRFUyBpbiB0aGlzKSA9PT0gZmFsc2UpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFbXB0eSBSZXNwb25zZUJ5dGVzIGZpZWxkXCIpO1xuICAgICAgICBpZiAodGhpcy5yZXNwb25zZUJ5dGVzICYmIHRoaXMucmVzcG9uc2VCeXRlcy5yZXNwb25zZVR5cGUgPT09IGlkX1BLSVhfT0NTUF9CYXNpYykge1xuICAgICAgICAgICAgY29uc3QgYmFzaWNSZXNwb25zZSA9IEJhc2ljT0NTUFJlc3BvbnNlLmZyb21CRVIodGhpcy5yZXNwb25zZUJ5dGVzLnJlc3BvbnNlLnZhbHVlQmxvY2sudmFsdWVIZXhWaWV3KTtcbiAgICAgICAgICAgIGlmIChpc3N1ZXJDZXJ0aWZpY2F0ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmICghYmFzaWNSZXNwb25zZS5jZXJ0cykge1xuICAgICAgICAgICAgICAgICAgICBiYXNpY1Jlc3BvbnNlLmNlcnRzID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJhc2ljUmVzcG9uc2UuY2VydHMucHVzaChpc3N1ZXJDZXJ0aWZpY2F0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYmFzaWNSZXNwb25zZS52ZXJpZnkoe30sIGNyeXB0byk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIFJlc3BvbnNlQnl0ZXMgdHlwZTogJHsoKF9hID0gdGhpcy5yZXNwb25zZUJ5dGVzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucmVzcG9uc2VUeXBlKSB8fCBcIlVua25vd25cIn1gKTtcbiAgICB9XG59XG5PQ1NQUmVzcG9uc2UuQ0xBU1NfTkFNRSA9IFwiT0NTUFJlc3BvbnNlXCI7XG5cbmNvbnN0IFRZUEUgPSBcInR5cGVcIjtcbmNvbnN0IEFUVFJJQlVURVMgPSBcImF0dHJpYnV0ZXNcIjtcbmNvbnN0IEVOQ09ERURfVkFMVUUgPSBcImVuY29kZWRWYWx1ZVwiO1xuY29uc3QgQ0xFQVJfUFJPUFMkNiA9IFtcbiAgICBBVFRSSUJVVEVTXG5dO1xuY2xhc3MgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy50eXBlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVFlQRSwgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLmRlZmF1bHRWYWx1ZXMoVFlQRSkpO1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBBVFRSSUJVVEVTLCBTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMuZGVmYXVsdFZhbHVlcyhBVFRSSUJVVEVTKSk7XG4gICAgICAgIHRoaXMuZW5jb2RlZFZhbHVlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRU5DT0RFRF9WQUxVRSwgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLmRlZmF1bHRWYWx1ZXMoRU5DT0RFRF9WQUxVRSkpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVFlQRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKC0xKTtcbiAgICAgICAgICAgIGNhc2UgQVRUUklCVVRFUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIEVOQ09ERURfVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX0JVRkZFUjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVFlQRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMuZGVmYXVsdFZhbHVlcyhUWVBFKSk7XG4gICAgICAgICAgICBjYXNlIEFUVFJJQlVURVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5sZW5ndGggPT09IDApO1xuICAgICAgICAgICAgY2FzZSBFTkNPREVEX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuYnl0ZUxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IG5hbWVzLnRhZ051bWJlciB8fCAwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmF0dHJpYnV0ZXMgfHwgRU1QVFlfU1RSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEF0dHJpYnV0ZS5zY2hlbWEoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZnJvbVNjaGVtYShzY2hlbWEpIHtcbiAgICAgICAgcHZ1dGlscy5jbGVhclByb3BzKHNjaGVtYSwgQ0xFQVJfUFJPUFMkNik7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHRhZ051bWJlcjogdGhpcy50eXBlLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IEFUVFJJQlVURVNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnR5cGUgPSBhc24xLnJlc3VsdC5pZEJsb2NrLnRhZ051bWJlcjtcbiAgICAgICAgdGhpcy5lbmNvZGVkVmFsdWUgPSBwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLnRvQXJyYXlCdWZmZXIoYXNuMS5yZXN1bHQudmFsdWVCZWZvcmVEZWNvZGVWaWV3KTtcbiAgICAgICAgY29uc3QgZW5jb2RlZFZpZXcgPSBuZXcgVWludDhBcnJheSh0aGlzLmVuY29kZWRWYWx1ZSk7XG4gICAgICAgIGVuY29kZWRWaWV3WzBdID0gMHgzMTtcbiAgICAgICAgaWYgKChBVFRSSUJVVEVTIGluIGFzbjEucmVzdWx0KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT09IDApXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiV3Jvbmcgc3RydWN0dXJlIG9mIFNpZ25lZFVuc2lnbmVkQXR0cmlidXRlc1wiKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdC5hdHRyaWJ1dGVzLCBlbGVtZW50ID0+IG5ldyBBdHRyaWJ1dGUoeyBzY2hlbWE6IGVsZW1lbnQgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgaWYgKFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcy5jb21wYXJlV2l0aERlZmF1bHQoVFlQRSwgdGhpcy50eXBlKSB8fCBTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMuY29tcGFyZVdpdGhEZWZhdWx0KEFUVFJJQlVURVMsIHRoaXMuYXR0cmlidXRlcykpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3RseSBpbml0aWFsaXplZCBcXFwiU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzXFxcIiBjbGFzc1wiKTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgIHRhZ051bWJlcjogdGhpcy50eXBlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmZyb20odGhpcy5hdHRyaWJ1dGVzLCBvID0+IG8udG9TY2hlbWEoKSlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGlmIChTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMuY29tcGFyZVdpdGhEZWZhdWx0KFRZUEUsIHRoaXMudHlwZSkgfHwgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLmNvbXBhcmVXaXRoRGVmYXVsdChBVFRSSUJVVEVTLCB0aGlzLmF0dHJpYnV0ZXMpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0bHkgaW5pdGlhbGl6ZWQgXFxcIlNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlc1xcXCIgY2xhc3NcIik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiB0aGlzLnR5cGUsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiBBcnJheS5mcm9tKHRoaXMuYXR0cmlidXRlcywgbyA9PiBvLnRvSlNPTigpKVxuICAgICAgICB9O1xuICAgIH1cbn1cblNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcy5DTEFTU19OQU1FID0gXCJTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXNcIjtcblxuY29uc3QgVkVSU0lPTiQ0ID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBTSUQgPSBcInNpZFwiO1xuY29uc3QgRElHRVNUX0FMR09SSVRITSA9IFwiZGlnZXN0QWxnb3JpdGhtXCI7XG5jb25zdCBTSUdORURfQVRUUlMgPSBcInNpZ25lZEF0dHJzXCI7XG5jb25zdCBTSUdOQVRVUkVfQUxHT1JJVEhNID0gXCJzaWduYXR1cmVBbGdvcml0aG1cIjtcbmNvbnN0IFNJR05BVFVSRSA9IFwic2lnbmF0dXJlXCI7XG5jb25zdCBVTlNJR05FRF9BVFRSUyA9IFwidW5zaWduZWRBdHRyc1wiO1xuY29uc3QgU0lHTkVSX0lORk8gPSBcIlNpZ25lckluZm9cIjtcbmNvbnN0IFNJR05FUl9JTkZPX1ZFUlNJT04gPSBgJHtTSUdORVJfSU5GT30uJHtWRVJTSU9OJDR9YDtcbmNvbnN0IFNJR05FUl9JTkZPX1NJRCA9IGAke1NJR05FUl9JTkZPfS4ke1NJRH1gO1xuY29uc3QgU0lHTkVSX0lORk9fRElHRVNUX0FMR09SSVRITSA9IGAke1NJR05FUl9JTkZPfS4ke0RJR0VTVF9BTEdPUklUSE19YDtcbmNvbnN0IFNJR05FUl9JTkZPX1NJR05FRF9BVFRSUyA9IGAke1NJR05FUl9JTkZPfS4ke1NJR05FRF9BVFRSU31gO1xuY29uc3QgU0lHTkVSX0lORk9fU0lHTkFUVVJFX0FMR09SSVRITSA9IGAke1NJR05FUl9JTkZPfS4ke1NJR05BVFVSRV9BTEdPUklUSE19YDtcbmNvbnN0IFNJR05FUl9JTkZPX1NJR05BVFVSRSA9IGAke1NJR05FUl9JTkZPfS4ke1NJR05BVFVSRX1gO1xuY29uc3QgU0lHTkVSX0lORk9fVU5TSUdORURfQVRUUlMgPSBgJHtTSUdORVJfSU5GT30uJHtVTlNJR05FRF9BVFRSU31gO1xuY29uc3QgQ0xFQVJfUFJPUFMkNSA9IFtcbiAgICBTSUdORVJfSU5GT19WRVJTSU9OLFxuICAgIFNJR05FUl9JTkZPX1NJRCxcbiAgICBTSUdORVJfSU5GT19ESUdFU1RfQUxHT1JJVEhNLFxuICAgIFNJR05FUl9JTkZPX1NJR05FRF9BVFRSUyxcbiAgICBTSUdORVJfSU5GT19TSUdOQVRVUkVfQUxHT1JJVEhNLFxuICAgIFNJR05FUl9JTkZPX1NJR05BVFVSRSxcbiAgICBTSUdORVJfSU5GT19VTlNJR05FRF9BVFRSU1xuXTtcbmNsYXNzIFNpZ25lckluZm8gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBWRVJTSU9OJDQsIFNpZ25lckluZm8uZGVmYXVsdFZhbHVlcyhWRVJTSU9OJDQpKTtcbiAgICAgICAgdGhpcy5zaWQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUQsIFNpZ25lckluZm8uZGVmYXVsdFZhbHVlcyhTSUQpKTtcbiAgICAgICAgdGhpcy5kaWdlc3RBbGdvcml0aG0gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBESUdFU1RfQUxHT1JJVEhNLCBTaWduZXJJbmZvLmRlZmF1bHRWYWx1ZXMoRElHRVNUX0FMR09SSVRITSkpO1xuICAgICAgICBpZiAoU0lHTkVEX0FUVFJTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc2lnbmVkQXR0cnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdORURfQVRUUlMsIFNpZ25lckluZm8uZGVmYXVsdFZhbHVlcyhTSUdORURfQVRUUlMpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNpZ25hdHVyZUFsZ29yaXRobSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNJR05BVFVSRV9BTEdPUklUSE0sIFNpZ25lckluZm8uZGVmYXVsdFZhbHVlcyhTSUdOQVRVUkVfQUxHT1JJVEhNKSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0lHTkFUVVJFLCBTaWduZXJJbmZvLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFKSk7XG4gICAgICAgIGlmIChVTlNJR05FRF9BVFRSUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnVuc2lnbmVkQXR0cnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBVTlNJR05FRF9BVFRSUywgU2lnbmVySW5mby5kZWZhdWx0VmFsdWVzKFVOU0lHTkVEX0FUVFJTKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kNDpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgU0lEOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkFueSgpO1xuICAgICAgICAgICAgY2FzZSBESUdFU1RfQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBTSUdORURfQVRUUlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMoeyB0eXBlOiAwIH0pO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcigpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoKTtcbiAgICAgICAgICAgIGNhc2UgVU5TSUdORURfQVRUUlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMoeyB0eXBlOiAxIH0pO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChTaWduZXJJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiQ0KSA9PT0gbWVtYmVyVmFsdWUpO1xuICAgICAgICAgICAgY2FzZSBTSUQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpO1xuICAgICAgICAgICAgY2FzZSBESUdFU1RfQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIGlmICgobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBBbGdvcml0aG1JZGVudGlmaWVyKSA9PT0gZmFsc2UpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVtYmVyVmFsdWUuaXNFcXVhbChTaWduZXJJbmZvLmRlZmF1bHRWYWx1ZXMoRElHRVNUX0FMR09SSVRITSkpO1xuICAgICAgICAgICAgY2FzZSBTSUdORURfQVRUUlM6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLmNvbXBhcmVXaXRoRGVmYXVsdChcInR5cGVcIiwgbWVtYmVyVmFsdWUudHlwZSkpXG4gICAgICAgICAgICAgICAgICAgICYmIChTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMuY29tcGFyZVdpdGhEZWZhdWx0KFwiYXR0cmlidXRlc1wiLCBtZW1iZXJWYWx1ZS5hdHRyaWJ1dGVzKSlcbiAgICAgICAgICAgICAgICAgICAgJiYgKFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcy5jb21wYXJlV2l0aERlZmF1bHQoXCJlbmNvZGVkVmFsdWVcIiwgbWVtYmVyVmFsdWUuZW5jb2RlZFZhbHVlKSkpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkVfQUxHT1JJVEhNOlxuICAgICAgICAgICAgICAgIGlmICgobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBBbGdvcml0aG1JZGVudGlmaWVyKSA9PT0gZmFsc2UpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVtYmVyVmFsdWUuaXNFcXVhbChTaWduZXJJbmZvLmRlZmF1bHRWYWx1ZXMoU0lHTkFUVVJFX0FMR09SSVRITSkpO1xuICAgICAgICAgICAgY2FzZSBTSUdOQVRVUkU6XG4gICAgICAgICAgICBjYXNlIFVOU0lHTkVEX0FUVFJTOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcy5jb21wYXJlV2l0aERlZmF1bHQoXCJ0eXBlXCIsIG1lbWJlclZhbHVlLnR5cGUpKVxuICAgICAgICAgICAgICAgICAgICAmJiAoU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLmNvbXBhcmVXaXRoRGVmYXVsdChcImF0dHJpYnV0ZXNcIiwgbWVtYmVyVmFsdWUuYXR0cmlidXRlcykpXG4gICAgICAgICAgICAgICAgICAgICYmIChTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMuY29tcGFyZVdpdGhEZWZhdWx0KFwiZW5jb2RlZFZhbHVlXCIsIG1lbWJlclZhbHVlLmVuY29kZWRWYWx1ZSkpKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IFNJR05FUl9JTkZPLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudmVyc2lvbiB8fCBTSUdORVJfSU5GT19WRVJTSU9OKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNob2ljZSh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIuc2NoZW1hKG5hbWVzLnNpZFNjaGVtYSB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBTSUdORVJfSU5GT19TSURcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ2hvaWNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLnNpZCB8fCBTSUdORVJfSU5GT19TSUQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5PY3RldFN0cmluZygpXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5QcmltaXRpdmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuc2lkIHx8IFNJR05FUl9JTkZPX1NJRCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuZGlnZXN0QWxnb3JpdGhtIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogU0lHTkVSX0lORk9fRElHRVNUX0FMR09SSVRITVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLnNjaGVtYShuYW1lcy5zaWduZWRBdHRycyB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFNJR05FUl9JTkZPX1NJR05FRF9BVFRSUyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgQWxnb3JpdGhtSWRlbnRpZmllci5zY2hlbWEobmFtZXMuc2lnbmF0dXJlQWxnb3JpdGhtIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogU0lHTkVSX0lORk9fU0lHTkFUVVJFX0FMR09SSVRITVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IG5hbWU6IChuYW1lcy5zaWduYXR1cmUgfHwgU0lHTkVSX0lORk9fU0lHTkFUVVJFKSB9KSxcbiAgICAgICAgICAgICAgICBTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMuc2NoZW1hKG5hbWVzLnVuc2lnbmVkQXR0cnMgfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBTSUdORVJfSU5GT19VTlNJR05FRF9BVFRSUyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQ1KTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBTaWduZXJJbmZvLnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gYXNuMS5yZXN1bHRbU0lHTkVSX0lORk9fVkVSU0lPTl0udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgY29uc3QgY3VycmVudFNpZCA9IGFzbjEucmVzdWx0W1NJR05FUl9JTkZPX1NJRF07XG4gICAgICAgIGlmIChjdXJyZW50U2lkLmlkQmxvY2sudGFnQ2xhc3MgPT09IDEpXG4gICAgICAgICAgICB0aGlzLnNpZCA9IG5ldyBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIoeyBzY2hlbWE6IGN1cnJlbnRTaWQgfSk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRoaXMuc2lkID0gY3VycmVudFNpZDtcbiAgICAgICAgdGhpcy5kaWdlc3RBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHRbU0lHTkVSX0lORk9fRElHRVNUX0FMR09SSVRITV0gfSk7XG4gICAgICAgIGlmIChTSUdORVJfSU5GT19TSUdORURfQVRUUlMgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnNpZ25lZEF0dHJzID0gbmV3IFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcyh7IHR5cGU6IDAsIHNjaGVtYTogYXNuMS5yZXN1bHRbU0lHTkVSX0lORk9fU0lHTkVEX0FUVFJTXSB9KTtcbiAgICAgICAgdGhpcy5zaWduYXR1cmVBbGdvcml0aG0gPSBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYXNuMS5yZXN1bHRbU0lHTkVSX0lORk9fU0lHTkFUVVJFX0FMR09SSVRITV0gfSk7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlID0gYXNuMS5yZXN1bHRbU0lHTkVSX0lORk9fU0lHTkFUVVJFXTtcbiAgICAgICAgaWYgKFNJR05FUl9JTkZPX1VOU0lHTkVEX0FUVFJTIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy51bnNpZ25lZEF0dHJzID0gbmV3IFNpZ25lZEFuZFVuc2lnbmVkQXR0cmlidXRlcyh7IHR5cGU6IDEsIHNjaGVtYTogYXNuMS5yZXN1bHRbU0lHTkVSX0lORk9fVU5TSUdORURfQVRUUlNdIH0pO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgaWYgKFNpZ25lckluZm8uY29tcGFyZVdpdGhEZWZhdWx0KFNJRCwgdGhpcy5zaWQpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5jb3JyZWN0bHkgaW5pdGlhbGl6ZWQgXFxcIlNpZ25lckluZm9cXFwiIGNsYXNzXCIpO1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSkpO1xuICAgICAgICBpZiAodGhpcy5zaWQgaW5zdGFuY2VvZiBJc3N1ZXJBbmRTZXJpYWxOdW1iZXIpXG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuc2lkLnRvU2NoZW1hKCkpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuc2lkKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLmRpZ2VzdEFsZ29yaXRobS50b1NjaGVtYSgpKTtcbiAgICAgICAgaWYgKHRoaXMuc2lnbmVkQXR0cnMpIHtcbiAgICAgICAgICAgIGlmIChTaWduZXJJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChTSUdORURfQVRUUlMsIHRoaXMuc2lnbmVkQXR0cnMpID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuc2lnbmVkQXR0cnMudG9TY2hlbWEoKSk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25hdHVyZUFsZ29yaXRobS50b1NjaGVtYSgpKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnNpZ25hdHVyZSk7XG4gICAgICAgIGlmICh0aGlzLnVuc2lnbmVkQXR0cnMpIHtcbiAgICAgICAgICAgIGlmIChTaWduZXJJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChVTlNJR05FRF9BVFRSUywgdGhpcy51bnNpZ25lZEF0dHJzKSA9PT0gZmFsc2UpXG4gICAgICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnVuc2lnbmVkQXR0cnMudG9TY2hlbWEoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgaWYgKFNpZ25lckluZm8uY29tcGFyZVdpdGhEZWZhdWx0KFNJRCwgdGhpcy5zaWQpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmNvcnJlY3RseSBpbml0aWFsaXplZCBcXFwiU2lnbmVySW5mb1xcXCIgY2xhc3NcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy52ZXJzaW9uLFxuICAgICAgICAgICAgZGlnZXN0QWxnb3JpdGhtOiB0aGlzLmRpZ2VzdEFsZ29yaXRobS50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZUFsZ29yaXRobTogdGhpcy5zaWduYXR1cmVBbGdvcml0aG0udG9KU09OKCksXG4gICAgICAgICAgICBzaWduYXR1cmU6IHRoaXMuc2lnbmF0dXJlLnRvSlNPTigpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAoISh0aGlzLnNpZCBpbnN0YW5jZW9mIGFzbjFqcy5BbnkpKVxuICAgICAgICAgICAgcmVzLnNpZCA9IHRoaXMuc2lkLnRvSlNPTigpO1xuICAgICAgICBpZiAodGhpcy5zaWduZWRBdHRycyAmJiBTaWduZXJJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChTSUdORURfQVRUUlMsIHRoaXMuc2lnbmVkQXR0cnMpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcmVzLnNpZ25lZEF0dHJzID0gdGhpcy5zaWduZWRBdHRycy50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy51bnNpZ25lZEF0dHJzICYmIFNpZ25lckluZm8uY29tcGFyZVdpdGhEZWZhdWx0KFVOU0lHTkVEX0FUVFJTLCB0aGlzLnVuc2lnbmVkQXR0cnMpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcmVzLnVuc2lnbmVkQXR0cnMgPSB0aGlzLnVuc2lnbmVkQXR0cnMudG9KU09OKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG5TaWduZXJJbmZvLkNMQVNTX05BTUUgPSBcIlNpZ25lckluZm9cIjtcblxuY29uc3QgVkVSU0lPTiQzID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBQT0xJQ1kgPSBcInBvbGljeVwiO1xuY29uc3QgTUVTU0FHRV9JTVBSSU5UJDEgPSBcIm1lc3NhZ2VJbXByaW50XCI7XG5jb25zdCBTRVJJQUxfTlVNQkVSID0gXCJzZXJpYWxOdW1iZXJcIjtcbmNvbnN0IEdFTl9USU1FID0gXCJnZW5UaW1lXCI7XG5jb25zdCBPUkRFUklORyA9IFwib3JkZXJpbmdcIjtcbmNvbnN0IE5PTkNFJDEgPSBcIm5vbmNlXCI7XG5jb25zdCBBQ0NVUkFDWSA9IFwiYWNjdXJhY3lcIjtcbmNvbnN0IFRTQSA9IFwidHNhXCI7XG5jb25zdCBFWFRFTlNJT05TJDEgPSBcImV4dGVuc2lvbnNcIjtcbmNvbnN0IFRTVF9JTkZPID0gXCJUU1RJbmZvXCI7XG5jb25zdCBUU1RfSU5GT19WRVJTSU9OID0gYCR7VFNUX0lORk99LiR7VkVSU0lPTiQzfWA7XG5jb25zdCBUU1RfSU5GT19QT0xJQ1kgPSBgJHtUU1RfSU5GT30uJHtQT0xJQ1l9YDtcbmNvbnN0IFRTVF9JTkZPX01FU1NBR0VfSU1QUklOVCA9IGAke1RTVF9JTkZPfS4ke01FU1NBR0VfSU1QUklOVCQxfWA7XG5jb25zdCBUU1RfSU5GT19TRVJJQUxfTlVNQkVSID0gYCR7VFNUX0lORk99LiR7U0VSSUFMX05VTUJFUn1gO1xuY29uc3QgVFNUX0lORk9fR0VOX1RJTUUgPSBgJHtUU1RfSU5GT30uJHtHRU5fVElNRX1gO1xuY29uc3QgVFNUX0lORk9fQUNDVVJBQ1kgPSBgJHtUU1RfSU5GT30uJHtBQ0NVUkFDWX1gO1xuY29uc3QgVFNUX0lORk9fT1JERVJJTkcgPSBgJHtUU1RfSU5GT30uJHtPUkRFUklOR31gO1xuY29uc3QgVFNUX0lORk9fTk9OQ0UgPSBgJHtUU1RfSU5GT30uJHtOT05DRSQxfWA7XG5jb25zdCBUU1RfSU5GT19UU0EgPSBgJHtUU1RfSU5GT30uJHtUU0F9YDtcbmNvbnN0IFRTVF9JTkZPX0VYVEVOU0lPTlMgPSBgJHtUU1RfSU5GT30uJHtFWFRFTlNJT05TJDF9YDtcbmNvbnN0IENMRUFSX1BST1BTJDQgPSBbXG4gICAgVFNUX0lORk9fVkVSU0lPTixcbiAgICBUU1RfSU5GT19QT0xJQ1ksXG4gICAgVFNUX0lORk9fTUVTU0FHRV9JTVBSSU5ULFxuICAgIFRTVF9JTkZPX1NFUklBTF9OVU1CRVIsXG4gICAgVFNUX0lORk9fR0VOX1RJTUUsXG4gICAgVFNUX0lORk9fQUNDVVJBQ1ksXG4gICAgVFNUX0lORk9fT1JERVJJTkcsXG4gICAgVFNUX0lORk9fTk9OQ0UsXG4gICAgVFNUX0lORk9fVFNBLFxuICAgIFRTVF9JTkZPX0VYVEVOU0lPTlNcbl07XG5jbGFzcyBUU1RJbmZvIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiQzLCBUU1RJbmZvLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiQzKSk7XG4gICAgICAgIHRoaXMucG9saWN5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUE9MSUNZLCBUU1RJbmZvLmRlZmF1bHRWYWx1ZXMoUE9MSUNZKSk7XG4gICAgICAgIHRoaXMubWVzc2FnZUltcHJpbnQgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBNRVNTQUdFX0lNUFJJTlQkMSwgVFNUSW5mby5kZWZhdWx0VmFsdWVzKE1FU1NBR0VfSU1QUklOVCQxKSk7XG4gICAgICAgIHRoaXMuc2VyaWFsTnVtYmVyID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgU0VSSUFMX05VTUJFUiwgVFNUSW5mby5kZWZhdWx0VmFsdWVzKFNFUklBTF9OVU1CRVIpKTtcbiAgICAgICAgdGhpcy5nZW5UaW1lID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgR0VOX1RJTUUsIFRTVEluZm8uZGVmYXVsdFZhbHVlcyhHRU5fVElNRSkpO1xuICAgICAgICBpZiAoQUNDVVJBQ1kgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5hY2N1cmFjeSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFDQ1VSQUNZLCBUU1RJbmZvLmRlZmF1bHRWYWx1ZXMoQUNDVVJBQ1kpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoT1JERVJJTkcgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5vcmRlcmluZyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE9SREVSSU5HLCBUU1RJbmZvLmRlZmF1bHRWYWx1ZXMoT1JERVJJTkcpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTk9OQ0UkMSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm5vbmNlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTk9OQ0UkMSwgVFNUSW5mby5kZWZhdWx0VmFsdWVzKE5PTkNFJDEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVFNBIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMudHNhID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVFNBLCBUU1RJbmZvLmRlZmF1bHRWYWx1ZXMoVFNBKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEVYVEVOU0lPTlMkMSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmV4dGVuc2lvbnMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBFWFRFTlNJT05TJDEsIFRTVEluZm8uZGVmYXVsdFZhbHVlcyhFWFRFTlNJT05TJDEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiQzOlxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSBQT0xJQ1k6XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGNhc2UgTUVTU0FHRV9JTVBSSU5UJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBNZXNzYWdlSW1wcmludCgpO1xuICAgICAgICAgICAgY2FzZSBTRVJJQUxfTlVNQkVSOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkludGVnZXIoKTtcbiAgICAgICAgICAgIGNhc2UgR0VOX1RJTUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKDAsIDAsIDApO1xuICAgICAgICAgICAgY2FzZSBBQ0NVUkFDWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFjY3VyYWN5KCk7XG4gICAgICAgICAgICBjYXNlIE9SREVSSU5HOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGNhc2UgTk9OQ0UkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIFRTQTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyYWxOYW1lKCk7XG4gICAgICAgICAgICBjYXNlIEVYVEVOU0lPTlMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kMzpcbiAgICAgICAgICAgIGNhc2UgUE9MSUNZOlxuICAgICAgICAgICAgY2FzZSBHRU5fVElNRTpcbiAgICAgICAgICAgIGNhc2UgT1JERVJJTkc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gVFNUSW5mby5kZWZhdWx0VmFsdWVzKE9SREVSSU5HKSk7XG4gICAgICAgICAgICBjYXNlIE1FU1NBR0VfSU1QUklOVCQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKE1lc3NhZ2VJbXByaW50LmNvbXBhcmVXaXRoRGVmYXVsdChIQVNIX0FMR09SSVRITSwgbWVtYmVyVmFsdWUuaGFzaEFsZ29yaXRobSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChNZXNzYWdlSW1wcmludC5jb21wYXJlV2l0aERlZmF1bHQoSEFTSEVEX01FU1NBR0UsIG1lbWJlclZhbHVlLmhhc2hlZE1lc3NhZ2UpKSk7XG4gICAgICAgICAgICBjYXNlIFNFUklBTF9OVU1CRVI6XG4gICAgICAgICAgICBjYXNlIE5PTkNFJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZS5pc0VxdWFsKFRTVEluZm8uZGVmYXVsdFZhbHVlcyhOT05DRSQxKSkpO1xuICAgICAgICAgICAgY2FzZSBBQ0NVUkFDWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKChBY2N1cmFjeS5jb21wYXJlV2l0aERlZmF1bHQoU0VDT05EUywgbWVtYmVyVmFsdWUuc2Vjb25kcykpICYmXG4gICAgICAgICAgICAgICAgICAgIChBY2N1cmFjeS5jb21wYXJlV2l0aERlZmF1bHQoTUlMTElTLCBtZW1iZXJWYWx1ZS5taWxsaXMpKSAmJlxuICAgICAgICAgICAgICAgICAgICAoQWNjdXJhY3kuY29tcGFyZVdpdGhEZWZhdWx0KE1JQ1JPUywgbWVtYmVyVmFsdWUubWljcm9zKSkpO1xuICAgICAgICAgICAgY2FzZSBUU0E6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoR2VuZXJhbE5hbWUuY29tcGFyZVdpdGhEZWZhdWx0KFRZUEUkNCwgbWVtYmVyVmFsdWUudHlwZSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChHZW5lcmFsTmFtZS5jb21wYXJlV2l0aERlZmF1bHQoVkFMVUUkNSwgbWVtYmVyVmFsdWUudmFsdWUpKSk7XG4gICAgICAgICAgICBjYXNlIEVYVEVOU0lPTlMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IFRTVF9JTkZPKSxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnZlcnNpb24gfHwgVFNUX0lORk9fVkVSU0lPTikgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgbmFtZTogKG5hbWVzLnBvbGljeSB8fCBUU1RfSU5GT19QT0xJQ1kpIH0pLFxuICAgICAgICAgICAgICAgIE1lc3NhZ2VJbXByaW50LnNjaGVtYShuYW1lcy5tZXNzYWdlSW1wcmludCB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRTVF9JTkZPX01FU1NBR0VfSU1QUklOVFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnNlcmlhbE51bWJlciB8fCBUU1RfSU5GT19TRVJJQUxfTlVNQkVSKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IG5hbWU6IChuYW1lcy5nZW5UaW1lIHx8IFRTVF9JTkZPX0dFTl9USU1FKSB9KSxcbiAgICAgICAgICAgICAgICBBY2N1cmFjeS5zY2hlbWEobmFtZXMuYWNjdXJhY3kgfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBUU1RfSU5GT19BQ0NVUkFDWVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5Cb29sZWFuKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLm9yZGVyaW5nIHx8IFRTVF9JTkZPX09SREVSSU5HKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMubm9uY2UgfHwgVFNUX0lORk9fTk9OQ0UpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtHZW5lcmFsTmFtZS5zY2hlbWEobmFtZXMudHNhIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRTVF9JTkZPX1RTQVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5leHRlbnNpb25zIHx8IFRTVF9JTkZPX0VYVEVOU0lPTlMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBFeHRlbnNpb24uc2NoZW1hKG5hbWVzLmV4dGVuc2lvbiB8fCB7fSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTJDQpO1xuICAgICAgICBjb25zdCBhc24xID0gYXNuMWpzLmNvbXBhcmVTY2hlbWEoc2NoZW1hLCBzY2hlbWEsIFRTVEluZm8uc2NoZW1hKCkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdFtUU1RfSU5GT19WRVJTSU9OXS52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLnBvbGljeSA9IGFzbjEucmVzdWx0W1RTVF9JTkZPX1BPTElDWV0udmFsdWVCbG9jay50b1N0cmluZygpO1xuICAgICAgICB0aGlzLm1lc3NhZ2VJbXByaW50ID0gbmV3IE1lc3NhZ2VJbXByaW50KHsgc2NoZW1hOiBhc24xLnJlc3VsdFtUU1RfSU5GT19NRVNTQUdFX0lNUFJJTlRdIH0pO1xuICAgICAgICB0aGlzLnNlcmlhbE51bWJlciA9IGFzbjEucmVzdWx0W1RTVF9JTkZPX1NFUklBTF9OVU1CRVJdO1xuICAgICAgICB0aGlzLmdlblRpbWUgPSBhc24xLnJlc3VsdFtUU1RfSU5GT19HRU5fVElNRV0udG9EYXRlKCk7XG4gICAgICAgIGlmIChUU1RfSU5GT19BQ0NVUkFDWSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuYWNjdXJhY3kgPSBuZXcgQWNjdXJhY3koeyBzY2hlbWE6IGFzbjEucmVzdWx0W1RTVF9JTkZPX0FDQ1VSQUNZXSB9KTtcbiAgICAgICAgaWYgKFRTVF9JTkZPX09SREVSSU5HIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5vcmRlcmluZyA9IGFzbjEucmVzdWx0W1RTVF9JTkZPX09SREVSSU5HXS52YWx1ZUJsb2NrLnZhbHVlO1xuICAgICAgICBpZiAoVFNUX0lORk9fTk9OQ0UgaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLm5vbmNlID0gYXNuMS5yZXN1bHRbVFNUX0lORk9fTk9OQ0VdO1xuICAgICAgICBpZiAoVFNUX0lORk9fVFNBIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy50c2EgPSBuZXcgR2VuZXJhbE5hbWUoeyBzY2hlbWE6IGFzbjEucmVzdWx0W1RTVF9JTkZPX1RTQV0gfSk7XG4gICAgICAgIGlmIChUU1RfSU5GT19FWFRFTlNJT05TIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5leHRlbnNpb25zID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdFtUU1RfSU5GT19FWFRFTlNJT05TXSwgZWxlbWVudCA9PiBuZXcgRXh0ZW5zaW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IHRoaXMucG9saWN5IH0pKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLm1lc3NhZ2VJbXByaW50LnRvU2NoZW1hKCkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuc2VyaWFsTnVtYmVyKTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkdlbmVyYWxpemVkVGltZSh7IHZhbHVlRGF0ZTogdGhpcy5nZW5UaW1lIH0pKTtcbiAgICAgICAgaWYgKHRoaXMuYWNjdXJhY3kpXG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuYWNjdXJhY3kudG9TY2hlbWEoKSk7XG4gICAgICAgIGlmICh0aGlzLm9yZGVyaW5nICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuQm9vbGVhbih7IHZhbHVlOiB0aGlzLm9yZGVyaW5nIH0pKTtcbiAgICAgICAgaWYgKHRoaXMubm9uY2UpXG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMubm9uY2UpO1xuICAgICAgICBpZiAodGhpcy50c2EpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogW3RoaXMudHNhLnRvU2NoZW1hKCldXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuZXh0ZW5zaW9ucywgbyA9PiBvLnRvU2NoZW1hKCkpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIHZhbHVlOiBvdXRwdXRBcnJheVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy52ZXJzaW9uLFxuICAgICAgICAgICAgcG9saWN5OiB0aGlzLnBvbGljeSxcbiAgICAgICAgICAgIG1lc3NhZ2VJbXByaW50OiB0aGlzLm1lc3NhZ2VJbXByaW50LnRvSlNPTigpLFxuICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiB0aGlzLnNlcmlhbE51bWJlci50b0pTT04oKSxcbiAgICAgICAgICAgIGdlblRpbWU6IHRoaXMuZ2VuVGltZVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5hY2N1cmFjeSlcbiAgICAgICAgICAgIHJlcy5hY2N1cmFjeSA9IHRoaXMuYWNjdXJhY3kudG9KU09OKCk7XG4gICAgICAgIGlmICh0aGlzLm9yZGVyaW5nICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXMub3JkZXJpbmcgPSB0aGlzLm9yZGVyaW5nO1xuICAgICAgICBpZiAodGhpcy5ub25jZSlcbiAgICAgICAgICAgIHJlcy5ub25jZSA9IHRoaXMubm9uY2UudG9KU09OKCk7XG4gICAgICAgIGlmICh0aGlzLnRzYSlcbiAgICAgICAgICAgIHJlcy50c2EgPSB0aGlzLnRzYS50b0pTT04oKTtcbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9ucylcbiAgICAgICAgICAgIHJlcy5leHRlbnNpb25zID0gQXJyYXkuZnJvbSh0aGlzLmV4dGVuc2lvbnMsIG8gPT4gby50b0pTT04oKSk7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuICAgIGFzeW5jIHZlcmlmeShwYXJhbXMsIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBpZiAoIXBhcmFtcy5kYXRhKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJcXFwiZGF0YVxcXCIgaXMgYSBtYW5kYXRvcnkgYXR0cmlidXRlIGZvciBUU1RfSU5GTyB2ZXJpZmljYXRpb25cIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGF0YSA9IHBhcmFtcy5kYXRhO1xuICAgICAgICBpZiAocGFyYW1zLm5vdEJlZm9yZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2VuVGltZSA8IHBhcmFtcy5ub3RCZWZvcmUpXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiR2VuZXJhdGlvbiB0aW1lIGZvciBUU1RJbmZvIG9iamVjdCBpcyBsZXNzIHRoYW4gbm90QmVmb3JlIHZhbHVlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbXMubm90QWZ0ZXIpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdlblRpbWUgPiBwYXJhbXMubm90QWZ0ZXIpXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiR2VuZXJhdGlvbiB0aW1lIGZvciBUU1RJbmZvIG9iamVjdCBpcyBtb3JlIHRoYW4gbm90QWZ0ZXIgdmFsdWVcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2hhQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHRoaXMubWVzc2FnZUltcHJpbnQuaGFzaEFsZ29yaXRobS5hbGdvcml0aG1JZCwgdHJ1ZSwgXCJNZXNzYWdlSW1wcmludC5oYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICBjb25zdCBoYXNoID0gYXdhaXQgY3J5cHRvLmRpZ2VzdChzaGFBbGdvcml0aG0ubmFtZSwgbmV3IFVpbnQ4QXJyYXkoZGF0YSkpO1xuICAgICAgICByZXR1cm4gcHZ0c3V0aWxzLkJ1ZmZlclNvdXJjZUNvbnZlcnRlci5pc0VxdWFsKGhhc2gsIHRoaXMubWVzc2FnZUltcHJpbnQuaGFzaGVkTWVzc2FnZS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgfVxufVxuVFNUSW5mby5DTEFTU19OQU1FID0gXCJUU1RJbmZvXCI7XG5cbmNvbnN0IFZFUlNJT04kMiA9IFwidmVyc2lvblwiO1xuY29uc3QgRElHRVNUX0FMR09SSVRITVMgPSBcImRpZ2VzdEFsZ29yaXRobXNcIjtcbmNvbnN0IEVOQ0FQX0NPTlRFTlRfSU5GTyA9IFwiZW5jYXBDb250ZW50SW5mb1wiO1xuY29uc3QgQ0VSVElGSUNBVEVTID0gXCJjZXJ0aWZpY2F0ZXNcIjtcbmNvbnN0IENSTFMgPSBcImNybHNcIjtcbmNvbnN0IFNJR05FUl9JTkZPUyA9IFwic2lnbmVySW5mb3NcIjtcbmNvbnN0IE9DU1BTID0gXCJvY3Nwc1wiO1xuY29uc3QgU0lHTkVEX0RBVEEgPSBcIlNpZ25lZERhdGFcIjtcbmNvbnN0IFNJR05FRF9EQVRBX1ZFUlNJT04gPSBgJHtTSUdORURfREFUQX0uJHtWRVJTSU9OJDJ9YDtcbmNvbnN0IFNJR05FRF9EQVRBX0RJR0VTVF9BTEdPUklUSE1TID0gYCR7U0lHTkVEX0RBVEF9LiR7RElHRVNUX0FMR09SSVRITVN9YDtcbmNvbnN0IFNJR05FRF9EQVRBX0VOQ0FQX0NPTlRFTlRfSU5GTyA9IGAke1NJR05FRF9EQVRBfS4ke0VOQ0FQX0NPTlRFTlRfSU5GT31gO1xuY29uc3QgU0lHTkVEX0RBVEFfQ0VSVElGSUNBVEVTID0gYCR7U0lHTkVEX0RBVEF9LiR7Q0VSVElGSUNBVEVTfWA7XG5jb25zdCBTSUdORURfREFUQV9DUkxTID0gYCR7U0lHTkVEX0RBVEF9LiR7Q1JMU31gO1xuY29uc3QgU0lHTkVEX0RBVEFfU0lHTkVSX0lORk9TID0gYCR7U0lHTkVEX0RBVEF9LiR7U0lHTkVSX0lORk9TfWA7XG5jb25zdCBDTEVBUl9QUk9QUyQzID0gW1xuICAgIFNJR05FRF9EQVRBX1ZFUlNJT04sXG4gICAgU0lHTkVEX0RBVEFfRElHRVNUX0FMR09SSVRITVMsXG4gICAgU0lHTkVEX0RBVEFfRU5DQVBfQ09OVEVOVF9JTkZPLFxuICAgIFNJR05FRF9EQVRBX0NFUlRJRklDQVRFUyxcbiAgICBTSUdORURfREFUQV9DUkxTLFxuICAgIFNJR05FRF9EQVRBX1NJR05FUl9JTkZPU1xuXTtcbmNsYXNzIFNpZ25lZERhdGFWZXJpZnlFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3Rvcih7IG1lc3NhZ2UsIGNvZGUgPSAwLCBkYXRlID0gbmV3IERhdGUoKSwgc2lnbmF0dXJlVmVyaWZpZWQgPSBudWxsLCBzaWduZXJDZXJ0aWZpY2F0ZSA9IG51bGwsIHNpZ25lckNlcnRpZmljYXRlVmVyaWZpZWQgPSBudWxsLCB0aW1lc3RhbXBTZXJpYWwgPSBudWxsLCBjZXJ0aWZpY2F0ZVBhdGggPSBbXSwgfSkge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5uYW1lID0gXCJTaWduZWREYXRhVmVyaWZ5RXJyb3JcIjtcbiAgICAgICAgdGhpcy5kYXRlID0gZGF0ZTtcbiAgICAgICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICAgICAgdGhpcy50aW1lc3RhbXBTZXJpYWwgPSB0aW1lc3RhbXBTZXJpYWw7XG4gICAgICAgIHRoaXMuc2lnbmF0dXJlVmVyaWZpZWQgPSBzaWduYXR1cmVWZXJpZmllZDtcbiAgICAgICAgdGhpcy5zaWduZXJDZXJ0aWZpY2F0ZSA9IHNpZ25lckNlcnRpZmljYXRlO1xuICAgICAgICB0aGlzLnNpZ25lckNlcnRpZmljYXRlVmVyaWZpZWQgPSBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkO1xuICAgICAgICB0aGlzLmNlcnRpZmljYXRlUGF0aCA9IGNlcnRpZmljYXRlUGF0aDtcbiAgICB9XG59XG5jbGFzcyBTaWduZWREYXRhIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiQyLCBTaWduZWREYXRhLmRlZmF1bHRWYWx1ZXMoVkVSU0lPTiQyKSk7XG4gICAgICAgIHRoaXMuZGlnZXN0QWxnb3JpdGhtcyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIERJR0VTVF9BTEdPUklUSE1TLCBTaWduZWREYXRhLmRlZmF1bHRWYWx1ZXMoRElHRVNUX0FMR09SSVRITVMpKTtcbiAgICAgICAgdGhpcy5lbmNhcENvbnRlbnRJbmZvID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgRU5DQVBfQ09OVEVOVF9JTkZPLCBTaWduZWREYXRhLmRlZmF1bHRWYWx1ZXMoRU5DQVBfQ09OVEVOVF9JTkZPKSk7XG4gICAgICAgIGlmIChDRVJUSUZJQ0FURVMgaW4gcGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhpcy5jZXJ0aWZpY2F0ZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDRVJUSUZJQ0FURVMsIFNpZ25lZERhdGEuZGVmYXVsdFZhbHVlcyhDRVJUSUZJQ0FURVMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQ1JMUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmNybHMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBDUkxTLCBTaWduZWREYXRhLmRlZmF1bHRWYWx1ZXMoQ1JMUykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChPQ1NQUyBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm9jc3BzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgT0NTUFMsIFNpZ25lZERhdGEuZGVmYXVsdFZhbHVlcyhPQ1NQUykpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2lnbmVySW5mb3MgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBTSUdORVJfSU5GT1MsIFNpZ25lZERhdGEuZGVmYXVsdFZhbHVlcyhTSUdORVJfSU5GT1MpKTtcbiAgICAgICAgaWYgKHBhcmFtZXRlcnMuc2NoZW1hKSB7XG4gICAgICAgICAgICB0aGlzLmZyb21TY2hlbWEocGFyYW1ldGVycy5zY2hlbWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT04kMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgRElHRVNUX0FMR09SSVRITVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBFTkNBUF9DT05URU5UX0lORk86XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBFbmNhcHN1bGF0ZWRDb250ZW50SW5mbygpO1xuICAgICAgICAgICAgY2FzZSBDRVJUSUZJQ0FURVM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBDUkxTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgT0NTUFM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSBTSUdORVJfSU5GT1M6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtZW1iZXJWYWx1ZSA9PT0gU2lnbmVkRGF0YS5kZWZhdWx0VmFsdWVzKFZFUlNJT04kMikpO1xuICAgICAgICAgICAgY2FzZSBFTkNBUF9DT05URU5UX0lORk86XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImVDb250ZW50VHlwZVwiLCBtZW1iZXJWYWx1ZS5lQ29udGVudFR5cGUpICYmXG4gICAgICAgICAgICAgICAgICAgIEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImVDb250ZW50XCIsIG1lbWJlclZhbHVlLmVDb250ZW50KTtcbiAgICAgICAgICAgIGNhc2UgRElHRVNUX0FMR09SSVRITVM6XG4gICAgICAgICAgICBjYXNlIENFUlRJRklDQVRFUzpcbiAgICAgICAgICAgIGNhc2UgQ1JMUzpcbiAgICAgICAgICAgIGNhc2UgT0NTUFM6XG4gICAgICAgICAgICBjYXNlIFNJR05FUl9JTkZPUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIGlmIChuYW1lcy5vcHRpb25hbCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBuYW1lcy5vcHRpb25hbCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IFNJR05FRF9EQVRBKSxcbiAgICAgICAgICAgIG9wdGlvbmFsOiBuYW1lcy5vcHRpb25hbCxcbiAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5JbnRlZ2VyKHsgbmFtZTogKG5hbWVzLnZlcnNpb24gfHwgU0lHTkVEX0RBVEFfVkVSU0lPTikgfSksXG4gICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5TZXQoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmRpZ2VzdEFsZ29yaXRobXMgfHwgU0lHTkVEX0RBVEFfRElHRVNUX0FMR09SSVRITVMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBBbGdvcml0aG1JZGVudGlmaWVyLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgRW5jYXBzdWxhdGVkQ29udGVudEluZm8uc2NoZW1hKG5hbWVzLmVuY2FwQ29udGVudEluZm8gfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBTSUdORURfREFUQV9FTkNBUF9DT05URU5UX0lORk9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuY2VydGlmaWNhdGVzIHx8IFNJR05FRF9EQVRBX0NFUlRJRklDQVRFUyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpZEJsb2NrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ051bWJlcjogMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogQ2VydGlmaWNhdGVTZXQuc2NoZW1hKCkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQ29uc3RydWN0ZWQoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnQ2xhc3M6IDMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdOdW1iZXI6IDFcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFJldm9jYXRpb25JbmZvQ2hvaWNlcy5zY2hlbWEobmFtZXMuY3JscyB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNybHM6IFNJR05FRF9EQVRBX0NSTFNcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSkudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuUmVwZWF0ZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5zaWduZXJJbmZvcyB8fCBTSUdORURfREFUQV9TSUdORVJfSU5GT1MpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBTaWduZXJJbmZvLnNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQzKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBTaWduZWREYXRhLnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gYXNuMS5yZXN1bHRbU0lHTkVEX0RBVEFfVkVSU0lPTl0udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgaWYgKFNJR05FRF9EQVRBX0RJR0VTVF9BTEdPUklUSE1TIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5kaWdlc3RBbGdvcml0aG1zID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdFtTSUdORURfREFUQV9ESUdFU1RfQUxHT1JJVEhNU10sIGFsZ29yaXRobSA9PiBuZXcgQWxnb3JpdGhtSWRlbnRpZmllcih7IHNjaGVtYTogYWxnb3JpdGhtIH0pKTtcbiAgICAgICAgdGhpcy5lbmNhcENvbnRlbnRJbmZvID0gbmV3IEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvKHsgc2NoZW1hOiBhc24xLnJlc3VsdFtTSUdORURfREFUQV9FTkNBUF9DT05URU5UX0lORk9dIH0pO1xuICAgICAgICBpZiAoU0lHTkVEX0RBVEFfQ0VSVElGSUNBVEVTIGluIGFzbjEucmVzdWx0KSB7XG4gICAgICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZVNldCA9IG5ldyBDZXJ0aWZpY2F0ZVNldCh7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiBuZXcgYXNuMWpzLlNldCh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhc24xLnJlc3VsdFtTSUdORURfREFUQV9DRVJUSUZJQ0FURVNdLnZhbHVlQmxvY2sudmFsdWVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmNlcnRpZmljYXRlcyA9IGNlcnRpZmljYXRlU2V0LmNlcnRpZmljYXRlcy5zbGljZSgwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoU0lHTkVEX0RBVEFfQ1JMUyBpbiBhc24xLnJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5jcmxzID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdFtTSUdORURfREFUQV9DUkxTXSwgKGNybCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjcmwuaWRCbG9jay50YWdDbGFzcyA9PT0gMSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0KHsgc2NoZW1hOiBjcmwgfSk7XG4gICAgICAgICAgICAgICAgY3JsLmlkQmxvY2sudGFnQ2xhc3MgPSAxO1xuICAgICAgICAgICAgICAgIGNybC5pZEJsb2NrLnRhZ051bWJlciA9IDE2O1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgT3RoZXJSZXZvY2F0aW9uSW5mb0Zvcm1hdCh7IHNjaGVtYTogY3JsIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFNJR05FRF9EQVRBX1NJR05FUl9JTkZPUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuc2lnbmVySW5mb3MgPSBBcnJheS5mcm9tKGFzbjEucmVzdWx0W1NJR05FRF9EQVRBX1NJR05FUl9JTkZPU10sIHNpZ25lckluZm9TY2hlbWEgPT4gbmV3IFNpZ25lckluZm8oeyBzY2hlbWE6IHNpZ25lckluZm9TY2hlbWEgfSkpO1xuICAgIH1cbiAgICB0b1NjaGVtYShlbmNvZGVGbGFnID0gZmFsc2UpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgaWYgKCh0aGlzLmNlcnRpZmljYXRlcyAmJiB0aGlzLmNlcnRpZmljYXRlcy5sZW5ndGggJiYgdGhpcy5jZXJ0aWZpY2F0ZXMuc29tZShvID0+IG8gaW5zdGFuY2VvZiBPdGhlckNlcnRpZmljYXRlRm9ybWF0KSlcbiAgICAgICAgICAgIHx8ICh0aGlzLmNybHMgJiYgdGhpcy5jcmxzLmxlbmd0aCAmJiB0aGlzLmNybHMuc29tZShvID0+IG8gaW5zdGFuY2VvZiBPdGhlclJldm9jYXRpb25JbmZvRm9ybWF0KSkpIHtcbiAgICAgICAgICAgIHRoaXMudmVyc2lvbiA9IDU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5jZXJ0aWZpY2F0ZXMgJiYgdGhpcy5jZXJ0aWZpY2F0ZXMubGVuZ3RoICYmIHRoaXMuY2VydGlmaWNhdGVzLnNvbWUobyA9PiBvIGluc3RhbmNlb2YgQXR0cmlidXRlQ2VydGlmaWNhdGVWMikpIHtcbiAgICAgICAgICAgIHRoaXMudmVyc2lvbiA9IDQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoKHRoaXMuY2VydGlmaWNhdGVzICYmIHRoaXMuY2VydGlmaWNhdGVzLmxlbmd0aCAmJiB0aGlzLmNlcnRpZmljYXRlcy5zb21lKG8gPT4gbyBpbnN0YW5jZW9mIEF0dHJpYnV0ZUNlcnRpZmljYXRlVjEpKVxuICAgICAgICAgICAgfHwgdGhpcy5zaWduZXJJbmZvcy5zb21lKG8gPT4gby52ZXJzaW9uID09PSAzKVxuICAgICAgICAgICAgfHwgdGhpcy5lbmNhcENvbnRlbnRJbmZvLmVDb250ZW50VHlwZSAhPT0gU2lnbmVkRGF0YS5JRF9EQVRBKSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSAzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy52ZXJzaW9uID0gMTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnZlcnNpb24gfSkpO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuZGlnZXN0QWxnb3JpdGhtcywgYWxnb3JpdGhtID0+IGFsZ29yaXRobS50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5lbmNhcENvbnRlbnRJbmZvLnRvU2NoZW1hKCkpO1xuICAgICAgICBpZiAodGhpcy5jZXJ0aWZpY2F0ZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGNlcnRpZmljYXRlU2V0ID0gbmV3IENlcnRpZmljYXRlU2V0KHsgY2VydGlmaWNhdGVzOiB0aGlzLmNlcnRpZmljYXRlcyB9KTtcbiAgICAgICAgICAgIGNvbnN0IGNlcnRpZmljYXRlU2V0U2NoZW1hID0gY2VydGlmaWNhdGVTZXQudG9TY2hlbWEoKTtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogY2VydGlmaWNhdGVTZXRTY2hlbWEudmFsdWVCbG9jay52YWx1ZVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNybHMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmNybHMsIGNybCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjcmwgaW5zdGFuY2VvZiBPdGhlclJldm9jYXRpb25JbmZvRm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjcmxTY2hlbWEgPSBjcmwudG9TY2hlbWEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNybFNjaGVtYS5pZEJsb2NrLnRhZ0NsYXNzID0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNybFNjaGVtYS5pZEJsb2NrLnRhZ051bWJlciA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3JsU2NoZW1hO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjcmwudG9TY2hlbWEoZW5jb2RlRmxhZyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuU2V0KHtcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5mcm9tKHRoaXMuc2lnbmVySW5mb3MsIHNpZ25lckluZm8gPT4gc2lnbmVySW5mby50b1NjaGVtYSgpKVxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIGRpZ2VzdEFsZ29yaXRobXM6IEFycmF5LmZyb20odGhpcy5kaWdlc3RBbGdvcml0aG1zLCBhbGdvcml0aG0gPT4gYWxnb3JpdGhtLnRvSlNPTigpKSxcbiAgICAgICAgICAgIGVuY2FwQ29udGVudEluZm86IHRoaXMuZW5jYXBDb250ZW50SW5mby50b0pTT04oKSxcbiAgICAgICAgICAgIHNpZ25lckluZm9zOiBBcnJheS5mcm9tKHRoaXMuc2lnbmVySW5mb3MsIHNpZ25lckluZm8gPT4gc2lnbmVySW5mby50b0pTT04oKSksXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmNlcnRpZmljYXRlcykge1xuICAgICAgICAgICAgcmVzLmNlcnRpZmljYXRlcyA9IEFycmF5LmZyb20odGhpcy5jZXJ0aWZpY2F0ZXMsIGNlcnRpZmljYXRlID0+IGNlcnRpZmljYXRlLnRvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jcmxzKSB7XG4gICAgICAgICAgICByZXMuY3JscyA9IEFycmF5LmZyb20odGhpcy5jcmxzLCBjcmwgPT4gY3JsLnRvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICBhc3luYyB2ZXJpZnkoeyBzaWduZXIgPSAoLTEpLCBkYXRhID0gKEVNUFRZX0JVRkZFUiksIHRydXN0ZWRDZXJ0cyA9IFtdLCBjaGVja0RhdGUgPSAobmV3IERhdGUoKSksIGNoZWNrQ2hhaW4gPSBmYWxzZSwgcGFzc2VkV2hlbk5vdFJldlZhbHVlcyA9IGZhbHNlLCBleHRlbmRlZE1vZGUgPSBmYWxzZSwgZmluZE9yaWdpbiA9IG51bGwsIGZpbmRJc3N1ZXIgPSBudWxsIH0gPSB7fSwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIGxldCBzaWduZXJDZXJ0ID0gbnVsbDtcbiAgICAgICAgbGV0IHRpbWVzdGFtcFNlcmlhbCA9IG51bGw7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgbWVzc2FnZURpZ2VzdFZhbHVlID0gRU1QVFlfQlVGRkVSO1xuICAgICAgICAgICAgbGV0IHNoYUFsZ29yaXRobSA9IEVNUFRZX1NUUklORztcbiAgICAgICAgICAgIGxldCBjZXJ0aWZpY2F0ZVBhdGggPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IHNpZ25lckluZm8gPSB0aGlzLnNpZ25lckluZm9zW3NpZ25lcl07XG4gICAgICAgICAgICBpZiAoIXNpZ25lckluZm8pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU2lnbmVkRGF0YVZlcmlmeUVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogY2hlY2tEYXRlLFxuICAgICAgICAgICAgICAgICAgICBjb2RlOiAxLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIlVuYWJsZSB0byBnZXQgc2lnbmVyIGJ5IHN1cHBsaWVkIGluZGV4XCIsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2VydGlmaWNhdGVzKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFNpZ25lZERhdGFWZXJpZnlFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGNoZWNrRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgY29kZTogMixcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJObyBjZXJ0aWZpY2F0ZXMgYXR0YWNoZWQgdG8gdGhpcyBzaWduZWQgZGF0YVwiLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNpZ25lckluZm8uc2lkIGluc3RhbmNlb2YgSXNzdWVyQW5kU2VyaWFsTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjZXJ0aWZpY2F0ZSBvZiB0aGlzLmNlcnRpZmljYXRlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShjZXJ0aWZpY2F0ZSBpbnN0YW5jZW9mIENlcnRpZmljYXRlKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoKGNlcnRpZmljYXRlLmlzc3Vlci5pc0VxdWFsKHNpZ25lckluZm8uc2lkLmlzc3VlcikpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAoY2VydGlmaWNhdGUuc2VyaWFsTnVtYmVyLmlzRXF1YWwoc2lnbmVySW5mby5zaWQuc2VyaWFsTnVtYmVyKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnQgPSBjZXJ0aWZpY2F0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2lkID0gc2lnbmVySW5mby5zaWQ7XG4gICAgICAgICAgICAgICAgY29uc3Qga2V5SWQgPSBzaWQuaWRCbG9jay5pc0NvbnN0cnVjdGVkXG4gICAgICAgICAgICAgICAgICAgID8gc2lkLnZhbHVlQmxvY2sudmFsdWVbMF0udmFsdWVCbG9jay52YWx1ZUhleFxuICAgICAgICAgICAgICAgICAgICA6IHNpZC52YWx1ZUJsb2NrLnZhbHVlSGV4O1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2VydGlmaWNhdGUgb2YgdGhpcy5jZXJ0aWZpY2F0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoY2VydGlmaWNhdGUgaW5zdGFuY2VvZiBDZXJ0aWZpY2F0ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpZ2VzdCA9IGF3YWl0IGNyeXB0by5kaWdlc3QoeyBuYW1lOiBcInNoYS0xXCIgfSwgY2VydGlmaWNhdGUuc3ViamVjdFB1YmxpY0tleUluZm8uc3ViamVjdFB1YmxpY0tleS52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwdnV0aWxzLmlzRXF1YWxCdWZmZXIoZGlnZXN0LCBrZXlJZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnQgPSBjZXJ0aWZpY2F0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFzaWduZXJDZXJ0KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFNpZ25lZERhdGFWZXJpZnlFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGNoZWNrRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgY29kZTogMyxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJVbmFibGUgdG8gZmluZCBzaWduZXIgY2VydGlmaWNhdGVcIixcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmVuY2FwQ29udGVudEluZm8uZUNvbnRlbnRUeXBlID09PSBpZF9lQ29udGVudFR5cGVfVFNUSW5mbykge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5lbmNhcENvbnRlbnRJbmZvLmVDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogY2hlY2tEYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogMTUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkVycm9yIGR1cmluZyB2ZXJpZmljYXRpb246IFRTVEluZm8gZUNvbnRlbnQgaXMgZW1wdHlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZVZlcmlmaWVkOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGU6IHNpZ25lckNlcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXBTZXJpYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsZXQgdHN0SW5mbztcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB0c3RJbmZvID0gVFNUSW5mby5mcm9tQkVSKHRoaXMuZW5jYXBDb250ZW50SW5mby5lQ29udGVudC52YWx1ZUJsb2NrLnZhbHVlSGV4Vmlldyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU2lnbmVkRGF0YVZlcmlmeUVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGNoZWNrRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IDE1LFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJFcnJvciBkdXJpbmcgdmVyaWZpY2F0aW9uOiBUU1RJbmZvIHdyb25nIEFTTi4xIHNjaGVtYSBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZVZlcmlmaWVkOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGU6IHNpZ25lckNlcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXBTZXJpYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjaGVja0RhdGUgPSB0c3RJbmZvLmdlblRpbWU7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wU2VyaWFsID0gdHN0SW5mby5zZXJpYWxOdW1iZXIudmFsdWVCbG9jay52YWx1ZUhleFZpZXcuc2xpY2UoKTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5ieXRlTGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogY2hlY2tEYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogNCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiTWlzc2VkIGRldGFjaGVkIGRhdGEgaW5wdXQgYXJyYXlcIixcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghKGF3YWl0IHRzdEluZm8udmVyaWZ5KHsgZGF0YSB9LCBjcnlwdG8pKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU2lnbmVkRGF0YVZlcmlmeUVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGNoZWNrRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IDE1LFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJFcnJvciBkdXJpbmcgdmVyaWZpY2F0aW9uOiBUU1RJbmZvIHZlcmlmaWNhdGlvbiBpcyBmYWlsZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZVZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wU2VyaWFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGVWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2hlY2tDaGFpbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNlcnRzID0gdGhpcy5jZXJ0aWZpY2F0ZXMuZmlsdGVyKGNlcnRpZmljYXRlID0+IChjZXJ0aWZpY2F0ZSBpbnN0YW5jZW9mIENlcnRpZmljYXRlICYmICEhY2hlY2tDQShjZXJ0aWZpY2F0ZSwgc2lnbmVyQ2VydCkpKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGFpblBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tEYXRlLFxuICAgICAgICAgICAgICAgICAgICBjZXJ0cyxcbiAgICAgICAgICAgICAgICAgICAgdHJ1c3RlZENlcnRzLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKGZpbmRJc3N1ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhaW5QYXJhbXMuZmluZElzc3VlciA9IGZpbmRJc3N1ZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmaW5kT3JpZ2luKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYWluUGFyYW1zLmZpbmRPcmlnaW4gPSBmaW5kT3JpZ2luO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBjaGFpbkVuZ2luZSA9IG5ldyBDZXJ0aWZpY2F0ZUNoYWluVmFsaWRhdGlvbkVuZ2luZShjaGFpblBhcmFtcyk7XG4gICAgICAgICAgICAgICAgY2hhaW5FbmdpbmUuY2VydHMucHVzaChzaWduZXJDZXJ0KTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jcmxzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY3JsIG9mIHRoaXMuY3Jscykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwidGhpc1VwZGF0ZVwiIGluIGNybClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFpbkVuZ2luZS5jcmxzLnB1c2goY3JsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjcmwub3RoZXJSZXZJbmZvRm9ybWF0ID09PSBpZF9QS0lYX09DU1BfQmFzaWMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYWluRW5naW5lLm9jc3BzLnB1c2gobmV3IEJhc2ljT0NTUFJlc3BvbnNlKHsgc2NoZW1hOiBjcmwub3RoZXJSZXZJbmZvIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vY3Nwcykge1xuICAgICAgICAgICAgICAgICAgICBjaGFpbkVuZ2luZS5vY3Nwcy5wdXNoKC4uLih0aGlzLm9jc3BzKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvblJlc3VsdCA9IGF3YWl0IGNoYWluRW5naW5lLnZlcmlmeSh7IHBhc3NlZFdoZW5Ob3RSZXZWYWx1ZXMgfSwgY3J5cHRvKVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogY2hlY2tEYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBWYWxpZGF0aW9uIG9mIHNpZ25lcidzIGNlcnRpZmljYXRlIGZhaWxlZCB3aXRoIGVycm9yOiAkeygoZSBpbnN0YW5jZW9mIE9iamVjdCkgPyBlLnJlc3VsdE1lc3NhZ2UgOiBlKX1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGU6IHNpZ25lckNlcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAodmVyaWZpY2F0aW9uUmVzdWx0LmNlcnRpZmljYXRlUGF0aCkge1xuICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0ZVBhdGggPSB2ZXJpZmljYXRpb25SZXN1bHQuY2VydGlmaWNhdGVQYXRoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXZlcmlmaWNhdGlvblJlc3VsdC5yZXN1bHQpXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogY2hlY2tEYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBWYWxpZGF0aW9uIG9mIHNpZ25lcidzIGNlcnRpZmljYXRlIGZhaWxlZDogJHt2ZXJpZmljYXRpb25SZXN1bHQucmVzdWx0TWVzc2FnZX1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGU6IHNpZ25lckNlcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNpZ25lckluZm9IYXNoQWxnb3JpdGhtID0gY3J5cHRvLmdldEFsZ29yaXRobUJ5T0lEKHNpZ25lckluZm8uZGlnZXN0QWxnb3JpdGhtLmFsZ29yaXRobUlkKTtcbiAgICAgICAgICAgIGlmICghKFwibmFtZVwiIGluIHNpZ25lckluZm9IYXNoQWxnb3JpdGhtKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBTaWduZWREYXRhVmVyaWZ5RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IDcsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBVbnN1cHBvcnRlZCBzaWduYXR1cmUgYWxnb3JpdGhtOiAke3NpZ25lckluZm8uZGlnZXN0QWxnb3JpdGhtLmFsZ29yaXRobUlkfWAsXG4gICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzaGFBbGdvcml0aG0gPSBzaWduZXJJbmZvSGFzaEFsZ29yaXRobS5uYW1lO1xuICAgICAgICAgICAgY29uc3QgZUNvbnRlbnQgPSB0aGlzLmVuY2FwQ29udGVudEluZm8uZUNvbnRlbnQ7XG4gICAgICAgICAgICBpZiAoZUNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoKGVDb250ZW50LmlkQmxvY2sudGFnQ2xhc3MgPT09IDEpICYmXG4gICAgICAgICAgICAgICAgICAgIChlQ29udGVudC5pZEJsb2NrLnRhZ051bWJlciA9PT0gNCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGVDb250ZW50LmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGVDb250ZW50LnZhbHVlQmxvY2sudmFsdWVCZWZvcmVEZWNvZGVWaWV3O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuYnl0ZUxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU2lnbmVkRGF0YVZlcmlmeUVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGNoZWNrRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IDgsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIk1pc3NlZCBkZXRhY2hlZCBkYXRhIGlucHV0IGFycmF5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZTogc2lnbmVyQ2VydCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlVmVyaWZpZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNpZ25lckluZm8uc2lnbmVkQXR0cnMpIHtcbiAgICAgICAgICAgICAgICBsZXQgZm91bmRDb250ZW50VHlwZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGxldCBmb3VuZE1lc3NhZ2VEaWdlc3QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZSBvZiBzaWduZXJJbmZvLnNpZ25lZEF0dHJzLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS50eXBlID09PSBcIjEuMi44NDAuMTEzNTQ5LjEuOS4zXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3VuZENvbnRlbnRUeXBlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS50eXBlID09PSBcIjEuMi44NDAuMTEzNTQ5LjEuOS40XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kTWVzc2FnZURpZ2VzdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlRGlnZXN0VmFsdWUgPSBhdHRyaWJ1dGUudmFsdWVzWzBdLnZhbHVlQmxvY2sudmFsdWVIZXg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kQ29udGVudFR5cGUgJiYgZm91bmRNZXNzYWdlRGlnZXN0KVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmb3VuZENvbnRlbnRUeXBlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU2lnbmVkRGF0YVZlcmlmeUVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGNoZWNrRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IDksXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkF0dHJpYnV0ZSBcXFwiY29udGVudC10eXBlXFxcIiBpcyBhIG1hbmRhdG9yeSBhdHRyaWJ1dGUgZm9yIFxcXCJzaWduZWQgYXR0cmlidXRlc1xcXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGVWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kTWVzc2FnZURpZ2VzdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFNpZ25lZERhdGFWZXJpZnlFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiAxMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiQXR0cmlidXRlIFxcXCJtZXNzYWdlLWRpZ2VzdFxcXCIgaXMgYSBtYW5kYXRvcnkgYXR0cmlidXRlIGZvciBcXFwic2lnbmVkIGF0dHJpYnV0ZXNcXFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduYXR1cmVWZXJpZmllZDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyQ2VydGlmaWNhdGVWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2lnbmVySW5mby5zaWduZWRBdHRycykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VEaWdlc3QgPSBhd2FpdCBjcnlwdG8uZGlnZXN0KHNoYUFsZ29yaXRobSwgbmV3IFVpbnQ4QXJyYXkoZGF0YSkpO1xuICAgICAgICAgICAgICAgIGlmICghcHZ1dGlscy5pc0VxdWFsQnVmZmVyKG1lc3NhZ2VEaWdlc3QsIG1lc3NhZ2VEaWdlc3RWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFNpZ25lZERhdGFWZXJpZnlFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiAxNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiRXJyb3IgZHVyaW5nIHZlcmlmaWNhdGlvbjogTWVzc2FnZSBkaWdlc3QgZG9lc24ndCBtYXRjaFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmF0dXJlVmVyaWZpZWQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZTogc2lnbmVyQ2VydCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcFNlcmlhbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlVmVyaWZpZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRhdGEgPSBzaWduZXJJbmZvLnNpZ25lZEF0dHJzLmVuY29kZWRWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHZlcmlmeVJlc3VsdCA9IHNpZ25lckluZm8uc2lnbmF0dXJlQWxnb3JpdGhtLmFsZ29yaXRobUlkID09PSBcIjEuMi44NDAuMTEzNTQ5LjEuMS4xXCJcbiAgICAgICAgICAgICAgICA/IGF3YWl0IGNyeXB0by52ZXJpZnlXaXRoUHVibGljS2V5KGRhdGEsIHNpZ25lckluZm8uc2lnbmF0dXJlLCBzaWduZXJDZXJ0LnN1YmplY3RQdWJsaWNLZXlJbmZvLCBzaWduZXJJbmZvLnNpZ25hdHVyZUFsZ29yaXRobSwgc2hhQWxnb3JpdGhtKVxuICAgICAgICAgICAgICAgIDogYXdhaXQgY3J5cHRvLnZlcmlmeVdpdGhQdWJsaWNLZXkoZGF0YSwgc2lnbmVySW5mby5zaWduYXR1cmUsIHNpZ25lckNlcnQuc3ViamVjdFB1YmxpY0tleUluZm8sIHNpZ25lckluZm8uc2lnbmF0dXJlQWxnb3JpdGhtKTtcbiAgICAgICAgICAgIGlmIChleHRlbmRlZE1vZGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IDE0LFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBFTVBUWV9TVFJJTkcsXG4gICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZVZlcmlmaWVkOiB2ZXJpZnlSZXN1bHQsXG4gICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXBTZXJpYWwsXG4gICAgICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRlUGF0aFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmVyaWZ5UmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFNpZ25lZERhdGFWZXJpZnlFcnJvcikge1xuICAgICAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgU2lnbmVkRGF0YVZlcmlmeUVycm9yKHtcbiAgICAgICAgICAgICAgICBkYXRlOiBjaGVja0RhdGUsXG4gICAgICAgICAgICAgICAgY29kZTogMTUsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYEVycm9yIGR1cmluZyB2ZXJpZmljYXRpb246ICR7ZSBpbnN0YW5jZW9mIEVycm9yID8gZS5tZXNzYWdlIDogZX1gLFxuICAgICAgICAgICAgICAgIHNpZ25hdHVyZVZlcmlmaWVkOiBudWxsLFxuICAgICAgICAgICAgICAgIHNpZ25lckNlcnRpZmljYXRlOiBzaWduZXJDZXJ0LFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcFNlcmlhbCxcbiAgICAgICAgICAgICAgICBzaWduZXJDZXJ0aWZpY2F0ZVZlcmlmaWVkOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBzaWduKHByaXZhdGVLZXksIHNpZ25lckluZGV4LCBoYXNoQWxnb3JpdGhtID0gXCJTSEEtMVwiLCBkYXRhID0gKEVNUFRZX0JVRkZFUiksIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICghcHJpdmF0ZUtleSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5lZWQgdG8gcHJvdmlkZSBhIHByaXZhdGUga2V5IGZvciBzaWduaW5nXCIpO1xuICAgICAgICBjb25zdCBzaWduZXJJbmZvID0gdGhpcy5zaWduZXJJbmZvc1tzaWduZXJJbmRleF07XG4gICAgICAgIGlmICghc2lnbmVySW5mbykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJTaWduZXJJbmZvIGluZGV4IGlzIG91dCBvZiByYW5nZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoISgoX2EgPSBzaWduZXJJbmZvLnNpZ25lZEF0dHJzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYXR0cmlidXRlcy5sZW5ndGgpICYmIFwiaGFzaFwiIGluIHByaXZhdGVLZXkuYWxnb3JpdGhtICYmIFwiaGFzaFwiIGluIHByaXZhdGVLZXkuYWxnb3JpdGhtICYmIHByaXZhdGVLZXkuYWxnb3JpdGhtLmhhc2gpIHtcbiAgICAgICAgICAgIGhhc2hBbGdvcml0aG0gPSBwcml2YXRlS2V5LmFsZ29yaXRobS5oYXNoLm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGFzaEFsZ29yaXRobU9JRCA9IGNyeXB0by5nZXRPSURCeUFsZ29yaXRobSh7IG5hbWU6IGhhc2hBbGdvcml0aG0gfSwgdHJ1ZSwgXCJoYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICBpZiAoKHRoaXMuZGlnZXN0QWxnb3JpdGhtcy5maWx0ZXIoYWxnb3JpdGhtID0+IGFsZ29yaXRobS5hbGdvcml0aG1JZCA9PT0gaGFzaEFsZ29yaXRobU9JRCkpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5kaWdlc3RBbGdvcml0aG1zLnB1c2gobmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgIGFsZ29yaXRobUlkOiBoYXNoQWxnb3JpdGhtT0lELFxuICAgICAgICAgICAgICAgIGFsZ29yaXRobVBhcmFtczogbmV3IGFzbjFqcy5OdWxsKClcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBzaWduZXJJbmZvLmRpZ2VzdEFsZ29yaXRobSA9IG5ldyBBbGdvcml0aG1JZGVudGlmaWVyKHtcbiAgICAgICAgICAgIGFsZ29yaXRobUlkOiBoYXNoQWxnb3JpdGhtT0lELFxuICAgICAgICAgICAgYWxnb3JpdGhtUGFyYW1zOiBuZXcgYXNuMWpzLk51bGwoKVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlUGFyYW1zID0gYXdhaXQgY3J5cHRvLmdldFNpZ25hdHVyZVBhcmFtZXRlcnMocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSk7XG4gICAgICAgIGNvbnN0IHBhcmFtZXRlcnMgPSBzaWduYXR1cmVQYXJhbXMucGFyYW1ldGVycztcbiAgICAgICAgc2lnbmVySW5mby5zaWduYXR1cmVBbGdvcml0aG0gPSBzaWduYXR1cmVQYXJhbXMuc2lnbmF0dXJlQWxnb3JpdGhtO1xuICAgICAgICBpZiAoc2lnbmVySW5mby5zaWduZWRBdHRycykge1xuICAgICAgICAgICAgaWYgKHNpZ25lckluZm8uc2lnbmVkQXR0cnMuZW5jb2RlZFZhbHVlLmJ5dGVMZW5ndGggIT09IDApXG4gICAgICAgICAgICAgICAgZGF0YSA9IHNpZ25lckluZm8uc2lnbmVkQXR0cnMuZW5jb2RlZFZhbHVlO1xuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IHNpZ25lckluZm8uc2lnbmVkQXR0cnMudG9TY2hlbWEoKS50b0JFUigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBwdnRzdXRpbHMuQnVmZmVyU291cmNlQ29udmVydGVyLnRvVWludDhBcnJheShkYXRhKTtcbiAgICAgICAgICAgICAgICB2aWV3WzBdID0gMHgzMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVDb250ZW50ID0gdGhpcy5lbmNhcENvbnRlbnRJbmZvLmVDb250ZW50O1xuICAgICAgICAgICAgaWYgKGVDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKChlQ29udGVudC5pZEJsb2NrLnRhZ0NsYXNzID09PSAxKSAmJlxuICAgICAgICAgICAgICAgICAgICAoZUNvbnRlbnQuaWRCbG9jay50YWdOdW1iZXIgPT09IDQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBlQ29udGVudC5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBlQ29udGVudC52YWx1ZUJsb2NrLnZhbHVlQmVmb3JlRGVjb2RlVmlldztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLmJ5dGVMZW5ndGggPT09IDApXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NlZCBkZXRhY2hlZCBkYXRhIGlucHV0IGFycmF5XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IGNyeXB0by5zaWduV2l0aFByaXZhdGVLZXkoZGF0YSwgcHJpdmF0ZUtleSwgcGFyYW1ldGVycyk7XG4gICAgICAgIHNpZ25lckluZm8uc2lnbmF0dXJlID0gbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBzaWduYXR1cmUgfSk7XG4gICAgfVxufVxuU2lnbmVkRGF0YS5DTEFTU19OQU1FID0gXCJTaWduZWREYXRhXCI7XG5TaWduZWREYXRhLklEX0RBVEEgPSBpZF9Db250ZW50VHlwZV9EYXRhO1xuXG5jb25zdCBWRVJTSU9OJDEgPSBcInZlcnNpb25cIjtcbmNvbnN0IEFVVEhfU0FGRSA9IFwiYXV0aFNhZmVcIjtcbmNvbnN0IE1BQ19EQVRBID0gXCJtYWNEYXRhXCI7XG5jb25zdCBQQVJTRURfVkFMVUUgPSBcInBhcnNlZFZhbHVlXCI7XG5jb25zdCBDTEVSQV9QUk9QUyA9IFtcbiAgICBWRVJTSU9OJDEsXG4gICAgQVVUSF9TQUZFLFxuICAgIE1BQ19EQVRBXG5dO1xuY2xhc3MgUEZYIGV4dGVuZHMgUGtpT2JqZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVkVSU0lPTiQxLCBQRlguZGVmYXVsdFZhbHVlcyhWRVJTSU9OJDEpKTtcbiAgICAgICAgdGhpcy5hdXRoU2FmZSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEFVVEhfU0FGRSwgUEZYLmRlZmF1bHRWYWx1ZXMoQVVUSF9TQUZFKSk7XG4gICAgICAgIGlmIChNQUNfREFUQSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm1hY0RhdGEgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBNQUNfREFUQSwgUEZYLmRlZmF1bHRWYWx1ZXMoTUFDX0RBVEEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoUEFSU0VEX1ZBTFVFIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2VkVmFsdWUgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBQQVJTRURfVkFMVUUsIFBGWC5kZWZhdWx0VmFsdWVzKFBBUlNFRF9WQUxVRSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLnNjaGVtYSkge1xuICAgICAgICAgICAgdGhpcy5mcm9tU2NoZW1hKHBhcmFtZXRlcnMuc2NoZW1hKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBWRVJTSU9OJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDM7XG4gICAgICAgICAgICBjYXNlIEFVVEhfU0FGRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBDb250ZW50SW5mbygpKTtcbiAgICAgICAgICAgIGNhc2UgTUFDX0RBVEE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgTWFjRGF0YSgpKTtcbiAgICAgICAgICAgIGNhc2UgUEFSU0VEX1ZBTFVFOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTiQxOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IFBGWC5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgQVVUSF9TQUZFOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImNvbnRlbnRUeXBlXCIsIG1lbWJlclZhbHVlLmNvbnRlbnRUeXBlKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKENvbnRlbnRJbmZvLmNvbXBhcmVXaXRoRGVmYXVsdChcImNvbnRlbnRcIiwgbWVtYmVyVmFsdWUuY29udGVudCkpKTtcbiAgICAgICAgICAgIGNhc2UgTUFDX0RBVEE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgoTWFjRGF0YS5jb21wYXJlV2l0aERlZmF1bHQoXCJtYWNcIiwgbWVtYmVyVmFsdWUubWFjKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKE1hY0RhdGEuY29tcGFyZVdpdGhEZWZhdWx0KFwibWFjU2FsdFwiLCBtZW1iZXJWYWx1ZS5tYWNTYWx0KSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKE1hY0RhdGEuY29tcGFyZVdpdGhEZWZhdWx0KFwiaXRlcmF0aW9uc1wiLCBtZW1iZXJWYWx1ZS5pdGVyYXRpb25zKSkpO1xuICAgICAgICAgICAgY2FzZSBQQVJTRURfVkFMVUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpICYmIChPYmplY3Qua2V5cyhtZW1iZXJWYWx1ZSkubGVuZ3RoID09PSAwKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy52ZXJzaW9uIHx8IFZFUlNJT04kMSkgfSksXG4gICAgICAgICAgICAgICAgQ29udGVudEluZm8uc2NoZW1hKG5hbWVzLmF1dGhTYWZlIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogQVVUSF9TQUZFXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBNYWNEYXRhLnNjaGVtYShuYW1lcy5tYWNEYXRhIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTmFtZTogTUFDX0RBVEEsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVSQV9QUk9QUyk7XG4gICAgICAgIGNvbnN0IGFzbjEgPSBhc24xanMuY29tcGFyZVNjaGVtYShzY2hlbWEsIHNjaGVtYSwgUEZYLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IFZFUlNJT04kMSxcbiAgICAgICAgICAgICAgICBhdXRoU2FmZToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBBVVRIX1NBRkVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWFjRGF0YToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBNQUNfREFUQVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGFzbjEucmVzdWx0LnZlcnNpb24udmFsdWVCbG9jay52YWx1ZURlYztcbiAgICAgICAgdGhpcy5hdXRoU2FmZSA9IG5ldyBDb250ZW50SW5mbyh7IHNjaGVtYTogYXNuMS5yZXN1bHQuYXV0aFNhZmUgfSk7XG4gICAgICAgIGlmIChNQUNfREFUQSBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMubWFjRGF0YSA9IG5ldyBNYWNEYXRhKHsgc2NoZW1hOiBhc24xLnJlc3VsdC5tYWNEYXRhIH0pO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXG4gICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyB2YWx1ZTogdGhpcy52ZXJzaW9uIH0pLFxuICAgICAgICAgICAgdGhpcy5hdXRoU2FmZS50b1NjaGVtYSgpXG4gICAgICAgIF07XG4gICAgICAgIGlmICh0aGlzLm1hY0RhdGEpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5tYWNEYXRhLnRvU2NoZW1hKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dCA9IHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIGF1dGhTYWZlOiB0aGlzLmF1dGhTYWZlLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLm1hY0RhdGEpIHtcbiAgICAgICAgICAgIG91dHB1dC5tYWNEYXRhID0gdGhpcy5tYWNEYXRhLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIGFzeW5jIG1ha2VJbnRlcm5hbFZhbHVlcyhwYXJhbWV0ZXJzID0ge30sIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICBBcmd1bWVudEVycm9yLmFzc2VydChwYXJhbWV0ZXJzLCBcInBhcmFtZXRlcnNcIiwgXCJvYmplY3RcIik7XG4gICAgICAgIGlmICghdGhpcy5wYXJzZWRWYWx1ZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGxlYXNlIGNhbGwgXFxcInBhcnNlVmFsdWVzXFxcIiBmdW5jdGlvbiBmaXJzdCBpbiBvcmRlciB0byBtYWtlIFxcXCJwYXJzZWRWYWx1ZVxcXCIgZGF0YVwiKTtcbiAgICAgICAgfVxuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnRFbXB0eSh0aGlzLnBhcnNlZFZhbHVlLmludGVncml0eU1vZGUsIFwiaW50ZWdyaXR5TW9kZVwiLCBcInBhcnNlZFZhbHVlXCIpO1xuICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnRFbXB0eSh0aGlzLnBhcnNlZFZhbHVlLmF1dGhlbnRpY2F0ZWRTYWZlLCBcImF1dGhlbnRpY2F0ZWRTYWZlXCIsIFwicGFyc2VkVmFsdWVcIik7XG4gICAgICAgIHN3aXRjaCAodGhpcy5wYXJzZWRWYWx1ZS5pbnRlZ3JpdHlNb2RlKSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShcIml0ZXJhdGlvbnNcIiBpbiBwYXJhbWV0ZXJzKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBQYXJhbWV0ZXJFcnJvcihcIml0ZXJhdGlvbnNcIik7XG4gICAgICAgICAgICAgICAgICAgIFBhcmFtZXRlckVycm9yLmFzc2VydEVtcHR5KHBhcmFtZXRlcnMucGJrZGYySGFzaEFsZ29yaXRobSwgXCJwYmtkZjJIYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnRFbXB0eShwYXJhbWV0ZXJzLmhtYWNIYXNoQWxnb3JpdGhtLCBcImhtYWNIYXNoQWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnRFbXB0eShwYXJhbWV0ZXJzLnBhc3N3b3JkLCBcInBhc3N3b3JkXCIpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzYWx0QnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKDY0KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2FsdFZpZXcgPSBuZXcgVWludDhBcnJheShzYWx0QnVmZmVyKTtcbiAgICAgICAgICAgICAgICAgICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhzYWx0Vmlldyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLnBhcnNlZFZhbHVlLmF1dGhlbnRpY2F0ZWRTYWZlLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dGhTYWZlID0gbmV3IENvbnRlbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBDb250ZW50SW5mby5EQVRBLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBkYXRhIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjcnlwdG8uc3RhbXBEYXRhV2l0aFBhc3N3b3JkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXJhbWV0ZXJzLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzaEFsZ29yaXRobTogcGFyYW1ldGVycy5obWFjSGFzaEFsZ29yaXRobSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbHQ6IHNhbHRCdWZmZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25Db3VudDogcGFyYW1ldGVycy5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFRvU3RhbXA6IGRhdGFcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWFjRGF0YSA9IG5ldyBNYWNEYXRhKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hYzogbmV3IERpZ2VzdEluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZ2VzdEFsZ29yaXRobTogbmV3IEFsZ29yaXRobUlkZW50aWZpZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1JZDogY3J5cHRvLmdldE9JREJ5QWxnb3JpdGhtKHsgbmFtZTogcGFyYW1ldGVycy5obWFjSGFzaEFsZ29yaXRobSB9LCB0cnVlLCBcImhtYWNIYXNoQWxnb3JpdGhtXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZ2VzdDogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiByZXN1bHQgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFjU2FsdDogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiBzYWx0QnVmZmVyIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlcmF0aW9uczogcGFyYW1ldGVycy5pdGVyYXRpb25zXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKFwic2lnbmluZ0NlcnRpZmljYXRlXCIgaW4gcGFyYW1ldGVycykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBQYXJhbWV0ZXJFcnJvcihcInNpZ25pbmdDZXJ0aWZpY2F0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBQYXJhbWV0ZXJFcnJvci5hc3NlcnRFbXB0eShwYXJhbWV0ZXJzLnByaXZhdGVLZXksIFwicHJpdmF0ZUtleVwiKTtcbiAgICAgICAgICAgICAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0RW1wdHkocGFyYW1ldGVycy5oYXNoQWxnb3JpdGhtLCBcImhhc2hBbGdvcml0aG1cIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvQmVTaWduZWQgPSB0aGlzLnBhcnNlZFZhbHVlLmF1dGhlbnRpY2F0ZWRTYWZlLnRvU2NoZW1hKCkudG9CRVIoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbXNTaWduZWQgPSBuZXcgU2lnbmVkRGF0YSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5jYXBDb250ZW50SW5mbzogbmV3IEVuY2Fwc3VsYXRlZENvbnRlbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlQ29udGVudFR5cGU6IFwiMS4yLjg0MC4xMTM1NDkuMS43LjFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlQ29udGVudDogbmV3IGFzbjFqcy5PY3RldFN0cmluZyh7IHZhbHVlSGV4OiB0b0JlU2lnbmVkIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRlczogW3BhcmFtZXRlcnMuc2lnbmluZ0NlcnRpZmljYXRlXVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3J5cHRvLmRpZ2VzdCh7IG5hbWU6IHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobSB9LCBuZXcgVWludDhBcnJheSh0b0JlU2lnbmVkKSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNpZ25lZEF0dHIgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgc2lnbmVkQXR0ci5wdXNoKG5ldyBBdHRyaWJ1dGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCIxLjIuODQwLjExMzU0OS4xLjkuM1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IGFzbjFqcy5PYmplY3RJZGVudGlmaWVyKHsgdmFsdWU6IFwiMS4yLjg0MC4xMTM1NDkuMS43LjFcIiB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIHNpZ25lZEF0dHIucHVzaChuZXcgQXR0cmlidXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiMS4yLjg0MC4xMTM1NDkuMS45LjVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuVVRDVGltZSh7IHZhbHVlRGF0ZTogbmV3IERhdGUoKSB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIHNpZ25lZEF0dHIucHVzaChuZXcgQXR0cmlidXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiMS4yLjg0MC4xMTM1NDkuMS45LjRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2N0ZXRTdHJpbmcoeyB2YWx1ZUhleDogcmVzdWx0IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgY21zU2lnbmVkLnNpZ25lckluZm9zLnB1c2gobmV3IFNpZ25lckluZm8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZDogbmV3IElzc3VlckFuZFNlcmlhbE51bWJlcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNzdWVyOiBwYXJhbWV0ZXJzLnNpZ25pbmdDZXJ0aWZpY2F0ZS5pc3N1ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VyaWFsTnVtYmVyOiBwYXJhbWV0ZXJzLnNpZ25pbmdDZXJ0aWZpY2F0ZS5zZXJpYWxOdW1iZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVkQXR0cnM6IG5ldyBTaWduZWRBbmRVbnNpZ25lZEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogc2lnbmVkQXR0clxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbXNTaWduZWQuc2lnbihwYXJhbWV0ZXJzLnByaXZhdGVLZXksIDAsIHBhcmFtZXRlcnMuaGFzaEFsZ29yaXRobSwgdW5kZWZpbmVkLCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dGhTYWZlID0gbmV3IENvbnRlbnRJbmZvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBcIjEuMi44NDAuMTEzNTQ5LjEuNy4yXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjbXNTaWduZWQudG9TY2hlbWEodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBhcmFtZXRlciBcImludGVncml0eU1vZGVcIiBoYXMgdW5rbm93biB2YWx1ZTogJHt0aGlzLnBhcnNlZFZhbHVlLmludGVncml0eU1vZGV9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgcGFyc2VJbnRlcm5hbFZhbHVlcyhwYXJhbWV0ZXJzLCBjcnlwdG8gPSBnZXRDcnlwdG8odHJ1ZSkpIHtcbiAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQocGFyYW1ldGVycywgXCJwYXJhbWV0ZXJzXCIsIFwib2JqZWN0XCIpO1xuICAgICAgICBpZiAocGFyYW1ldGVycy5jaGVja0ludGVncml0eSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLmNoZWNrSW50ZWdyaXR5ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcnNlZFZhbHVlID0ge307XG4gICAgICAgIHN3aXRjaCAodGhpcy5hdXRoU2FmZS5jb250ZW50VHlwZSkge1xuICAgICAgICAgICAgY2FzZSBDb250ZW50SW5mby5EQVRBOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0RW1wdHkocGFyYW1ldGVycy5wYXNzd29yZCwgXCJwYXNzd29yZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZS5pbnRlZ3JpdHlNb2RlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgQXJndW1lbnRFcnJvci5hc3NlcnQodGhpcy5hdXRoU2FmZS5jb250ZW50LCBcImF1dGhTYWZlLmNvbnRlbnRcIiwgYXNuMWpzLk9jdGV0U3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXV0aFNhZmVDb250ZW50ID0gdGhpcy5hdXRoU2FmZS5jb250ZW50LmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VkVmFsdWUuYXV0aGVudGljYXRlZFNhZmUgPSBBdXRoZW50aWNhdGVkU2FmZS5mcm9tQkVSKGF1dGhTYWZlQ29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbWV0ZXJzLmNoZWNrSW50ZWdyaXR5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubWFjRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFic2VudCBcXFwibWFjRGF0YVxcXCIgdmFsdWUsIGNhbiBub3QgY2hlY2sgUEtDUyMxMiBkYXRhIGludGVncml0eVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhhc2hBbGdvcml0aG0gPSBjcnlwdG8uZ2V0QWxnb3JpdGhtQnlPSUQodGhpcy5tYWNEYXRhLm1hYy5kaWdlc3RBbGdvcml0aG0uYWxnb3JpdGhtSWQsIHRydWUsIFwiZGlnZXN0QWxnb3JpdGhtXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3J5cHRvLnZlcmlmeURhdGFTdGFtcGVkV2l0aFBhc3N3b3JkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFyYW1ldGVycy5wYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoQWxnb3JpdGhtOiBoYXNoQWxnb3JpdGhtLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsdDogQnVmZmVyU291cmNlQ29udmVydGVyLnRvQXJyYXlCdWZmZXIodGhpcy5tYWNEYXRhLm1hY1NhbHQudmFsdWVCbG9jay52YWx1ZUhleFZpZXcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZXJhdGlvbkNvdW50OiB0aGlzLm1hY0RhdGEuaXRlcmF0aW9ucyB8fCAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUb1ZlcmlmeTogYXV0aFNhZmVDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZVRvVmVyaWZ5OiBCdWZmZXJTb3VyY2VDb252ZXJ0ZXIudG9BcnJheUJ1ZmZlcih0aGlzLm1hY0RhdGEubWFjLmRpZ2VzdC52YWx1ZUJsb2NrLnZhbHVlSGV4VmlldyksXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW50ZWdyaXR5IGZvciB0aGUgUEtDUyMxMiBkYXRhIGlzIGJyb2tlbiFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIENvbnRlbnRJbmZvLlNJR05FRF9EQVRBOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZWRWYWx1ZS5pbnRlZ3JpdHlNb2RlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY21zU2lnbmVkID0gbmV3IFNpZ25lZERhdGEoeyBzY2hlbWE6IHRoaXMuYXV0aFNhZmUuY29udGVudCB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZUNvbnRlbnQgPSBjbXNTaWduZWQuZW5jYXBDb250ZW50SW5mby5lQ29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgUGFyYW1ldGVyRXJyb3IuYXNzZXJ0KGVDb250ZW50LCBcImVDb250ZW50XCIsIFwiY21zU2lnbmVkLmVuY2FwQ29udGVudEluZm9cIik7XG4gICAgICAgICAgICAgICAgICAgIEFyZ3VtZW50RXJyb3IuYXNzZXJ0KGVDb250ZW50LCBcImVDb250ZW50XCIsIGFzbjFqcy5PY3RldFN0cmluZyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBlQ29udGVudC5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlZFZhbHVlLmF1dGhlbnRpY2F0ZWRTYWZlID0gQXV0aGVudGljYXRlZFNhZmUuZnJvbUJFUihkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2sgPSBhd2FpdCBjbXNTaWduZWQudmVyaWZ5KHsgc2lnbmVyOiAwLCBjaGVja0NoYWluOiBmYWxzZSB9LCBjcnlwdG8pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW9rKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnRlZ3JpdHkgZm9yIHRoZSBQS0NTIzEyIGRhdGEgaXMgYnJva2VuIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbmNvcnJlY3QgdmFsdWUgZm9yIFwidGhpcy5hdXRoU2FmZS5jb250ZW50VHlwZVwiOiAke3RoaXMuYXV0aFNhZmUuY29udGVudFR5cGV9YCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5QRlguQ0xBU1NfTkFNRSA9IFwiUEZYXCI7XG5cbmNvbnN0IFNUQVRVUyQxID0gXCJzdGF0dXNcIjtcbmNvbnN0IFNUQVRVU19TVFJJTkdTID0gXCJzdGF0dXNTdHJpbmdzXCI7XG5jb25zdCBGQUlMX0lORk8gPSBcImZhaWxJbmZvXCI7XG5jb25zdCBDTEVBUl9QUk9QUyQyID0gW1xuICAgIFNUQVRVUyQxLFxuICAgIFNUQVRVU19TVFJJTkdTLFxuICAgIEZBSUxfSU5GT1xuXTtcbnZhciBQS0lTdGF0dXM7XG4oZnVuY3Rpb24gKFBLSVN0YXR1cykge1xuICAgIFBLSVN0YXR1c1tQS0lTdGF0dXNbXCJncmFudGVkXCJdID0gMF0gPSBcImdyYW50ZWRcIjtcbiAgICBQS0lTdGF0dXNbUEtJU3RhdHVzW1wiZ3JhbnRlZFdpdGhNb2RzXCJdID0gMV0gPSBcImdyYW50ZWRXaXRoTW9kc1wiO1xuICAgIFBLSVN0YXR1c1tQS0lTdGF0dXNbXCJyZWplY3Rpb25cIl0gPSAyXSA9IFwicmVqZWN0aW9uXCI7XG4gICAgUEtJU3RhdHVzW1BLSVN0YXR1c1tcIndhaXRpbmdcIl0gPSAzXSA9IFwid2FpdGluZ1wiO1xuICAgIFBLSVN0YXR1c1tQS0lTdGF0dXNbXCJyZXZvY2F0aW9uV2FybmluZ1wiXSA9IDRdID0gXCJyZXZvY2F0aW9uV2FybmluZ1wiO1xuICAgIFBLSVN0YXR1c1tQS0lTdGF0dXNbXCJyZXZvY2F0aW9uTm90aWZpY2F0aW9uXCJdID0gNV0gPSBcInJldm9jYXRpb25Ob3RpZmljYXRpb25cIjtcbn0pKFBLSVN0YXR1cyB8fCAoUEtJU3RhdHVzID0ge30pKTtcbmNsYXNzIFBLSVN0YXR1c0luZm8gZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnN0YXR1cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNUQVRVUyQxLCBQS0lTdGF0dXNJbmZvLmRlZmF1bHRWYWx1ZXMoU1RBVFVTJDEpKTtcbiAgICAgICAgaWYgKFNUQVRVU19TVFJJTkdTIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzU3RyaW5ncyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNUQVRVU19TVFJJTkdTLCBQS0lTdGF0dXNJbmZvLmRlZmF1bHRWYWx1ZXMoU1RBVFVTX1NUUklOR1MpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoRkFJTF9JTkZPIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZmFpbEluZm8gPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBGQUlMX0lORk8sIFBLSVN0YXR1c0luZm8uZGVmYXVsdFZhbHVlcyhGQUlMX0lORk8pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU1RBVFVTJDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgICAgICBjYXNlIFNUQVRVU19TVFJJTkdTOlxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNhc2UgRkFJTF9JTkZPOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXNuMWpzLkJpdFN0cmluZygpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyZVdpdGhEZWZhdWx0KG1lbWJlck5hbWUsIG1lbWJlclZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAobWVtYmVyTmFtZSkge1xuICAgICAgICAgICAgY2FzZSBTVEFUVVMkMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlID09PSBQS0lTdGF0dXNJbmZvLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkpO1xuICAgICAgICAgICAgY2FzZSBTVEFUVVNfU1RSSU5HUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmxlbmd0aCA9PT0gMCk7XG4gICAgICAgICAgICBjYXNlIEZBSUxfSU5GTzpcbiAgICAgICAgICAgICAgICByZXR1cm4gKG1lbWJlclZhbHVlLmlzRXF1YWwoUEtJU3RhdHVzSW5mby5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuSW50ZWdlcih7IG5hbWU6IChuYW1lcy5zdGF0dXMgfHwgRU1QVFlfU1RSSU5HKSB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLlJlcGVhdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMuc3RhdHVzU3RyaW5ncyB8fCBFTVBUWV9TVFJJTkcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuZXcgYXNuMWpzLlV0ZjhTdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQml0U3RyaW5nKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmZhaWxJbmZvIHx8IEVNUFRZX1NUUklORyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQyKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBQS0lTdGF0dXNJbmZvLnNjaGVtYSh7XG4gICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgIHN0YXR1czogU1RBVFVTJDEsXG4gICAgICAgICAgICAgICAgc3RhdHVzU3RyaW5nczogU1RBVFVTX1NUUklOR1MsXG4gICAgICAgICAgICAgICAgZmFpbEluZm86IEZBSUxfSU5GT1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIEFzbkVycm9yLmFzc2VydFNjaGVtYShhc24xLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgICAgIGNvbnN0IF9zdGF0dXMgPSBhc24xLnJlc3VsdC5zdGF0dXM7XG4gICAgICAgIGlmICgoX3N0YXR1cy52YWx1ZUJsb2NrLmlzSGV4T25seSA9PT0gdHJ1ZSkgfHxcbiAgICAgICAgICAgIChfc3RhdHVzLnZhbHVlQmxvY2sudmFsdWVEZWMgPCAwKSB8fFxuICAgICAgICAgICAgKF9zdGF0dXMudmFsdWVCbG9jay52YWx1ZURlYyA+IDUpKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUEtJU3RhdHVzSW5mbyBcXFwic3RhdHVzXFxcIiBoYXMgaW52YWxpZCB2YWx1ZVwiKTtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBfc3RhdHVzLnZhbHVlQmxvY2sudmFsdWVEZWM7XG4gICAgICAgIGlmIChTVEFUVVNfU1RSSU5HUyBpbiBhc24xLnJlc3VsdClcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzU3RyaW5ncyA9IGFzbjEucmVzdWx0LnN0YXR1c1N0cmluZ3M7XG4gICAgICAgIGlmIChGQUlMX0lORk8gaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLmZhaWxJbmZvID0gYXNuMS5yZXN1bHQuZmFpbEluZm87XG4gICAgfVxuICAgIHRvU2NoZW1hKCkge1xuICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IFtdO1xuICAgICAgICBvdXRwdXRBcnJheS5wdXNoKG5ldyBhc24xanMuSW50ZWdlcih7IHZhbHVlOiB0aGlzLnN0YXR1cyB9KSk7XG4gICAgICAgIGlmICh0aGlzLnN0YXR1c1N0cmluZ3MpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuc3RhdHVzU3RyaW5nc1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZhaWxJbmZvKSB7XG4gICAgICAgICAgICBvdXRwdXRBcnJheS5wdXNoKHRoaXMuZmFpbEluZm8pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHN0YXR1czogdGhpcy5zdGF0dXNcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdHVzU3RyaW5ncykge1xuICAgICAgICAgICAgcmVzLnN0YXR1c1N0cmluZ3MgPSBBcnJheS5mcm9tKHRoaXMuc3RhdHVzU3RyaW5ncywgbyA9PiBvLnRvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5mYWlsSW5mbykge1xuICAgICAgICAgICAgcmVzLmZhaWxJbmZvID0gdGhpcy5mYWlsSW5mby50b0pTT04oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cblBLSVN0YXR1c0luZm8uQ0xBU1NfTkFNRSA9IFwiUEtJU3RhdHVzSW5mb1wiO1xuXG5jb25zdCBWRVJTSU9OID0gXCJ2ZXJzaW9uXCI7XG5jb25zdCBNRVNTQUdFX0lNUFJJTlQgPSBcIm1lc3NhZ2VJbXByaW50XCI7XG5jb25zdCBSRVFfUE9MSUNZID0gXCJyZXFQb2xpY3lcIjtcbmNvbnN0IE5PTkNFID0gXCJub25jZVwiO1xuY29uc3QgQ0VSVF9SRVEgPSBcImNlcnRSZXFcIjtcbmNvbnN0IEVYVEVOU0lPTlMgPSBcImV4dGVuc2lvbnNcIjtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRID0gXCJUaW1lU3RhbXBSZXFcIjtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRX1ZFUlNJT04gPSBgJHtUSU1FX1NUQU1QX1JFUX0uJHtWRVJTSU9OfWA7XG5jb25zdCBUSU1FX1NUQU1QX1JFUV9NRVNTQUdFX0lNUFJJTlQgPSBgJHtUSU1FX1NUQU1QX1JFUX0uJHtNRVNTQUdFX0lNUFJJTlR9YDtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRX1BPTElDWSA9IGAke1RJTUVfU1RBTVBfUkVRfS4ke1JFUV9QT0xJQ1l9YDtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRX05PTkNFID0gYCR7VElNRV9TVEFNUF9SRVF9LiR7Tk9OQ0V9YDtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRX0NFUlRfUkVRID0gYCR7VElNRV9TVEFNUF9SRVF9LiR7Q0VSVF9SRVF9YDtcbmNvbnN0IFRJTUVfU1RBTVBfUkVRX0VYVEVOU0lPTlMgPSBgJHtUSU1FX1NUQU1QX1JFUX0uJHtFWFRFTlNJT05TfWA7XG5jb25zdCBDTEVBUl9QUk9QUyQxID0gW1xuICAgIFRJTUVfU1RBTVBfUkVRX1ZFUlNJT04sXG4gICAgVElNRV9TVEFNUF9SRVFfTUVTU0FHRV9JTVBSSU5ULFxuICAgIFRJTUVfU1RBTVBfUkVRX1BPTElDWSxcbiAgICBUSU1FX1NUQU1QX1JFUV9OT05DRSxcbiAgICBUSU1FX1NUQU1QX1JFUV9DRVJUX1JFUSxcbiAgICBUSU1FX1NUQU1QX1JFUV9FWFRFTlNJT05TLFxuXTtcbmNsYXNzIFRpbWVTdGFtcFJlcSBleHRlbmRzIFBraU9iamVjdCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFZFUlNJT04sIFRpbWVTdGFtcFJlcS5kZWZhdWx0VmFsdWVzKFZFUlNJT04pKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlSW1wcmludCA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIE1FU1NBR0VfSU1QUklOVCwgVGltZVN0YW1wUmVxLmRlZmF1bHRWYWx1ZXMoTUVTU0FHRV9JTVBSSU5UKSk7XG4gICAgICAgIGlmIChSRVFfUE9MSUNZIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucmVxUG9saWN5ID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgUkVRX1BPTElDWSwgVGltZVN0YW1wUmVxLmRlZmF1bHRWYWx1ZXMoUkVRX1BPTElDWSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChOT05DRSBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm5vbmNlID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgTk9OQ0UsIFRpbWVTdGFtcFJlcS5kZWZhdWx0VmFsdWVzKE5PTkNFKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKENFUlRfUkVRIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuY2VydFJlcSA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIENFUlRfUkVRLCBUaW1lU3RhbXBSZXEuZGVmYXVsdFZhbHVlcyhDRVJUX1JFUSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChFWFRFTlNJT05TIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIEVYVEVOU0lPTlMsIFRpbWVTdGFtcFJlcS5kZWZhdWx0VmFsdWVzKEVYVEVOU0lPTlMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgVkVSU0lPTjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgTUVTU0FHRV9JTVBSSU5UOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTWVzc2FnZUltcHJpbnQoKTtcbiAgICAgICAgICAgIGNhc2UgUkVRX1BPTElDWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRU1QVFlfU1RSSU5HO1xuICAgICAgICAgICAgY2FzZSBOT05DRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGFzbjFqcy5JbnRlZ2VyKCk7XG4gICAgICAgICAgICBjYXNlIENFUlRfUkVROlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGNhc2UgRVhURU5TSU9OUzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlV2l0aERlZmF1bHQobWVtYmVyTmFtZSwgbWVtYmVyVmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChtZW1iZXJOYW1lKSB7XG4gICAgICAgICAgICBjYXNlIFZFUlNJT046XG4gICAgICAgICAgICBjYXNlIFJFUV9QT0xJQ1k6XG4gICAgICAgICAgICBjYXNlIENFUlRfUkVROlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUgPT09IFRpbWVTdGFtcFJlcS5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpKTtcbiAgICAgICAgICAgIGNhc2UgTUVTU0FHRV9JTVBSSU5UOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKE1lc3NhZ2VJbXByaW50LmNvbXBhcmVXaXRoRGVmYXVsdChcImhhc2hBbGdvcml0aG1cIiwgbWVtYmVyVmFsdWUuaGFzaEFsZ29yaXRobSkpICYmXG4gICAgICAgICAgICAgICAgICAgIChNZXNzYWdlSW1wcmludC5jb21wYXJlV2l0aERlZmF1bHQoXCJoYXNoZWRNZXNzYWdlXCIsIG1lbWJlclZhbHVlLmhhc2hlZE1lc3NhZ2UpKSk7XG4gICAgICAgICAgICBjYXNlIE5PTkNFOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUuaXNFcXVhbChUaW1lU3RhbXBSZXEuZGVmYXVsdFZhbHVlcyhtZW1iZXJOYW1lKSkpO1xuICAgICAgICAgICAgY2FzZSBFWFRFTlNJT05TOlxuICAgICAgICAgICAgICAgIHJldHVybiAobWVtYmVyVmFsdWUubGVuZ3RoID09PSAwKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHNjaGVtYShwYXJhbWV0ZXJzID0ge30pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBwdnV0aWxzLmdldFBhcmFtZXRlcnNWYWx1ZShwYXJhbWV0ZXJzLCBcIm5hbWVzXCIsIHt9KTtcbiAgICAgICAgcmV0dXJuIChuZXcgYXNuMWpzLlNlcXVlbmNlKHtcbiAgICAgICAgICAgIG5hbWU6IChuYW1lcy5ibG9ja05hbWUgfHwgVElNRV9TVEFNUF9SRVEpLFxuICAgICAgICAgICAgdmFsdWU6IFtcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoeyBuYW1lOiAobmFtZXMudmVyc2lvbiB8fCBUSU1FX1NUQU1QX1JFUV9WRVJTSU9OKSB9KSxcbiAgICAgICAgICAgICAgICBNZXNzYWdlSW1wcmludC5zY2hlbWEobmFtZXMubWVzc2FnZUltcHJpbnQgfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tOYW1lOiBUSU1FX1NUQU1QX1JFUV9NRVNTQUdFX0lNUFJJTlRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuT2JqZWN0SWRlbnRpZmllcih7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5yZXFQb2xpY3kgfHwgVElNRV9TVEFNUF9SRVFfUE9MSUNZKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkludGVnZXIoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAobmFtZXMubm9uY2UgfHwgVElNRV9TVEFNUF9SRVFfTk9OQ0UpLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIG5ldyBhc24xanMuQm9vbGVhbih7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IChuYW1lcy5jZXJ0UmVxIHx8IFRJTUVfU1RBTVBfUkVRX0NFUlRfUkVRKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBuZXcgYXNuMWpzLkNvbnN0cnVjdGVkKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlkQmxvY2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0NsYXNzOiAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbbmV3IGFzbjFqcy5SZXBlYXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogKG5hbWVzLmV4dGVuc2lvbnMgfHwgVElNRV9TVEFNUF9SRVFfRVhURU5TSU9OUyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEV4dGVuc2lvbi5zY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSldXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBmcm9tU2NoZW1hKHNjaGVtYSkge1xuICAgICAgICBwdnV0aWxzLmNsZWFyUHJvcHMoc2NoZW1hLCBDTEVBUl9QUk9QUyQxKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBUaW1lU3RhbXBSZXEuc2NoZW1hKCkpO1xuICAgICAgICBBc25FcnJvci5hc3NlcnRTY2hlbWEoYXNuMSwgdGhpcy5jbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSBhc24xLnJlc3VsdFtUSU1FX1NUQU1QX1JFUV9WRVJTSU9OXS52YWx1ZUJsb2NrLnZhbHVlRGVjO1xuICAgICAgICB0aGlzLm1lc3NhZ2VJbXByaW50ID0gbmV3IE1lc3NhZ2VJbXByaW50KHsgc2NoZW1hOiBhc24xLnJlc3VsdFtUSU1FX1NUQU1QX1JFUV9NRVNTQUdFX0lNUFJJTlRdIH0pO1xuICAgICAgICBpZiAoVElNRV9TVEFNUF9SRVFfUE9MSUNZIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5yZXFQb2xpY3kgPSBhc24xLnJlc3VsdFtUSU1FX1NUQU1QX1JFUV9QT0xJQ1ldLnZhbHVlQmxvY2sudG9TdHJpbmcoKTtcbiAgICAgICAgaWYgKFRJTUVfU1RBTVBfUkVRX05PTkNFIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5ub25jZSA9IGFzbjEucmVzdWx0W1RJTUVfU1RBTVBfUkVRX05PTkNFXTtcbiAgICAgICAgaWYgKFRJTUVfU1RBTVBfUkVRX0NFUlRfUkVRIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5jZXJ0UmVxID0gYXNuMS5yZXN1bHRbVElNRV9TVEFNUF9SRVFfQ0VSVF9SRVFdLnZhbHVlQmxvY2sudmFsdWU7XG4gICAgICAgIGlmIChUSU1FX1NUQU1QX1JFUV9FWFRFTlNJT05TIGluIGFzbjEucmVzdWx0KVxuICAgICAgICAgICAgdGhpcy5leHRlbnNpb25zID0gQXJyYXkuZnJvbShhc24xLnJlc3VsdFtUSU1FX1NUQU1QX1JFUV9FWFRFTlNJT05TXSwgZWxlbWVudCA9PiBuZXcgRXh0ZW5zaW9uKHsgc2NoZW1hOiBlbGVtZW50IH0pKTtcbiAgICB9XG4gICAgdG9TY2hlbWEoKSB7XG4gICAgICAgIGNvbnN0IG91dHB1dEFycmF5ID0gW107XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5JbnRlZ2VyKHsgdmFsdWU6IHRoaXMudmVyc2lvbiB9KSk7XG4gICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5tZXNzYWdlSW1wcmludC50b1NjaGVtYSgpKTtcbiAgICAgICAgaWYgKHRoaXMucmVxUG9saWN5KVxuICAgICAgICAgICAgb3V0cHV0QXJyYXkucHVzaChuZXcgYXNuMWpzLk9iamVjdElkZW50aWZpZXIoeyB2YWx1ZTogdGhpcy5yZXFQb2xpY3kgfSkpO1xuICAgICAgICBpZiAodGhpcy5ub25jZSlcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy5ub25jZSk7XG4gICAgICAgIGlmICgoQ0VSVF9SRVEgaW4gdGhpcykgJiYgKFRpbWVTdGFtcFJlcS5jb21wYXJlV2l0aERlZmF1bHQoQ0VSVF9SRVEsIHRoaXMuY2VydFJlcSkgPT09IGZhbHNlKSlcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Cb29sZWFuKHsgdmFsdWU6IHRoaXMuY2VydFJlcSB9KSk7XG4gICAgICAgIGlmICh0aGlzLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2gobmV3IGFzbjFqcy5Db25zdHJ1Y3RlZCh7XG4gICAgICAgICAgICAgICAgaWRCbG9jazoge1xuICAgICAgICAgICAgICAgICAgICB0YWdDbGFzczogMyxcbiAgICAgICAgICAgICAgICAgICAgdGFnTnVtYmVyOiAwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbSh0aGlzLmV4dGVuc2lvbnMsIG8gPT4gby50b1NjaGVtYSgpKVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICB2YWx1ZTogb3V0cHV0QXJyYXlcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMudmVyc2lvbixcbiAgICAgICAgICAgIG1lc3NhZ2VJbXByaW50OiB0aGlzLm1lc3NhZ2VJbXByaW50LnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnJlcVBvbGljeSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmVzLnJlcVBvbGljeSA9IHRoaXMucmVxUG9saWN5O1xuICAgICAgICBpZiAodGhpcy5ub25jZSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmVzLm5vbmNlID0gdGhpcy5ub25jZS50b0pTT04oKTtcbiAgICAgICAgaWYgKCh0aGlzLmNlcnRSZXEgIT09IHVuZGVmaW5lZCkgJiYgKFRpbWVTdGFtcFJlcS5jb21wYXJlV2l0aERlZmF1bHQoQ0VSVF9SRVEsIHRoaXMuY2VydFJlcSkgPT09IGZhbHNlKSlcbiAgICAgICAgICAgIHJlcy5jZXJ0UmVxID0gdGhpcy5jZXJ0UmVxO1xuICAgICAgICBpZiAodGhpcy5leHRlbnNpb25zKSB7XG4gICAgICAgICAgICByZXMuZXh0ZW5zaW9ucyA9IEFycmF5LmZyb20odGhpcy5leHRlbnNpb25zLCBvID0+IG8udG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxufVxuVGltZVN0YW1wUmVxLkNMQVNTX05BTUUgPSBcIlRpbWVTdGFtcFJlcVwiO1xuXG5jb25zdCBTVEFUVVMgPSBcInN0YXR1c1wiO1xuY29uc3QgVElNRV9TVEFNUF9UT0tFTiA9IFwidGltZVN0YW1wVG9rZW5cIjtcbmNvbnN0IFRJTUVfU1RBTVBfUkVTUCA9IFwiVGltZVN0YW1wUmVzcFwiO1xuY29uc3QgVElNRV9TVEFNUF9SRVNQX1NUQVRVUyA9IGAke1RJTUVfU1RBTVBfUkVTUH0uJHtTVEFUVVN9YDtcbmNvbnN0IFRJTUVfU1RBTVBfUkVTUF9UT0tFTiA9IGAke1RJTUVfU1RBTVBfUkVTUH0uJHtUSU1FX1NUQU1QX1RPS0VOfWA7XG5jb25zdCBDTEVBUl9QUk9QUyA9IFtcbiAgICBUSU1FX1NUQU1QX1JFU1BfU1RBVFVTLFxuICAgIFRJTUVfU1RBTVBfUkVTUF9UT0tFTlxuXTtcbmNsYXNzIFRpbWVTdGFtcFJlc3AgZXh0ZW5kcyBQa2lPYmplY3Qge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMgPSB7fSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnN0YXR1cyA9IHB2dXRpbHMuZ2V0UGFyYW1ldGVyc1ZhbHVlKHBhcmFtZXRlcnMsIFNUQVRVUywgVGltZVN0YW1wUmVzcC5kZWZhdWx0VmFsdWVzKFNUQVRVUykpO1xuICAgICAgICBpZiAoVElNRV9TVEFNUF9UT0tFTiBpbiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVTdGFtcFRva2VuID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgVElNRV9TVEFNUF9UT0tFTiwgVGltZVN0YW1wUmVzcC5kZWZhdWx0VmFsdWVzKFRJTUVfU1RBTVBfVE9LRU4pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1ldGVycy5zY2hlbWEpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvbVNjaGVtYShwYXJhbWV0ZXJzLnNjaGVtYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU1RBVFVTOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUEtJU3RhdHVzSW5mbygpO1xuICAgICAgICAgICAgY2FzZSBUSU1FX1NUQU1QX1RPS0VOOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29udGVudEluZm8oKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlZmF1bHRWYWx1ZXMobWVtYmVyTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmVXaXRoRGVmYXVsdChtZW1iZXJOYW1lLCBtZW1iZXJWYWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKG1lbWJlck5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgU1RBVFVTOlxuICAgICAgICAgICAgICAgIHJldHVybiAoKFBLSVN0YXR1c0luZm8uY29tcGFyZVdpdGhEZWZhdWx0KFNUQVRVUywgbWVtYmVyVmFsdWUuc3RhdHVzKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKChcInN0YXR1c1N0cmluZ3NcIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSAmJlxuICAgICAgICAgICAgICAgICAgICAoKFwiZmFpbEluZm9cIiBpbiBtZW1iZXJWYWx1ZSkgPT09IGZhbHNlKSk7XG4gICAgICAgICAgICBjYXNlIFRJTUVfU1RBTVBfVE9LRU46XG4gICAgICAgICAgICAgICAgcmV0dXJuICgobWVtYmVyVmFsdWUuY29udGVudFR5cGUgPT09IEVNUFRZX1NUUklORykgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1lbWJlclZhbHVlLmNvbnRlbnQgaW5zdGFuY2VvZiBhc24xanMuQW55KSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZWZhdWx0VmFsdWVzKG1lbWJlck5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBzY2hlbWEocGFyYW1ldGVycyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG5hbWVzID0gcHZ1dGlscy5nZXRQYXJhbWV0ZXJzVmFsdWUocGFyYW1ldGVycywgXCJuYW1lc1wiLCB7fSk7XG4gICAgICAgIHJldHVybiAobmV3IGFzbjFqcy5TZXF1ZW5jZSh7XG4gICAgICAgICAgICBuYW1lOiAobmFtZXMuYmxvY2tOYW1lIHx8IFRJTUVfU1RBTVBfUkVTUCksXG4gICAgICAgICAgICB2YWx1ZTogW1xuICAgICAgICAgICAgICAgIFBLSVN0YXR1c0luZm8uc2NoZW1hKG5hbWVzLnN0YXR1cyB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRJTUVfU1RBTVBfUkVTUF9TVEFUVVNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIENvbnRlbnRJbmZvLnNjaGVtYShuYW1lcy50aW1lU3RhbXBUb2tlbiB8fCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBibG9ja05hbWU6IFRJTUVfU1RBTVBfUkVTUF9UT0tFTixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZyb21TY2hlbWEoc2NoZW1hKSB7XG4gICAgICAgIHB2dXRpbHMuY2xlYXJQcm9wcyhzY2hlbWEsIENMRUFSX1BST1BTKTtcbiAgICAgICAgY29uc3QgYXNuMSA9IGFzbjFqcy5jb21wYXJlU2NoZW1hKHNjaGVtYSwgc2NoZW1hLCBUaW1lU3RhbXBSZXNwLnNjaGVtYSgpKTtcbiAgICAgICAgQXNuRXJyb3IuYXNzZXJ0U2NoZW1hKGFzbjEsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBuZXcgUEtJU3RhdHVzSW5mbyh7IHNjaGVtYTogYXNuMS5yZXN1bHRbVElNRV9TVEFNUF9SRVNQX1NUQVRVU10gfSk7XG4gICAgICAgIGlmIChUSU1FX1NUQU1QX1JFU1BfVE9LRU4gaW4gYXNuMS5yZXN1bHQpXG4gICAgICAgICAgICB0aGlzLnRpbWVTdGFtcFRva2VuID0gbmV3IENvbnRlbnRJbmZvKHsgc2NoZW1hOiBhc24xLnJlc3VsdFtUSU1FX1NUQU1QX1JFU1BfVE9LRU5dIH0pO1xuICAgIH1cbiAgICB0b1NjaGVtYSgpIHtcbiAgICAgICAgY29uc3Qgb3V0cHV0QXJyYXkgPSBbXTtcbiAgICAgICAgb3V0cHV0QXJyYXkucHVzaCh0aGlzLnN0YXR1cy50b1NjaGVtYSgpKTtcbiAgICAgICAgaWYgKHRoaXMudGltZVN0YW1wVG9rZW4pIHtcbiAgICAgICAgICAgIG91dHB1dEFycmF5LnB1c2godGhpcy50aW1lU3RhbXBUb2tlbi50b1NjaGVtYSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5ldyBhc24xanMuU2VxdWVuY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IG91dHB1dEFycmF5XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICBzdGF0dXM6IHRoaXMuc3RhdHVzLnRvSlNPTigpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnRpbWVTdGFtcFRva2VuKSB7XG4gICAgICAgICAgICByZXMudGltZVN0YW1wVG9rZW4gPSB0aGlzLnRpbWVTdGFtcFRva2VuLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuICAgIGFzeW5jIHNpZ24ocHJpdmF0ZUtleSwgaGFzaEFsZ29yaXRobSwgY3J5cHRvID0gZ2V0Q3J5cHRvKHRydWUpKSB7XG4gICAgICAgIHRoaXMuYXNzZXJ0Q29udGVudFR5cGUoKTtcbiAgICAgICAgY29uc3Qgc2lnbmVkID0gbmV3IFNpZ25lZERhdGEoeyBzY2hlbWE6IHRoaXMudGltZVN0YW1wVG9rZW4uY29udGVudCB9KTtcbiAgICAgICAgcmV0dXJuIHNpZ25lZC5zaWduKHByaXZhdGVLZXksIDAsIGhhc2hBbGdvcml0aG0sIHVuZGVmaW5lZCwgY3J5cHRvKTtcbiAgICB9XG4gICAgYXN5bmMgdmVyaWZ5KHZlcmlmaWNhdGlvblBhcmFtZXRlcnMgPSB7IHNpZ25lcjogMCwgdHJ1c3RlZENlcnRzOiBbXSwgZGF0YTogRU1QVFlfQlVGRkVSIH0sIGNyeXB0byA9IGdldENyeXB0byh0cnVlKSkge1xuICAgICAgICB0aGlzLmFzc2VydENvbnRlbnRUeXBlKCk7XG4gICAgICAgIGNvbnN0IHNpZ25lZCA9IG5ldyBTaWduZWREYXRhKHsgc2NoZW1hOiB0aGlzLnRpbWVTdGFtcFRva2VuLmNvbnRlbnQgfSk7XG4gICAgICAgIHJldHVybiBzaWduZWQudmVyaWZ5KHZlcmlmaWNhdGlvblBhcmFtZXRlcnMsIGNyeXB0byk7XG4gICAgfVxuICAgIGFzc2VydENvbnRlbnRUeXBlKCkge1xuICAgICAgICBpZiAoIXRoaXMudGltZVN0YW1wVG9rZW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRpbWVTdGFtcFRva2VuIGlzIGFic2VudCBpbiBUU1AgcmVzcG9uc2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudGltZVN0YW1wVG9rZW4uY29udGVudFR5cGUgIT09IGlkX0NvbnRlbnRUeXBlX1NpZ25lZERhdGEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgV3JvbmcgZm9ybWF0IG9mIHRpbWVTdGFtcFRva2VuOiAke3RoaXMudGltZVN0YW1wVG9rZW4uY29udGVudFR5cGV9YCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5UaW1lU3RhbXBSZXNwLkNMQVNTX05BTUUgPSBcIlRpbWVTdGFtcFJlc3BcIjtcblxuZnVuY3Rpb24gaW5pdENyeXB0b0VuZ2luZSgpIHtcbiAgICBpZiAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgaWYgKFwiY3J5cHRvXCIgaW4gc2VsZikge1xuICAgICAgICAgICAgbGV0IGVuZ2luZU5hbWUgPSBcIndlYmNyeXB0b1wiO1xuICAgICAgICAgICAgaWYgKFwid2Via2l0U3VidGxlXCIgaW4gc2VsZi5jcnlwdG8pIHtcbiAgICAgICAgICAgICAgICBlbmdpbmVOYW1lID0gXCJzYWZhcmlcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldEVuZ2luZShlbmdpbmVOYW1lLCBuZXcgQ3J5cHRvRW5naW5lKHsgbmFtZTogZW5naW5lTmFtZSwgY3J5cHRvOiBjcnlwdG8gfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBjcnlwdG8gIT09IFwidW5kZWZpbmVkXCIgJiYgXCJ3ZWJjcnlwdG9cIiBpbiBjcnlwdG8pIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IFwiTm9kZUpTIF4xNVwiO1xuICAgICAgICBjb25zdCBub2RlQ3J5cHRvID0gY3J5cHRvLndlYmNyeXB0bztcbiAgICAgICAgc2V0RW5naW5lKG5hbWUsIG5ldyBDcnlwdG9FbmdpbmUoeyBuYW1lLCBjcnlwdG86IG5vZGVDcnlwdG8gfSkpO1xuICAgIH1cbn1cblxuaW5pdENyeXB0b0VuZ2luZSgpO1xuXG5leHBvcnQgeyBBYnN0cmFjdENyeXB0b0VuZ2luZSwgQWNjZXNzRGVzY3JpcHRpb24sIEFjY3VyYWN5LCBBbGdvcml0aG1JZGVudGlmaWVyLCBBbHROYW1lLCBBcmd1bWVudEVycm9yLCBBc25FcnJvciwgQXR0Q2VydFZhbGlkaXR5UGVyaW9kLCBBdHRyaWJ1dGUsIEF0dHJpYnV0ZUNlcnRpZmljYXRlSW5mb1YxLCBBdHRyaWJ1dGVDZXJ0aWZpY2F0ZUluZm9WMiwgQXR0cmlidXRlQ2VydGlmaWNhdGVWMSwgQXR0cmlidXRlQ2VydGlmaWNhdGVWMiwgQXR0cmlidXRlVHlwZUFuZFZhbHVlLCBBdXRoZW50aWNhdGVkU2FmZSwgQXV0aG9yaXR5S2V5SWRlbnRpZmllciwgQmFzaWNDb25zdHJhaW50cywgQmFzaWNPQ1NQUmVzcG9uc2UsIENBVmVyc2lvbiwgQ1JMQmFnLCBDUkxEaXN0cmlidXRpb25Qb2ludHMsIENlcnRCYWcsIENlcnRJRCwgQ2VydGlmaWNhdGUsIENlcnRpZmljYXRlQ2hhaW5WYWxpZGF0aW9uRW5naW5lLCBDZXJ0aWZpY2F0ZVBvbGljaWVzLCBDZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0LCBDZXJ0aWZpY2F0ZVNldCwgQ2VydGlmaWNhdGVUZW1wbGF0ZSwgQ2VydGlmaWNhdGlvblJlcXVlc3QsIENoYWluVmFsaWRhdGlvbkNvZGUsIENoYWluVmFsaWRhdGlvbkVycm9yLCBDb250ZW50SW5mbywgQ3J5cHRvRW5naW5lLCBEaWdlc3RJbmZvLCBEaXN0cmlidXRpb25Qb2ludCwgRUNDQ01TU2hhcmVkSW5mbywgRUNOYW1lZEN1cnZlcywgRUNQcml2YXRlS2V5LCBFQ1B1YmxpY0tleSwgRW5jYXBzdWxhdGVkQ29udGVudEluZm8sIEVuY3J5cHRlZENvbnRlbnRJbmZvLCBFbmNyeXB0ZWREYXRhLCBFbnZlbG9wZWREYXRhLCBFeHRLZXlVc2FnZSwgRXh0ZW5zaW9uLCBFeHRlbnNpb25WYWx1ZUZhY3RvcnksIEV4dGVuc2lvbnMsIEdlbmVyYWxOYW1lLCBHZW5lcmFsTmFtZXMsIEdlbmVyYWxTdWJ0cmVlLCBIQVNIRURfTUVTU0FHRSwgSEFTSF9BTEdPUklUSE0sIEhvbGRlciwgSW5mb0FjY2VzcywgSXNzdWVyQW5kU2VyaWFsTnVtYmVyLCBJc3N1ZXJTZXJpYWwsIElzc3VpbmdEaXN0cmlidXRpb25Qb2ludCwgS0VLSWRlbnRpZmllciwgS0VLUmVjaXBpZW50SW5mbywgS2V5QWdyZWVSZWNpcGllbnRJZGVudGlmaWVyLCBLZXlBZ3JlZVJlY2lwaWVudEluZm8sIEtleUJhZywgS2V5VHJhbnNSZWNpcGllbnRJbmZvLCBNSUNST1MsIE1JTExJUywgTWFjRGF0YSwgTWVzc2FnZUltcHJpbnQsIE5hbWVDb25zdHJhaW50cywgT0NTUFJlcXVlc3QsIE9DU1BSZXNwb25zZSwgT2JqZWN0RGlnZXN0SW5mbywgT3JpZ2luYXRvcklkZW50aWZpZXJPcktleSwgT3JpZ2luYXRvckluZm8sIE9yaWdpbmF0b3JQdWJsaWNLZXksIE90aGVyQ2VydGlmaWNhdGVGb3JtYXQsIE90aGVyS2V5QXR0cmlidXRlLCBPdGhlclByaW1lSW5mbywgT3RoZXJSZWNpcGllbnRJbmZvLCBPdGhlclJldm9jYXRpb25JbmZvRm9ybWF0LCBQQkVTMlBhcmFtcywgUEJLREYyUGFyYW1zLCBQRlgsIFBLQ1M4U2hyb3VkZWRLZXlCYWcsIFBLSVN0YXR1cywgUEtJU3RhdHVzSW5mbywgUE9MSUNZX0lERU5USUZJRVIsIFBPTElDWV9RVUFMSUZJRVJTLCBQYXJhbWV0ZXJFcnJvciwgUGFzc3dvcmRSZWNpcGllbnRpbmZvLCBQa2lPYmplY3QsIFBvbGljeUNvbnN0cmFpbnRzLCBQb2xpY3lJbmZvcm1hdGlvbiwgUG9saWN5TWFwcGluZywgUG9saWN5TWFwcGluZ3MsIFBvbGljeVF1YWxpZmllckluZm8sIFByaXZhdGVLZXlJbmZvLCBQcml2YXRlS2V5VXNhZ2VQZXJpb2QsIFB1YmxpY0tleUluZm8sIFFDU3RhdGVtZW50LCBRQ1N0YXRlbWVudHMsIFJETiwgUlNBRVNPQUVQUGFyYW1zLCBSU0FQcml2YXRlS2V5LCBSU0FQdWJsaWNLZXksIFJTQVNTQVBTU1BhcmFtcywgUmVjaXBpZW50RW5jcnlwdGVkS2V5LCBSZWNpcGllbnRFbmNyeXB0ZWRLZXlzLCBSZWNpcGllbnRJZGVudGlmaWVyLCBSZWNpcGllbnRJbmZvLCBSZWNpcGllbnRLZXlJZGVudGlmaWVyLCBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lcywgUmVxdWVzdCwgUmVzcG9uc2VCeXRlcywgUmVzcG9uc2VEYXRhLCBSZXZvY2F0aW9uSW5mb0Nob2ljZXMsIFJldm9rZWRDZXJ0aWZpY2F0ZSwgU0VDT05EUywgU2FmZUJhZywgU2FmZUJhZ1ZhbHVlRmFjdG9yeSwgU2FmZUNvbnRlbnRzLCBTZWNyZXRCYWcsIFNpZ25hdHVyZSwgU2lnbmVkQW5kVW5zaWduZWRBdHRyaWJ1dGVzLCBTaWduZWRDZXJ0aWZpY2F0ZVRpbWVzdGFtcCwgU2lnbmVkQ2VydGlmaWNhdGVUaW1lc3RhbXBMaXN0LCBTaWduZWREYXRhLCBTaWduZWREYXRhVmVyaWZ5RXJyb3IsIFNpZ25lckluZm8sIFNpbmdsZVJlc3BvbnNlLCBTdWJqZWN0RGlyZWN0b3J5QXR0cmlidXRlcywgVEJTUmVxdWVzdCwgVFNUSW5mbywgVFlQRSQ0IGFzIFRZUEUsIFRZUEVfQU5EX1ZBTFVFUywgVGltZSwgVGltZVN0YW1wUmVxLCBUaW1lU3RhbXBSZXNwLCBUaW1lVHlwZSwgVjJGb3JtLCBWQUxVRSQ1IGFzIFZBTFVFLCBWQUxVRV9CRUZPUkVfREVDT0RFLCBjaGVja0NBLCBjcmVhdGVDTVNFQ0RTQVNpZ25hdHVyZSwgY3JlYXRlRUNEU0FTaWduYXR1cmVGcm9tQ01TLCBlbmdpbmUsIGdldEFsZ29yaXRobUJ5T0lELCBnZXRBbGdvcml0aG1QYXJhbWV0ZXJzLCBnZXRDcnlwdG8sIGdldEVuZ2luZSwgZ2V0SGFzaEFsZ29yaXRobSwgZ2V0T0lEQnlBbGdvcml0aG0sIGdldFJhbmRvbVZhbHVlcywgaWRfQW55UG9saWN5LCBpZF9BdXRob3JpdHlJbmZvQWNjZXNzLCBpZF9BdXRob3JpdHlLZXlJZGVudGlmaWVyLCBpZF9CYXNlQ1JMTnVtYmVyLCBpZF9CYXNpY0NvbnN0cmFpbnRzLCBpZF9DUkxCYWdfWDUwOUNSTCwgaWRfQ1JMRGlzdHJpYnV0aW9uUG9pbnRzLCBpZF9DUkxOdW1iZXIsIGlkX0NSTFJlYXNvbiwgaWRfQ2VydEJhZ19BdHRyaWJ1dGVDZXJ0aWZpY2F0ZSwgaWRfQ2VydEJhZ19TRFNJQ2VydGlmaWNhdGUsIGlkX0NlcnRCYWdfWDUwOUNlcnRpZmljYXRlLCBpZF9DZXJ0aWZpY2F0ZUlzc3VlciwgaWRfQ2VydGlmaWNhdGVQb2xpY2llcywgaWRfQ29udGVudFR5cGVfRGF0YSwgaWRfQ29udGVudFR5cGVfRW5jcnlwdGVkRGF0YSwgaWRfQ29udGVudFR5cGVfRW52ZWxvcGVkRGF0YSwgaWRfQ29udGVudFR5cGVfU2lnbmVkRGF0YSwgaWRfRXh0S2V5VXNhZ2UsIGlkX0ZyZXNoZXN0Q1JMLCBpZF9JbmhpYml0QW55UG9saWN5LCBpZF9JbnZhbGlkaXR5RGF0ZSwgaWRfSXNzdWVyQWx0TmFtZSwgaWRfSXNzdWluZ0Rpc3RyaWJ1dGlvblBvaW50LCBpZF9LZXlVc2FnZSwgaWRfTWljcm9zb2Z0QXBwUG9saWNpZXMsIGlkX01pY3Jvc29mdENhVmVyc2lvbiwgaWRfTWljcm9zb2Z0Q2VydFRlbXBsYXRlVjEsIGlkX01pY3Jvc29mdENlcnRUZW1wbGF0ZVYyLCBpZF9NaWNyb3NvZnRQcmV2Q2FDZXJ0SGFzaCwgaWRfTmFtZUNvbnN0cmFpbnRzLCBpZF9QS0lYX09DU1BfQmFzaWMsIGlkX1BvbGljeUNvbnN0cmFpbnRzLCBpZF9Qb2xpY3lNYXBwaW5ncywgaWRfUHJpdmF0ZUtleVVzYWdlUGVyaW9kLCBpZF9RQ1N0YXRlbWVudHMsIGlkX1NpZ25lZENlcnRpZmljYXRlVGltZXN0YW1wTGlzdCwgaWRfU3ViamVjdEFsdE5hbWUsIGlkX1N1YmplY3REaXJlY3RvcnlBdHRyaWJ1dGVzLCBpZF9TdWJqZWN0SW5mb0FjY2VzcywgaWRfU3ViamVjdEtleUlkZW50aWZpZXIsIGlkX2FkLCBpZF9hZF9jYUlzc3VlcnMsIGlkX2FkX29jc3AsIGlkX2VDb250ZW50VHlwZV9UU1RJbmZvLCBpZF9wa2l4LCBpZF9zaGExLCBpZF9zaGEyNTYsIGlkX3NoYTM4NCwgaWRfc2hhNTEyLCBrZGYsIHNldEVuZ2luZSwgc3RyaW5nUHJlcCwgdmVyaWZ5U0NUc0ZvckNlcnRpZmljYXRlIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/pkijs/build/index.es.js\n");

/***/ })

};
;